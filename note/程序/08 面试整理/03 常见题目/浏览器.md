# 浏览器

仅作大纲描述

## 从输入 URL 到页面加载完成的过程

1. DNS 查询
2. TCP 连接
3. 数据传输，状态判断
4. 资源解析(解码、解压)
5. 渲染流程(DOM + Style DOM -> render tree -> layout -> paint -> display)

## 事件循环(帧)

1. 当 Event loop 执行完 Microtasks 后，会判断 document 是否需要更新。因为浏览器是 60Hz 的刷新率，每 16ms 才会更新一次。
2. 然后判断是否有 resize 或者 scroll ，有的话会去触发事件，所以 resize 和 scroll 事件也是至少 16ms 才会触发一次，并且自带节流功能。
3. 判断是否触发了 media query
4. 更新动画并且发送事件
5. 判断是否有全屏操作事件
6. 执行 requestAnimationFrame 回调
7. 执行 IntersectionObserver 回调，该方法用于判断元素是否可见，可以用于懒加载上，但是兼容性不好
8. 更新界面
9. 以上就是一帧中可能会做的事情。如果在一帧中有空闲时间，就会去执行 requestIdleCallback 回调。

## 缓存

- 强缓存：Expired / Cache-Control: max-age=3600
- 协商缓存: Last-Modified | If-Modified-Since; ETag | If-None-Match
