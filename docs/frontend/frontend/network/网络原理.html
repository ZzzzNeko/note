<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>网络原理 | 前端梳理</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="">
    <link rel="preload" href="/note/frontend/assets/css/0.styles.f583d883.css" as="style"><link rel="preload" href="/note/frontend/assets/js/app.eced46f7.js" as="script"><link rel="preload" href="/note/frontend/assets/js/2.b6515a82.js" as="script"><link rel="preload" href="/note/frontend/assets/js/16.6437975a.js" as="script"><link rel="prefetch" href="/note/frontend/assets/js/10.f72ffc0a.js"><link rel="prefetch" href="/note/frontend/assets/js/11.d6ef73ec.js"><link rel="prefetch" href="/note/frontend/assets/js/12.3f087f64.js"><link rel="prefetch" href="/note/frontend/assets/js/13.f8b42937.js"><link rel="prefetch" href="/note/frontend/assets/js/14.8965b067.js"><link rel="prefetch" href="/note/frontend/assets/js/15.b05c841a.js"><link rel="prefetch" href="/note/frontend/assets/js/17.f0a618f1.js"><link rel="prefetch" href="/note/frontend/assets/js/18.734b2c5d.js"><link rel="prefetch" href="/note/frontend/assets/js/19.ff03f539.js"><link rel="prefetch" href="/note/frontend/assets/js/20.6f5fc561.js"><link rel="prefetch" href="/note/frontend/assets/js/21.d95a981e.js"><link rel="prefetch" href="/note/frontend/assets/js/22.5550cf8c.js"><link rel="prefetch" href="/note/frontend/assets/js/3.bee01d26.js"><link rel="prefetch" href="/note/frontend/assets/js/4.ebd39db4.js"><link rel="prefetch" href="/note/frontend/assets/js/5.1515271b.js"><link rel="prefetch" href="/note/frontend/assets/js/6.2ebd2551.js"><link rel="prefetch" href="/note/frontend/assets/js/7.df3151be.js"><link rel="prefetch" href="/note/frontend/assets/js/8.2f585eec.js"><link rel="prefetch" href="/note/frontend/assets/js/9.75d035fb.js">
    <link rel="stylesheet" href="/note/frontend/assets/css/0.styles.f583d883.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/frontend/" class="home-link router-link-active"><img src="/note/frontend/imgs/logo.jpg" alt="前端梳理" class="logo"> <span class="site-name can-hide">前端梳理</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/frontend/frontend/basic/" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/note/frontend/frontend/network/" class="nav-link router-link-active">
  网络
</a></div><div class="nav-item"><a href="/note/frontend/frontend/project/" class="nav-link">
  工程
</a></div><div class="nav-item"><a href="http://blog.lazyneko.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  nekoya
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/frontend/frontend/basic/" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/note/frontend/frontend/network/" class="nav-link router-link-active">
  网络
</a></div><div class="nav-item"><a href="/note/frontend/frontend/project/" class="nav-link">
  工程
</a></div><div class="nav-item"><a href="http://blog.lazyneko.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  nekoya
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/note/frontend/frontend/network/网络原理.html" class="active sidebar-link">网络原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#网络模型" class="sidebar-link">网络模型</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#tcp" class="sidebar-link">TCP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#三次握手" class="sidebar-link">三次握手</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#四次挥手" class="sidebar-link">四次挥手</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#重传机制" class="sidebar-link">重传机制</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#滑动窗口" class="sidebar-link">滑动窗口</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#拥塞控制" class="sidebar-link">拥塞控制</a></li></ul></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#udp" class="sidebar-link">UDP</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#dns" class="sidebar-link">DNS</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#http" class="sidebar-link">HTTP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#基本内容" class="sidebar-link">基本内容</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#http1-x" class="sidebar-link">HTTP1.x</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#https" class="sidebar-link">HTTPS</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络原理.html#http2" class="sidebar-link">HTTP2</a></li></ul></li></ul></li><li><a href="/note/frontend/frontend/network/网络安全.html" class="sidebar-link">网络安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络安全.html#跨站脚本攻击-xss" class="sidebar-link">跨站脚本攻击(XSS)</a></li><li class="sidebar-sub-header"><a href="/note/frontend/frontend/network/网络安全.html#跨站请求伪造-csrf" class="sidebar-link">跨站请求伪造(CSRF)</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="网络原理"><a href="#网络原理" class="header-anchor">#</a> 网络原理</h1> <h2 id="网络模型"><a href="#网络模型" class="header-anchor">#</a> 网络模型</h2> <ul><li>应用层</li> <li>传输层</li> <li>网络层</li> <li>链路层</li></ul> <h2 id="tcp"><a href="#tcp" class="header-anchor">#</a> TCP</h2> <h3 id="三次握手"><a href="#三次握手" class="header-anchor">#</a> 三次握手</h3> <ol><li>请求方 -- SYN --&gt; 响应方；请求方进入 SYN_SEND 状态</li> <li>响应方(接收 SYN) -- ACK + SYN --&gt; 请求方；响应方进入 SYN_RECV 状态</li> <li>请求方(接收 ACK + SYN) -- ACK --&gt; 响应方；请求方进入 ESTABLISHED 状态</li></ol> <h3 id="四次挥手"><a href="#四次挥手" class="header-anchor">#</a> 四次挥手</h3> <ol><li>请求方 -- FIN --&gt; 响应方；请求方不再发送数据，进入 FIN_WAIT_1 状态</li> <li>响应方(接收 FIN) -- ACK --&gt; 请求方；
<ul><li>响应方进入 CLOSE_WAIT 状态</li> <li>请求方(接收 ACK) 进入 FIN_WAIT_2 状态</li></ul></li> <li>响应方(数据发送完) -- FIN --&gt; 请求方；响应方进入 LAST_ACT 状态</li> <li>请求方(接收 FIN) -- ACK --&gt; 响应方；请求方进入 TIME_WAIT 状态
<ul><li>响应方(接收 ACK) 进入 CLOSED 状态</li> <li>请求方(经过最大生存期后)进入 CLOSED 状态</li></ul></li></ol> <p>说明：第二次和第三次可以合并发送</p> <h3 id="重传机制"><a href="#重传机制" class="header-anchor">#</a> 重传机制</h3> <p>在发送报文时会开启定时器并保留副本</p> <ul><li>在定时器时间内接收到响应则取消定时器并删除副本</li> <li>在超出定时器时间外会重置定时器并重新发送报文</li> <li>一般超时重传时间取 加权平均往返时间 + 4 倍加权平均往返偏差时间</li></ul> <h3 id="滑动窗口"><a href="#滑动窗口" class="header-anchor">#</a> 滑动窗口</h3> <p>发送方和接收方分别维护发送窗口和接收窗口</p> <ul><li>发送窗口按序号发送帧，直到全部帧处于待确认状态</li> <li>接收窗口按序号接收帧，接收后发送确认帧后滑动窗口</li> <li>发送窗口接收到确认帧，删除重发表对应帧后滑动窗口</li></ul> <p>根据发送窗口和接收窗口的大小分为</p> <ul><li>停等协议：发送窗口=1，接收窗口=1；需要不断等待应答，效率低下</li> <li>后退 n 协议：发送窗口&gt;1，接收窗口=1；重传时需要后退到错误帧并重传</li> <li>选择重传协议：发生窗口&gt;1，接收窗口&gt;1；传输效率较高，需要接收方具有足够的缓冲空间</li></ul> <h3 id="拥塞控制"><a href="#拥塞控制" class="header-anchor">#</a> 拥塞控制</h3> <ol><li>慢启动：给定一个初始 cwnd，每次收到确认包时大小翻倍，直到达到 ssthresh 或丢包</li> <li>拥塞避免：cwnd 达到 ssthresh 时，采用线增积减的反馈机制控制 cwnd 大小
<ul><li>若网络良好，则每经过一个 RTT ，cwnd 与 ssthresh += 1MSS</li> <li>若网络拥塞，则 ssthresh 减半，cwnd 置为 1MSS，进入慢启动阶段</li></ul></li> <li>快速重传：当发送方收到 4 次相同的确认时，忽略超时计时器并立即重发，进入快速恢复阶段</li> <li>快速恢复：发送方将 cwnd 与 ssthresh 减半，进入拥塞避免阶段</li></ol> <p>说明：</p> <ul><li>MSS: 最大分段大小，拥塞窗口的大小单位</li> <li>cwnd: 拥塞窗口，每次发送数据包的大小，由发送方维护</li> <li>ssthresh: 慢开始门限，控制拥塞窗口的最大值</li></ul> <h2 id="udp"><a href="#udp" class="header-anchor">#</a> UDP</h2> <div class="language-code extra-class"><pre class="language-text"><code>&lt;源端口号&gt;&lt;目的端口&gt;
&lt;报文长度&gt;&lt;报文校验码&gt;
&lt;数据内容&gt;
</code></pre></div><p>特点：报文结构简单，开销低，传输效率高；传输时不建立连接，无状态、不可靠</p> <p>用途：DNS，广播，及时通话</p> <h2 id="dns"><a href="#dns" class="header-anchor">#</a> DNS</h2> <p>域名系统时将域名与 IP 地址相互映射的分布式数据库</p> <p>域名解析流程</p> <ul><li>静态映射：通过本地缓存或配置进行查询
<ol><li>客户端缓存</li> <li>本地 host</li> <li>本地 DNS 缓存</li> <li>本地 DNS 服务器</li></ol></li> <li>动态映射：通过其他域名服务器进行查询
<ol><li>跟域名服务器</li> <li>顶级域名服务器</li> <li>权威域名服务器</li></ol></li></ul> <p>DNS 基于 UDP 协议实现，理由如下</p> <ul><li>DNS 解析发生在数据传输之前，追求快速</li> <li>DNS 解析报文简单，域名服务器相对稳定</li></ul> <p>注：当报文超过 512 字节时，应当转为 TCP 进行查询</p> <h2 id="http"><a href="#http" class="header-anchor">#</a> HTTP</h2> <h3 id="基本内容"><a href="#基本内容" class="header-anchor">#</a> 基本内容</h3> <p>报文格式</p> <ul><li>请求报文
<ul><li>请求行：方法 地址 协议</li> <li>请求头</li> <li>空行</li> <li>请求体</li></ul></li> <li>响应报文
<ul><li>状态行(协议 状态)</li> <li>响应头</li> <li>恐慌</li> <li>响应体</li></ul></li></ul> <p>请求方法：GET POST PUT PATCH DELETE OPTIONS HEAD TRACE CONNECT</p> <p>状态码</p> <ul><li>1xx：消息类通知</li> <li>2xx：成功类通知</li> <li>3xx：重定向通知；301-永久重定向，302-临时重定向，304-命中协商缓存</li> <li>4xx：客户端错误；400-请求错误，401-用户未认证，403-请求被拒绝，404-资源不存在</li> <li>5xx：服务端错误：500-服务器异常，502-网关错误，504-网关超时</li></ul> <h3 id="http1-x"><a href="#http1-x" class="header-anchor">#</a> HTTP1.x</h3> <p>传输特点</p> <ul><li>持久连接：设置 <code>Connection: Keep-Alive</code>开启</li> <li>管道机制</li> <li>断点续传</li> <li>虚拟网络</li></ul> <p>存在问题</p> <ul><li>明文传输：可以被窃听、篡改、冒充</li> <li>性能浪费：由 持久连接 导致占用服务器资源</li> <li>对头阻塞：由 管道机制 导致有序请求阻塞时整列请求受阻</li></ul> <h3 id="https"><a href="#https" class="header-anchor">#</a> HTTPS</h3> <p>HTTPS = HTTP + SSL/TLS</p> <p>SSL/TLS 进行了以下处理</p> <ul><li>信息加密，避免窃听</li> <li>信息校验，避免篡改</li> <li>证书校验，避免冒充</li></ul> <p>工作流程</p> <ol><li>客户端 -- client hello --&gt; 服务端</li> <li>服务端 -- 证书(公钥) --&gt; 客户端</li> <li>客户端(获取证书公钥) -- 公钥加密信息 --&gt; 服务端</li> <li>服务端(私钥解密信息) -- 生成会话密钥 --&gt; 客户端</li> <li>后续服务端与客户端使用会话密钥进行加密解密通信(对称加密)</li></ol> <h3 id="http2"><a href="#http2" class="header-anchor">#</a> HTTP2</h3> <ul><li>二进制分帧</li> <li>请求优先级</li> <li>头部压缩</li> <li>多路复用：解决 对头阻塞 问题</li> <li>服务端推送</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/note/frontend/frontend/network/网络安全.html">
        网络安全
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/note/frontend/assets/js/app.eced46f7.js" defer></script><script src="/note/frontend/assets/js/2.b6515a82.js" defer></script><script src="/note/frontend/assets/js/16.6437975a.js" defer></script>
  </body>
</html>
