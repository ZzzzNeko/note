(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{297:function(t,a,s){"use strict";s.r(a);var n=s(10),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"项目优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目优化"}},[t._v("#")]),t._v(" 项目优化")]),t._v(" "),a("h2",{attrs:{id:"加载优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加载优化"}},[t._v("#")]),t._v(" 加载优化")]),t._v(" "),a("p",[t._v("不同于传统 GUI 开发应用先下载后使用的方式，网页应用是动态增量下载的 "),a("br"),t._v("\n因而页面加载是对用户使用体验影响最大的部分，超过 3s 的加载时间会导致大量用户的流失。"),a("br"),t._v("\n提高加载速度，即在最短的时间内获取用户需要使用到的资源，包括对资源的压缩和控制资源的获取两大方面。")]),t._v(" "),a("h3",{attrs:{id:"资源方面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资源方面"}},[t._v("#")]),t._v(" 资源方面")]),t._v(" "),a("p",[t._v("图片资源")]),t._v(" "),a("ul",[a("li",[t._v("小图资源：对于常规小图采用 BASE64 编码，对于图标资源转为字体图标或 svg 图标，以减少资源请求")]),t._v(" "),a("li",[t._v("大图资源：开启资源压缩，或使用预览图片用于原图加载的缓冲")])]),t._v(" "),a("p",[t._v("代码资源")]),t._v(" "),a("ul",[a("li",[t._v("使用 tree shaking 移除无效代码")]),t._v(" "),a("li",[t._v("开启压缩减少代码体积")]),t._v(" "),a("li",[t._v("使用 SplitChunks 拆分依赖")])]),t._v(" "),a("h3",{attrs:{id:"网络方面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络方面"}},[t._v("#")]),t._v(" 网络方面")]),t._v(" "),a("p",[t._v("配置 CDN")]),t._v(" "),a("ul",[a("li",[t._v("对静态资源或静态页面开启 CDN")]),t._v(" "),a("li",[t._v("针对不同的资源类型使用不同的域名(并避免 cookie 的携带)")])]),t._v(" "),a("p",[t._v("配置缓存")]),t._v(" "),a("ul",[a("li",[t._v("频繁修改的资源：使用协商缓存，配置 "),a("code",[t._v("Cache-Control: no-cache")]),t._v(" 并配合 "),a("code",[t._v("Etag")]),t._v(" 检测是否使用缓存")]),t._v(" "),a("li",[t._v("长期不变的资源：使用强缓存，配置 "),a("code",[t._v("Cache-Control: max-age=xxx")])]),t._v(" "),a("li",[t._v("无需缓存的资源：禁用缓存，配置 "),a("code",[t._v("Cache-Control: no-store")])])]),t._v(" "),a("p",[t._v("开启 HTTP2")]),t._v(" "),a("ul",[a("li",[t._v("多路复用：提高 TCP 连接使用效率")]),t._v(" "),a("li",[t._v("头部压缩：减少数据请求大小")])]),t._v(" "),a("p",[t._v("服务端")]),t._v(" "),a("ul",[a("li",[t._v("DNS 解析使用 IP 循环")]),t._v(" "),a("li",[t._v("开启反向代理实现负载均衡")]),t._v(" "),a("li",[t._v("开启 GZIP 压缩减少响应体积")])]),t._v(" "),a("h3",{attrs:{id:"加载方面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#加载方面"}},[t._v("#")]),t._v(" 加载方面")]),t._v(" "),a("p",[t._v("标签位置")]),t._v(" "),a("ul",[a("li",[t._v("样式文件：置于页面头部，CSS 文件的加载不会阻塞 DOM 的解析")]),t._v(" "),a("li",[t._v("脚本文件：置于页面底部，JS 文件的加载会阻塞页面的解析和渲染")])]),t._v(" "),a("p",[t._v("预处理")]),t._v(" "),a("ul",[a("li",[t._v("DNS 预获取："),a("code",[t._v('<link rel="dns-prefetch" href="//www.xxx.com" />')])]),t._v(" "),a("li",[t._v("资源预加载："),a("code",[t._v('<link rel="preload" href="https://www.xxx.com" as="style" />')]),t._v(" "),a("ul",[a("li",[t._v("用于预先加载当前页面需要使用的资源，提高在后续使用时的效率")])])]),t._v(" "),a("li",[t._v("资源预获取："),a("code",[t._v('<link rel="prefetch" href="https://www.xxx.com" />')]),t._v(" "),a("ul",[a("li",[t._v("用于预先获取接下来需要使用的资源并缓存 5 分钟，提高页面切换时的效率")])])]),t._v(" "),a("li",[t._v("资源预渲染："),a("code",[t._v('<link rel="prerender" href="https://www.xxx.com" />')]),t._v(" "),a("ul",[a("li",[t._v("实验中的属性，预先获取资源并在屏幕之外进行渲染，提高渲染时的效率")])])])]),t._v(" "),a("p",[t._v("懒加载")]),t._v(" "),a("ul",[a("li",[t._v("懒加载：在使用时再加载\n"),a("ul",[a("li",[t._v("路由切换：常见于 SPA 应用")]),t._v(" "),a("li",[t._v("滚动加载：当模块滚动到可视区域时进行加载(如 "),a("code",[t._v('<img loading="lazy" />')]),t._v(")")])])]),t._v(" "),a("li",[t._v("懒执行：在使用时再执行，通常用于耗时逻辑，一般通过事件唤醒")])]),t._v(" "),a("h3",{attrs:{id:"首屏加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#首屏加载"}},[t._v("#")]),t._v(" 首屏加载")]),t._v(" "),a("p",[t._v("首屏加载主要指优化白屏时间以提升用户体验")]),t._v(" "),a("ul",[a("li",[t._v("对于需要服务请求的页面：可以使用 loading 或骨架屏缓解用户等待体验")]),t._v(" "),a("li",[t._v("对于无需服务请求的页面：可以使用服务端渲染或静态页面")])]),t._v(" "),a("h2",{attrs:{id:"运行优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行优化"}},[t._v("#")]),t._v(" 运行优化")]),t._v(" "),a("p",[t._v("某些时候，可能需要使用动画效果提升页面表现，或者渲染大量的列表元素用于内容展示 "),a("br"),t._v("\n前者往往容易频繁的触发页面的回流重绘降低网页流畅度，后者可能导致页面短时间卡顿。")]),t._v(" "),a("h3",{attrs:{id:"渲染优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渲染优化"}},[t._v("#")]),t._v(" 渲染优化")]),t._v(" "),a("ul",[a("li",[t._v("独立图层：独立图层的布局互不干扰，可以提高渲染效率\n"),a("ul",[a("li",[t._v("有 3d "),a("code",[t._v("transform")]),t._v("；")]),t._v(" "),a("li",[t._v("对 "),a("code",[t._v("opacity")]),t._v("、"),a("code",[t._v("transform")]),t._v("、"),a("code",[t._v("filter")]),t._v(" 应用了动画或过渡")]),t._v(" "),a("li",[t._v("设置 "),a("code",[t._v("will-change: opacity|transform|top|left|right|bottom")])])])]),t._v(" "),a("li",[t._v("减少回流\n"),a("ul",[a("li",[t._v("使用 "),a("code",[t._v("transform")]),t._v("、"),a("code",[t._v("opacity")]),t._v(" 实现动画效果，会创建独立图层并获得 GPU 加速")]),t._v(" "),a("li",[t._v("使用 "),a("code",[t._v("requestAnimationFrame")]),t._v(" 实现动画")]),t._v(" "),a("li",[t._v("对于多次操作的 DOM 元素先离线("),a("code",[t._v("display: none")]),t._v(")，等处理完毕后再展示")])])])]),t._v(" "),a("h3",{attrs:{id:"批量渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#批量渲染"}},[t._v("#")]),t._v(" 批量渲染")]),t._v(" "),a("p",[t._v("对于一次性渲染大量元素，可以使用 "),a("code",[t._v("requestAnimationFrame")]),t._v(" 控制渲染频率，使用 "),a("code",[t._v("DocumentFragment")]),t._v(" 对多个元素进行一次插入")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// <div id="wrap"></div>')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" total "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" once "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1e2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" nums "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fragment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createDocumentFragment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" once"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" div "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"div"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerText "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      fragment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    wrap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fragment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    nums "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" once"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nums "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" total"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestAnimationFrame")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"虚拟渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟渲染"}},[t._v("#")]),t._v(" 虚拟渲染")]),t._v(" "),a("p",[t._v("对于大量数据渲染的列表，若每项高度可计算，可以仅渲染可视区域以及滚动缓冲部分，对于其他不可视部分，使用一个计算后的空白盒子进行支撑。")]),t._v(" "),a("h3",{attrs:{id:"计算优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#计算优化"}},[t._v("#")]),t._v(" 计算优化")]),t._v(" "),a("p",[t._v("使用 web worker 将耗时的操作交给其他线程，减轻主线程压力")])])}),[],!1,null,null,null);a.default=e.exports}}]);