import{_ as s,v as a,b as l,R as n}from"./chunks/framework.cc13f38d.js";const C=JSON.parse('{"title":"跨域通信 - postMessage","description":"","frontmatter":{},"headers":[],"relativePath":"程序/网络通信/跨域通信/02-03 跨域通信 - postMessage.md","filePath":"程序/网络通信/跨域通信/02-03 跨域通信 - postMessage.md","lastUpdated":1688401094000}'),o={name:"程序/网络通信/跨域通信/02-03 跨域通信 - postMessage.md"},p=n(`<h1 id="跨域通信-postmessage" tabindex="-1">跨域通信 - postMessage <a class="header-anchor" href="#跨域通信-postmessage" aria-label="Permalink to &quot;跨域通信 - postMessage&quot;">​</a></h1><h2 id="实现方式" tabindex="-1">实现方式 <a class="header-anchor" href="#实现方式" aria-label="Permalink to &quot;实现方式&quot;">​</a></h2><p><code>targetWindow.postMessage(message, targetOrigin)</code></p><ul><li>说明 <ul><li>父级页面通过该方法将需要通知的信息传递给子页面</li><li>子级也 main 通过 <code>message</code> 事件获取传递的信息</li></ul></li><li>参数 <ul><li><code>message</code>: 需要通信的数据</li><li><code>targetOrigin &lt;string&gt;|&lt;URI&gt;</code>: 指定可以接受到该通信的窗口；如果指定值为 <code>&#39;*&#39;</code> 表示可以通知到任意窗口</li></ul></li></ul><p><code>message</code> 事件</p><ul><li>说明 <ul><li>监听 <code>postMessage</code> 传递的信息</li></ul></li><li>参数 <ul><li><code>ev &lt;object&gt;</code>: 事件对象 <ul><li><code>data</code>: 接受到的数据</li><li><code>origin &lt;URL&gt;</code>: 调用 <code>postMessage</code> 发送的窗口的 URL 地址</li><li><code>source</code>: 对发送消息的窗口对象的引用</li></ul></li></ul></li></ul><h2 id="实现示例" tabindex="-1">实现示例 <a class="header-anchor" href="#实现示例" aria-label="Permalink to &quot;实现示例&quot;">​</a></h2><h3 id="父级页面通知子页面-假设-mainiframe-为要通知的页面-id" tabindex="-1">父级页面通知子页面(假设, mainIframe 为要通知的页面 id) <a class="header-anchor" href="#父级页面通知子页面-假设-mainiframe-为要通知的页面-id" aria-label="Permalink to &quot;父级页面通知子页面(假设, mainIframe 为要通知的页面 id)&quot;">​</a></h3><ul><li><p>父级页面</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mainIframe</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">contentWindow</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">postMessage</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">msg</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">通知的信息</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">//这里第二个参数填域名地址，*表示全部域名都可以通知</span></span></code></pre></div></li><li><p>子级页面</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">message</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//e.data为父页面通知的信息</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div></li></ul><h3 id="子级页面通知父级页面" tabindex="-1">子级页面通知父级页面 <a class="header-anchor" href="#子级页面通知父级页面" aria-label="Permalink to &quot;子级页面通知父级页面&quot;">​</a></h3><ul><li><p>子级页面</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">top</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">postMessage</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">msg</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div></li><li><p>父级页面</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">message</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div></li></ul>`,11),e=[p];function t(c,r,i,D,y,F){return a(),l("div",null,e)}const d=s(o,[["render",t]]);export{C as __pageData,d as default};
