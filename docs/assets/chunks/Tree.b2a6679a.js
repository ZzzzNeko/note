import{u as zP,k as GP,A as UP,v as YP,b as VP}from"./framework.f165b36f.js";function WP(t,n){for(var e=0;e<n.length;e++){const r=n[e];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}const ry=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return Ri},get Circle(){return dY},get Ellipse(){return pY},get Image(){return gY},get Line(){return vY},get Marker(){return yY},get Path(){return $y},get Polygon(){return _Y},get Polyline(){return kY},get Rect(){return IY},get Text(){return TY}},Symbol.toStringTag,{value:"Module"})),iy=Object.freeze(Object.defineProperty({__proto__:null,get Base(){return bi},get Circle(){return PY},get Dom(){return LY},get Ellipse(){return jY},get Image(){return RY},get Line(){return FY},get Marker(){return BY},get Path(){return zY},get Polygon(){return GY},get Polyline(){return UY},get Rect(){return VY},get Text(){return qY}},Symbol.toStringTag,{value:"Module"}));var wv=function(t,n){return wv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])},wv(t,n)};function Te(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");wv(t,n);function e(){this.constructor=t}t.prototype=n===null?Object.create(n):(e.prototype=n.prototype,new e)}var B=function(){return B=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},B.apply(this,arguments)};function or(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]]);return e}function K_(t,n,e,r){var i=arguments.length,o=i<3?n:r===null?r=Object.getOwnPropertyDescriptor(n,e):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,n,e,r);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(i<3?a(o):i>3?a(n,e,o):a(n,e))||o);return i>3&&o&&Object.defineProperty(n,e,o),o}function Q_(t,n){return function(e,r){n(e,r,t)}}function XP(t,n,e,r,i,o){function a(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var s=r.kind,u=s==="getter"?"get":s==="setter"?"set":"value",c=!n&&t?r.static?t:t.prototype:null,l=n||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),h,f=!1,d=e.length-1;d>=0;d--){var p={};for(var g in r)p[g]=g==="access"?{}:r[g];for(var g in r.access)p.access[g]=r.access[g];p.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");o.push(a(m||null))};var v=(0,e[d])(s==="accessor"?{get:l.get,set:l.set}:l[u],p);if(s==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(h=a(v.get))&&(l.get=h),(h=a(v.set))&&(l.set=h),(h=a(v.init))&&i.unshift(h)}else(h=a(v))&&(s==="field"?i.unshift(h):l[u]=h)}c&&Object.defineProperty(c,r.name,l),f=!0}function HP(t,n,e){for(var r=arguments.length>2,i=0;i<n.length;i++)e=r?n[i].call(t,e):n[i].call(t);return r?e:void 0}function qP(t){return typeof t=="symbol"?t:"".concat(t)}function ZP(t,n,e){return typeof n=="symbol"&&(n=n.description?"[".concat(n.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:e?"".concat(e," ",n):n})}function J_(t,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,n)}function Hr(t,n,e,r){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(l){try{c(r.next(l))}catch(h){a(h)}}function u(l){try{c(r.throw(l))}catch(h){a(h)}}function c(l){l.done?o(l.value):i(l.value).then(s,u)}c((r=r.apply(t,n||[])).next())})}function qr(t,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(e=0)),e;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++,i=c[1],c=[0];continue;case 7:c=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){e=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){e.label=c[1];break}if(c[0]===6&&e.label<o[1]){e.label=o[1],o=c;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(c);break}o[2]&&e.ops.pop(),e.trys.pop();continue}c=n.call(t,e)}catch(l){c=[6,l],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}var op=Object.create?function(t,n,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,r,i)}:function(t,n,e,r){r===void 0&&(r=e),t[r]=n[e]};function $_(t,n){for(var e in t)e!=="default"&&!Object.prototype.hasOwnProperty.call(n,e)&&op(n,t,e)}function dd(t){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&t[n],r=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function oy(t,n){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var r=e.call(t),i,o=[],a;try{for(;(n===void 0||n-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(a)throw a.error}}return o}function tk(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(oy(arguments[n]));return t}function ap(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;for(var r=Array(t),i=0,n=0;n<e;n++)for(var o=arguments[n],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function Di(t,n,e){if(e||arguments.length===2)for(var r=0,i=n.length,o;r<i;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}function Nu(t){return this instanceof Nu?(this.v=t,this):new Nu(t)}function ek(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=e.apply(t,n||[]),i,o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(f){r[f]&&(i[f]=function(d){return new Promise(function(p,g){o.push([f,d,p,g])>1||s(f,d)})})}function s(f,d){try{u(r[f](d))}catch(p){h(o[0][3],p)}}function u(f){f.value instanceof Nu?Promise.resolve(f.value.v).then(c,l):h(o[0][2],f)}function c(f){s("next",f)}function l(f){s("throw",f)}function h(f,d){f(d),o.shift(),o.length&&s(o[0][0],o[0][1])}}function nk(t){var n,e;return n={},r("next"),r("throw",function(i){throw i}),r("return"),n[Symbol.iterator]=function(){return this},n;function r(i,o){n[i]=t[i]?function(a){return(e=!e)?{value:Nu(t[i](a)),done:!1}:o?o(a):a}:o}}function rk(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t[Symbol.asyncIterator],e;return n?n.call(t):(t=typeof dd=="function"?dd(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(o){e[o]=t[o]&&function(a){return new Promise(function(s,u){a=t[o](a),i(s,u,a.done,a.value)})}}function i(o,a,s,u){Promise.resolve(u).then(function(c){o({value:c,done:s})},a)}}function ik(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t}var KP=Object.create?function(t,n){Object.defineProperty(t,"default",{enumerable:!0,value:n})}:function(t,n){t.default=n};function ok(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var e in t)e!=="default"&&Object.prototype.hasOwnProperty.call(t,e)&&op(n,t,e);return KP(n,t),n}function ak(t){return t&&t.__esModule?t:{default:t}}function sk(t,n,e,r){if(e==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?t!==n||!r:!n.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?r:e==="a"?r.call(t):r?r.value:n.get(t)}function uk(t,n,e,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?t!==n||!i:!n.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,e):i?i.value=e:n.set(t,e),e}function ck(t,n){if(n===null||typeof n!="object"&&typeof n!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?n===t:t.has(n)}function lk(t,n,e){if(n!=null){if(typeof n!="object")throw new TypeError("Object expected.");var r;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=n[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=n[Symbol.dispose]}if(typeof r!="function")throw new TypeError("Object not disposable.");t.stack.push({value:n,dispose:r,async:e})}else e&&t.stack.push({async:!0});return n}var QP=typeof SuppressedError=="function"?SuppressedError:function(t,n,e){var r=new Error(e);return r.name="SuppressedError",r.error=t,r.suppressed=n,r};function hk(t){function n(r){t.error=t.hasError?new QP(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}function e(){for(;t.stack.length;){var r=t.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(e,function(o){return n(o),e()})}catch(o){n(o)}}if(t.hasError)throw t.error}return e()}const JP={__extends:Te,__assign:B,__rest:or,__decorate:K_,__param:Q_,__metadata:J_,__awaiter:Hr,__generator:qr,__createBinding:op,__exportStar:$_,__values:dd,__read:oy,__spread:tk,__spreadArrays:ap,__spreadArray:Di,__await:Nu,__asyncGenerator:ek,__asyncDelegator:nk,__asyncValues:rk,__makeTemplateObject:ik,__importStar:ok,__importDefault:ak,__classPrivateFieldGet:sk,__classPrivateFieldSet:uk,__classPrivateFieldIn:ck,__addDisposableResource:lk,__disposeResources:hk},$P=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:lk,get __assign(){return B},__asyncDelegator:nk,__asyncGenerator:ek,__asyncValues:rk,__await:Nu,__awaiter:Hr,__classPrivateFieldGet:sk,__classPrivateFieldIn:ck,__classPrivateFieldSet:uk,__createBinding:op,__decorate:K_,__disposeResources:hk,__esDecorate:XP,__exportStar:$_,__extends:Te,__generator:qr,__importDefault:ak,__importStar:ok,__makeTemplateObject:ik,__metadata:J_,__param:Q_,__propKey:qP,__read:oy,__rest:or,__runInitializers:HP,__setFunctionName:ZP,__spread:tk,__spreadArray:Di,__spreadArrays:ap,__values:dd,default:JP},Symbol.toStringTag,{value:"Module"}));var Br=function(t){return t!==null&&typeof t!="function"&&isFinite(t.length)},pd=function(t,n){return Br(t)?t.indexOf(n)>-1:!1},sp=function(t,n){if(!Br(t))return t;for(var e=[],r=0;r<t.length;r++){var i=t[r];n(i,r)&&e.push(i)}return e},tL=function(t,n){return n===void 0&&(n=[]),sp(t,function(e){return!pd(n,e)})},eL={}.toString,ji=function(t,n){return eL.call(t)==="[object "+n+"]"};const An=function(t){return ji(t,"Function")};var fe=function(t){return t==null};const ve=function(t){return Array.isArray?Array.isArray(t):ji(t,"Array")},yr=function(t){var n=typeof t;return t!==null&&n==="object"||n==="function"};function mt(t,n){if(t){var e;if(ve(t))for(var r=0,i=t.length;r<i&&(e=n(t[r],r),e!==!1);r++);else if(yr(t)){for(var o in t)if(t.hasOwnProperty(o)&&(e=n(t[o],o),e===!1))break}}}var fk=Object.keys?function(t){return Object.keys(t)}:function(t){var n=[];return mt(t,function(e,r){An(t)&&r==="prototype"||n.push(r)}),n};function dk(t,n){var e=fk(n),r=e.length;if(fe(t))return!r;for(var i=0;i<r;i+=1){var o=e[i];if(n[o]!==t[o]||!(o in t))return!1}return!0}var gd=function(t){return typeof t=="object"&&t!==null},vr=function(t){if(!gd(t)||!ji(t,"Object"))return!1;if(Object.getPrototypeOf(t)===null)return!0;for(var n=t;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(t)===n};function nL(t,n){if(!ve(t))return null;var e;if(An(n)&&(e=n),vr(n)&&(e=function(i){return dk(i,n)}),e){for(var r=0;r<t.length;r+=1)if(e(t[r]))return t[r]}return null}function rL(t,n,e){e===void 0&&(e=0);for(var r=e;r<t.length;r++)if(n(t[r],r))return r;return-1}var iL=function(t,n){for(var e=null,r=0;r<t.length;r++){var i=t[r],o=i[n];if(!fe(o)){ve(o)?e=o[0]:e=o;break}}return e},oL=function(t){if(!ve(t))return[];for(var n=[],e=0;e<t.length;e++)n=n.concat(t[e]);return n},pk=function(t,n){if(n===void 0&&(n=[]),!ve(t))n.push(t);else for(var e=0;e<t.length;e+=1)pk(t[e],n);return n};const po=function(t){if(ve(t))return t.reduce(function(n,e){return Math.max(n,e)},t[0])},go=function(t){if(ve(t))return t.reduce(function(n,e){return Math.min(n,e)},t[0])};var gk=function(t){var n=t.filter(function(a){return!isNaN(a)});if(!n.length)return{min:0,max:0};if(ve(t[0])){for(var e=[],r=0;r<t.length;r++)e=e.concat(t[r]);n=e}var i=po(n),o=go(n);return{min:o,max:i}},vk=Array.prototype,aL=vk.splice,sL=vk.indexOf,uL=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(var r=0;r<n.length;r++)for(var i=n[r],o=-1;(o=sL.call(t,i))>-1;)aL.call(t,o,1);return t},cL=Array.prototype.splice,mk=function(t,n){if(!Br(t))return[];for(var e=t?n.length:0,r=e-1;e--;){var i=void 0,o=n[e];(e===r||o!==i)&&(i=o,cL.call(t,o,1))}return t},yk=function(t,n,e){if(!ve(t)&&!vr(t))return t;var r=e;return mt(t,function(i,o){r=n(r,i,o)}),r},lL=function(t,n){var e=[];if(!Br(t))return e;for(var r=-1,i=[],o=t.length;++r<o;){var a=t[r];n(a,r,t)&&(e.push(a),i.push(r))}return mk(t,i),e};const Dt=function(t){return ji(t,"String")};function hL(t,n){var e;if(An(n))e=function(i,o){return n(i)-n(o)};else{var r=[];Dt(n)?r.push(n):ve(n)&&(r=n),e=function(i,o){for(var a=0;a<r.length;a+=1){var s=r[a];if(i[s]>o[s])return 1;if(i[s]<o[s])return-1}return 0}}return t.sort(e),t}function hl(t,n){n===void 0&&(n=new Map);var e=[];if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];n.has(o)||(e.push(o),n.set(o,!0))}return e}var fL=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return hl([].concat.apply([],t))};const dL=function(t,n){for(var e=[],r={},i=0;i<t.length;i++){var o=t[i],a=o[n];if(!fe(a)){ve(a)||(a=[a]);for(var s=0;s<a.length;s++){var u=a[s];r[u]||(e.push(u),r[u]=!0)}}}return e};function lo(t){if(Br(t))return t[0]}function gi(t){if(Br(t)){var n=t;return n[n.length-1]}}function pL(t,n){return ve(t)||Dt(t)?t[0]===n:!1}function gL(t,n){return ve(t)||Dt(t)?t[t.length-1]===n:!1}var vL=function(t,n){for(var e=0;e<t.length;e++)if(!n(t[e],e))return!1;return!0},mL=function(t,n){for(var e=0;e<t.length;e++)if(n(t[e],e))return!0;return!1},yL=Object.prototype.hasOwnProperty;function vd(t,n){if(!n||!ve(t))return{};for(var e={},r=An(n)?n:function(s){return s[n]},i,o=0;o<t.length;o++){var a=t[o];i=r(a),yL.call(e,i)?e[i].push(a):e[i]=[a]}return e}function bk(t,n){if(!n)return{0:t};if(!An(n)){var e=ve(n)?n:n.replace(/\s+/g,"").split("*");n=function(r){for(var i="_",o=0,a=e.length;o<a;o++)i+=r[e[o]]&&r[e[o]].toString();return i}}return vd(t,n)}const bL=function(t,n){if(!n)return[t];var e=bk(t,n),r=[];for(var i in e)r.push(e[i]);return r};function xL(t,n){return t["_wrap_"+n]}function fs(t,n){if(t["_wrap_"+n])return t["_wrap_"+n];var e=function(r){t[n](r)};return t["_wrap_"+n]=e,e}var fw={};function wL(t){var n=fw[t];if(!n){for(var e=t.toString(16),r=e.length;r<6;r++)e="0"+e;n="#"+e,fw[t]=n}return n}function EL(t){var n=0,e=0,r=0,i=0;return ve(t)?t.length===1?n=e=r=i=t[0]:t.length===2?(n=r=t[0],e=i=t[1]):t.length===3?(n=t[0],e=i=t[1],r=t[2]):(n=t[0],e=t[1],r=t[2],i=t[3]):n=e=r=i=t,{r1:n,r2:e,r3:r,r4:i}}var ML=function(t,n,e){return t<n?n:t>e?e:t},Uf=function(t,n){var e=n.toString(),r=e.indexOf(".");if(r===-1)return Math.round(t);var i=e.substr(r+1).length;return i>20&&(i=20),parseFloat(t.toFixed(i))},pe=function(t){return ji(t,"Number")},SL=function(t){return pe(t)&&t%1!==0},_L=function(t){return pe(t)&&t%2===0},kL=Number.isInteger?Number.isInteger:function(t){return pe(t)&&t%1===0},AL=function(t){return pe(t)&&t<0},CL=1e-5;function xk(t,n,e){return e===void 0&&(e=CL),Math.abs(t-n)<e}var IL=function(t){return pe(t)&&t%2!==0},TL=function(t){return pe(t)&&t>0};const OL=function(t,n){if(ve(t)){for(var e,r=-1/0,i=0;i<t.length;i++){var o=t[i],a=An(n)?n(o):o[n];a>r&&(e=o,r=a)}return e}},NL=function(t,n){if(ve(t)){for(var e,r=1/0,i=0;i<t.length;i++){var o=t[i],a=An(n)?n(o):o[n];a<r&&(e=o,r=a)}return e}};var up=function(t,n){return(t%n+n)%n},DL=180/Math.PI,PL=function(t){return DL*t};const LL=parseInt;var jL=Math.PI/180,cp=function(t){return jL*t};const dw=function(t,n){return t.hasOwnProperty(n)};var ay=Object.values?function(t){return Object.values(t)}:function(t){var n=[];return mt(t,function(e,r){An(t)&&r==="prototype"||n.push(e)}),n};const RL=function(t,n){return pd(ay(t),n)},Qu=function(t){return fe(t)?"":t.toString()};var FL=function(t){return Qu(t).toLowerCase()},BL=function(t){var n=Qu(t);return n.charAt(0).toLowerCase()+n.substring(1)};function zL(t,n){return!t||!n?t:t.replace(/\\?\{([^{}]+)\}/g,function(e,r){return e.charAt(0)==="\\"?e.slice(1):n[r]===void 0?"":n[r]})}var GL=function(t){return Qu(t).toUpperCase()},Du=function(t){var n=Qu(t);return n.charAt(0).toUpperCase()+n.substring(1)},UL={}.toString,wk=function(t){return UL.call(t).replace(/^\[object /,"").replace(/]$/,"")},YL=function(t){return ji(t,"Arguments")},Rl=function(t){return ji(t,"Boolean")},sy=function(t){return ji(t,"Date")},VL=function(t){return ji(t,"Error")};function WL(t){return pe(t)&&isFinite(t)}var XL=function(t){return t===null},HL=Object.prototype,Ek=function(t){var n=t&&t.constructor,e=typeof n=="function"&&n.prototype||HL;return t===e},qL=function(t){return ji(t,"RegExp")},ZL=function(t){return t===void 0},KL=function(t){return t instanceof Element||t instanceof HTMLDocument};function Mk(t){var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,16)};return n(t)}function Sk(t){var n=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;n(t)}function p0(t,n){for(var e in n)n.hasOwnProperty(e)&&e!=="constructor"&&n[e]!==void 0&&(t[e]=n[e])}function ye(t,n,e,r){return n&&p0(t,n),e&&p0(t,e),r&&p0(t,r),t}var QL=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=t[0],r=1;r<t.length;r++){var i=t[r];An(i)&&(i=i.prototype),ye(e.prototype,i)}},Xe=function(t){if(typeof t!="object"||t===null)return t;var n;if(ve(t)){n=[];for(var e=0,r=t.length;e<r;e++)typeof t[e]=="object"&&t[e]!=null?n[e]=Xe(t[e]):n[e]=t[e]}else{n={};for(var i in t)typeof t[i]=="object"&&t[i]!=null?n[i]=Xe(t[i]):n[i]=t[i]}return n};function Fl(t,n,e){var r;return function(){var i=this,o=arguments,a=function(){r=null,e||t.apply(i,o)},s=e&&!r;clearTimeout(r),r=setTimeout(a,n),s&&t.apply(i,o)}}const _k=function(t,n){if(!An(t))throw new TypeError("Expected a function");var e=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=n?n.apply(this,r):r[0],a=e.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};return e.cache=new Map,e};var JL=5;function kk(t,n,e,r){e=e||0,r=r||JL;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o!==null&&vr(o)?(vr(t[i])||(t[i]={}),e<r?kk(t[i],o,e+1,r):t[i]=n[i]):ve(o)?(t[i]=[],t[i]=t[i].concat(o)):o!==void 0&&(t[i]=o)}}var mn=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(var r=0;r<n.length;r+=1)kk(t,n[r]);return t},$L=function(t,n,e,r){An(n)||(e=n,n=t,t=function(){});var i=Object.create?function(a,s){return Object.create(a,{constructor:{value:s}})}:function(a,s){function u(){}u.prototype=a;var c=new u;return c.constructor=s,c},o=i(n.prototype,t);return t.prototype=ye(o,t.prototype),t.superclass=i(n.prototype,n),ye(o,e),ye(t,r),t},uy=function(t,n){if(!Br(t))return-1;var e=Array.prototype.indexOf;if(e)return e.call(t,n);for(var r=-1,i=0;i<t.length;i++)if(t[i]===n){r=i;break}return r},t4=Object.prototype.hasOwnProperty;function Ak(t){if(fe(t))return!0;if(Br(t))return!t.length;var n=wk(t);if(n==="Map"||n==="Set")return!t.size;if(Ek(t))return!Object.keys(t).length;for(var e in t)if(t4.call(t,e))return!1;return!0}var Aa=function(t,n){if(t===n)return!0;if(!t||!n||Dt(t)||Dt(n))return!1;if(Br(t)||Br(n)){if(t.length!==n.length)return!1;for(var e=!0,r=0;r<t.length&&(e=Aa(t[r],n[r]),!!e);r++);return e}if(gd(t)||gd(n)){var i=Object.keys(t),o=Object.keys(n);if(i.length!==o.length)return!1;for(var e=!0,r=0;r<i.length&&(e=Aa(t[i[r]],n[i[r]]),!!e);r++);return e}return!1};const e4=function(t,n,e){return An(e)?!!e(t,n):Aa(t,n)};var Ms=function(t,n){if(!Br(t))return t;for(var e=[],r=0;r<t.length;r++){var i=t[r];e.push(n(i,r))}return e},n4=function(t){return t};const r4=function(t,n){n===void 0&&(n=n4);var e={};return yr(t)&&!fe(t)&&Object.keys(t).forEach(function(r){e[r]=n(t[r],r)}),e},Bo=function(t,n,e){for(var r=0,i=Dt(n)?n.split("."):n;t&&r<i.length;)t=t[i[r++]];return t===void 0||r<i.length?e:t},i4=function(t,n,e){var r=t,i=Dt(n)?n.split("."):n;return i.forEach(function(o,a){a<i.length-1?(yr(r[o])||(r[o]=pe(i[a+1])?[]:{}),r=r[o]):r[o]=e}),t};var o4=Object.prototype.hasOwnProperty;const a4=function(t,n){if(t===null||!vr(t))return{};var e={};return mt(n,function(r){o4.call(t,r)&&(e[r]=t[r])}),e},s4=function(t,n){return yk(t,function(e,r,i){return n.includes(i)||(e[i]=r),e},{})},fl=function(t,n,e){var r,i,o,a,s=0;e||(e={});var u=function(){s=e.leading===!1?0:Date.now(),r=null,a=t.apply(i,o),r||(i=o=null)},c=function(){var l=Date.now();!s&&e.leading===!1&&(s=l);var h=n-(l-s);return i=this,o=arguments,h<=0||h>n?(r&&(clearTimeout(r),r=null),s=l,a=t.apply(i,o),r||(i=o=null)):!r&&e.trailing!==!1&&(r=setTimeout(u,h)),a};return c.cancel=function(){clearTimeout(r),s=0,r=i=o=null},c},Ck=function(t){return Br(t)?Array.prototype.slice.call(t):[]};var Vh={};const vo=function(t){return t=t||"g",Vh[t]?Vh[t]+=1:Vh[t]=1,t+Vh[t]},Bc=function(){},u4=function(t){return t};function lp(t){return fe(t)?0:Br(t)?t.length:Object.keys(t).length}var Wh;const zc=_k(function(t,n){n===void 0&&(n={});var e=n.fontSize,r=n.fontFamily,i=n.fontWeight,o=n.fontStyle,a=n.fontVariant;return Wh||(Wh=document.createElement("canvas").getContext("2d")),Wh.font=[o,a,i,e+"px",r].join(" "),Wh.measureText(Dt(t)?t:"").width},function(t,n){return n===void 0&&(n={}),ap([t],ay(n)).join("")}),c4=function(t,n,e,r){r===void 0&&(r="...");var i=16,o=zc(r,e),a=Dt(t)?t:Qu(t),s=n,u=[],c,l;if(zc(t,e)<=n)return t;for(;c=a.substr(0,i),l=zc(c,e),!(l+o>s&&l>s);)if(u.push(c),s-=l,a=a.substr(i),!a)return u.join("");for(;c=a.substr(0,1),l=zc(c,e),!(l+o>s);)if(u.push(c),s-=l,a=a.substr(1),!a)return u.join("");return""+u.join("")+r};var l4=function(){function t(){this.map={}}return t.prototype.has=function(n){return this.map[n]!==void 0},t.prototype.get=function(n,e){var r=this.map[n];return r===void 0?e:r},t.prototype.set=function(n,e){this.map[n]=e},t.prototype.clear=function(){this.map={}},t.prototype.delete=function(n){delete this.map[n]},t.prototype.size=function(){return Object.keys(this.map).length},t}();const h4=Object.freeze(Object.defineProperty({__proto__:null,Cache:l4,assign:ye,augment:QL,clamp:ML,clearAnimationFrame:Sk,clone:Xe,contains:pd,debounce:Fl,deepMix:mn,difference:tL,each:mt,endsWith:gL,every:vL,extend:$L,filter:sp,find:nL,findIndex:rL,firstValue:iL,fixedBase:Uf,flatten:oL,flattenDeep:pk,forIn:mt,get:Bo,getEllipsisText:c4,getRange:gk,getType:wk,getWrapBehavior:xL,group:bL,groupBy:vd,groupToMap:bk,has:dw,hasKey:dw,hasValue:RL,head:lo,identity:u4,includes:pd,indexOf:uy,isArguments:YL,isArray:ve,isArrayLike:Br,isBoolean:Rl,isDate:sy,isDecimal:SL,isElement:KL,isEmpty:Ak,isEqual:Aa,isEqualWith:e4,isError:VL,isEven:_L,isFinite:WL,isFunction:An,isInteger:kL,isMatch:dk,isNegative:AL,isNil:fe,isNull:XL,isNumber:pe,isNumberEqual:xk,isObject:yr,isObjectLike:gd,isOdd:IL,isPlainObject:vr,isPositive:TL,isPrototype:Ek,isRegExp:qL,isString:Dt,isType:ji,isUndefined:ZL,keys:fk,last:gi,lowerCase:FL,lowerFirst:BL,map:Ms,mapValues:r4,max:po,maxBy:OL,measureTextWidth:zc,memoize:_k,min:go,minBy:NL,mix:ye,mod:up,noop:Bc,number2color:wL,omit:s4,parseRadius:EL,pick:a4,pull:uL,pullAt:mk,reduce:yk,remove:lL,requestAnimationFrame:Mk,set:i4,size:lp,some:mL,sortBy:hL,startsWith:pL,substitute:zL,throttle:fl,toArray:Ck,toDegree:PL,toInteger:LL,toRadian:cp,toString:Qu,union:fL,uniq:hl,uniqueId:vo,upperCase:GL,upperFirst:Du,values:ay,valuesOfKey:dL,wrapBehavior:fs},Symbol.toStringTag,{value:"Module"})),f4={getDefaultCfg:function(){return{}},getEvents:function(){return{}},updateCfg:function(t){return Object.assign(this,t),!0},shouldBegin:function(){return!0},shouldUpdate:function(){return!0},shouldEnd:function(){return!0},bind:function(t){var n=this,e=this.events;this.graph=t,(this.type==="drag-canvas"||this.type==="brush-select"||this.type==="lasso-select")&&t.get("canvas").set("draggable",!0),mt(e,function(r,i){t.on(i,r)}),document.addEventListener("visibilitychange",function(){n.keydown=!1})},unbind:function(t){var n=this.events,e=t.get("canvas").get("draggable");(this.type==="drag-canvas"||this.type==="brush-select"||this.type==="lasso-select")&&t.get("canvas").set("draggable",!1),mt(n,function(r,i){t.off(i,r)}),t.get("canvas").set("draggable",e)},get:function(t){return this[t]},set:function(t,n){return this[t]=n,this}};var Ik=function(){function t(){}return t.registerBehavior=function(n,e){if(!e)throw new Error("please specify handler for this behavior: ".concat(n));var r=Xe(f4);Object.assign(r,e);var i=function(o){var a=this;Object.assign(this,this.getDefaultCfg(),o);var s=this.getEvents();this.events=null;var u={};s&&(mt(s,function(c,l){u[l]=fs(a,c)}),this.events=u)};i.prototype=r,t.types[n]=i},t.hasBehavior=function(n){return!!t.types[n]},t.getBehavior=function(n){return t.types[n]},t.types={},t}(),d4="*",Tk=function(){function t(){this._events={}}return t.prototype.on=function(n,e,r){return this._events[n]||(this._events[n]=[]),this._events[n].push({callback:e,once:!!r}),this},t.prototype.once=function(n,e){return this.on(n,e,!0)},t.prototype.emit=function(n){for(var e=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=this._events[n]||[],a=this._events[d4]||[],s=function(u){for(var c=u.length,l=0;l<c;l++)if(u[l]){var h=u[l],f=h.callback,d=h.once;d&&(u.splice(l,1),u.length===0&&delete e._events[n],c--,l--),f.apply(e,r)}};s(o),s(a)},t.prototype.off=function(n,e){if(!n)this._events={};else if(!e)delete this._events[n];else{for(var r=this._events[n]||[],i=r.length,o=0;o<i;o++)r[o].callback===e&&(r.splice(o,1),i--,o--);r.length===0&&delete this._events[n]}return this},t.prototype.getEvents=function(){return this._events},t}(),we=1e-6,tn=typeof Float32Array<"u"?Float32Array:Array,Oi=Math.random;function p4(t){tn=t}var g4=Math.PI/180;function v4(t){return t*g4}function m4(t,n){return Math.abs(t-n)<=we*Math.max(1,Math.abs(t),Math.abs(n))}Math.hypot||(Math.hypot=function(){for(var t=0,n=arguments.length;n--;)t+=arguments[n]*arguments[n];return Math.sqrt(t)});const y4=Object.freeze(Object.defineProperty({__proto__:null,get ARRAY_TYPE(){return tn},EPSILON:we,RANDOM:Oi,equals:m4,setMatrixArrayType:p4,toRadian:v4},Symbol.toStringTag,{value:"Module"}));function b4(){var t=new tn(4);return tn!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function x4(t){var n=new tn(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function w4(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function E4(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function M4(t,n,e,r){var i=new tn(4);return i[0]=t,i[1]=n,i[2]=e,i[3]=r,i}function S4(t,n,e,r,i){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t}function _4(t,n){if(t===n){var e=n[1];t[1]=n[2],t[2]=e}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t}function k4(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=e*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=e*a,t):null}function A4(t,n){var e=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=e,t}function C4(t){return t[0]*t[3]-t[2]*t[1]}function Ok(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=e[3];return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*c+o*l,t[3]=i*c+a*l,t}function I4(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(e),u=Math.cos(e);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t}function T4(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1];return t[0]=r*s,t[1]=i*s,t[2]=o*u,t[3]=a*u,t}function O4(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=-e,t[3]=r,t}function N4(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t}function D4(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function P4(t){return Math.hypot(t[0],t[1],t[2],t[3])}function L4(t,n,e,r){return t[2]=r[2]/r[0],e[0]=r[0],e[1]=r[1],e[3]=r[3]-t[2]*e[1],[t,n,e]}function j4(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t}function Nk(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t}function R4(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function F4(t,n){var e=t[0],r=t[1],i=t[2],o=t[3],a=n[0],s=n[1],u=n[2],c=n[3];return Math.abs(e-a)<=we*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(r-s)<=we*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=we*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=we*Math.max(1,Math.abs(o),Math.abs(c))}function B4(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t}function z4(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t}var G4=Ok,U4=Nk;const Y4=Object.freeze(Object.defineProperty({__proto__:null,LDU:L4,add:j4,adjoint:A4,clone:x4,copy:w4,create:b4,determinant:C4,equals:F4,exactEquals:R4,frob:P4,fromRotation:O4,fromScaling:N4,fromValues:M4,identity:E4,invert:k4,mul:G4,multiply:Ok,multiplyScalar:B4,multiplyScalarAndAdd:z4,rotate:I4,scale:T4,set:S4,str:D4,sub:U4,subtract:Nk,transpose:_4},Symbol.toStringTag,{value:"Module"}));function V4(){var t=new tn(6);return tn!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function W4(t){var n=new tn(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function X4(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function H4(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function q4(t,n,e,r,i,o){var a=new tn(6);return a[0]=t,a[1]=n,a[2]=e,a[3]=r,a[4]=i,a[5]=o,a}function Z4(t,n,e,r,i,o,a){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t}function K4(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=e*o-r*i;return u?(u=1/u,t[0]=o*u,t[1]=-r*u,t[2]=-i*u,t[3]=e*u,t[4]=(i*s-o*a)*u,t[5]=(r*a-e*s)*u,t):null}function Q4(t){return t[0]*t[3]-t[1]*t[2]}function Dk(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=e[0],l=e[1],h=e[2],f=e[3],d=e[4],p=e[5];return t[0]=r*c+o*l,t[1]=i*c+a*l,t[2]=r*h+o*f,t[3]=i*h+a*f,t[4]=r*d+o*p+s,t[5]=i*d+a*p+u,t}function J4(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=Math.sin(e),l=Math.cos(e);return t[0]=r*l+o*c,t[1]=i*l+a*c,t[2]=r*-c+o*l,t[3]=i*-c+a*l,t[4]=s,t[5]=u,t}function $4(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=e[0],l=e[1];return t[0]=r*c,t[1]=i*c,t[2]=o*l,t[3]=a*l,t[4]=s,t[5]=u,t}function t6(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=e[0],l=e[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*c+o*l+s,t[5]=i*c+a*l+u,t}function e6(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=-e,t[3]=r,t[4]=0,t[5]=0,t}function n6(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t}function r6(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t}function i6(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function o6(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function a6(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t}function Pk(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t}function s6(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t}function u6(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t}function c6(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]}function l6(t,n){var e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=n[0],c=n[1],l=n[2],h=n[3],f=n[4],d=n[5];return Math.abs(e-u)<=we*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(r-c)<=we*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-l)<=we*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-h)<=we*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(a-f)<=we*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-d)<=we*Math.max(1,Math.abs(s),Math.abs(d))}var h6=Dk,f6=Pk;const d6=Object.freeze(Object.defineProperty({__proto__:null,add:a6,clone:W4,copy:X4,create:V4,determinant:Q4,equals:l6,exactEquals:c6,frob:o6,fromRotation:e6,fromScaling:n6,fromTranslation:r6,fromValues:q4,identity:H4,invert:K4,mul:h6,multiply:Dk,multiplyScalar:s6,multiplyScalarAndAdd:u6,rotate:J4,scale:$4,set:Z4,str:i6,sub:f6,subtract:Pk,translate:t6},Symbol.toStringTag,{value:"Module"}));function Lk(){var t=new tn(9);return tn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function p6(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function g6(t){var n=new tn(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function v6(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function m6(t,n,e,r,i,o,a,s,u){var c=new tn(9);return c[0]=t,c[1]=n,c[2]=e,c[3]=r,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c[8]=u,c}function y6(t,n,e,r,i,o,a,s,u,c){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t}function b6(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function x6(t,n){if(t===n){var e=n[1],r=n[2],i=n[5];t[1]=n[3],t[2]=n[6],t[3]=e,t[5]=n[7],t[6]=r,t[7]=i}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function cy(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8],h=l*a-s*c,f=-l*o+s*u,d=c*o-a*u,p=e*h+r*f+i*d;return p?(p=1/p,t[0]=h*p,t[1]=(-l*r+i*c)*p,t[2]=(s*r-i*a)*p,t[3]=f*p,t[4]=(l*e-i*u)*p,t[5]=(-s*e+i*o)*p,t[6]=d*p,t[7]=(-c*e+r*u)*p,t[8]=(a*e-r*o)*p,t):null}function w6(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8];return t[0]=a*l-s*c,t[1]=i*c-r*l,t[2]=r*s-i*a,t[3]=s*u-o*l,t[4]=e*l-i*u,t[5]=i*o-e*s,t[6]=o*c-a*u,t[7]=r*u-e*c,t[8]=e*a-r*o,t}function E6(t){var n=t[0],e=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return n*(c*o-a*u)+e*(-c*i+a*s)+r*(u*i-o*s)}function mo(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=e[0],d=e[1],p=e[2],g=e[3],v=e[4],m=e[5],y=e[6],b=e[7],x=e[8];return t[0]=f*r+d*a+p*c,t[1]=f*i+d*s+p*l,t[2]=f*o+d*u+p*h,t[3]=g*r+v*a+m*c,t[4]=g*i+v*s+m*l,t[5]=g*o+v*u+m*h,t[6]=y*r+b*a+x*c,t[7]=y*i+b*s+x*l,t[8]=y*o+b*u+x*h,t}function M6(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=e[0],d=e[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=f*r+d*a+c,t[7]=f*i+d*s+l,t[8]=f*o+d*u+h,t}function S6(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=Math.sin(e),d=Math.cos(e);return t[0]=d*r+f*a,t[1]=d*i+f*s,t[2]=d*o+f*u,t[3]=d*a-f*r,t[4]=d*s-f*i,t[5]=d*u-f*o,t[6]=c,t[7]=l,t[8]=h,t}function _6(t,n,e){var r=e[0],i=e[1];return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=i*n[3],t[4]=i*n[4],t[5]=i*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function ly(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function hy(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=0,t[3]=-e,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function fy(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function k6(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function A6(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=e+e,s=r+r,u=i+i,c=e*a,l=r*a,h=r*s,f=i*a,d=i*s,p=i*u,g=o*a,v=o*s,m=o*u;return t[0]=1-h-p,t[3]=l-m,t[6]=f+v,t[1]=l+m,t[4]=1-c-p,t[7]=d-g,t[2]=f-v,t[5]=d+g,t[8]=1-c-h,t}function C6(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8],h=n[9],f=n[10],d=n[11],p=n[12],g=n[13],v=n[14],m=n[15],y=e*s-r*a,b=e*u-i*a,x=e*c-o*a,w=r*u-i*s,E=r*c-o*s,M=i*c-o*u,_=l*g-h*p,k=l*v-f*p,S=l*m-d*p,A=h*v-f*g,C=h*m-d*g,I=f*m-d*v,N=y*I-b*C+x*A+w*S-E*k+M*_;return N?(N=1/N,t[0]=(s*I-u*C+c*A)*N,t[1]=(u*S-a*I-c*k)*N,t[2]=(a*C-s*S+c*_)*N,t[3]=(i*C-r*I-o*A)*N,t[4]=(e*I-i*S+o*k)*N,t[5]=(r*S-e*C-o*_)*N,t[6]=(g*M-v*E+m*w)*N,t[7]=(v*x-p*M-m*b)*N,t[8]=(p*E-g*x+m*y)*N,t):null}function I6(t,n,e){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/e,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function T6(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function O6(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function N6(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t[8]=n[8]+e[8],t}function jk(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t[6]=n[6]-e[6],t[7]=n[7]-e[7],t[8]=n[8]-e[8],t}function D6(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*e,t}function P6(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t[6]=n[6]+e[6]*r,t[7]=n[7]+e[7]*r,t[8]=n[8]+e[8]*r,t}function L6(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function j6(t,n){var e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=n[0],f=n[1],d=n[2],p=n[3],g=n[4],v=n[5],m=n[6],y=n[7],b=n[8];return Math.abs(e-h)<=we*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(r-f)<=we*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-d)<=we*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=we*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-g)<=we*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(s-v)<=we*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-m)<=we*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(c-y)<=we*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(l-b)<=we*Math.max(1,Math.abs(l),Math.abs(b))}var R6=mo,F6=jk;const Rk=Object.freeze(Object.defineProperty({__proto__:null,add:N6,adjoint:w6,clone:g6,copy:v6,create:Lk,determinant:E6,equals:j6,exactEquals:L6,frob:O6,fromMat2d:k6,fromMat4:p6,fromQuat:A6,fromRotation:hy,fromScaling:fy,fromTranslation:ly,fromValues:m6,identity:b6,invert:cy,mul:R6,multiply:mo,multiplyScalar:D6,multiplyScalarAndAdd:P6,normalFromMat4:C6,projection:I6,rotate:S6,scale:_6,set:y6,str:T6,sub:F6,subtract:jk,translate:M6,transpose:x6},Symbol.toStringTag,{value:"Module"}));function B6(){var t=new tn(16);return tn!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function z6(t){var n=new tn(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function G6(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function U6(t,n,e,r,i,o,a,s,u,c,l,h,f,d,p,g){var v=new tn(16);return v[0]=t,v[1]=n,v[2]=e,v[3]=r,v[4]=i,v[5]=o,v[6]=a,v[7]=s,v[8]=u,v[9]=c,v[10]=l,v[11]=h,v[12]=f,v[13]=d,v[14]=p,v[15]=g,v}function Y6(t,n,e,r,i,o,a,s,u,c,l,h,f,d,p,g,v){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=l,t[10]=h,t[11]=f,t[12]=d,t[13]=p,t[14]=g,t[15]=v,t}function Fk(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function V6(t,n){if(t===n){var e=n[1],r=n[2],i=n[3],o=n[6],a=n[7],s=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=e,t[6]=n[9],t[7]=n[13],t[8]=r,t[9]=o,t[11]=n[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function W6(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8],h=n[9],f=n[10],d=n[11],p=n[12],g=n[13],v=n[14],m=n[15],y=e*s-r*a,b=e*u-i*a,x=e*c-o*a,w=r*u-i*s,E=r*c-o*s,M=i*c-o*u,_=l*g-h*p,k=l*v-f*p,S=l*m-d*p,A=h*v-f*g,C=h*m-d*g,I=f*m-d*v,N=y*I-b*C+x*A+w*S-E*k+M*_;return N?(N=1/N,t[0]=(s*I-u*C+c*A)*N,t[1]=(i*C-r*I-o*A)*N,t[2]=(g*M-v*E+m*w)*N,t[3]=(f*E-h*M-d*w)*N,t[4]=(u*S-a*I-c*k)*N,t[5]=(e*I-i*S+o*k)*N,t[6]=(v*x-p*M-m*b)*N,t[7]=(l*M-f*x+d*b)*N,t[8]=(a*C-s*S+c*_)*N,t[9]=(r*S-e*C-o*_)*N,t[10]=(p*E-g*x+m*y)*N,t[11]=(h*x-l*E-d*y)*N,t[12]=(s*k-a*A-u*_)*N,t[13]=(e*A-r*k+i*_)*N,t[14]=(g*b-p*w-v*y)*N,t[15]=(l*w-h*b+f*y)*N,t):null}function X6(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],c=n[7],l=n[8],h=n[9],f=n[10],d=n[11],p=n[12],g=n[13],v=n[14],m=n[15];return t[0]=s*(f*m-d*v)-h*(u*m-c*v)+g*(u*d-c*f),t[1]=-(r*(f*m-d*v)-h*(i*m-o*v)+g*(i*d-o*f)),t[2]=r*(u*m-c*v)-s*(i*m-o*v)+g*(i*c-o*u),t[3]=-(r*(u*d-c*f)-s*(i*d-o*f)+h*(i*c-o*u)),t[4]=-(a*(f*m-d*v)-l*(u*m-c*v)+p*(u*d-c*f)),t[5]=e*(f*m-d*v)-l*(i*m-o*v)+p*(i*d-o*f),t[6]=-(e*(u*m-c*v)-a*(i*m-o*v)+p*(i*c-o*u)),t[7]=e*(u*d-c*f)-a*(i*d-o*f)+l*(i*c-o*u),t[8]=a*(h*m-d*g)-l*(s*m-c*g)+p*(s*d-c*h),t[9]=-(e*(h*m-d*g)-l*(r*m-o*g)+p*(r*d-o*h)),t[10]=e*(s*m-c*g)-a*(r*m-o*g)+p*(r*c-o*s),t[11]=-(e*(s*d-c*h)-a*(r*d-o*h)+l*(r*c-o*s)),t[12]=-(a*(h*v-f*g)-l*(s*v-u*g)+p*(s*f-u*h)),t[13]=e*(h*v-f*g)-l*(r*v-i*g)+p*(r*f-i*h),t[14]=-(e*(s*v-u*g)-a*(r*v-i*g)+p*(r*u-i*s)),t[15]=e*(s*f-u*h)-a*(r*f-i*h)+l*(r*u-i*s),t}function H6(t){var n=t[0],e=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11],d=t[12],p=t[13],g=t[14],v=t[15],m=n*a-e*o,y=n*s-r*o,b=n*u-i*o,x=e*s-r*a,w=e*u-i*a,E=r*u-i*s,M=c*p-l*d,_=c*g-h*d,k=c*v-f*d,S=l*g-h*p,A=l*v-f*p,C=h*v-f*g;return m*C-y*A+b*S+x*k-w*_+E*M}function Bk(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=n[9],d=n[10],p=n[11],g=n[12],v=n[13],m=n[14],y=n[15],b=e[0],x=e[1],w=e[2],E=e[3];return t[0]=b*r+x*s+w*h+E*g,t[1]=b*i+x*u+w*f+E*v,t[2]=b*o+x*c+w*d+E*m,t[3]=b*a+x*l+w*p+E*y,b=e[4],x=e[5],w=e[6],E=e[7],t[4]=b*r+x*s+w*h+E*g,t[5]=b*i+x*u+w*f+E*v,t[6]=b*o+x*c+w*d+E*m,t[7]=b*a+x*l+w*p+E*y,b=e[8],x=e[9],w=e[10],E=e[11],t[8]=b*r+x*s+w*h+E*g,t[9]=b*i+x*u+w*f+E*v,t[10]=b*o+x*c+w*d+E*m,t[11]=b*a+x*l+w*p+E*y,b=e[12],x=e[13],w=e[14],E=e[15],t[12]=b*r+x*s+w*h+E*g,t[13]=b*i+x*u+w*f+E*v,t[14]=b*o+x*c+w*d+E*m,t[15]=b*a+x*l+w*p+E*y,t}function q6(t,n,e){var r=e[0],i=e[1],o=e[2],a,s,u,c,l,h,f,d,p,g,v,m;return n===t?(t[12]=n[0]*r+n[4]*i+n[8]*o+n[12],t[13]=n[1]*r+n[5]*i+n[9]*o+n[13],t[14]=n[2]*r+n[6]*i+n[10]*o+n[14],t[15]=n[3]*r+n[7]*i+n[11]*o+n[15]):(a=n[0],s=n[1],u=n[2],c=n[3],l=n[4],h=n[5],f=n[6],d=n[7],p=n[8],g=n[9],v=n[10],m=n[11],t[0]=a,t[1]=s,t[2]=u,t[3]=c,t[4]=l,t[5]=h,t[6]=f,t[7]=d,t[8]=p,t[9]=g,t[10]=v,t[11]=m,t[12]=a*r+l*i+p*o+n[12],t[13]=s*r+h*i+g*o+n[13],t[14]=u*r+f*i+v*o+n[14],t[15]=c*r+d*i+m*o+n[15]),t}function Z6(t,n,e){var r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function K6(t,n,e,r){var i=r[0],o=r[1],a=r[2],s=Math.hypot(i,o,a),u,c,l,h,f,d,p,g,v,m,y,b,x,w,E,M,_,k,S,A,C,I,N,D;return s<we?null:(s=1/s,i*=s,o*=s,a*=s,u=Math.sin(e),c=Math.cos(e),l=1-c,h=n[0],f=n[1],d=n[2],p=n[3],g=n[4],v=n[5],m=n[6],y=n[7],b=n[8],x=n[9],w=n[10],E=n[11],M=i*i*l+c,_=o*i*l+a*u,k=a*i*l-o*u,S=i*o*l-a*u,A=o*o*l+c,C=a*o*l+i*u,I=i*a*l+o*u,N=o*a*l-i*u,D=a*a*l+c,t[0]=h*M+g*_+b*k,t[1]=f*M+v*_+x*k,t[2]=d*M+m*_+w*k,t[3]=p*M+y*_+E*k,t[4]=h*S+g*A+b*C,t[5]=f*S+v*A+x*C,t[6]=d*S+m*A+w*C,t[7]=p*S+y*A+E*C,t[8]=h*I+g*N+b*D,t[9]=f*I+v*N+x*D,t[10]=d*I+m*N+w*D,t[11]=p*I+y*N+E*D,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function Q6(t,n,e){var r=Math.sin(e),i=Math.cos(e),o=n[4],a=n[5],s=n[6],u=n[7],c=n[8],l=n[9],h=n[10],f=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+h*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=h*i-s*r,t[11]=f*i-u*r,t}function J6(t,n,e){var r=Math.sin(e),i=Math.cos(e),o=n[0],a=n[1],s=n[2],u=n[3],c=n[8],l=n[9],h=n[10],f=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-h*r,t[3]=u*i-f*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+h*i,t[11]=u*r+f*i,t}function $6(t,n,e){var r=Math.sin(e),i=Math.cos(e),o=n[0],a=n[1],s=n[2],u=n[3],c=n[4],l=n[5],h=n[6],f=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+h*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=h*i-s*r,t[7]=f*i-u*r,t}function tj(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ej(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nj(t,n,e){var r=e[0],i=e[1],o=e[2],a=Math.hypot(r,i,o),s,u,c;return a<we?null:(a=1/a,r*=a,i*=a,o*=a,s=Math.sin(n),u=Math.cos(n),c=1-u,t[0]=r*r*c+u,t[1]=i*r*c+o*s,t[2]=o*r*c-i*s,t[3]=0,t[4]=r*i*c-o*s,t[5]=i*i*c+u,t[6]=o*i*c+r*s,t[7]=0,t[8]=r*o*c+i*s,t[9]=i*o*c-r*s,t[10]=o*o*c+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function rj(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=e,t[7]=0,t[8]=0,t[9]=-e,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ij(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=0,t[2]=-e,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=e,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function oj(t,n){var e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=0,t[3]=0,t[4]=-e,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function zk(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=r+r,u=i+i,c=o+o,l=r*s,h=r*u,f=r*c,d=i*u,p=i*c,g=o*c,v=a*s,m=a*u,y=a*c;return t[0]=1-(d+g),t[1]=h+y,t[2]=f-m,t[3]=0,t[4]=h-y,t[5]=1-(l+g),t[6]=p+v,t[7]=0,t[8]=f+m,t[9]=p-v,t[10]=1-(l+d),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function aj(t,n){var e=new tn(3),r=-n[0],i=-n[1],o=-n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=r*r+i*i+o*o+a*a;return h>0?(e[0]=(s*a+l*r+u*o-c*i)*2/h,e[1]=(u*a+l*i+c*r-s*o)*2/h,e[2]=(c*a+l*o+s*i-u*r)*2/h):(e[0]=(s*a+l*r+u*o-c*i)*2,e[1]=(u*a+l*i+c*r-s*o)*2,e[2]=(c*a+l*o+s*i-u*r)*2),zk(t,n,e),t}function Gk(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function Uk(t,n){var e=n[0],r=n[1],i=n[2],o=n[4],a=n[5],s=n[6],u=n[8],c=n[9],l=n[10];return t[0]=Math.hypot(e,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,c,l),t}function Yk(t,n){var e=new tn(3);Uk(e,n);var r=1/e[0],i=1/e[1],o=1/e[2],a=n[0]*r,s=n[1]*i,u=n[2]*o,c=n[4]*r,l=n[5]*i,h=n[6]*o,f=n[8]*r,d=n[9]*i,p=n[10]*o,g=a+l+p,v=0;return g>0?(v=Math.sqrt(g+1)*2,t[3]=.25*v,t[0]=(h-d)/v,t[1]=(f-u)/v,t[2]=(s-c)/v):a>l&&a>p?(v=Math.sqrt(1+a-l-p)*2,t[3]=(h-d)/v,t[0]=.25*v,t[1]=(s+c)/v,t[2]=(f+u)/v):l>p?(v=Math.sqrt(1+l-a-p)*2,t[3]=(f-u)/v,t[0]=(s+c)/v,t[1]=.25*v,t[2]=(h+d)/v):(v=Math.sqrt(1+p-a-l)*2,t[3]=(s-c)/v,t[0]=(f+u)/v,t[1]=(h+d)/v,t[2]=.25*v),t}function sj(t,n,e,r){var i=n[0],o=n[1],a=n[2],s=n[3],u=i+i,c=o+o,l=a+a,h=i*u,f=i*c,d=i*l,p=o*c,g=o*l,v=a*l,m=s*u,y=s*c,b=s*l,x=r[0],w=r[1],E=r[2];return t[0]=(1-(p+v))*x,t[1]=(f+b)*x,t[2]=(d-y)*x,t[3]=0,t[4]=(f-b)*w,t[5]=(1-(h+v))*w,t[6]=(g+m)*w,t[7]=0,t[8]=(d+y)*E,t[9]=(g-m)*E,t[10]=(1-(h+p))*E,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function uj(t,n,e,r,i){var o=n[0],a=n[1],s=n[2],u=n[3],c=o+o,l=a+a,h=s+s,f=o*c,d=o*l,p=o*h,g=a*l,v=a*h,m=s*h,y=u*c,b=u*l,x=u*h,w=r[0],E=r[1],M=r[2],_=i[0],k=i[1],S=i[2],A=(1-(g+m))*w,C=(d+x)*w,I=(p-b)*w,N=(d-x)*E,D=(1-(f+m))*E,P=(v+y)*E,j=(p+b)*M,L=(v-y)*M,R=(1-(f+g))*M;return t[0]=A,t[1]=C,t[2]=I,t[3]=0,t[4]=N,t[5]=D,t[6]=P,t[7]=0,t[8]=j,t[9]=L,t[10]=R,t[11]=0,t[12]=e[0]+_-(A*_+N*k+j*S),t[13]=e[1]+k-(C*_+D*k+L*S),t[14]=e[2]+S-(I*_+P*k+R*S),t[15]=1,t}function cj(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=e+e,s=r+r,u=i+i,c=e*a,l=r*a,h=r*s,f=i*a,d=i*s,p=i*u,g=o*a,v=o*s,m=o*u;return t[0]=1-h-p,t[1]=l+m,t[2]=f-v,t[3]=0,t[4]=l-m,t[5]=1-c-p,t[6]=d+g,t[7]=0,t[8]=f+v,t[9]=d-g,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function lj(t,n,e,r,i,o,a){var s=1/(e-n),u=1/(i-r),c=1/(o-a);return t[0]=o*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*u,t[6]=0,t[7]=0,t[8]=(e+n)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function Vk(t,n,e,r,i){var o=1/Math.tan(n/2),a;return t[0]=o/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}var hj=Vk;function fj(t,n,e,r,i){var o=1/Math.tan(n/2),a;return t[0]=o/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(a=1/(r-i),t[10]=i*a,t[14]=i*r*a):(t[10]=-1,t[14]=-r),t}function dj(t,n,e,r){var i=Math.tan(n.upDegrees*Math.PI/180),o=Math.tan(n.downDegrees*Math.PI/180),a=Math.tan(n.leftDegrees*Math.PI/180),s=Math.tan(n.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((a-s)*u*.5),t[9]=(i-o)*c*.5,t[10]=r/(e-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*e/(e-r),t[15]=0,t}function Wk(t,n,e,r,i,o,a){var s=1/(n-e),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(n+e)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}var pj=Wk;function gj(t,n,e,r,i,o,a){var s=1/(n-e),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(n+e)*s,t[13]=(i+r)*u,t[14]=o*c,t[15]=1,t}function vj(t,n,e,r){var i,o,a,s,u,c,l,h,f,d,p=n[0],g=n[1],v=n[2],m=r[0],y=r[1],b=r[2],x=e[0],w=e[1],E=e[2];return Math.abs(p-x)<we&&Math.abs(g-w)<we&&Math.abs(v-E)<we?Fk(t):(l=p-x,h=g-w,f=v-E,d=1/Math.hypot(l,h,f),l*=d,h*=d,f*=d,i=y*f-b*h,o=b*l-m*f,a=m*h-y*l,d=Math.hypot(i,o,a),d?(d=1/d,i*=d,o*=d,a*=d):(i=0,o=0,a=0),s=h*a-f*o,u=f*i-l*a,c=l*o-h*i,d=Math.hypot(s,u,c),d?(d=1/d,s*=d,u*=d,c*=d):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=h,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(i*p+o*g+a*v),t[13]=-(s*p+u*g+c*v),t[14]=-(l*p+h*g+f*v),t[15]=1,t)}function mj(t,n,e,r){var i=n[0],o=n[1],a=n[2],s=r[0],u=r[1],c=r[2],l=i-e[0],h=o-e[1],f=a-e[2],d=l*l+h*h+f*f;d>0&&(d=1/Math.sqrt(d),l*=d,h*=d,f*=d);var p=u*f-c*h,g=c*l-s*f,v=s*h-u*l;return d=p*p+g*g+v*v,d>0&&(d=1/Math.sqrt(d),p*=d,g*=d,v*=d),t[0]=p,t[1]=g,t[2]=v,t[3]=0,t[4]=h*v-f*g,t[5]=f*p-l*v,t[6]=l*g-h*p,t[7]=0,t[8]=l,t[9]=h,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function yj(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function bj(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function xj(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t[8]=n[8]+e[8],t[9]=n[9]+e[9],t[10]=n[10]+e[10],t[11]=n[11]+e[11],t[12]=n[12]+e[12],t[13]=n[13]+e[13],t[14]=n[14]+e[14],t[15]=n[15]+e[15],t}function Xk(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t[6]=n[6]-e[6],t[7]=n[7]-e[7],t[8]=n[8]-e[8],t[9]=n[9]-e[9],t[10]=n[10]-e[10],t[11]=n[11]-e[11],t[12]=n[12]-e[12],t[13]=n[13]-e[13],t[14]=n[14]-e[14],t[15]=n[15]-e[15],t}function wj(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=n[11]*e,t[12]=n[12]*e,t[13]=n[13]*e,t[14]=n[14]*e,t[15]=n[15]*e,t}function Ej(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t[6]=n[6]+e[6]*r,t[7]=n[7]+e[7]*r,t[8]=n[8]+e[8]*r,t[9]=n[9]+e[9]*r,t[10]=n[10]+e[10]*r,t[11]=n[11]+e[11]*r,t[12]=n[12]+e[12]*r,t[13]=n[13]+e[13]*r,t[14]=n[14]+e[14]*r,t[15]=n[15]+e[15]*r,t}function Mj(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function Sj(t,n){var e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],f=t[10],d=t[11],p=t[12],g=t[13],v=t[14],m=t[15],y=n[0],b=n[1],x=n[2],w=n[3],E=n[4],M=n[5],_=n[6],k=n[7],S=n[8],A=n[9],C=n[10],I=n[11],N=n[12],D=n[13],P=n[14],j=n[15];return Math.abs(e-y)<=we*Math.max(1,Math.abs(e),Math.abs(y))&&Math.abs(r-b)<=we*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-x)<=we*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-w)<=we*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-E)<=we*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(s-M)<=we*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-_)<=we*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(c-k)<=we*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(l-S)<=we*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(h-A)<=we*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(f-C)<=we*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(d-I)<=we*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(p-N)<=we*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(g-D)<=we*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(v-P)<=we*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(m-j)<=we*Math.max(1,Math.abs(m),Math.abs(j))}var _j=Bk,kj=Xk;const Aj=Object.freeze(Object.defineProperty({__proto__:null,add:xj,adjoint:X6,clone:z6,copy:G6,create:B6,determinant:H6,equals:Sj,exactEquals:Mj,frob:bj,fromQuat:cj,fromQuat2:aj,fromRotation:nj,fromRotationTranslation:zk,fromRotationTranslationScale:sj,fromRotationTranslationScaleOrigin:uj,fromScaling:ej,fromTranslation:tj,fromValues:U6,fromXRotation:rj,fromYRotation:ij,fromZRotation:oj,frustum:lj,getRotation:Yk,getScaling:Uk,getTranslation:Gk,identity:Fk,invert:W6,lookAt:vj,mul:_j,multiply:Bk,multiplyScalar:wj,multiplyScalarAndAdd:Ej,ortho:pj,orthoNO:Wk,orthoZO:gj,perspective:hj,perspectiveFromFieldOfView:dj,perspectiveNO:Vk,perspectiveZO:fj,rotate:K6,rotateX:Q6,rotateY:J6,rotateZ:$6,scale:Z6,set:Y6,str:yj,sub:kj,subtract:Xk,targetTo:mj,translate:q6,transpose:V6},Symbol.toStringTag,{value:"Module"}));function dy(){var t=new tn(3);return tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Cj(t){var n=new tn(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function Hk(t){var n=t[0],e=t[1],r=t[2];return Math.hypot(n,e,r)}function Ev(t,n,e){var r=new tn(3);return r[0]=t,r[1]=n,r[2]=e,r}function Ij(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function Tj(t,n,e,r){return t[0]=n,t[1]=e,t[2]=r,t}function Oj(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t}function qk(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t}function Zk(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t}function Kk(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t}function Nj(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function Dj(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function Pj(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t}function Lj(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t}function jj(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function Rj(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t}function Fj(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t}function Qk(t,n){var e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2];return Math.hypot(e,r,i)}function Jk(t,n){var e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2];return e*e+r*r+i*i}function $k(t){var n=t[0],e=t[1],r=t[2];return n*n+e*e+r*r}function Bj(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function zj(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function tA(t,n){var e=n[0],r=n[1],i=n[2],o=e*e+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o,t}function py(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function Yf(t,n,e){var r=n[0],i=n[1],o=n[2],a=e[0],s=e[1],u=e[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function Gj(t,n,e,r){var i=n[0],o=n[1],a=n[2];return t[0]=i+r*(e[0]-i),t[1]=o+r*(e[1]-o),t[2]=a+r*(e[2]-a),t}function Uj(t,n,e,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return t[0]=n[0]*s+e[0]*u+r[0]*c+i[0]*l,t[1]=n[1]*s+e[1]*u+r[1]*c+i[1]*l,t[2]=n[2]*s+e[2]*u+r[2]*c+i[2]*l,t}function Yj(t,n,e,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,h=3*u*a,f=u*o;return t[0]=n[0]*c+e[0]*l+r[0]*h+i[0]*f,t[1]=n[1]*c+e[1]*l+r[1]*h+i[1]*f,t[2]=n[2]*c+e[2]*l+r[2]*h+i[2]*f,t}function Vj(t,n){n=n||1;var e=Oi()*2*Math.PI,r=Oi()*2-1,i=Math.sqrt(1-r*r)*n;return t[0]=Math.cos(e)*i,t[1]=Math.sin(e)*i,t[2]=r*n,t}function Wj(t,n,e){var r=n[0],i=n[1],o=n[2],a=e[3]*r+e[7]*i+e[11]*o+e[15];return a=a||1,t[0]=(e[0]*r+e[4]*i+e[8]*o+e[12])/a,t[1]=(e[1]*r+e[5]*i+e[9]*o+e[13])/a,t[2]=(e[2]*r+e[6]*i+e[10]*o+e[14])/a,t}function hp(t,n,e){var r=n[0],i=n[1],o=n[2];return t[0]=r*e[0]+i*e[3]+o*e[6],t[1]=r*e[1]+i*e[4]+o*e[7],t[2]=r*e[2]+i*e[5]+o*e[8],t}function Xj(t,n,e){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=i*c-o*u,h=o*s-r*c,f=r*u-i*s,d=i*f-o*h,p=o*l-r*f,g=r*h-i*l,v=a*2;return l*=v,h*=v,f*=v,d*=2,p*=2,g*=2,t[0]=s+l+d,t[1]=u+h+p,t[2]=c+f+g,t}function Hj(t,n,e,r){var i=[],o=[];return i[0]=n[0]-e[0],i[1]=n[1]-e[1],i[2]=n[2]-e[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t}function qj(t,n,e,r){var i=[],o=[];return i[0]=n[0]-e[0],i[1]=n[1]-e[1],i[2]=n[2]-e[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t}function Zj(t,n,e,r){var i=[],o=[];return i[0]=n[0]-e[0],i[1]=n[1]-e[1],i[2]=n[2]-e[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t}function Kj(t,n){var e=t[0],r=t[1],i=t[2],o=n[0],a=n[1],s=n[2],u=Math.sqrt(e*e+r*r+i*i),c=Math.sqrt(o*o+a*a+s*s),l=u*c,h=l&&py(t,n)/l;return Math.acos(Math.min(Math.max(h,-1),1))}function Qj(t){return t[0]=0,t[1]=0,t[2]=0,t}function Jj(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function $j(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function tR(t,n){var e=t[0],r=t[1],i=t[2],o=n[0],a=n[1],s=n[2];return Math.abs(e-o)<=we*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(r-a)<=we*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=we*Math.max(1,Math.abs(i),Math.abs(s))}var eR=qk,nR=Zk,rR=Kk,iR=Qk,oR=Jk,eA=Hk,aR=$k,sR=function(){var t=dy();return function(n,e,r,i,o,a){var s,u;for(e||(e=3),r||(r=0),i?u=Math.min(i*e+r,n.length):u=n.length,s=r;s<u;s+=e)t[0]=n[s],t[1]=n[s+1],t[2]=n[s+2],o(t,t,a),n[s]=t[0],n[s+1]=t[1],n[s+2]=t[2];return n}}();const uR=Object.freeze(Object.defineProperty({__proto__:null,add:Oj,angle:Kj,bezier:Yj,ceil:Nj,clone:Cj,copy:Ij,create:dy,cross:Yf,dist:iR,distance:Qk,div:rR,divide:Kk,dot:py,equals:tR,exactEquals:$j,floor:Dj,forEach:sR,fromValues:Ev,hermite:Uj,inverse:zj,len:eA,length:Hk,lerp:Gj,max:Lj,min:Pj,mul:nR,multiply:Zk,negate:Bj,normalize:tA,random:Vj,rotateX:Hj,rotateY:qj,rotateZ:Zj,round:jj,scale:Rj,scaleAndAdd:Fj,set:Tj,sqrDist:oR,sqrLen:aR,squaredDistance:Jk,squaredLength:$k,str:Jj,sub:eR,subtract:qk,transformMat3:hp,transformMat4:Wj,transformQuat:Xj,zero:Qj},Symbol.toStringTag,{value:"Module"}));function nA(){var t=new tn(4);return tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function rA(t){var n=new tn(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function iA(t,n,e,r){var i=new tn(4);return i[0]=t,i[1]=n,i[2]=e,i[3]=r,i}function oA(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function aA(t,n,e,r,i){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t}function sA(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t}function uA(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t}function cA(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t[3]=n[3]*e[3],t}function lA(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t[3]=n[3]/e[3],t}function cR(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t}function lR(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t}function hR(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t[3]=Math.min(n[3],e[3]),t}function fR(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t[3]=Math.max(n[3],e[3]),t}function dR(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t}function hA(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t}function pR(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t}function fA(t,n){var e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return Math.hypot(e,r,i,o)}function dA(t,n){var e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return e*e+r*r+i*i+o*o}function gy(t){var n=t[0],e=t[1],r=t[2],i=t[3];return Math.hypot(n,e,r,i)}function vy(t){var n=t[0],e=t[1],r=t[2],i=t[3];return n*n+e*e+r*r+i*i}function gR(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function vR(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t}function pA(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=e*e+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=e*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t}function gA(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function mR(t,n,e,r){var i=e[0]*r[1]-e[1]*r[0],o=e[0]*r[2]-e[2]*r[0],a=e[0]*r[3]-e[3]*r[0],s=e[1]*r[2]-e[2]*r[1],u=e[1]*r[3]-e[3]*r[1],c=e[2]*r[3]-e[3]*r[2],l=n[0],h=n[1],f=n[2],d=n[3];return t[0]=h*c-f*u+d*s,t[1]=-(l*c)+f*a-d*o,t[2]=l*u-h*a+d*i,t[3]=-(l*s)+h*o-f*i,t}function vA(t,n,e,r){var i=n[0],o=n[1],a=n[2],s=n[3];return t[0]=i+r*(e[0]-i),t[1]=o+r*(e[1]-o),t[2]=a+r*(e[2]-a),t[3]=s+r*(e[3]-s),t}function yR(t,n){n=n||1;var e,r,i,o,a,s;do e=Oi()*2-1,r=Oi()*2-1,a=e*e+r*r;while(a>=1);do i=Oi()*2-1,o=Oi()*2-1,s=i*i+o*o;while(s>=1);var u=Math.sqrt((1-a)/s);return t[0]=n*e,t[1]=n*r,t[2]=n*i*u,t[3]=n*o*u,t}function bR(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3];return t[0]=e[0]*r+e[4]*i+e[8]*o+e[12]*a,t[1]=e[1]*r+e[5]*i+e[9]*o+e[13]*a,t[2]=e[2]*r+e[6]*i+e[10]*o+e[14]*a,t[3]=e[3]*r+e[7]*i+e[11]*o+e[15]*a,t}function xR(t,n,e){var r=n[0],i=n[1],o=n[2],a=e[0],s=e[1],u=e[2],c=e[3],l=c*r+s*o-u*i,h=c*i+u*r-a*o,f=c*o+a*i-s*r,d=-a*r-s*i-u*o;return t[0]=l*c+d*-a+h*-u-f*-s,t[1]=h*c+d*-s+f*-a-l*-u,t[2]=f*c+d*-u+l*-s-h*-a,t[3]=n[3],t}function wR(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function ER(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function mA(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function yA(t,n){var e=t[0],r=t[1],i=t[2],o=t[3],a=n[0],s=n[1],u=n[2],c=n[3];return Math.abs(e-a)<=we*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(r-s)<=we*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=we*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=we*Math.max(1,Math.abs(o),Math.abs(c))}var MR=uA,SR=cA,_R=lA,kR=fA,AR=dA,CR=gy,IR=vy,TR=function(){var t=nA();return function(n,e,r,i,o,a){var s,u;for(e||(e=4),r||(r=0),i?u=Math.min(i*e+r,n.length):u=n.length,s=r;s<u;s+=e)t[0]=n[s],t[1]=n[s+1],t[2]=n[s+2],t[3]=n[s+3],o(t,t,a),n[s]=t[0],n[s+1]=t[1],n[s+2]=t[2],n[s+3]=t[3];return n}}();const OR=Object.freeze(Object.defineProperty({__proto__:null,add:sA,ceil:cR,clone:rA,copy:oA,create:nA,cross:mR,dist:kR,distance:fA,div:_R,divide:lA,dot:gA,equals:yA,exactEquals:mA,floor:lR,forEach:TR,fromValues:iA,inverse:vR,len:CR,length:gy,lerp:vA,max:fR,min:hR,mul:SR,multiply:cA,negate:gR,normalize:pA,random:yR,round:dR,scale:hA,scaleAndAdd:pR,set:aA,sqrDist:AR,sqrLen:IR,squaredDistance:dA,squaredLength:vy,str:ER,sub:MR,subtract:uA,transformMat4:bR,transformQuat:xR,zero:wR},Symbol.toStringTag,{value:"Module"}));function md(){var t=new tn(4);return tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function NR(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function bA(t,n,e){e=e*.5;var r=Math.sin(e);return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=Math.cos(e),t}function DR(t,n){var e=Math.acos(n[3])*2,r=Math.sin(e/2);return r>we?(t[0]=n[0]/r,t[1]=n[1]/r,t[2]=n[2]/r):(t[0]=1,t[1]=0,t[2]=0),e}function PR(t,n){var e=yy(t,n);return Math.acos(2*e*e-1)}function xA(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=e[3];return t[0]=r*l+a*s+i*c-o*u,t[1]=i*l+a*u+o*s-r*c,t[2]=o*l+a*c+r*u-i*s,t[3]=a*l-r*s-i*u-o*c,t}function wA(t,n,e){e*=.5;var r=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(e),u=Math.cos(e);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t}function EA(t,n,e){e*=.5;var r=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(e),u=Math.cos(e);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t}function MA(t,n,e){e*=.5;var r=n[0],i=n[1],o=n[2],a=n[3],s=Math.sin(e),u=Math.cos(e);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t}function LR(t,n){var e=n[0],r=n[1],i=n[2];return t[0]=e,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-e*e-r*r-i*i)),t}function SA(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=Math.sqrt(e*e+r*r+i*i),s=Math.exp(o),u=a>0?s*Math.sin(a)/a:0;return t[0]=e*u,t[1]=r*u,t[2]=i*u,t[3]=s*Math.cos(a),t}function _A(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=Math.sqrt(e*e+r*r+i*i),s=a>0?Math.atan2(a,o)/a:0;return t[0]=e*s,t[1]=r*s,t[2]=i*s,t[3]=.5*Math.log(e*e+r*r+i*i+o*o),t}function jR(t,n,e){return _A(t,n),AA(t,t,e),SA(t,t),t}function Vf(t,n,e,r){var i=n[0],o=n[1],a=n[2],s=n[3],u=e[0],c=e[1],l=e[2],h=e[3],f,d,p,g,v;return d=i*u+o*c+a*l+s*h,d<0&&(d=-d,u=-u,c=-c,l=-l,h=-h),1-d>we?(f=Math.acos(d),p=Math.sin(f),g=Math.sin((1-r)*f)/p,v=Math.sin(r*f)/p):(g=1-r,v=r),t[0]=g*i+v*u,t[1]=g*o+v*c,t[2]=g*a+v*l,t[3]=g*s+v*h,t}function RR(t){var n=Oi(),e=Oi(),r=Oi(),i=Math.sqrt(1-n),o=Math.sqrt(n);return t[0]=i*Math.sin(2*Math.PI*e),t[1]=i*Math.cos(2*Math.PI*e),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function FR(t,n){var e=n[0],r=n[1],i=n[2],o=n[3],a=e*e+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-e*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function BR(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function kA(t,n){var e=n[0]+n[4]+n[8],r;if(e>0)r=Math.sqrt(e+1),t[3]=.5*r,r=.5/r,t[0]=(n[5]-n[7])*r,t[1]=(n[6]-n[2])*r,t[2]=(n[1]-n[3])*r;else{var i=0;n[4]>n[0]&&(i=1),n[8]>n[i*3+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(n[i*3+i]-n[o*3+o]-n[a*3+a]+1),t[i]=.5*r,r=.5/r,t[3]=(n[o*3+a]-n[a*3+o])*r,t[o]=(n[o*3+i]+n[i*3+o])*r,t[a]=(n[a*3+i]+n[i*3+a])*r}return t}function zR(t,n,e,r){var i=.5*Math.PI/180;n*=i,e*=i,r*=i;var o=Math.sin(n),a=Math.cos(n),s=Math.sin(e),u=Math.cos(e),c=Math.sin(r),l=Math.cos(r);return t[0]=o*u*l-a*s*c,t[1]=a*s*l+o*u*c,t[2]=a*u*c-o*s*l,t[3]=a*u*l+o*s*c,t}function GR(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var UR=rA,YR=iA,my=oA,VR=aA,WR=sA,XR=xA,AA=hA,yy=gA,HR=vA,by=gy,qR=by,xy=vy,ZR=xy,wy=pA,KR=mA,QR=yA,JR=function(){var t=dy(),n=Ev(1,0,0),e=Ev(0,1,0);return function(r,i,o){var a=py(i,o);return a<-.999999?(Yf(t,n,i),eA(t)<1e-6&&Yf(t,e,i),tA(t,t),bA(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Yf(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,wy(r,r))}}(),$R=function(){var t=md(),n=md();return function(e,r,i,o,a,s){return Vf(t,r,a,s),Vf(n,i,o,s),Vf(e,t,n,2*s*(1-s)),e}}(),tF=function(){var t=Lk();return function(n,e,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],wy(n,kA(n,t))}}();const eF=Object.freeze(Object.defineProperty({__proto__:null,add:WR,calculateW:LR,clone:UR,conjugate:BR,copy:my,create:md,dot:yy,equals:QR,exactEquals:KR,exp:SA,fromEuler:zR,fromMat3:kA,fromValues:YR,getAngle:PR,getAxisAngle:DR,identity:NR,invert:FR,len:qR,length:by,lerp:HR,ln:_A,mul:XR,multiply:xA,normalize:wy,pow:jR,random:RR,rotateX:wA,rotateY:EA,rotateZ:MA,rotationTo:JR,scale:AA,set:VR,setAxes:tF,setAxisAngle:bA,slerp:Vf,sqlerp:$R,sqrLen:ZR,squaredLength:xy,str:GR},Symbol.toStringTag,{value:"Module"}));function nF(){var t=new tn(8);return tn!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function rF(t){var n=new tn(8);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n}function iF(t,n,e,r,i,o,a,s){var u=new tn(8);return u[0]=t,u[1]=n,u[2]=e,u[3]=r,u[4]=i,u[5]=o,u[6]=a,u[7]=s,u}function oF(t,n,e,r,i,o,a){var s=new tn(8);s[0]=t,s[1]=n,s[2]=e,s[3]=r;var u=i*.5,c=o*.5,l=a*.5;return s[4]=u*r+c*e-l*n,s[5]=c*r+l*t-u*e,s[6]=l*r+u*n-c*t,s[7]=-u*t-c*n-l*e,s}function CA(t,n,e){var r=e[0]*.5,i=e[1]*.5,o=e[2]*.5,a=n[0],s=n[1],u=n[2],c=n[3];return t[0]=a,t[1]=s,t[2]=u,t[3]=c,t[4]=r*c+i*u-o*s,t[5]=i*c+o*a-r*u,t[6]=o*c+r*s-i*a,t[7]=-r*a-i*s-o*u,t}function aF(t,n){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0]*.5,t[5]=n[1]*.5,t[6]=n[2]*.5,t[7]=0,t}function sF(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function uF(t,n){var e=md();Yk(e,n);var r=new tn(3);return Gk(r,n),CA(t,e,r),t}function IA(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t}function cF(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function lF(t,n,e,r,i,o,a,s,u){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t}var hF=my;function fF(t,n){return t[0]=n[4],t[1]=n[5],t[2]=n[6],t[3]=n[7],t}var dF=my;function pF(t,n){return t[4]=n[0],t[5]=n[1],t[6]=n[2],t[7]=n[3],t}function gF(t,n){var e=n[4],r=n[5],i=n[6],o=n[7],a=-n[0],s=-n[1],u=-n[2],c=n[3];return t[0]=(e*c+o*a+r*u-i*s)*2,t[1]=(r*c+o*s+i*a-e*u)*2,t[2]=(i*c+o*u+e*s-r*a)*2,t}function vF(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0]*.5,u=e[1]*.5,c=e[2]*.5,l=n[4],h=n[5],f=n[6],d=n[7];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=a*s+i*c-o*u+l,t[5]=a*u+o*s-r*c+h,t[6]=a*c+r*u-i*s+f,t[7]=-r*s-i*u-o*c+d,t}function mF(t,n,e){var r=-n[0],i=-n[1],o=-n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=s*a+l*r+u*o-c*i,f=u*a+l*i+c*r-s*o,d=c*a+l*o+s*i-u*r,p=l*a-s*r-u*i-c*o;return wA(t,n,e),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=h*a+p*r+f*o-d*i,t[5]=f*a+p*i+d*r-h*o,t[6]=d*a+p*o+h*i-f*r,t[7]=p*a-h*r-f*i-d*o,t}function yF(t,n,e){var r=-n[0],i=-n[1],o=-n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=s*a+l*r+u*o-c*i,f=u*a+l*i+c*r-s*o,d=c*a+l*o+s*i-u*r,p=l*a-s*r-u*i-c*o;return EA(t,n,e),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=h*a+p*r+f*o-d*i,t[5]=f*a+p*i+d*r-h*o,t[6]=d*a+p*o+h*i-f*r,t[7]=p*a-h*r-f*i-d*o,t}function bF(t,n,e){var r=-n[0],i=-n[1],o=-n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=s*a+l*r+u*o-c*i,f=u*a+l*i+c*r-s*o,d=c*a+l*o+s*i-u*r,p=l*a-s*r-u*i-c*o;return MA(t,n,e),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=h*a+p*r+f*o-d*i,t[5]=f*a+p*i+d*r-h*o,t[6]=d*a+p*o+h*i-f*r,t[7]=p*a-h*r-f*i-d*o,t}function xF(t,n,e){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=s*a+l*r+u*o-c*i,t[1]=u*a+l*i+c*r-s*o,t[2]=c*a+l*o+s*i-u*r,t[3]=l*a-s*r-u*i-c*o,s=n[4],u=n[5],c=n[6],l=n[7],t[4]=s*a+l*r+u*o-c*i,t[5]=u*a+l*i+c*r-s*o,t[6]=c*a+l*o+s*i-u*r,t[7]=l*a-s*r-u*i-c*o,t}function wF(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=e[3];return t[0]=r*l+a*s+i*c-o*u,t[1]=i*l+a*u+o*s-r*c,t[2]=o*l+a*c+r*u-i*s,t[3]=a*l-r*s-i*u-o*c,s=e[4],u=e[5],c=e[6],l=e[7],t[4]=r*l+a*s+i*c-o*u,t[5]=i*l+a*u+o*s-r*c,t[6]=o*l+a*c+r*u-i*s,t[7]=a*l-r*s-i*u-o*c,t}function EF(t,n,e,r){if(Math.abs(r)<we)return IA(t,n);var i=Math.hypot(e[0],e[1],e[2]);r=r*.5;var o=Math.sin(r),a=o*e[0]/i,s=o*e[1]/i,u=o*e[2]/i,c=Math.cos(r),l=n[0],h=n[1],f=n[2],d=n[3];t[0]=l*c+d*a+h*u-f*s,t[1]=h*c+d*s+f*a-l*u,t[2]=f*c+d*u+l*s-h*a,t[3]=d*c-l*a-h*s-f*u;var p=n[4],g=n[5],v=n[6],m=n[7];return t[4]=p*c+m*a+g*u-v*s,t[5]=g*c+m*s+v*a-p*u,t[6]=v*c+m*u+p*s-g*a,t[7]=m*c-p*a-g*s-v*u,t}function MF(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t}function TA(t,n,e){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[4],u=e[5],c=e[6],l=e[7],h=n[4],f=n[5],d=n[6],p=n[7],g=e[0],v=e[1],m=e[2],y=e[3];return t[0]=r*y+a*g+i*m-o*v,t[1]=i*y+a*v+o*g-r*m,t[2]=o*y+a*m+r*v-i*g,t[3]=a*y-r*g-i*v-o*m,t[4]=r*l+a*s+i*c-o*u+h*y+p*g+f*m-d*v,t[5]=i*l+a*u+o*s-r*c+f*y+p*v+d*g-h*m,t[6]=o*l+a*c+r*u-i*s+d*y+p*m+h*v-f*g,t[7]=a*l-r*s-i*u-o*c+p*y-h*g-f*v-d*m,t}var SF=TA;function _F(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t}var OA=yy;function kF(t,n,e,r){var i=1-r;return OA(n,e)<0&&(r=-r),t[0]=n[0]*i+e[0]*r,t[1]=n[1]*i+e[1]*r,t[2]=n[2]*i+e[2]*r,t[3]=n[3]*i+e[3]*r,t[4]=n[4]*i+e[4]*r,t[5]=n[5]*i+e[5]*r,t[6]=n[6]*i+e[6]*r,t[7]=n[7]*i+e[7]*r,t}function AF(t,n){var e=fp(n);return t[0]=-n[0]/e,t[1]=-n[1]/e,t[2]=-n[2]/e,t[3]=n[3]/e,t[4]=-n[4]/e,t[5]=-n[5]/e,t[6]=-n[6]/e,t[7]=n[7]/e,t}function CF(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=n[7],t}var NA=by,IF=NA,fp=xy,TF=fp;function OF(t,n){var e=fp(n);if(e>0){e=Math.sqrt(e);var r=n[0]/e,i=n[1]/e,o=n[2]/e,a=n[3]/e,s=n[4],u=n[5],c=n[6],l=n[7],h=r*s+i*u+o*c+a*l;t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=(s-r*h)/e,t[5]=(u-i*h)/e,t[6]=(c-o*h)/e,t[7]=(l-a*h)/e}return t}function NF(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function DF(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]}function PF(t,n){var e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=n[0],h=n[1],f=n[2],d=n[3],p=n[4],g=n[5],v=n[6],m=n[7];return Math.abs(e-l)<=we*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(r-h)<=we*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-f)<=we*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-d)<=we*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-p)<=we*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-g)<=we*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(u-v)<=we*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-m)<=we*Math.max(1,Math.abs(c),Math.abs(m))}const LF=Object.freeze(Object.defineProperty({__proto__:null,add:MF,clone:rF,conjugate:CF,copy:IA,create:nF,dot:OA,equals:PF,exactEquals:DF,fromMat4:uF,fromRotation:sF,fromRotationTranslation:CA,fromRotationTranslationValues:oF,fromTranslation:aF,fromValues:iF,getDual:fF,getReal:hF,getTranslation:gF,identity:cF,invert:AF,len:IF,length:NA,lerp:kF,mul:SF,multiply:TA,normalize:OF,rotateAroundAxis:EF,rotateByQuatAppend:xF,rotateByQuatPrepend:wF,rotateX:mF,rotateY:yF,rotateZ:bF,scale:_F,set:lF,setDual:pF,setReal:dF,sqrLen:TF,squaredLength:fp,str:NF,translate:vF},Symbol.toStringTag,{value:"Module"}));function DA(){var t=new tn(2);return tn!=Float32Array&&(t[0]=0,t[1]=0),t}function jF(t){var n=new tn(2);return n[0]=t[0],n[1]=t[1],n}function RF(t,n){var e=new tn(2);return e[0]=t,e[1]=n,e}function FF(t,n){return t[0]=n[0],t[1]=n[1],t}function BF(t,n,e){return t[0]=n,t[1]=e,t}function pr(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t}function PA(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t}function LA(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t}function jA(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t}function zF(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function GF(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function pa(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t}function ga(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t}function UF(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function kr(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t}function YF(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t}function yd(t,n){var e=n[0]-t[0],r=n[1]-t[1];return Math.hypot(e,r)}function RA(t,n){var e=n[0]-t[0],r=n[1]-t[1];return e*e+r*r}function FA(t){var n=t[0],e=t[1];return Math.hypot(n,e)}function BA(t){var n=t[0],e=t[1];return n*n+e*e}function VF(t,n){return t[0]=-n[0],t[1]=-n[1],t}function WF(t,n){return t[0]=1/n[0],t[1]=1/n[1],t}function _a(t,n){var e=n[0],r=n[1],i=e*e+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=n[0]*i,t[1]=n[1]*i,t}function Ey(t,n){return t[0]*n[0]+t[1]*n[1]}function XF(t,n,e){var r=n[0]*e[1]-n[1]*e[0];return t[0]=t[1]=0,t[2]=r,t}function HF(t,n,e,r){var i=n[0],o=n[1];return t[0]=i+r*(e[0]-i),t[1]=o+r*(e[1]-o),t}function qF(t,n){n=n||1;var e=Oi()*2*Math.PI;return t[0]=Math.cos(e)*n,t[1]=Math.sin(e)*n,t}function ZF(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[2]*i,t[1]=e[1]*r+e[3]*i,t}function KF(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[2]*i+e[4],t[1]=e[1]*r+e[3]*i+e[5],t}function QF(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[3]*i+e[6],t[1]=e[1]*r+e[4]*i+e[7],t}function JF(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[4]*i+e[12],t[1]=e[1]*r+e[5]*i+e[13],t}function $F(t,n,e,r){var i=n[0]-e[0],o=n[1]-e[1],a=Math.sin(r),s=Math.cos(r);return t[0]=i*s-o*a+e[0],t[1]=i*a+o*s+e[1],t}function zA(t,n){var e=t[0],r=t[1],i=n[0],o=n[1],a=Math.sqrt(e*e+r*r)*Math.sqrt(i*i+o*o),s=a&&(e*i+r*o)/a;return Math.acos(Math.min(Math.max(s,-1),1))}function tB(t){return t[0]=0,t[1]=0,t}function eB(t){return"vec2("+t[0]+", "+t[1]+")"}function My(t,n){return t[0]===n[0]&&t[1]===n[1]}function nB(t,n){var e=t[0],r=t[1],i=n[0],o=n[1];return Math.abs(e-i)<=we*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(r-o)<=we*Math.max(1,Math.abs(r),Math.abs(o))}var rB=FA,Wf=PA,iB=LA,oB=jA,aB=yd,sB=RA,uB=BA,cB=function(){var t=DA();return function(n,e,r,i,o,a){var s,u;for(e||(e=2),r||(r=0),i?u=Math.min(i*e+r,n.length):u=n.length,s=r;s<u;s+=e)t[0]=n[s],t[1]=n[s+1],o(t,t,a),n[s]=t[0],n[s+1]=t[1];return n}}();const lB=Object.freeze(Object.defineProperty({__proto__:null,add:pr,angle:zA,ceil:zF,clone:jF,copy:FF,create:DA,cross:XF,dist:aB,distance:yd,div:oB,divide:jA,dot:Ey,equals:nB,exactEquals:My,floor:GF,forEach:cB,fromValues:RF,inverse:WF,len:rB,length:FA,lerp:HF,max:ga,min:pa,mul:iB,multiply:LA,negate:VF,normalize:_a,random:qF,rotate:$F,round:UF,scale:kr,scaleAndAdd:YF,set:BF,sqrDist:sB,sqrLen:uB,squaredDistance:RA,squaredLength:BA,str:eB,sub:Wf,subtract:PA,transformMat2:ZF,transformMat2d:KF,transformMat3:QF,transformMat4:JF,zero:tB},Symbol.toStringTag,{value:"Module"})),hB=Object.freeze(Object.defineProperty({__proto__:null,glMatrix:y4,mat2:Y4,mat2d:d6,mat3:Rk,mat4:Aj,quat:eF,quat2:LF,vec2:lB,vec3:uR,vec4:OR},Symbol.toStringTag,{value:"Module"}));function fB(t,n,e){var r=[0,0,0,0,0,0,0,0,0];return ly(r,e),mo(t,r,n)}function dB(t,n,e){var r=[0,0,0,0,0,0,0,0,0];return hy(r,e),mo(t,r,n)}function pB(t,n,e){var r=[0,0,0,0,0,0,0,0,0];return fy(r,e),mo(t,r,n)}function gB(t,n,e){return mo(t,e,n)}function yi(t,n){for(var e=t?[].concat(t):[1,0,0,0,1,0,0,0,1],r=0,i=n.length;r<i;r++){var o=n[r];switch(o[0]){case"t":fB(e,e,[o[1],o[2]]);break;case"s":pB(e,e,[o[1],o[2]]);break;case"r":dB(e,e,o[1]);break;case"m":gB(e,e,o[1]);break}}return e}var Ss=function(t,n){var e=t.nodes,r=t.edges,i=[],o={};if(!e)throw new Error("invalid nodes data!");return e&&e.forEach(function(a,s){o[a.id]=s;var u=[];i.push(u)}),r&&r.forEach(function(a){var s=a.source,u=a.target,c=o[s],l=o[u];!c&&c!==0||!l&&l!==0||(i[c][l]=1,n||(i[l][c]=1))}),i},vB=function(t,n){return t===n},pw=function(){function t(n,e){e===void 0&&(e=null),this.value=n,this.next=e}return t.prototype.toString=function(n){return n?n(this.value):"".concat(this.value)},t}(),GA=function(){function t(n){n===void 0&&(n=vB),this.head=null,this.tail=null,this.compare=n}return t.prototype.prepend=function(n){var e=new pw(n,this.head);return this.head=e,this.tail||(this.tail=e),this},t.prototype.append=function(n){var e=new pw(n);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},t.prototype.delete=function(n){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,n);)e=this.head,this.head=this.head.next;var r=this.head;if(r!==null)for(;r.next;)this.compare(r.next.value,n)?(e=r.next,r.next=r.next.next):r=r.next;return this.compare(this.tail.value,n)&&(this.tail=r),e},t.prototype.find=function(n){var e=n.value,r=e===void 0?void 0:e,i=n.callback,o=i===void 0?void 0:i;if(!this.head)return null;for(var a=this.head;a;){if(o&&o(a.value)||r!==void 0&&this.compare(a.value,r))return a;a=a.next}return null},t.prototype.deleteTail=function(){var n=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,n;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,n},t.prototype.deleteHead=function(){if(!this.head)return null;var n=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),n},t.prototype.fromArray=function(n){var e=this;return n.forEach(function(r){return e.append(r)}),this},t.prototype.toArray=function(){for(var n=[],e=this.head;e;)n.push(e),e=e.next;return n},t.prototype.reverse=function(){for(var n=this.head,e=null,r=null;n;)r=n.next,n.next=e,e=n,n=r;this.tail=this.head,this.head=e},t.prototype.toString=function(n){return n===void 0&&(n=void 0),this.toArray().map(function(e){return e.toString(n)}).toString()},t}(),mB=function(){function t(){this.linkedList=new GA}return t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},t.prototype.enqueue=function(n){this.linkedList.append(n)},t.prototype.dequeue=function(){var n=this.linkedList.deleteHead();return n?n.value:null},t.prototype.toString=function(n){return this.linkedList.toString(n)},t}(),Qr=function(t,n,e){n===void 0&&(n=[]);var r=n.filter(function(s){return s.source===t||s.target===t});if(e==="target"){var i=function(s){return s.source===t};return r.filter(i).map(function(s){return s.target})}if(e==="source"){var o=function(s){return s.target===t};return r.filter(o).map(function(s){return s.source})}var a=function(s){return s.source===t?s.target:s.source};return r.map(a)},yB=function(t,n){return n.filter(function(e){return e.source===t})},Xf=function(t,n){return n.filter(function(e){return e.source===t||e.target===t})},UA=function(t){t===void 0&&(t=0);var n="".concat(Math.random()).split(".")[1].substr(0,5),e="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(t,"-").concat(n).concat(e)};function bB(t){t===void 0&&(t={});var n=t,e=function(){},r=function(){var i={};return function(o){var a=o.next,s=a;return i[s]?!1:(i[s]=!0,!0)}}();return n.allowTraversal=t.allowTraversal||r,n.enter=t.enter||e,n.leave=t.leave||e,n}var YA=function(t,n,e,r){r===void 0&&(r=!0);var i=bB(e),o=new mB,a=t.edges,s=a===void 0?[]:a;o.enqueue(n);for(var u="",c=function(){var l=o.dequeue();i.enter({current:l,previous:u}),Qr(l,s,r?"target":void 0).forEach(function(h){i.allowTraversal({previous:u,current:l,next:h})&&o.enqueue(h)}),i.leave({current:l,previous:u}),u=l};!o.isEmpty();)c()},xB=function(t){for(var n=t.nodes,e=n===void 0?[]:n,r=t.edges,i=r===void 0?[]:r,o=[],a={},s=[],u=function f(d){s.push(d),a[d.id]=!0;for(var p=Qr(d.id,i),g=function(m){var y=p[m];if(!a[y]){var b=e.filter(function(x){return x.id===y});b.length>0&&f(b[0])}},v=0;v<p.length;++v)g(v)},c=0;c<e.length;c++){var l=e[c];if(!a[l.id]){u(l);for(var h=[];s.length>0;)h.push(s.pop());o.push(h)}}return o},VA=function(t){for(var n=t.nodes,e=n===void 0?[]:n,r=t.edges,i=r===void 0?[]:r,o=[],a={},s={},u={},c=[],l=0,h=function g(v){s[v.id]=l,u[v.id]=l,l+=1,o.push(v),a[v.id]=!0;for(var m=Qr(v.id,i,"target").filter(function(E){return e.map(function(M){return M.id}).indexOf(E)>-1}),y=function(E){var M=m[E];if(!s[M]&&s[M]!==0){var _=e.filter(function(k){return k.id===M});_.length>0&&g(_[0]),u[v.id]=Math.min(u[v.id],u[M])}else a[M]&&(u[v.id]=Math.min(u[v.id],s[M]))},b=0;b<m.length;b++)y(b);if(u[v.id]===s[v.id]){for(var x=[];o.length>0;){var w=o.pop();if(a[w.id]=!1,x.push(w),w===v)break}x.length>0&&c.push(x)}},f=0,d=e;f<d.length;f++){var p=d[f];!s[p.id]&&s[p.id]!==0&&h(p)}return c};function Sy(t,n){return n?VA(t):xB(t)}var qo=function(t){var n={},e=t.nodes,r=e===void 0?[]:e,i=t.edges,o=i===void 0?[]:i;return r.forEach(function(a){n[a.id]={degree:0,inDegree:0,outDegree:0}}),o.forEach(function(a){n[a.source].degree++,n[a.source].outDegree++,n[a.target].degree++,n[a.target].inDegree++}),n},WA=function(t,n){var e=qo(t);return e[n]?qo(t)[n].inDegree:0},XA=function(t,n){var e=qo(t);return e[n]?qo(t)[n].outDegree:0};function wB(t){t===void 0&&(t={});var n=t,e=function(){},r=function(){var i={};return function(o){var a=o.next;return i[a]?!1:(i[a]=!0,!0)}}();return n.allowTraversal=t.allowTraversal||r,n.enter=t.enter||e,n.leave=t.leave||e,n}function HA(t,n,e,r){r.enter({current:n,previous:e});var i=t.edges,o=i===void 0?[]:i;Qr(n,o,"target").forEach(function(a){r.allowTraversal({previous:e,current:n,next:a})&&HA(t,a,n,r)}),r.leave({current:n,previous:e})}function _y(t,n,e){HA(t,n,"",wB(e))}var ky=function(t){var n=null,e=t.nodes,r=e===void 0?[]:e,i={},o={},a={},s={};r.forEach(function(l){o[l.id]=l});for(var u={enter:function(l){var h=l.current,f=l.previous;if(a[h]){n={};for(var d=h,p=f;p!==h;)n[d]=p,d=p,p=i[p];n[d]=p}else a[h]=h,delete o[h],i[h]=f},leave:function(l){var h=l.current;s[h]=h,delete a[h]},allowTraversal:function(l){var h=l.next;return n?!1:!s[h]}};Object.keys(o).length;){var c=Object.keys(o)[0];_y(t,c,u)}return n},Ay=function(t,n,e){var r,i;e===void 0&&(e=!0);for(var o=[],a=Sy(t,!1),s=0,u=a;s<u.length;s++){var c=u[s];if(c.length)for(var l=c[0],h=l.id,f=[l],d=(r={},r[h]=l,r),p=(i={},i[h]=new Set,i);f.length>0;)for(var g=f.pop(),v=g.id,m=Qr(v,t.edges),y=function(x){var w,E=m[x],M=t.nodes.find(function(I){return I.id===E});if(E===v)o.push((w={},w[E]=g,w));else if(!(E in p))d[E]=g,f.push(M),p[E]=new Set([g]);else if(!p[v].has(M)){for(var _=!0,k=[M,g],S=d[v];p[E].size&&!p[E].has(S)&&(k.push(S),S!==d[S.id]);)S=d[S.id];if(k.push(S),n&&e?(_=!1,k.findIndex(function(I){return n.indexOf(I.id)>-1})>-1&&(_=!0)):n&&!e&&k.findIndex(function(I){return n.indexOf(I.id)>-1})>-1&&(_=!1),_){for(var A={},C=1;C<k.length;C+=1)A[k[C-1].id]=k[C];k.length&&(A[k[k.length-1].id]=k[0]),o.push(A)}p[E].add(g)}},b=0;b<m.length;b+=1)y(b)}return o},Cy=function(t,n,e){e===void 0&&(e=!0);for(var r=[],i=new Set,o=[],a=[],s={},u={},c=function(S){for(var A=[S];A.length>0;){var C=A.pop();i.has(C)&&(i.delete(C),o[C.id].forEach(function(I){A.push(I)}),o[C.id].clear())}},l=function S(A,C,I){var N=!1;if(n&&e===!1&&n.indexOf(A.id)>-1)return N;r.push(A),i.add(A);for(var D=I[A.id],P=0;P<D.length;P+=1){var j=s[D[P]];if(j===C){for(var L={},R=1;R<r.length;R+=1)L[r[R-1].id]=r[R];r.length&&(L[r[r.length-1].id]=r[0]),a.push(L),N=!0}else i.has(j)||S(j,C,I)&&(N=!0)}if(N)c(A);else for(var P=0;P<D.length;P+=1){var j=s[D[P]];o[j.id].has(A)||o[j.id].add(A)}return r.pop(),N},h=t.nodes,f=h===void 0?[]:h,d=0;d<f.length;d+=1){var p=f[d],g=p.id;u[g]=d,s[d]=p}if(n&&e)for(var v=function(A){var C=n[A];u[f[A].id]=u[C],u[C]=0,s[0]=f.find(function(I){return I.id===C}),s[u[f[A].id]]=f[A]},d=0;d<n.length;d++)v(d);for(var m=function(S){for(var A,C,I=1/0,N=0;N<S.length;N+=1)for(var D=S[N],P=0;P<D.length;P++){var j=u[D[P].id];j<I&&(I=j,C=N)}for(var L=S[C],R=[],N=0;N<L.length;N+=1){var V=L[N];R[V.id]=[];for(var tt=0,ut=Qr(V.id,t.edges,"target").filter(function(Et){return L.map(function(Bt){return Bt.id}).indexOf(Et)>-1});tt<ut.length;tt++){var dt=ut[tt];dt===V.id&&!(e===!1&&n.indexOf(V.id)>-1)?a.push((A={},A[V.id]=V,A)):R[V.id].push(u[dt])}}return{component:L,adjList:R,minIdx:I}},y=0;y<f.length;){var b=f.filter(function(S){return u[S.id]>=y}),x=VA({nodes:b,edges:t.edges}).filter(function(S){return S.length>1});if(x.length===0)break;var w=m(x),E=w.minIdx,M=w.adjList,_=w.component;if(_.length>1){_.forEach(function(S){o[S.id]=new Set});var k=s[E];if(n&&e&&n.indexOf(k.id)===-1)return a;l(k,k,M),y=E+1}else break}return a},qA=function(t,n,e,r){return r===void 0&&(r=!0),n?Cy(t,e,r):Ay(t,e,r)},EB=function(t,n,e){for(var r=1/0,i,o=0;o<n.length;o++){var a=n[o].id;!e[a]&&t[a]<=r&&(r=t[a],i=n[o])}return i},dl=function(t,n,e,r){var i=t.nodes,o=i===void 0?[]:i,a=t.edges,s=a===void 0?[]:a,u={},c={},l={};o.forEach(function(m,y){var b=m.id;c[b]=1/0,b===n&&(c[b]=0)});for(var h=o.length,f=function(m){var y=EB(c,o,u),b=y.id;if(u[b]=!0,c[b]===1/0)return"continue";var x=[];e?x=yB(b,s):x=Xf(b,s),x.forEach(function(w){var E=w.target,M=w.source,_=E===b?M:E,k=r&&w[r]?w[r]:1;c[_]>c[y.id]+k?(c[_]=c[y.id]+k,l[_]=[y.id]):c[_]===c[y.id]+k&&l[_].push(y.id)})},d=0;d<h;d++)f();l[n]=[n];var p={};for(var g in c)c[g]!==1/0&&ZA(n,g,l,p);var v={};for(var g in p)v[g]=p[g][0];return{length:c,path:v,allPath:p}};function ZA(t,n,e,r){if(t===n)return[t];if(r[n])return r[n];for(var i=[],o=0,a=e[n];o<a.length;o++){var s=a[o],u=ZA(t,s,e,r);if(!u)return;for(var c=0,l=u;c<l.length;c++){var h=l[c];ve(h)?i.push(Di(Di([],h,!0),[n],!1)):i.push([h,n])}}return r[n]=i,r[n]}var KA=function(t,n,e,r,i){var o=dl(t,n,r,i),a=o.length,s=o.path,u=o.allPath;return{length:a[e],path:s[e],allPath:u[e]}},QA=function(t,n,e,r){var i;if(n===e)return[[n]];var o=t.edges,a=o===void 0?[]:o,s=[n],u=(i={},i[n]=!0,i),c=[],l=[],h=r?Qr(n,a,"target"):Qr(n,a);for(c.push(h);s.length>0&&c.length>0;){var f=c[c.length-1];if(f.length){var d=f.shift();d&&(s.push(d),u[d]=!0,h=r?Qr(d,a,"target"):Qr(d,a),c.push(h.filter(function(v){return!u[v]})))}else{var p=s.pop();u[p]=!1,c.pop();continue}if(s[s.length-1]===e){var g=s.map(function(m){return m});l.push(g);var p=s.pop();u[p]=!1,c.pop()}}return l},pl=function(t,n){for(var e=Ss(t,n),r=[],i=e.length,o=0;o<i;o+=1){r[o]=[];for(var a=0;a<i;a+=1)o===a?r[o][a]=0:e[o][a]===0||!e[o][a]?r[o][a]=1/0:r[o][a]=e[o][a]}for(var s=0;s<i;s+=1)for(var o=0;o<i;o+=1)for(var a=0;a<i;a+=1)r[o][a]>r[o][s]+r[s][a]&&(r[o][a]=r[o][s]+r[s][a]);return r},JA=function(t,n,e,r){n===void 0&&(n=!1),e===void 0&&(e="weight"),r===void 0&&(r=1e3);var i=t.nodes,o=i===void 0?[]:i,a=t.edges,s=a===void 0?[]:a,u={},c={};o.forEach(function(y,b){var x=UA();y.clusterId=x,u[x]={id:x,nodes:[y]},c[y.id]={node:y,idx:b}});var l=Ss(t,n),h={};l.forEach(function(y,b){var x=o[b].id;h[x]={},y.forEach(function(w,E){if(w){var M=o[E].id;h[x][M]=w}})});for(var f=0,d=function(){var y=!1;if(o.forEach(function(b){var x={};Object.keys(h[b.id]).forEach(function(C){var I=h[b.id][C],N=c[C].node,D=N.clusterId;x[D]||(x[D]=0),x[D]+=I});var w=-1/0,E=[];if(Object.keys(x).forEach(function(C){w<x[C]?(w=x[C],E=[C]):w===x[C]&&E.push(C)}),!(E.length===1&&E[0]===b.clusterId)){var M=E.indexOf(b.clusterId);if(M>=0&&E.splice(M,1),E&&E.length){y=!0;var _=u[b.clusterId],k=_.nodes.indexOf(b);_.nodes.splice(k,1);var S=Math.floor(Math.random()*E.length),A=u[E[S]];A.nodes.push(b),b.clusterId=A.id}}}),!y)return"break";f++};f<r;){var p=d();if(p==="break")break}Object.keys(u).forEach(function(y){var b=u[y];(!b.nodes||!b.nodes.length)&&delete u[y]});var g=[],v={};s.forEach(function(y){var b=y.source,x=y.target,w=y[e]||1,E=c[b].node.clusterId,M=c[x].node.clusterId,_="".concat(E,"---").concat(M);if(v[_])v[_].weight+=w,v[_].count++;else{var k={source:E,target:M,weight:w,count:1};v[_]=k,g.push(k)}});var m=[];return Object.keys(u).forEach(function(y){m.push(u[y])}),{clusters:m,clusterEdges:g}},pi=function(){function t(n){this.arr=n}return t.prototype.getArr=function(){return this.arr||[]},t.prototype.add=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length))return new t(r);if(!(r!=null&&r.length))return new t(this.arr);if(this.arr.length===r.length){var i=[];for(var o in this.arr)i[o]=this.arr[o]+r[o];return new t(i)}},t.prototype.subtract=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length))return new t(r);if(!(r!=null&&r.length))return new t(this.arr);if(this.arr.length===r.length){var i=[];for(var o in this.arr)i[o]=this.arr[o]-r[o];return new t(i)}},t.prototype.avg=function(n){var e=[];if(n!==0)for(var r in this.arr)e[r]=this.arr[r]/n;return new t(e)},t.prototype.negate=function(){var n=[];for(var e in this.arr)n[e]=-this.arr[e];return new t(n)},t.prototype.squareEuclideanDistance=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=Math.pow(this.arr[o]-n.arr[o],2);return i}},t.prototype.euclideanDistance=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=Math.pow(this.arr[o]-n.arr[o],2);return Math.sqrt(i)}else console.error("The two vectors are unequal in length.")},t.prototype.normalize=function(){var n=[],e=Xe(this.arr);e.sort(function(a,s){return a-s});var r=e[e.length-1],i=e[0];for(var o in this.arr)n[o]=(this.arr[o]-i)/(r-i);return new t(n)},t.prototype.norm2=function(){var n;if(!(!((n=this.arr)===null||n===void 0)&&n.length))return 0;var e=0;for(var r in this.arr)e+=Math.pow(this.arr[r],2);return Math.sqrt(e)},t.prototype.dot=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=this.arr[o]*n.arr[o];return i}else console.error("The two vectors are unequal in length.")},t.prototype.equal=function(n){var e,r=n.arr;if(((e=this.arr)===null||e===void 0?void 0:e.length)!==(r==null?void 0:r.length))return!1;for(var i in this.arr)if(this.arr[i]!==r[i])return!1;return!0},t}(),Iy=function(t,n){n===void 0&&(n=void 0);var e=[];return t.forEach(function(r){n===void 0&&e.push(r),r[n]!==void 0&&e.push(r[n])}),e},Ii;(function(t){t.EuclideanDistance="euclideanDistance"})(Ii||(Ii={}));var MB=function(t,n,e){var r=[];n!=null&&n.length?r=n:(t.forEach(function(o){r=r.concat(Object.keys(o))}),r=hl(r));var i={};return r.forEach(function(o){var a=[];t.forEach(function(s){s[o]!==void 0&&s[o]!==""&&a.push(s[o])}),a.length&&!(e!=null&&e.includes(o))&&(i[o]=hl(a))}),i},Ty=function(t,n,e){var r=MB(t,n,e),i=[];if(!Object.keys(r).length)return i;var o=Object.values(r),a=o.every(function(s){return s.every(function(u){return typeof u=="number"})});return t.forEach(function(s,u){var c=[];Object.keys(r).forEach(function(l){var h=s[l],f=r[l],d=f.findIndex(function(v){return h===v}),p=[];if(a)p.push(h);else for(var g=0;g<f.length;g++)g===d?p.push(1):p.push(0);c=c.concat(p)}),i[u]=c}),i},gw=function(t,n,e,r){e===void 0&&(e=Ii.EuclideanDistance);var i=0;switch(e){case Ii.EuclideanDistance:i=new pi(t).euclideanDistance(new pi(n));break}return i},vw=function(t,n,e,r){for(var i=n.length,o=2*r,a=0,s=0;s<i;s++)for(var u=t[s].clusterId,c=0;c<i;c++){var l=t[c].clusterId;if(u===l){var h=n[s][c]||0,f=e[s]||0,d=e[c]||0;a+=h-f*d/o}}return a*=1/o,a},g0=function(t,n){t===void 0&&(t=[]);for(var e=t.length,r=new pi([]),i=0;i<e;i++)r=r.add(new pi(n[i]));var o=r.avg(e);o.normalize();for(var a=0,i=0;i<e;i++){var s=new pi(n[i]),u=s.squareEuclideanDistance(o);a+=u}var c=[];t.forEach(function(){c.push([])});for(var i=0;i<e;i++){var s=new pi(n[i]);t[i].clusterInertial=0;for(var l=0;l<e;l++){if(i===l){c[i][l]=0;continue}var h=new pi(n[l]);c[i][l]=s.squareEuclideanDistance(h),t[i].clusterInertial+=c[i][l]}}for(var f=0,d=2*e*a,i=0;i<e;i++)for(var p=t[i].clusterId,l=0;l<e;l++){var g=t[l].clusterId;if(!(i===l||p!==g)){var v=t[i].clusterInertial*t[l].clusterInertial/Math.pow(d,2)-c[i][l]/d;f+=v}}return Number(f.toFixed(4))},Oy=function(t,n,e,r,i,o,a,s,u){n===void 0&&(n=!1),e===void 0&&(e="weight"),r===void 0&&(r=1e-4),i===void 0&&(i=!1),o===void 0&&(o=void 0),a===void 0&&(a=[]),s===void 0&&(s=["id"]),u===void 0&&(u=1);var c=t.nodes,l=c===void 0?[]:c,h=t.edges,f=h===void 0?[]:h,d=[];if(i){l.forEach(function(L,R){L.properties=L.properties||{},L.originIndex=R});var p=[];l.every(function(L){return L.hasOwnProperty("nodeType")})&&(p=Array.from(new Set(l.map(function(L){return L.nodeType}))),l.forEach(function(L){L.properties.nodeType=p.findIndex(function(R){return R===L.nodeType})}));var g=Iy(l,o);d=Ty(g,a,s)}var v=1,m={},y={};l.forEach(function(L,R){var V=String(v++);L.clusterId=V,m[V]={id:V,nodes:[L]},y[L.id]={node:L,idx:R}});var b=Ss(t,n),x=[],w={},E=0;b.forEach(function(L,R){var V=0,tt=l[R].id;w[tt]={},L.forEach(function(ut,dt){if(ut){V+=ut;var J=l[dt].id;w[tt][J]=ut,E+=ut}}),x.push(V)}),E/=2;for(var M=1/0,_=1/0,k=0,S=[],A={};;){i&&l.every(function(L){return L.hasOwnProperty("properties")})?M=vw(l,b,x,E)+g0(l,d)*u:M=vw(l,b,x,E),k===0&&(_=M,S=l,A=m);var C=M>0&&M>_&&M-_<r;if(M>_&&(S=l.map(function(L){return{node:L,clusterId:L.clusterId}}),A=Xe(m),_=M),C||k>100)break;k++,Object.keys(m).forEach(function(L){var R=0;f.forEach(function(V){var tt=V.source,ut=V.target,dt=y[tt].node.clusterId,J=y[ut].node.clusterId;(dt===L&&J!==L||J===L&&dt!==L)&&(R=R+(V[e]||1))}),m[L].sumTot=R}),l.forEach(function(L,R){var V=m[L.clusterId],tt=0,ut,dt=x[R]/(2*E),J=0,Et=V.nodes;Et.forEach(function(Re){var pn=y[Re.id].idx;J+=b[R][pn]||0});var Bt=J-V.sumTot*dt,Vt=Et.filter(function(Re){return Re.id!==L.id});Vt.forEach(function(Re,pn){d[Re.originIndex]});var se=g0(Vt,d)*u,re=w[L.id];if(Object.keys(re).forEach(function(Re){var pn=y[Re].node,en=pn.clusterId;if(en!==L.clusterId){var fn=m[en],De=fn.nodes;if(!(!De||!De.length)){var Vn=0;De.forEach(function(ct){var Xt=y[ct.id].idx;Vn+=b[R][Xt]||0});var Wt=Vn-fn.sumTot*dt,ee=De.concat([L]);ee.forEach(function(ct,Xt){d[ct.originIndex]});var ot=g0(ee,d)*u,O=Wt-Bt;i&&(O=Wt+ot-(Bt+se)),O>tt&&(tt=O,ut=fn)}}}),tt>0){ut.nodes.push(L);var ue=L.clusterId;L.clusterId=ut.id;var de=V.nodes.indexOf(L);V.nodes.splice(de,1);var Ze=0,Ne=0;f.forEach(function(Re){var pn=Re.source,en=Re.target,fn=y[pn].node.clusterId,De=y[en].node.clusterId;(fn===ut.id&&De!==ut.id||De===ut.id&&fn!==ut.id)&&(Ze=Ze+(Re[e]||1)),(fn===ue&&De!==ue||De===ue&&fn!==ue)&&(Ne=Ne+(Re[e]||1))}),ut.sumTot=Ze,V.sumTot=Ne}})}var I={},N=0;Object.keys(A).forEach(function(L){var R=A[L];if(!R.nodes||!R.nodes.length){delete A[L];return}var V=String(N+1);V!==L&&(R.id=V,R.nodes=R.nodes.map(function(tt){return{id:tt.id,clusterId:V}}),A[V]=R,I[L]=V,delete A[L],N++)}),S.forEach(function(L){var R=L.node,V=L.clusterId;R&&(R.clusterId=V,R.clusterId&&I[R.clusterId]&&(R.clusterId=I[R.clusterId]))});var D=[],P={};f.forEach(function(L){var R=L.source,V=L.target,tt=L[e]||1,ut=y[R].node.clusterId,dt=y[V].node.clusterId;if(!(!ut||!dt)){var J="".concat(ut,"---").concat(dt);if(P[J])P[J].weight+=tt,P[J].count++;else{var Et={source:ut,target:dt,weight:tt,count:1};P[J]=Et,D.push(Et)}}});var j=[];return Object.keys(A).forEach(function(L){j.push(A[L])}),{clusters:j,clusterEdges:D}},$A=function(t,n,e,r,i,o,a,s){return n===void 0&&(n=!1),e===void 0&&(e="weight"),r===void 0&&(r=1e-4),i===void 0&&(i=void 0),o===void 0&&(o=[]),a===void 0&&(a=["id"]),s===void 0&&(s=1),Oy(t,n,e,r,!0,i,o,a,s)},tC=function(t,n){var e;n===void 0&&(n=1);for(var r=Xe(t),i=r.nodes,o=i===void 0?[]:i,a=r.edges,s=a===void 0?[]:a,u=function(){var l=qo({nodes:o,edges:s}),h=Object.keys(l);h.sort(function(p,g){var v,m;return((v=l[p])===null||v===void 0?void 0:v.degree)-((m=l[g])===null||m===void 0?void 0:m.degree)});var f=h[0];if(!o.length||((e=l[f])===null||e===void 0?void 0:e.degree)>=n)return"break";var d=o.findIndex(function(p){return p.id===f});o.splice(d,1),s=s.filter(function(p){return!(p.source===f||p.target===f)})};;){var c=u();if(c==="break")break}return{nodes:o,edges:s}},mw=function(t,n,e){var r=[];switch(t){case Ii.EuclideanDistance:r=n[e];break;default:r=[];break}return r},eC=function(t,n,e,r,i,o){n===void 0&&(n=3),e===void 0&&(e=void 0),r===void 0&&(r=[]),i===void 0&&(i=["id"]),o===void 0&&(o=Ii.EuclideanDistance);var a=t.nodes,s=a===void 0?[]:a,u=t.edges,c=u===void 0?[]:u,l={clusters:[{id:"0",nodes:s}],clusterEdges:[]};if(o===Ii.EuclideanDistance&&!s.every(function(V){return V.hasOwnProperty(e)}))return l;var h=[],f=[];if(o===Ii.EuclideanDistance&&(h=Iy(s,e),f=Ty(h,r,i)),!f.length)return l;for(var d=hl(f.map(function(V){return V.join("")})),p=Math.min(n,s.length,d.length),g=0;g<s.length;g++)s[g].originIndex=g;for(var v=[],m=[],y=[],g=0;g<p;g++)if(g===0){var b=Math.floor(Math.random()*s.length);switch(o){case Ii.EuclideanDistance:v[g]=f[b];break;default:v[g]=[];break}m.push(b),y[g]=[s[b]],s[b].clusterId=String(g)}else{for(var x=-1/0,w=0,E=function(tt){if(!m.includes(tt)){for(var ut=0,dt=0;dt<v.length;dt++){var J=0;switch(o){case Ii.EuclideanDistance:J=gw(f[s[tt].originIndex],v[dt],o);break}ut+=J}var Et=ut/v.length;Et>x&&!v.find(function(Bt){return Aa(Bt,mw(o,f,s[tt].originIndex))})&&(x=Et,w=tt)}},M=0;M<s.length;M++)E(M);v[g]=mw(o,f,w),m.push(w),y[g]=[s[w]],s[w].clusterId=String(g)}for(var _=0;;){for(var g=0;g<s.length;g++){var k=0,S=1/0;if(!(_===0&&m.includes(g))){for(var A=0;A<v.length;A++){var C=0;switch(o){case Ii.EuclideanDistance:C=gw(f[g],v[A],o);break}C<S&&(S=C,k=A)}if(s[g].clusterId!==void 0)for(var I=y[Number(s[g].clusterId)].length-1;I>=0;I--)y[Number(s[g].clusterId)][I].id===s[g].id&&y[Number(s[g].clusterId)].splice(I,1);s[g].clusterId=String(k),y[k].push(s[g])}}for(var N=!1,g=0;g<y.length;g++){for(var D=y[g],P=new pi([]),A=0;A<D.length;A++)P=P.add(new pi(f[D[A].originIndex]));var j=P.avg(D.length);j.equal(new pi(v[g]))||(N=!0,v[g]=j.getArr())}if(_++,s.every(function(V){return V.clusterId!==void 0})&&N||_>=1e3)break}var L=[],R={};return c.forEach(function(V){var tt,ut,dt=V.source,J=V.target,Et=(tt=s.find(function(re){return re.id===dt}))===null||tt===void 0?void 0:tt.clusterId,Bt=(ut=s.find(function(re){return re.id===J}))===null||ut===void 0?void 0:ut.clusterId,Vt="".concat(Et,"---").concat(Bt);if(R[Vt])R[Vt].count++;else{var se={source:Et,target:Bt,count:1};R[Vt]=se,L.push(se)}}),{clusters:y,clusterEdges:L}},Ny=function(t,n){var e=new pi(n),r=e.norm2(),i=new pi(t),o=i.norm2(),a=e.dot(i),s=r*o,u=s?a/s:0;return u},nC=function(t,n,e,r,i){t===void 0&&(t=[]),e===void 0&&(e=void 0),r===void 0&&(r=[]),i===void 0&&(i=[]);var o=Xe(t.filter(function(h){return h.id!==n.id})),a=t.findIndex(function(h){return h.id===n.id}),s=Iy(t,e),u=Ty(s,r,i),c=u[a],l=[];return o.forEach(function(h,f){if(h.id!==n.id){var d=u[f],p=Ny(d,c);l.push(p),h.cosineSimilarity=p}}),o.sort(function(h,f){return f.cosineSimilarity-h.cosineSimilarity}),{allCosineSimilarity:l,similarNodes:o}},SB=function(){function t(n){this.count=n.length,this.parent={};for(var e=0,r=n;e<r.length;e++){var i=r[e];this.parent[i]=i}}return t.prototype.find=function(n){for(;this.parent[n]!==n;)n=this.parent[n];return n},t.prototype.union=function(n,e){var r=this.find(n),i=this.find(e);r!==i&&(r<i?(this.parent[e]!==e&&this.union(this.parent[e],n),this.parent[e]=this.parent[n]):(this.parent[n]!==n&&this.union(this.parent[n],e),this.parent[n]=this.parent[e]))},t.prototype.connected=function(n,e){return this.find(n)===this.find(e)},t}(),_B=function(t,n){return t-n},kB=function(){function t(n){n===void 0&&(n=_B),this.compareFn=n,this.list=[]}return t.prototype.getLeft=function(n){return 2*n+1},t.prototype.getRight=function(n){return 2*n+2},t.prototype.getParent=function(n){return n===0?null:Math.floor((n-1)/2)},t.prototype.isEmpty=function(){return this.list.length<=0},t.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},t.prototype.delMin=function(){var n=this.top(),e=this.list.pop();return this.list.length>0&&(this.list[0]=e,this.moveDown(0)),n},t.prototype.insert=function(n){if(n!==null){this.list.push(n);var e=this.list.length-1;return this.moveUp(e),!0}return!1},t.prototype.moveUp=function(n){for(var e=this.getParent(n);n&&n>0&&this.compareFn(this.list[e],this.list[n])>0;){var r=this.list[e];this.list[e]=this.list[n],this.list[n]=r,n=e,e=this.getParent(n)}},t.prototype.moveDown=function(n){var e,r=n,i=this.getLeft(n),o=this.getRight(n),a=this.list.length;i!==null&&i<a&&this.compareFn(this.list[r],this.list[i])>0?r=i:o!==null&&o<a&&this.compareFn(this.list[r],this.list[o])>0&&(r=o),n!==r&&(e=[this.list[r],this.list[n]],this.list[n]=e[0],this.list[r]=e[1],this.moveDown(r))},t}(),AB=function(t,n){var e=[],r=t.nodes,i=r===void 0?[]:r,o=t.edges,a=o===void 0?[]:o;if(i.length===0)return e;var s=i[0],u=new Set;u.add(s);var c=function(p,g){return n?p.weight-g.weight:0},l=new kB(c);for(Xf(s.id,a).forEach(function(p){l.insert(p)});!l.isEmpty();){var h=l.delMin(),f=h.source,d=h.target;u.has(f)&&u.has(d)||(e.push(h),u.has(f)||(u.add(f),Xf(f,a).forEach(function(p){l.insert(p)})),u.has(d)||(u.add(d),Xf(d,a).forEach(function(p){l.insert(p)})))}return e},yw=function(t,n){var e=[],r=t.nodes,i=r===void 0?[]:r,o=t.edges,a=o===void 0?[]:o;if(i.length===0)return e;var s=a.map(function(f){return f});n&&s.sort(function(f,d){return f.weight-d.weight});for(var u=new SB(i.map(function(f){return f.id}));s.length>0;){var c=s.shift(),l=c.source,h=c.target;u.connected(l,h)||(e.push(c),u.union(l,h))}return e},rC=function(t,n,e){var r={prim:AB,kruskal:yw};return e?r[e](t,n):yw(t,n)},iC=function(t,n,e){typeof n!="number"&&(n=1e-6),typeof e!="number"&&(e=.85);for(var r=1,i=0,o=1e3,a=t.nodes,s=a===void 0?[]:a,u=t.edges,c=u===void 0?[]:u,l=s.length,h,f={},d={},p=0;p<l;++p){var g=s[p],v=g.id;f[v]=1/l,d[v]=1/l}for(var m=qo(t);o>0&&r>n;){i=0;for(var p=0;p<l;++p){var g=s[p],v=g.id;if(h=0,m[g.id].inDegree===0)f[v]=0;else{for(var y=Qr(v,c,"source"),b=0;b<y.length;++b){var x=y[b],w=m[x].outDegree;w>0&&(h+=d[x]/w)}f[v]=e*h,i+=f[v]}}i=(1-i)/l,r=0;for(var p=0;p<l;++p){var g=s[p],v=g.id;h=f[v]+i,r+=Math.abs(h-d[v]),d[v]=h}o-=1}return d},CB=-1,bd=-1,oC="-1",ro="-1",aC=-1,bw=function(){function t(n,e,r,i){n===void 0&&(n=CB),e===void 0&&(e=bd),r===void 0&&(r=bd),i===void 0&&(i=oC),this.id=n,this.from=e,this.to=r,this.label=i}return t}(),IB=function(){function t(n,e){n===void 0&&(n=bd),e===void 0&&(e=ro),this.id=n,this.label=e,this.edges=[],this.edgeMap={}}return t.prototype.addEdge=function(n){this.edges.push(n),this.edgeMap[n.id]=n},t}(),sC=function(){function t(n,e,r){n===void 0&&(n=bd),e===void 0&&(e=!0),r===void 0&&(r=!1),this.id=n,this.edgeIdAutoIncrease=e,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=r}return t.prototype.getNodeNum=function(){return this.nodes.length},t.prototype.addNode=function(n,e){if(!this.nodeMap[n]){var r=new IB(n,e);this.nodes.push(r),this.nodeMap[n]=r,this.nodeLabelMap[e]||(this.nodeLabelMap[e]=[]),this.nodeLabelMap[e].push(n)}},t.prototype.addEdge=function(n,e,r,i){if((this.edgeIdAutoIncrease||n===void 0)&&(n=this.counter++),!(this.nodeMap[e]&&this.nodeMap[r]&&this.nodeMap[r].edgeMap[n])){var o=new bw(n,e,r,i);if(this.edges.push(o),this.edgeMap[n]=o,this.nodeMap[e].addEdge(o),this.edgeLabelMap[i]||(this.edgeLabelMap[i]=[]),this.edgeLabelMap[i].push(o),!this.directed){var a=new bw(n,r,e,i);this.nodeMap[r].addEdge(a),this.edgeLabelMap[i].push(a)}}},t}(),ss=function(){function t(n,e,r,i,o){this.fromNode=n,this.toNode=e,this.nodeEdgeNodeLabel={nodeLabel1:r||ro,edgeLabel:i||oC,nodeLabel2:o||ro}}return t.prototype.equalTo=function(n){return this.fromNode===n.formNode&&this.toNode===n.toNode&&this.nodeEdgeNodeLabel===n.nodeEdgeNodeLabel},t.prototype.notEqualTo=function(n){return!this.equalTo(n)},t}(),xw=function(){function t(){this.rmpath=[],this.dfsEdgeList=[]}return t.prototype.equalTo=function(n){var e=this.dfsEdgeList.length,r=n.length;if(e!==r)return!1;for(var i=0;i<e;i++)if(this.dfsEdgeList[i]!==n[i])return!1;return!0},t.prototype.notEqualTo=function(n){return!this.equalTo(n)},t.prototype.pushBack=function(n,e,r,i,o){return this.dfsEdgeList.push(new ss(n,e,r,i,o)),this.dfsEdgeList},t.prototype.toGraph=function(n,e){n===void 0&&(n=aC),e===void 0&&(e=!1);var r=new sC(n,!0,e);return this.dfsEdgeList.forEach(function(i){var o=i.fromNode,a=i.toNode,s=i.nodeEdgeNodeLabel,u=s.nodeLabel1,c=s.edgeLabel,l=s.nodeLabel2;u!==ro&&r.addNode(o,u),l!==ro&&r.addNode(a,l),u!==ro&&l!==u&&r.addEdge(void 0,o,a,c)}),r},t.prototype.buildRmpath=function(){this.rmpath=[];for(var n=void 0,e=this.dfsEdgeList.length,r=e-1;r>=0;r--){var i=this.dfsEdgeList[r],o=i.fromNode,a=i.toNode;o<a&&(n===void 0||a===n)&&(this.rmpath.push(r),n=o)}return this.rmpath},t.prototype.getNodeNum=function(){var n={};return this.dfsEdgeList.forEach(function(e){n[e.fromNode]||(n[e.fromNode]=!0),n[e.toNode]||(n[e.toNode]=!0)}),Object.keys(n).length},t}(),Xh=function(){function t(n){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!n){for(;n;){var e=n.edge;this.edges.push(e),this.nodesUsed[e.from]=1,this.nodesUsed[e.to]=1,this.edgesUsed[e.id]=1,n=n.preNode}this.edges=this.edges.reverse()}}return t.prototype.hasNode=function(n){return this.nodesUsed[n.id]===1},t.prototype.hasEdge=function(n){return this.edgesUsed[n.id]===1},t}(),TB=function(){function t(n){var e=n.graphs,r=n.minSupport,i=r===void 0?2:r,o=n.minNodeNum,a=o===void 0?1:o,s=n.maxNodeNum,u=s===void 0?4:s,c=n.top,l=c===void 0?10:c,h=n.directed,f=h===void 0?!1:h,d=n.verbose,p=d===void 0?!1:d;this.graphs=e,this.dfsCode=new xw,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=i,this.top=l,this.directed=f,this.counter=0,this.maxNodeNum=u,this.minNodeNum=a,this.verbose=p,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return t.prototype.findForwardRootEdges=function(n,e){var r=this,i=[],o=n.nodeMap;return e.edges.forEach(function(a){(r.directed||e.label<=o[a.to].label)&&i.push(a)}),i},t.prototype.findBackwardEdge=function(n,e,r,i){if(!this.directed&&e===r)return null;for(var o=n.nodeMap,a=o[r.to],s=a.edges,u=s.length,c=0;c<u;c++){var l=s[c];if(!(i.hasEdge(l)||l.to!==e.from)){if(this.directed){if(o[e.from].label<o[r.to].label||o[e.from].label===o[r.to].label&&e.label<=l.label)return l}else if(e.label<l.label||e.label===l.label&&o[e.to].label<=o[r.to].label)return l}}return null},t.prototype.findForwardPureEdges=function(n,e,r,i){for(var o=[],a=e.to,s=n.nodeMap[a].edges,u=s.length,c=0;c<u;c++){var l=s[c],h=n.nodeMap[l.to];r<=h.label&&!i.hasNode(h)&&o.push(l)}return o},t.prototype.findForwardRmpathEdges=function(n,e,r,i){for(var o=[],a=n.nodeMap,s=a[e.to].label,u=a[e.from],c=u.edges,l=c.length,h=0;h<l;h++){var f=c[h],d=a[f.to].label;e.to===f.to||r>d||i.hasNode(a[f.to])||(e.label<f.label||e.label===f.label&&s<=d)&&o.push(f)}return o},t.prototype.getSupport=function(n){var e={};return n.forEach(function(r){e[r.graphId]||(e[r.graphId]=!0)}),Object.keys(e).length},t.prototype.findMinLabel=function(n){var e=void 0;return Object.keys(n).forEach(function(r){var i=n[r],o=i.nodeLabel1,a=i.edgeLabel,s=i.nodeLabel2;if(!e){e={nodeLabel1:o,edgeLabel:a,nodeLabel2:s};return}(o<e.nodeLabel1||o===e.nodeLabel1&&a<e.edgeLabel||o===e.nodeLabel1&&a===e.edgeLabel&&s<e.nodeLabel2)&&(e={nodeLabel1:o,edgeLabel:a,nodeLabel2:s})}),e},t.prototype.isMin=function(){var n=this,e=this.dfsCode;if(this.verbose&&console.log("isMin checking",e),e.dfsEdgeList.length===1)return!0;var r=this.directed,i=e.toGraph(aC,r),o=i.nodeMap,a=new xw,s={};i.nodes.forEach(function(h){var f=n.findForwardRootEdges(i,h);f.forEach(function(d){var p=o[d.to],g="".concat(h.label,"-").concat(d.label,"-").concat(p.label);s[g]||(s[g]={projected:[],nodeLabel1:h.label,edgeLabel:d.label,nodeLabel2:p.label});var v={graphId:i.id,edge:d,preNode:null};s[g].projected.push(v)})});var u=this.findMinLabel(s);if(u){a.dfsEdgeList.push(new ss(0,1,u.nodeLabel1,u.edgeLabel,u.nodeLabel2));var c=function h(f){for(var d=a.buildRmpath(),p=a.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,g=a.dfsEdgeList[d[0]].toNode,v={},m=!1,y=0,b=r?-1:0,x=function(P){if(m)return"break";f.forEach(function(j){var L=new Xh(j),R=n.findBackwardEdge(i,L.edges[d[P]],L.edges[d[0]],L);R&&(v[R.label]||(v[R.label]={projected:[],edgeLabel:R.label}),v[R.label].projected.push({graphId:i.id,edge:v,preNode:j}),y=a.dfsEdgeList[d[P]].fromNode,m=!0)})},w=d.length-1;w>b;w--){var E=x(w);if(E==="break")break}if(m){var M=n.findMinLabel(v);a.dfsEdgeList.push(new ss(g,y,ro,M.edgeLabel,ro));var _=a.dfsEdgeList.length-1;return n.dfsCode.dfsEdgeList[_]!==a.dfsEdgeList[_]?!1:h(v[M.edgeLabel].projected)}var k={};m=!1;var S=0;f.forEach(function(P){var j=new Xh(P),L=n.findForwardPureEdges(i,j.edges[d[0]],p,j);L.length>0&&(m=!0,S=g,L.forEach(function(R){var V="".concat(R.label,"-").concat(o[R.to].label);k[V]||(k[V]={projected:[],edgeLabel:R.label,nodeLabel2:o[R.to].label}),k[V].projected.push({graphId:i.id,edge:R,preNode:P})}))});for(var A=d.length,C=function(j){if(m)return"break";var L=d[j];f.forEach(function(R){var V=new Xh(R),tt=n.findForwardRmpathEdges(i,V.edges[L],p,V);tt.length>0&&(m=!0,S=a.dfsEdgeList[L].fromNode,tt.forEach(function(ut){var dt="".concat(ut.label,"-").concat(o[ut.to].label);k[dt]||(k[dt]={projected:[],edgeLabel:ut.label,nodeLabel2:o[ut.to].label}),k[dt].projected.push({graphId:i.id,edge:ut,preNode:R})}))})},w=0;w<A;w++){var I=C(w);if(I==="break")break}if(!m)return!0;var N=n.findMinLabel(k);a.dfsEdgeList.push(new ss(S,g+1,ro,N.edgeLabel,N.nodeLabel2));var D=a.dfsEdgeList.length-1;return e.dfsEdgeList[D]!==a.dfsEdgeList[D]?!1:h(k["".concat(N.edgeLabel,"-").concat(N.nodeLabel2)].projected)},l="".concat(u.nodeLabel1,"-").concat(u.edgeLabel,"-").concat(u.nodeLabel2);return c(s[l].projected)}},t.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var n=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(Xe(n))}},t.prototype.subGraphMining=function(n){var e=this,r=this.getSupport(n);if(!(r<this.minSupport)&&this.isMin()){this.report();var i=this.dfsCode.getNodeNum(),o=this.dfsCode.buildRmpath(),a=this.dfsCode.dfsEdgeList[o[0]].toNode,s=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,u={},c={};n.forEach(function(l){for(var h=e.graphs[l.graphId],f=h.nodeMap,d=new Xh(l),p=o.length-1;p>=0;p--){var g=e.findBackwardEdge(h,d.edges[o[p]],d.edges[o[0]],d);if(g){var v="".concat(e.dfsCode.dfsEdgeList[o[p]].fromNode,"-").concat(g.label);c[v]||(c[v]={projected:[],toNodeId:e.dfsCode.dfsEdgeList[o[p]].fromNode,edgeLabel:g.label}),c[v].projected.push({graphId:l.graphId,edge:g,preNode:l})}}if(!(i>=e.maxNodeNum)){var m=e.findForwardPureEdges(h,d.edges[o[0]],s,d);m.forEach(function(b){var x="".concat(a,"-").concat(b.label,"-").concat(f[b.to].label);u[x]||(u[x]={projected:[],fromNodeId:a,edgeLabel:b.label,nodeLabel2:f[b.to].label}),u[x].projected.push({graphId:l.graphId,edge:b,preNode:l})});for(var y=function(x){var w=e.findForwardRmpathEdges(h,d.edges[o[x]],s,d);w.forEach(function(E){var M="".concat(e.dfsCode.dfsEdgeList[o[x]].fromNode,"-").concat(E.label,"-").concat(f[E.to].label);u[M]||(u[M]={projected:[],fromNodeId:e.dfsCode.dfsEdgeList[o[x]].fromNode,edgeLabel:E.label,nodeLabel2:f[E.to].label}),u[M].projected.push({graphId:l.graphId,edge:E,preNode:l})})},p=0;p<o.length;p++)y(p)}}),Object.keys(c).forEach(function(l){var h=c[l],f=h.toNodeId,d=h.edgeLabel;e.dfsCode.dfsEdgeList.push(new ss(a,f,"-1",d,"-1")),e.subGraphMining(c[l].projected),e.dfsCode.dfsEdgeList.pop()}),Object.keys(u).forEach(function(l){var h=u[l],f=h.fromNodeId,d=h.edgeLabel,p=h.nodeLabel2;e.dfsCode.dfsEdgeList.push(new ss(f,a+1,ro,d,p)),e.subGraphMining(u[l].projected),e.dfsCode.dfsEdgeList.pop()})}},t.prototype.generate1EdgeFrequentSubGraphs=function(){var n=this.graphs,e=this.directed,r=this.minSupport,i=this.frequentSize1Subgraphs,o={},a={},s={};return Object.keys(n).forEach(function(u){var c=n[u],l=c.nodeMap;c.nodes.forEach(function(h,f){var d=h.label,p="".concat(u,"-").concat(d);if(!s[p]){var g=o[d]||0;g++,o[d]=g}s[p]={graphKey:u,label:d},h.edges.forEach(function(v){var m=d,y=l[v.to].label;if(!e&&m>y){var b=y;y=m,m=b}var x=v.label,w="".concat(m,"-").concat(x,"-").concat(y);if(!a[w]){var E=a[w]||0;E++,a[w]=E}})})}),Object.keys(o).forEach(function(u){var c=o[u];if(!(c<r)){var l={nodes:[],edges:[]};l.nodes.push({id:"0",label:u}),i.push(l)}}),i},t.prototype.run=function(){var n=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var e=this.graphs;this.directed;var r={};Object.keys(e).forEach(function(i){var o=e[i],a=o.nodeMap;o.nodes.forEach(function(s){var u=n.findForwardRootEdges(o,s);u.forEach(function(c){var l=a[c.to],h="".concat(s.label,"-").concat(c.label,"-").concat(l.label);r[h]||(r[h]={projected:[],nodeLabel1:s.label,edgeLabel:c.label,nodeLabel2:l.label});var f={graphId:i,edge:c,preNode:null};r[h].projected.push(f)})})}),Object.keys(r).forEach(function(i){var o=r[i],a=o.projected,s=o.nodeLabel1,u=o.edgeLabel,c=o.nodeLabel2;n.dfsCode.dfsEdgeList.push(new ss(0,1,s,u,c)),n.subGraphMining(a),n.dfsCode.dfsEdgeList.pop()})}},t}(),OB=function(t,n,e,r){var i={};return Object.keys(t).forEach(function(o,a){var s=t[o],u=new sC(a,!0,n),c={};s.nodes.forEach(function(l,h){u.addNode(h,l[e]),c[l.id]=h}),s.edges.forEach(function(l,h){var f=c[l.source],d=c[l.target];u.addEdge(-1,f,d,l[r])}),u&&u.getNodeNum()&&(i[u.id]=u)}),i},NB=function(t,n,e){var r=[];return t.forEach(function(i){var o={nodes:[],edges:[]};i.nodes.forEach(function(a){var s;o.nodes.push((s={id:"".concat(a.id)},s[n]=a.label,s))}),i.edges.forEach(function(a){var s;o.edges.push((s={source:"".concat(a.from),target:"".concat(a.to)},s[e]=a.label,s))}),r.push(o)}),r},ww="cluster",DB=function(t){var n=t.graphs,e=t.directed,r=e===void 0?!1:e,i=t.nodeLabelProp,o=i===void 0?ww:i,a=t.edgeLabelProp,s=a===void 0?ww:a,u=OB(n,r,o,s),c=t.minSupport,l=t.maxNodeNum,h=t.minNodeNum,f=t.verbose,d=t.top,p={graphs:u,minSupport:c,maxNodeNum:l,minNodeNum:h,top:d,verbose:f,directed:r},g=new TB(p);g.run();var v=NB(g.frequentSubgraphs,o,s);return v},Ew=function(t,n,e,r){e===void 0&&(e="cluster"),r===void 0&&(r=2);var i=[],o=t.nodes;return n.forEach(function(a,s){i.push(uC(o,a,s,e,r))}),i},uC=function(t,n,e,r,i){var o=[e],a=[],s={};return n.forEach(function(u,c){if(u<=i&&e!==c){o.push(c),a.push(t[c]);var l=t[c][r];s[l]?(s[l].count++,s[l].dists.push(u)):s[l]={count:1,dists:[u]}}}),Object.keys(s).forEach(function(u){s[u].dists=s[u].dists.sort(function(c,l){return c-l})}),{nodeIdx:e,nodeId:t[e].id,nodeIdxs:o,neighbors:a,neighborNum:o.length-1,nodeLabelCountMap:s}},PB=function(t,n,e,r,i){var o=Math.ceil(e/n),a={},s=0;return r.forEach(function(u,c){for(var l=0,h=0,f=u.nodeIdxs,d=u.neighborNum-1;l<o;){for(var p=f[1+Math.floor(Math.random()*d)],g=0;(a["".concat(c,"-").concat(p)]||a["".concat(p,"-").concat(c)])&&(p=Math.floor(Math.random()*n),g++,!(g>2*n)););if(g<2*n&&(a["".concat(c,"-").concat(p)]={start:c,end:p,distance:i[c][p]},l++,s++,s>=e))return a;if(h++,h>2*n)break}if(l<o){var v=o-l;o=(o+v)/(n-c-1)}}),a},Hf=function(t,n,e,r){var i=e.nodes;return r||(r={}),Object.keys(t).forEach(function(o){var a,s;if(!(r&&r[o])){r[o]={nodes:[],edges:[]};var u=t[o],c=(a=n[u.start])===null||a===void 0?void 0:a.nodeIdxs,l=(s=n[u.end])===null||s===void 0?void 0:s.nodeIdxs;if(!(!c||!l)){var h=new Set(l),f=c.filter(function(m){return h.has(m)});if(!(!f||!f.length)){for(var d={},p=f.length,g=0;g<p;g++){var v=i[f[g]];r[o].nodes.push(v),d[v.id]=!0}e.edges.forEach(function(m){d[m.source]&&d[m.target]&&r[o].edges.push(m)})}}}}),r},qf=function(t,n,e,r){var i,o,a={};t.nodes.forEach(function(u){a[u.id]=u});var s=0;return!(!((i=n==null?void 0:n.edges)===null||i===void 0)&&i.length)||((o=n==null?void 0:n.nodes)===null||o===void 0?void 0:o.length)<2?0:(t.edges.forEach(function(u){var c=a[u.source][e],l=a[u.target][e],h=n==null?void 0:n.nodes[0][e],f=n==null?void 0:n.nodes[1][e],d=n==null?void 0:n.edges[0][r];u[r]===d&&(c===h&&l===f||c===f&&l===h)&&s++}),s)},LB=function(t,n,e){for(var r=1/0,i=0,o=function(s){var u=t[s],c=Object.keys(u).sort(function(v,m){return u[v]-u[m]}),l=10,h=[];c.forEach(function(v,m){h[m%l]||(h[m%l]={graphs:[],totalCount:0,aveCount:0}),h[m%l].graphs.push(v),h[m%l].totalCount+=u[v]});var f=0,d=[];h.forEach(function(v){var m=v.totalCount/v.graphs.length;v.aveCount=m,d.push(m);var y=0,b=v.length;v.graphs.forEach(function(x,w){var E=u[x];v.graphs.forEach(function(M,_){w!==_&&(y+=Math.abs(E-u[M]))})}),y/=b*(b-1)/2,f+=y}),f/=h.length;var p=0;d.forEach(function(v,m){d.forEach(function(y,b){m!==b&&(p+=Math.abs(v-y))}),p/=d.length*(d.length-1)/2});var g=p-f;r<g&&(r=g,i=s)},a=0;a<n;a++)o(a);return{structure:e[i],structureCountMap:t[i]}},Mw=function(t,n){var e={},r={};return t.forEach(function(i,o){e[i.id]={idx:o,node:i,degree:0,inDegree:0,outDegree:0};var a=i[n];r[a]||(r[a]=[]),r[a].push(i)}),{nodeMap:e,nodeLabelMap:r}},Sw=function(t,n,e){var r={},i={};return t.forEach(function(o,a){r["".concat(UA)]={idx:a,edge:o};var s=o[n];i[s]||(i[s]=[]),i[s].push(o);var u=e[o.source];u&&(u.degree++,u.outDegree++);var c=e[o.target];c&&(c.degree++,c.inDegree++)}),{edgeMap:r,edgeLabelMap:i}},_w=function(t,n,e){var r=n.length,i={};return n.forEach(function(o,a){for(var s=e?0:a+1,u=t[a].id,c=s;c<r;c++)if(a!==c){var l=t[c].id,h=o[c];i["".concat(u,"-").concat(l)]=h,e||(i["".concat(l,"-").concat(u)]=h)}}),i},jB=function(t,n,e,r,i,o,a,s,u,c,l){var h,f="".concat(n.id,"-").concat(e.id);if(c&&c[f])return c[f];var d=l?l[f]:void 0;if(!d){var p=(h={},h[f]={start:r[n.id].idx,end:r[e.id].idx,distance:i},h);l=Hf(p,o,t,l),d=l[f]}return qf(d,a,s,u)},kw=function(t,n,e,r){var i,o,a,s=(i=t[n])===null||i===void 0?void 0:i.degree,u=(o=t[n])===null||o===void 0?void 0:o.inDegree,c=(a=t[n])===null||a===void 0?void 0:a.outDegree;return t[n]===void 0&&(s=1/0,u=1/0,c=1/0,r[n].forEach(function(l){var h=e[l.id].degree;s>h&&(s=h);var f=e[l.id].inDegree;u>f&&(u=f);var d=e[l.id].outDegree;c>d&&(c=d)}),t[n]={degree:s,inDegree:u,outDegree:c}),{minPatternNodeLabelDegree:s,minPatternNodeLabelInDegree:u,minPatternNodeLabelOutDegree:c}},cC=function(t,n,e,r,i,o,a){var s;if(e===void 0&&(e=!1),o===void 0&&(o="cluster"),a===void 0&&(a="cluster"),!(!t||!t.nodes)){var u=t.nodes.length;if(u){var c=pl(t,e),l=pl(n,e),h=_w(t.nodes,c,e),f=_w(n.nodes,l,e),d=Mw(t.nodes,o),p=d.nodeMap,g=d.nodeLabelMap,v=Mw(n.nodes,o),m=v.nodeMap,y=v.nodeLabelMap;Sw(t.edges,a,p);var b=Sw(n.edges,a,m).edgeLabelMap,x=[];l==null||l.forEach(function(Wt){x=x.concat(Wt)}),i||(i=Math.max.apply(Math,Di(Di([],x,!1),[2],!1))),r||(r=i);var w=Ew(t,c,o,r),E=Ew(n,l,o,r),M=Math.min(100,u*(u-1)/2),_=PB(r,u,M,w,c),k=Hf(_,w,t),S=10,A=1,C=1,I=4,N={graphs:k,nodeLabelProp:o,edgeLabelProp:a,minSupport:A,minNodeNum:C,maxNodeNum:I,directed:e},D=DB(N).slice(0,S),P=D.length,j=[];D.forEach(function(Wt,ee){j[ee]={},Object.keys(k).forEach(function(ot){var O=k[ot],ct=qf(O,Wt,o,a);j[ee][ot]=ct})});var L=LB(j,P,D),R=L.structure,V=L.structureCountMap,tt=n.nodes[0],ut=[],dt=(s=n.nodes[0])===null||s===void 0?void 0:s[o],J=-1/0;n.nodes.forEach(function(Wt){var ee=Wt[o],ot=g[ee];(ot==null?void 0:ot.length)>J&&(J=ot.length,ut=ot,dt=ee,tt=Wt)});var Et={},Bt={},Vt={},se={},re={},ue={};Object.keys(y).forEach(function(Wt,ee){re[Wt]=[],e&&(ue[Wt]=[]);var ot=y[Wt],O={};ot.forEach(function(_t){var Zt=f["".concat(tt.id,"-").concat(_t.id)];if(Zt&&re[Wt].push(Zt),O["".concat(tt.id,"-").concat(_t.id)]={start:0,end:m[_t.id].idx,distance:Zt},e){var me=f["".concat(_t.id,"-").concat(tt.id)];me&&ue[Wt].push(me)}}),re[Wt]=re[Wt].sort(function(_t,Zt){return _t-Zt}),e&&(ue[Wt]=ue[Wt].sort(function(_t,Zt){return _t-Zt})),Bt=Hf(O,E,n,Bt);var ct=[];if(Object.keys(O).forEach(function(_t){if(Vt[_t]){ct.push(Vt[_t]);return}var Zt=Bt[_t];Vt[_t]=qf(Zt,R,o,a),ct.push(Vt[_t])}),ct=ct.sort(function(_t,Zt){return Zt-_t}),se["".concat(tt.id,"-").concat(Wt)]=ct,Wt!==dt)for(var Xt=(ut==null?void 0:ut.length)||0,jt=function(_t){var Zt=ut[_t],me=w[p[Zt.id].idx],Ce=me.nodeLabelCountMap[Wt],_e=y[Wt].length;if(!Ce||Ce.count<_e)return ut.splice(_t,1),"continue";for(var Qn=!1,dn=0;dn<_e;dn++)if(Ce.dists[dn]>re[Wt][dn]){Qn=!0;break}if(Qn)return ut.splice(_t,1),"continue";var He={};me.neighbors.forEach(function(hn){var bn=h["".concat(Zt.id,"-").concat(hn.id)];He["".concat(Zt.id,"-").concat(hn.id)]={start:p[Zt.id].idx,end:p[hn.id].idx,distance:bn}}),k=Hf(He,w,t,k);var un=[];Object.keys(He).forEach(function(hn){if(V[hn]){un.push(V[hn]);return}var bn=k[hn];V[hn]=qf(bn,R,o,a),un.push(V[hn])}),un=un.sort(function(hn,bn){return bn-hn});for(var yn=!1,dn=0;dn<_e;dn++)if(un[dn]<ct[dn]){yn=!0;break}if(yn)return ut.splice(_t,1),"continue"},te=Xt-1;te>=0;te--)jt(te)});var de=[];ut==null||ut.forEach(function(Wt){for(var ee=p[Wt.id].idx,ot=uC(t.nodes,c[ee],ee,o,i),O=ot.neighbors,ct=O.length,Xt=!1,jt=ct-1;jt>=0;jt--){if(O.length+1<n.nodes.length){Xt=!0;return}var te=O[jt],_t=te[o];if(!y[_t]||!y[_t].length){O.splice(jt,1);continue}if(!re[_t]||!re[_t].length){O.splice(jt,1);continue}var Zt="".concat(Wt.id,"-").concat(te.id),me=h[Zt],Ce=re[_t].length-1,_e=re[_t][Ce];if(me>_e){O.splice(jt,1);continue}if(e){var Qn="".concat(te.id,"-").concat(Wt.id),dn=h[Qn];Ce=ue[_t].length-1;var He=ue[_t][Ce];if(dn>He){O.splice(jt,1);continue}}var un=V[Zt]?V[Zt]:jB(t,Wt,te,p,me,w,R,o,a,V,k),yn="".concat(tt.id,"-").concat(_t),hn=se[yn][se[yn].length-1];if(un<hn){O.splice(jt,1);continue}var bn=kw(Et,_t,m,y),xr=bn.minPatternNodeLabelDegree;if(bn.minPatternNodeLabelInDegree,bn.minPatternNodeLabelOutDegree,p[te.id].degree<xr){O.splice(jt,1);continue}}Xt||de.push({nodes:[Wt].concat(O)})});var Ze=dl(n,tt.id,!1).length,Ne={};e?(Object.keys(Ze).forEach(function(Wt){var ee=m[Wt].node[o];Ne[ee]?Ne[ee].push(Ze[Wt]):Ne[ee]=[Ze[Wt]]}),Object.keys(Ne).forEach(function(Wt){Ne[Wt].sort(function(ee,ot){return ee-ot})})):Ne=re;for(var Re=de.length,pn=function(Wt){var ee=de[Wt],ot=ee.nodes[0],O={},ct={};ee.nodes.forEach(function(ke,gn){ct[ke.id]={idx:gn,node:ke,degree:0,inDegree:0,outDegree:0};var Ue=ke[o];O[Ue]?O[Ue]++:O[Ue]=1});var Xt=[],jt={};t.edges.forEach(function(ke){ct[ke.source]&&ct[ke.target]&&(Xt.push(ke),jt[ke[a]]?jt[ke[a]]++:jt[ke[a]]=1,ct[ke.source].degree++,ct[ke.target].degree++,ct[ke.source].outDegree++,ct[ke.target].inDegree++)});for(var te=Object.keys(b).length,_t=!1,Zt=0;Zt<te;Zt++){var me=Object.keys(b)[Zt];if(!jt[me]||jt[me]<b[me].length){_t=!0;break}}if(_t)return de.splice(Wt,1),"continue";var Ce=Xt.length;if(Ce<n.edges.length)return de.splice(Wt,1),"break";for(var _e=!1,Qn=function(gn){var Ue=Xt[gn],wn=Ue[a],Ke=b[wn];if(!Ke||!Ke.length)return jt[wn]--,Ke&&jt[wn]<Ke.length?(_e=!0,"break"):(Xt.splice(gn,1),ct[Ue.source].degree--,ct[Ue.target].degree--,ct[Ue.source].outDegree--,ct[Ue.target].inDegree--,"continue");var ko=ct[Ue.source].node[o],Ao=ct[Ue.target].node[o],wi=!1;if(Ke.forEach(function(Co){var Io=m[Co.source].node,Ui=m[Co.target].node;Io[o]===ko&&Ui[o]===Ao&&(wi=!0),!e&&Io[o]===Ao&&Ui[o]===ko&&(wi=!0)}),!wi)return jt[wn]--,Ke&&jt[wn]<Ke.length?(_e=!0,"break"):(Xt.splice(gn,1),ct[Ue.source].degree--,ct[Ue.target].degree--,ct[Ue.source].outDegree--,ct[Ue.target].inDegree--,"continue")},Zt=Ce-1;Zt>=0;Zt--){var dn=Qn(Zt);if(dn==="break")break}if(_e)return de.splice(Wt,1),"continue";ee.edges=Xt;var He=dl(ee,ee.nodes[0].id,!1).length;if(Object.keys(He).reverse().forEach(function(ke){if(!(ke===ee.nodes[0].id||_e)){if(He[ke]===1/0){var gn=ct[ke].node[o];if(O[gn]--,O[gn]<y[gn].length){_e=!0;return}var Ue=ee.nodes.indexOf(ct[ke].node);ee.nodes.splice(Ue,1),ct[ke]=void 0;return}var wn=p[ke].node[o];if(!Ne[wn]||!Ne[wn].length||He[ke]>Ne[wn][Ne[wn].length-1]){var gn=ct[ke].node[o];if(O[gn]--,O[gn]<y[gn].length){_e=!0;return}var Ue=ee.nodes.indexOf(ct[ke].node);ee.nodes.splice(Ue,1),ct[ke]=void 0}}}),_e)return de.splice(Wt,1),"continue";for(var un=!0,yn=0;un&&!_e;){un=!1;var hn=e?ct[ot.id].degree<m[tt.id].degree||ct[ot.id].inDegree<m[tt.id].inDegree||ct[ot.id].outDegree<m[tt.id].outDegree:ct[ot.id].degree<m[tt.id].degree;if(hn){_e=!0;break}if(O[ot[o]]<y[ot[o]].length){_e=!0;break}for(var bn=ee.nodes.length,xr=bn-1;xr>=0;xr--){var Wn=ee.nodes[xr],_o=ct[Wn.id].degree,ea=ct[Wn.id].inDegree,na=ct[Wn.id].outDegree,Ga=Wn[o],xi=kw(Et,Ga,m,y),jn=xi.minPatternNodeLabelDegree,Ua=xi.minPatternNodeLabelInDegree,Ya=xi.minPatternNodeLabelOutDegree,Va=e?_o<jn||ea<Ua||na<Ya:_o<jn;if(Va){if(O[Wn[o]]--,O[Wn[o]]<y[Wn[o]].length){_e=!0;break}ee.nodes.splice(xr,1),ct[Wn.id]=void 0,un=!0}}if(_e||!un&&yn!==0)break;Ce=Xt.length;for(var Ur=Ce-1;Ur>=0;Ur--){var On=Xt[Ur];if(!ct[On.source]||!ct[On.target]){Xt.splice(Ur,1);var Yr=On[a];if(jt[Yr]--,ct[On.source]&&(ct[On.source].degree--,ct[On.source].outDegree--),ct[On.target]&&(ct[On.target].degree--,ct[On.target].inDegree--),b[Yr]&&jt[Yr]<b[Yr].length){_e=!0;break}un=!0}}yn++}if(_e||_e||ee.nodes.length<n.nodes.length||Xt.length<n.edges.length)return de.splice(Wt,1),"continue"},en=Re-1;en>=0;en--){var fn=pn(en);if(fn==="break")break}for(var De=de.length,Vn=function(ee){var ot=de[ee],O={};ot.edges.forEach(function(jt){var te="".concat(jt.source,"-").concat(jt.target,"-").concat(jt.label);O[te]?O[te]++:O[te]=1});for(var ct=function(jt){var te=de[jt],_t={};te.edges.forEach(function(me){var Ce="".concat(me.source,"-").concat(me.target,"-").concat(me.label);_t[Ce]?_t[Ce]++:_t[Ce]=1});var Zt=!0;Object.keys(_t).length!==Object.keys(O).length?Zt=!1:Object.keys(O).forEach(function(me){_t[me]!==O[me]&&(Zt=!1)}),Zt&&de.splice(jt,1)},Xt=De-1;Xt>ee;Xt--)ct(Xt);De=de.length},en=0;en<=De-1;en++)Vn(en);return de}}},wu=function(){function t(n){n===void 0&&(n=10),this.linkedList=new GA,this.maxStep=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},t.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},t.prototype.push=function(n){this.linkedList.prepend(n),this.length>this.maxStep&&this.linkedList.deleteTail()},t.prototype.pop=function(){var n=this.linkedList.deleteHead();return n?n.value:null},t.prototype.toArray=function(){return this.linkedList.toArray().map(function(n){return n.value})},t.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},t}(),lC=ky;const RB={getAdjMatrix:Ss,breadthFirstSearch:YA,connectedComponent:Sy,getDegree:qo,getInDegree:WA,getOutDegree:XA,detectCycle:ky,detectDirectedCycle:lC,detectAllCycles:qA,detectAllDirectedCycle:Cy,detectAllUndirectedCycle:Ay,depthFirstSearch:_y,dijkstra:dl,findAllPath:QA,findShortestPath:KA,floydWarshall:pl,labelPropagation:JA,louvain:Oy,iLouvain:$A,kCore:tC,kMeans:eC,cosineSimilarity:Ny,nodesCosineSimilarity:nC,minimumSpanningTree:rC,pageRank:iC,getNeighbors:Qr,Stack:wu,GADDI:cC},FB=Object.freeze(Object.defineProperty({__proto__:null,GADDI:cC,Stack:wu,breadthFirstSearch:YA,connectedComponent:Sy,cosineSimilarity:Ny,default:RB,depthFirstSearch:_y,detectAllCycles:qA,detectAllDirectedCycle:Cy,detectAllUndirectedCycle:Ay,detectCycle:ky,detectDirectedCycle:lC,dijkstra:dl,findAllPath:QA,findShortestPath:KA,floydWarshall:pl,getAdjMatrix:Ss,getDegree:qo,getInDegree:WA,getNeighbors:Qr,getOutDegree:XA,iLouvain:$A,kCore:tC,kMeans:eC,labelPropagation:JA,louvain:Oy,minimumSpanningTree:rC,nodesCosineSimilarity:nC,pageRank:iC},Symbol.toStringTag,{value:"Module"}));var xd=yi,BB=function(t){return function(n,e){return n[t]-e[t]}},Aw=function(t,n,e){return t>=n&&t<=e},dp=function(t,n,e,r){var i=1e-4,o={x:e.x-t.x,y:e.y-t.y},a={x:n.x-t.x,y:n.y-t.y},s={x:r.x-e.x,y:r.y-e.y},u=a.x*s.y-a.y*s.x,c=u*u,l=1/u,h=a.x*a.x+a.y*a.y,f=s.x*s.x+s.y*s.y;if(c>i*h*f){var d=(o.x*s.y-o.y*s.x)*l,p=(o.x*a.y-o.y*a.x)*l;return!Aw(d,0,1)||!Aw(p,0,1)?null:{x:t.x+d*a.x,y:t.y+d*a.y}}return null},hC=function(t,n){var e=t.x,r=t.y,i=t.width,o=t.height,a=e+i/2,s=r+o/2,u=[],c={x:a,y:s};u.push({x:e,y:r}),u.push({x:e+i,y:r}),u.push({x:e+i,y:r+o}),u.push({x:e,y:r+o}),u.push({x:e,y:r});for(var l=null,h=1;h<u.length&&(l=dp(u[h-1],u[h],c,n),!l);h++);return l},fC=function(t,n){var e=t.x,r=t.y,i=t.r,o=n.x,a=n.y,s=o-e,u=a-r;if(s*s+u*u<i*i)return null;var c=Math.atan(u/s);return{x:e+Math.abs(i*Math.cos(c))*Math.sign(s),y:r+Math.abs(i*Math.sin(c))*Math.sign(u)}},dC=function(t,n){var e=t.rx,r=t.ry,i=t.x,o=t.y,a=n.x-i,s=n.y-o,u=Math.atan2(s/r,a/e);return u<0&&(u+=2*Math.PI),{x:i+e*Math.cos(u),y:o+r*Math.sin(u)}},_u=function(t,n,e){e===void 0&&(e=1);var r=[t.x,t.y,e];return(!n||isNaN(n[0]))&&(n=[1,0,0,0,1,0,0,0,1]),hp(r,r,n),{x:r[0],y:r[1]}},pC=function(t,n,e){e===void 0&&(e=1),(!n||isNaN(n[0]))&&(n=[1,0,0,0,1,0,0,0,1]);var r=cy([1,0,0,0,1,0,0,0,1],n);r||(r=[1,0,0,0,1,0,0,0,1]);var i=[t.x,t.y,e];return hp(i,i,r),{x:i[0],y:i[1]}},Mv=function(t,n,e){var r=t.x-n.x,i=t.y-n.y,o=t.x-e.x,a=t.y-e.y,s=(t.x*t.x-n.x*n.x-n.y*n.y+t.y*t.y)/2,u=(t.x*t.x-e.x*e.x-e.y*e.y+t.y*t.y)/2,c=i*o-r*a;return{x:-(a*s-i*u)/c,y:-(r*u-o*s)/c}},wd=function(t,n){var e=t.x-n.x,r=t.y-n.y;return Math.sqrt(e*e+r*r)},zB=function(t,n){var e=[];return t.forEach(function(r){var i=[];r.forEach(function(o){i.push(o*n)}),e.push(i)}),e},GB=function(t){for(var n=[],e=t.length,r=0;r<e;r+=1){n[r]=[];for(var i=0;i<e;i+=1)r===i?n[r][i]=0:t[r][i]===0||!t[r][i]?n[r][i]=1/0:n[r][i]=t[r][i]}for(var o=0;o<e;o+=1)for(var r=0;r<e;r+=1)for(var i=0;i<e;i+=1)n[r][i]>n[r][o]+n[o][i]&&(n[r][i]=n[r][o]+n[o][i]);return n},UB=function(t,n){var e=t.nodes,r=t.edges,i=[],o={};if(!e)throw new Error("invalid nodes data!");return e&&e.forEach(function(a,s){o[a.id]=s;var u=[];i.push(u)}),r&&r.forEach(function(a){var s=a.source,u=a.target,c=o[s],l=o[u];i[c][l]=1,n||(i[l][c]=1)}),i},gC=function(t,n){t.translate(n.x,n.y)},Sv=function(t,n,e,r){r===void 0&&(r={duration:500});var i=t.getMatrix();i||(i=[1,0,0,0,1,0,0,0,1]);var o=t.getCanvasBBox(),a=n.x-o.minX,s=n.y-o.minY;if(e){var u=a*i[0],c=s*i[4],l=0,h=0,f=0,d=0;t.animate(function(g){return f=u*g,d=c*g,i=xd(i,[["t",f-l,d-h]]),l=f,h=d,{matrix:i}},r)}else{var p=xd(i,[["t",a,s]]);t.setMatrix(p)}},YB=function(t,n){var e=t.getMatrix();e||(e=[1,0,0,0,1,0,0,0,1]);var r=n;ve(n)||(r=[n,n]),ve(n)&&n.length===1&&(r=[n[0],n[0]]),e=xd(e,[["s",r[0],r[1]]]),t.setMatrix(e)},VB=function(t,n){var e=t.getMatrix();e||(e=[1,0,0,0,1,0,0,0,1]),e=xd(e,[["r",n]]),t.setMatrix(e)},WB=function(t,n,e){for(var r=[],i=0;i<t;i++)r[i]=0;return e.forEach(function(o){o.source&&(r[n[o.source]]+=1),o.target&&(r[n[o.target]]+=1)}),r};function XB(t,n,e){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])&&Math.min(t[0],n[0])<=e[0]&&e[0]<=Math.max(t[0],n[0])&&Math.min(t[1],n[1])<=e[1]&&e[1]<=Math.max(t[1],n[1])}var gl=function(t,n,e){var r=!1,i=t.length,o=1e-6;function a(l){return Math.abs(l)<o?0:l<0?-1:1}if(i<=2)return!1;for(var s=0;s<i;s++){var u=t[s],c=t[(s+1)%i];if(XB(u,c,[n,e]))return!0;a(u[1]-e)>0!=a(c[1]-e)>0&&a(n-(e-u[1])*(u[0]-c[0])/(u[1]-c[1])-u[0])<0&&(r=!r)}return r},vC=function(t,n){return!(n.minX>t.maxX||n.maxX<t.minX||n.minY>t.maxY||n.maxY<t.minY)},HB=function(t,n){var e=!1;return mt(t,function(r){if(dp(r.from,r.to,n.from,n.to))return e=!0,!1}),e},mC=function(t,n){var e=function(l){var h=l.map(function(d){return d[0]}),f=l.map(function(d){return d[1]});return{minX:Math.min.apply(null,h),maxX:Math.max.apply(null,h),minY:Math.min.apply(null,f),maxY:Math.max.apply(null,f)}},r=function(l){for(var h=[],f=l.length,d=0;d<f-1;d++){var p=l[d],g=l[d+1];h.push({from:{x:p[0],y:p[1]},to:{x:g[0],y:g[1]}})}if(h.length>1){var v=l[0],m=l[f-1];h.push({from:{x:m[0],y:m[1]},to:{x:v[0],y:v[1]}})}return h};if(t.length<2||n.length<2)return!1;var i=e(t),o=e(n);if(!vC(i,o))return!1;var a=!1;if(mt(n,function(l){if(gl(t,l[0],l[1]))return a=!0,!1}),a||(mt(t,function(l){if(gl(n,l[0],l[1]))return a=!0,!1}),a))return!0;var s=r(t),u=r(n),c=!1;return mt(u,function(l){if(HB(s,l))return c=!0,!1}),c},_s=function(){function t(n,e,r,i){this.x1=n,this.y1=e,this.x2=r,this.y2=i}return t.prototype.getBBox=function(){var n=Math.min(this.x1,this.x2),e=Math.min(this.y1,this.y2),r=Math.max(this.x1,this.x2),i=Math.max(this.y1,this.y2),o={x:n,y:e,minX:n,minY:e,maxX:r,maxY:i,width:r-n,height:i-e};return o},t}(),Dy=function(t,n){var e={top:[t.minX,t.minY,t.maxX,t.minY],left:[t.minX,t.minY,t.minX,t.maxY],bottom:[t.minX,t.maxY,t.maxX,t.maxY],right:[t.maxX,t.minY,t.maxX,t.maxY]};return e[n]},qB=function(t,n){var e=(n.x2-n.x1)*(t.y1-n.y1)-(n.y2-n.y1)*(t.x1-n.x1),r=(t.x2-t.x1)*(t.y1-n.y1)-(t.y2-t.y1)*(t.x1-n.x1),i=(n.y2-n.y1)*(t.x2-t.x1)-(n.x2-n.x1)*(t.y2-t.y1);if(i){var o=e/i,a=r/i;if(o>=0&&o<=1&&a>=0&&a<=1)return o}return Number.POSITIVE_INFINITY},yC=function(t,n){for(var e=["top","left","bottom","right"],r=t.getBBox(),i=0,o=[],a=0;a<4;a++){var s=Dy(r,e[a]),u=s[0],c=s[1],l=s[2],h=s[3];o[a]=dp({x:n.x1,y:n.y1},{x:n.x2,y:n.y2},{x:u,y:c},{x:l,y:h}),o[a]&&(i+=1)}return[o,i]},Py=function(t,n){for(var e=["top","left","bottom","right"],r=t.getBBox(),i=Number.POSITIVE_INFINITY,o=0,a=0;a<4;a++){var s=Dy(r,e[a]),u=s[0],c=s[1],l=s[2],h=s[3],f=qB(n,new _s(u,c,l,h));f=Math.abs(f-.5),f>=0&&f<=1&&(o+=1,i=f<i?f:i)}return o===0?-1:i},bC=function(t){var n=0,e=0;if(t.length>0){for(var r=0,i=t;r<i.length;r++){var o=i[r];n+=o.x,e+=o.y}n/=t.length,e/=t.length}return{x:n,y:e}},Ed=function(t,n){return Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)},xC=function(t,n){var e=n.x1,r=n.y1,i=n.x2-e,o=n.y2-r,a=t.x-e,s=t.y-r,u=a*i+s*o,c;u<=0?c=0:(a=i-a,s=o-s,u=a*i+s*o,u<=0?c=0:c=u*u/(i*i+o*o));var l=a*a+s*s-c;return l<0&&(l=0),l},_v=function(t,n,e){return e===void 0&&(e=.001),Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)<Math.pow(e,2)},wC=function(t,n){var e=t.x<n.x,r=t.x>n.x+n.width,i=t.y>n.y+n.height,o=t.y<n.y,a=e||r||i||o;if(!a)return 0;if(i&&!e&&!r)return Math.pow(n.y+n.height-t.y,2);if(o&&!e&&!r)return Math.pow(t.y-n.y,2);if(e&&!i&&!o)return Math.pow(n.x-t.x,2);if(r&&!i&&!o)return Math.pow(n.x+n.width-t.x,2);var s=Math.min(Math.abs(n.x-t.x),Math.abs(n.x+n.width-t.x)),u=Math.min(Math.abs(n.y-t.y),Math.abs(n.y+n.height-t.y));return s*s+u*u},ZB=function(t,n){var e=t[0],r=t[1],i=t[2],o=t[3],a=n.x,s=n.y,u=[i-e,o-r];if(My(u,[0,0]))return NaN;var c=[-u[1],u[0]];_a(c,c);var l=[a-e,s-r];return Math.abs(Ey(l,c))},Ly=function(t,n,e){return t+(n-t)*e},kv=function(t,n,e){for(var r=Math.min(t.length,n.length),i=new Array(r),o=0;o<r;o++)i[o]=Ly(t[o],n[o],e);return i};const KB=Object.freeze(Object.defineProperty({__proto__:null,Line:_s,applyMatrix:_u,compare:BB,distance:wd,floydWarshall:GB,fractionToLine:Py,getAdjMatrix:UB,getBBoxBoundLine:Dy,getCircleCenterByPoints:Mv,getCircleIntersectByPoint:fC,getDegree:WB,getEllipseIntersectByPoint:dC,getLineIntersect:dp,getPointsCenter:bC,getRectIntersectByPoint:hC,intersectBBox:vC,invertMatrix:pC,isPointInPolygon:gl,isPointsOverlap:_v,isPolygonsIntersect:mC,itemIntersectByLine:yC,lerp:Ly,lerpArray:kv,move:Sv,pointLineDistance:ZB,pointLineSquareDist:xC,pointRectSquareDist:wC,rotate:VB,scale:YB,scaleMatrix:zB,squareDist:Ed,translate:gC},Symbol.toStringTag,{value:"Module"}));var ua="rgb(95, 149, 255)",QB="rgb(255, 255, 255)",Cw="rgb(0, 0, 0)",v0="rgb(247, 250, 255)",EC="rgb(239, 244, 255)",Hh="rgb(253, 253, 253)",Iw="rgb(250, 250, 250)",qh="rgb(224, 224, 224)",Tw="rgb(234, 234, 234)",JB="rgb(245, 245, 245)",$B="rgb(191, 213, 255)",Ow="#4572d9",tz="rgb(223, 234, 255)",an={mainStroke:ua,mainFill:EC,activeStroke:ua,activeFill:v0,inactiveStroke:$B,inactiveFill:v0,selectedStroke:ua,selectedFill:QB,highlightStroke:Ow,highlightFill:tz,disableStroke:qh,disableFill:Iw,edgeMainStroke:qh,edgeActiveStroke:ua,edgeInactiveStroke:Tw,edgeSelectedStroke:ua,edgeHighlightStroke:ua,edgeDisableStroke:JB,comboMainStroke:qh,comboMainFill:Hh,comboActiveStroke:ua,comboActiveFill:v0,comboInactiveStroke:qh,comboInactiveFill:Hh,comboSelectedStroke:ua,comboSelectedFill:Hh,comboHighlightStroke:Ow,comboHighlightFill:Hh,comboDisableStroke:Tw,comboDisableFill:Iw};const he={version:"0.8.20",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:an.mainStroke,fill:EC},size:20,color:an.mainStroke,linkPoints:{size:8,lineWidth:1,fill:an.activeFill,stroke:an.activeStroke}},nodeStateStyles:{active:{fill:an.activeFill,stroke:an.activeStroke,lineWidth:2,shadowColor:an.mainStroke,shadowBlur:10},selected:{fill:an.selectedFill,stroke:an.selectedStroke,lineWidth:4,shadowColor:an.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:an.highlightFill,stroke:an.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:an.inactiveFill,stroke:an.inactiveStroke,lineWidth:1},disable:{fill:an.disableFill,stroke:an.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:Cw,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:an.edgeMainStroke,lineAppendWidth:2},color:an.edgeMainStroke},edgeStateStyles:{active:{stroke:an.edgeActiveStroke,lineWidth:1},selected:{stroke:an.edgeSelectedStroke,lineWidth:2,shadowColor:an.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:an.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:an.edgeInactiveStroke,lineWidth:1},disable:{stroke:an.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:Cw,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:an.comboMainFill,lineWidth:1,stroke:an.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:an.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:an.comboActiveStroke,lineWidth:1,fill:an.comboActiveFill},selected:{stroke:an.comboSelectedStroke,lineWidth:2,fill:an.comboSelectedFill,shadowColor:an.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:an.comboHighlightStroke,lineWidth:2,fill:an.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:an.comboInactiveStroke,fill:an.comboInactiveFill,lineWidth:1},disable:{stroke:an.comboDisableStroke,fill:an.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},windowFontFamily:typeof window<"u"&&window.getComputedStyle&&document.body&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},ez={" ":.3329986572265625,a:.5589996337890625,A:.6569992065429687,b:.58599853515625,B:.6769989013671875,c:.5469985961914062,C:.7279998779296875,d:.58599853515625,D:.705999755859375,e:.554998779296875,E:.63699951171875,f:.37299957275390627,F:.5769989013671875,g:.5909988403320312,G:.7479995727539063,h:.555999755859375,H:.7199996948242188,i:.255999755859375,I:.23699951171875,j:.26699981689453123,J:.5169998168945312,k:.5289993286132812,K:.6899993896484375,l:.23499908447265624,L:.5879989624023437,m:.854998779296875,M:.8819992065429687,n:.5589996337890625,N:.7189987182617188,o:.58599853515625,O:.7669998168945312,p:.58599853515625,P:.6419998168945312,q:.58599853515625,Q:.7669998168945312,r:.3649993896484375,R:.6759994506835938,s:.504998779296875,S:.6319992065429687,t:.354998779296875,T:.6189987182617187,u:.5599990844726562,U:.7139999389648437,v:.48199920654296874,V:.6389999389648438,w:.754998779296875,W:.929998779296875,x:.5089996337890625,X:.63699951171875,y:.4959991455078125,Y:.66199951171875,z:.48699951171875,Z:.6239990234375,0:.6,1:.40099945068359377,2:.6,3:.6,4:.6,5:.6,6:.6,7:.5469985961914062,8:.6,9:.6,"[":.3329986572265625,"]":.3329986572265625,",":.26399993896484375,".":.26399993896484375,";":.26399993896484375,":":.26399993896484375,"{":.3329986572265625,"}":.3329986572265625,"\\":.5,"|":.19499969482421875,"=":.604998779296875,"+":.604998779296875,"-":.604998779296875,_:.5,"`":.3329986572265625," ~":.8329986572265625,"!":.3329986572265625,"@":.8579986572265625,"#":.6,$:.6,"%":.9699996948242188,"^":.517999267578125,"&":.7259994506835937,"*":.505999755859375,"(":.3329986572265625,")":.3329986572265625,"<":.604998779296875,">":.604998779296875,"/":.5,"?":.53699951171875};var Ji=Math.PI,Av=Math.sin,Cv=Math.cos,fr=Av(Ji/8),dr=Cv(Ji/8),Md=function(t,n){var e=t.getBBox(),r={x:e.minX,y:e.minY},i={x:e.maxX,y:e.maxY};if(n){var o=n.getMatrix();o||(o=[1,0,0,0,1,0,0,0,1]),r=_u(r,o),i=_u(i,o)}var a=r.x,s=r.y,u=i.x,c=i.y;return{x:a,y:s,minX:a,minY:s,maxX:u,maxY:c,width:u-a,height:c-s}},MC=function(t){var n=t.sourceNode||t.targetNode,e=n.get("group"),r=e.getMatrix();r||(r=[1,0,0,0,1,0,0,0,1]);var i=n.getKeyShape(),o=i.getBBox(),a=t.loopCfg||{},s=a.dist||Math.max(o.width,o.height)*2,u=a.position||he.defaultLoopPosition,c=[(o.minX+o.maxX)/2+r[6],(o.minY+o.maxY)/2+r[7]],l=[t.startPoint.x,t.startPoint.y],h=[t.endPoint.x,t.endPoint.y],f=o.height/2,d=o.width/2,p=f,g=f,v=p*fr,m=p*dr,y=g*fr,b=g*dr,x=i.get("type"),w=Math.min(f/2,d/2),E=Math.min(f,d),M=a!=null&&a.pointPadding?Math.min(E,a==null?void 0:a.pointPadding):w;if(l[0]===h[0]&&l[1]===h[1]){switch(u){case"top":x==="circle"?(l=[c[0]-v,c[1]-m],h=[c[0]+y,c[1]-b]):(l=[c[0]-M,c[1]-f],h=[c[0]+M,c[1]-f]);break;case"top-right":p=f,g=d,x==="circle"?(v=p*fr,m=p*dr,y=g*fr,b=g*dr,l=[c[0]+v,c[1]-m],h=[c[0]+b,c[1]-y]):(l=[c[0]+d-M,c[1]-f],h=[c[0]+d,c[1]-f+M]);break;case"right":p=d,g=d,x==="circle"?(v=p*fr,m=p*dr,y=g*fr,b=g*dr,l=[c[0]+m,c[1]-v],h=[c[0]+b,c[1]+y]):(l=[c[0]+d,c[1]-M],h=[c[0]+d,c[1]+M]);break;case"bottom-right":p=d,g=f,x==="circle"?(v=p*fr,m=p*dr,y=g*fr,b=g*dr,l=[c[0]+m,c[1]+v],h=[c[0]+y,c[1]+b]):(l=[c[0]+d,c[1]+f-M],h=[c[0]+d-M,c[1]+f]);break;case"bottom":p=f,g=f,x==="circle"?(v=p*fr,m=p*dr,y=g*fr,b=g*dr,l=[c[0]+v,c[1]+m],h=[c[0]-y,c[1]+b]):(l=[c[0]-M,c[1]+f],h=[c[0]+M,c[1]+f]);break;case"bottom-left":p=f,g=d,x==="circle"?(v=p*fr,m=p*dr,y=g*fr,b=g*dr,l=[c[0]-v,c[1]+m],h=[c[0]-b,c[1]+y]):(l=[c[0]-d,c[1]+f-M],h=[c[0]-d+M,c[1]+f]);break;case"left":p=d,g=d,x==="circle"?(v=p*fr,m=p*dr,y=g*fr,b=g*dr,l=[c[0]-m,c[1]+v],h=[c[0]-b,c[1]-y]):(l=[c[0]-d,c[1]-M],h=[c[0]-d,c[1]+M]);break;case"top-left":p=d,g=f,x==="circle"?(v=p*fr,m=p*dr,y=g*fr,b=g*dr,l=[c[0]-m,c[1]-v],h=[c[0]-y,c[1]-b]):(l=[c[0]-d+M,c[1]-f],h=[c[0]-d,c[1]-f+M]);break;default:p=d,g=d,v=p*fr,m=p*dr,y=g*fr,b=g*dr,l=[c[0]-v,c[1]-m],h=[c[0]+y,c[1]-b]}if(a.clockwise===!1){var _=[l[0],l[1]];l=[h[0],h[1]],h=[_[0],_[1]]}}var k=[l[0]-c[0],l[1]-c[1]],S=(p+s)/p,A=(g+s)/g;a.clockwise===!1&&(S=(g+s)/g,A=(p+s)/p);var C=kr([0,0],k,S),I=[c[0]+C[0],c[1]+C[1]],N=[h[0]-c[0],h[1]-c[1]],D=kr([0,0],N,A),P=[c[0]+D[0],c[1]+D[1]];return t.startPoint={x:l[0],y:l[1]},t.endPoint={x:h[0],y:h[1]},t.controlPoints=[{x:I[0],y:I[1]},{x:P[0],y:P[1]}],t},SC=function(t,n,e,r,i){var o=1e-4,a=[],s=t==null?void 0:t.getPoint(n);if(!s)return{x:0,y:0,angle:0};if(n<o)a=t.getStartTangent().reverse();else if(n>1-o)a=t.getEndTangent();else{var u=t==null?void 0:t.getPoint(n+o);a.push([s.x,s.y]),a.push([u.x,u.y])}var c=Math.atan2(a[1][1]-a[0][1],a[1][0]-a[0][0]);if(c<0&&(c+=Ji*2),e&&(s.x+=Cv(c)*e,s.y+=Av(c)*e),r){var l=c-Ji/2;c>1/2*Ji&&c<3*1/2*Ji&&(l-=Ji),s.x+=Cv(l)*r,s.y+=Av(l)*r}var h={x:s.x,y:s.y,angle:c};return i?(c>.5*Ji&&c<1.5*Ji&&(c-=Ji),B({rotate:c},h)):h},nz=function t(n,e,r,i){if(i(n,e,r)===!1)return!1;if(n&&n.children){for(var o=n.children.length-1;o>=0;o--)if(!t(n.children[o],n,o,i))return!1}return!0},rz=function t(n,e,r,i){if(n&&n.children){for(var o=n.children.length-1;o>=0;o--)if(!t(n.children[o],n,o,i))return}return i(n,e,r)!==!1},_r=function(t,n){typeof n=="function"&&nz(t,null,-1,n)},$i=function(t,n){typeof n=="function"&&rz(t,null,-1,n)},_C=function(t,n){return n*(ez[t]||1)},kC=function(t,n){var e=0,r=new RegExp("[一-龥]+");return t.split("").forEach(function(i){r.test(i)?e+=n:e+=_C(i,n)}),[e,n]},AC=function(t,n){return typeof n!="number"||n<=0||n>=t.length?t:t.substring(0,n)+"..."},Iv=function(t,n){var e=[],r={},i={};t.forEach(function(s){i[s.id]=s}),t.forEach(function(s,u){var c=Xe(s);c.itemType="combo",c.children=void 0,c.parentId===c.id?(console.warn("The parentId for combo ".concat(c.id," can not be the same as the combo's id")),delete c.parentId):c.parentId&&!i[c.parentId]&&(console.warn("The parent combo for combo ".concat(c.id," does not exist!")),delete c.parentId);var l=r[c.id];if(l){if(c.children=l.children,r[c.id]=c,l=c,!l.parentId){e.push(l);return}var h=r[l.parentId];if(h)h.children?h.children.push(c):h.children=[c];else{var f={id:l.parentId,children:[l]};r[l.parentId]=f,r[c.id]=c}return}if(Dt(s.parentId)){var d=r[s.parentId];if(d)d.children?d.children.push(c):d.children=[c],r[c.id]=c;else{var p={id:s.parentId,children:[c]};r[p.id]=p,r[c.id]=c}}else e.push(c),r[c.id]=c});var o={};(n||[]).forEach(function(s){o[s.id]=s;var u=r[s.comboId];if(u){var c={id:s.id,comboId:s.comboId};u.children?u.children.push(c):u.children=[c],c.itemType="node",r[s.id]=c}});var a=0;return e.forEach(function(s){s.depth=a+10,_r(s,function(u){var c,l=r[u.id].itemType;l==="node"?c=r[u.comboId]:c=r[u.parentId],c&&l==="node"?u.depth=a+1:u.depth=a+10,a<u.depth&&(a=u.depth);var h=o[u.id];return h&&(h.depth=u.depth),!0})}),e},Tv=function(t,n,e){var r,i=t,o,a={root:{children:t}},s=!1,u="root";(t||[]).forEach(function(d){if(!s){if(d.id===n){o=d,d.itemType==="combo"?o.parentId=e:o.comboId=e,s=!0;return}_r(d,function(p){var g;return a[p.id]={children:(p==null?void 0:p.children)||[]},i=(g=a[p.parentId||p.comboId||"root"])===null||g===void 0?void 0:g.children,p&&(p.removed||n===p.id)&&i?(u=p.parentId||p.comboId||"root",o=p,p.itemType==="combo"?o.parentId=e:o.comboId=e,s=!0,!1):!0})}}),i=(r=a[u])===null||r===void 0?void 0:r.children;var c=i?i.indexOf(o):-1;if(c>-1&&i.splice(c,1),s||(o={id:n,itemType:"node",comboId:e},a[n]={children:void 0}),n){var l=!1;if(e){var h=0;(t||[]).forEach(function(d){l||_r(d,function(p){return e===p.id?(l=!0,p.children?p.children.push(o):p.children=[o],h=p.depth,o.itemType==="node"?o.depth=h+2:o.depth=h+1,!1):!0})})}else(!e||!l)&&o.itemType!=="node"&&t.push(o);var f=o.depth;_r(o,function(d){return d.itemType==="node"?f+=2:f+=1,d.depth=f,!0})}return t},Zf=function(t,n,e){var r={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0,x:void 0,y:void 0,width:void 0,height:void 0,centerX:void 0,centerY:void 0};if(!t||t.length===0){var i=e==null?void 0:e.getModel(),o=i||{},a=o.x,s=o.y,u=o.fixSize,c=o.collapsed,l=o.fixCollapseSize,h=c?l:u,f=ve(h)?h:[h,h],d=f[0],p=f[1],g=[d/2,p/2];return{minX:a-g[0],minY:s-g[1],maxX:a+g[0],maxY:s+g[1],x:a,y:s,width:d,height:p}}return t.forEach(function(v){var m=n.findById(v.id);if(!(!m||!m.isVisible())){m.set("bboxCanvasCache",void 0);var y=m.getCanvasBBox();y.x&&r.minX>y.minX&&(r.minX=y.minX),y.y&&r.minY>y.minY&&(r.minY=y.minY),y.x&&r.maxX<y.maxX&&(r.maxX=y.maxX),y.y&&r.maxY<y.maxY&&(r.maxY=y.maxY)}}),r.x=(r.minX+r.maxX)/2,r.y=(r.minY+r.maxY)/2,r.width=r.maxX-r.minX,r.height=r.maxY-r.minY,r.centerX=(r.minX+r.maxX)/2,r.centerY=(r.minY+r.maxY)/2,(e==null?void 0:e.getKeyShape().get("type"))==="circle"&&(r.width=Math.hypot(r.height,r.width),r.height=r.width),Object.keys(r).forEach(function(v){(r[v]===1/0||r[v]===-1/0)&&(r[v]=void 0)}),r},iz=function(t){var n=pe(t.x)||pe(t.y)||t.type||t.anchorPoints||t.size;return t.style&&(n=n||pe(t.style.r)||pe(t.style.width)||pe(t.style.height)||pe(t.style.rx)||pe(t.style.ry)),n},Kf=function(t){var n={};return Object.keys(t).forEach(function(e){var r=t[e];if(!(e==="img"&&!Dt(r)))if(yr(r)&&!ve(r)){var i={};Object.keys(r).forEach(function(o){var a=r[o];o==="img"&&!Dt(a)||(i[o]=Xe(a))}),n[e]=i}else n[e]=Xe(r)}),n},vl=function(t){var n=t.animateCfg,e=t.callback,r;if(!n)r={duration:500,callback:e};else if(r=Xe(n),n.callback){var i=n.callback;r.callback=function(){e(),i()}}else r.callback=e;return r};const oz=Object.freeze(Object.defineProperty({__proto__:null,cloneBesidesImg:Kf,getAnimateCfgWithCallback:vl,getBBox:Md,getComboBBox:Zf,getLabelPosition:SC,getLetterWidth:_C,getLoopCfgs:MC,getTextSize:kC,plainCombosToTrees:Iv,reconstructTree:Tv,shouldRefreshEdge:iz,traverseTree:_r,traverseTreeUp:$i,truncateLabelByLength:AC},Symbol.toStringTag,{value:"Module"}));var Nw=function(t){if(!t)return console.error("G6 Error Tips: the data must be defined"),!1;var n=t.nodes,e=t.edges,r=t.combos,i=r===void 0?[]:r;if(!n&&!e){var o=!0;return _r(t,function(h){return Dt(h.id)?!0:(o=!1,!1)}),o}var a=(n||[]).find(function(h){return!Dt(h.id)});if(a)return console.warn("G6 Warning Tips: missing 'id' property, or %c".concat(a.id,"%c is not a string."),"font-size: 20px; color: red;",""),!1;var s=(n||[]).map(function(h){return h.id}),u=i==null?void 0:i.map(function(h){return h.id}),c=Di(Di([],s,!0),u,!0),l=(e||[]).find(function(h){return!c.includes(h.source)||!c.includes(h.target)});return l?(console.warn("G6 Warning Tips: The source %c".concat(l.source,"%c or the target %c").concat(l.target,"%c of the edge do not exist in the nodes or combos."),"font-size: 20px; color: red;","","font-size: 20px; color: red;",""),!1):!0},az=function(t,n){if(t==="node"||t==="combo"){if(n.id&&!Dt(n.id))return console.warn("G6 Warning Tips: missing 'id' property, or the 'id' %c".concat(n.id,"%c is not a string."),"font-size: 20px; color: red;",""),!1}else if(t==="edge"&&(!n.source||!n.target))return console.warn("G6 Warning Tips: missing 'source' or 'target' for the edge."),!1;return!0},sz=function(){function t(n){this.graph=n,this.destroyed=!1,this.modes=n.get("modes")||{default:[]},this.formatModes(),this.mode=n.get("defaultMode")||"default",this.currentBehaves=[],this.setMode(this.mode)}return t.prototype.formatModes=function(){var n=this.modes;mt(n,function(e){mt(e,function(r,i){Dt(r)&&(e[i]={type:r})})})},t.prototype.setBehaviors=function(n){var e=this.graph,r=this.modes[n],i=[],o;mt(r||[],function(a){var s=Ik.getBehavior(a.type||a);s&&(o=new s(a),o&&(o.bind(e),i.push(o)))}),this.currentBehaves=i},t.mergeBehaviors=function(n,e){return mt(e,function(r){n.indexOf(r)<0&&(Dt(r)&&(r={type:r}),n.push(r))}),n},t.filterBehaviors=function(n,e){var r=[];return n.forEach(function(i){var o="";Dt(i)?o=i:o=i.type,e.indexOf(o)<0&&r.push(i)}),r},t.prototype.setMode=function(n){var e=this,r=e.modes,i=e.graph,o=n,a=r[o];a&&(i.emit("beforemodechange",{mode:n}),mt(this.currentBehaves,function(s){s.delegate&&s.delegate.remove(),s.unbind(i)}),this.setBehaviors(o),i.emit("aftermodechange",{mode:n}),this.mode=n)},t.prototype.getMode=function(){return this.mode},t.prototype.manipulateBehaviors=function(n,e,r){var i=this,o;if(ve(n)?o=n:o=[n],ve(e))return mt(e,function(s){i.modes[s]?r?i.modes[s]=t.mergeBehaviors(i.modes[s]||[],o):i.modes[s]=t.filterBehaviors(i.modes[s]||[],o):r&&(i.modes[s]=o)}),this;var a=e;return e||(a=this.mode),this.modes[a]||r&&(this.modes[a]=o),r?this.modes[a]=t.mergeBehaviors(this.modes[a]||[],o):this.modes[a]=t.filterBehaviors(this.modes[a]||[],o),this.formatModes(),this.setMode(this.mode),this},t.prototype.updateBehavior=function(n,e,r){Dt(n)&&(n={type:n});var i=[];if(!r||r===this.mode||r==="default"){if(i=this.currentBehaves,!i||!i.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;for(var o=i.length,a=0;a<o;a++){var s=i[a];if(s.type===n.type)return s.updateCfg(e),this;a===o-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}else{if(i=this.modes[r],!i||!i.length)return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."),this;for(var u=i.length,a=0;a<u;a++){var s=i[a];if(s.type===n.type||s===n.type)return s===n.type&&(s={type:s}),Object.assign(s,e),i[a]=s,this;a===u-1&&console.warn("Update behavior failed! There is no such behavior in the mode")}}return this},t.prototype.destroy=function(){this.graph=null,this.modes=null,this.currentBehaves=null,this.destroyed=!0},t}(),Kc=`	
\v\f\r   ᠎             　\u2028\u2029`,uz=new RegExp("([a-z])["+Kc+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Kc+"]*,?["+Kc+"]*)+)","ig"),cz=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Kc+"]*,?["+Kc+"]*","ig"),Eu=function(t){if(!t)return null;if(ve(t))return t;var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},e=[];return String(t).replace(uz,function(r,i,o){var a=[],s=i.toLowerCase();if(o.replace(cz,function(u,c){c&&a.push(+c)}),s==="m"&&a.length>2&&(e.push([i].concat(a.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&a.length===1&&e.push([i,a[0]]),s==="r")e.push([i].concat(a));else for(;a.length>=n[s]&&(e.push([i].concat(a.splice(0,n[s]))),!!n[s]););return t}),e},Ov=function(t,n){for(var e=[],r=0,i=t.length;i-2*!n>r;r+=2){var o=[{x:+t[r-2],y:+t[r-1]},{x:+t[r],y:+t[r+1]},{x:+t[r+2],y:+t[r+3]},{x:+t[r+4],y:+t[r+5]}];n?r?i-4===r?o[3]={x:+t[0],y:+t[1]}:i-2===r&&(o[2]={x:+t[0],y:+t[1]},o[3]={x:+t[2],y:+t[3]}):o[0]={x:+t[i-2],y:+t[i-1]}:i-4===r?o[3]=o[2]:r||(o[0]={x:+t[r],y:+t[r+1]}),e.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return e},Zh=function(t,n,e,r,i){var o=[];if(i===null&&r===null&&(r=e),t=+t,n=+n,e=+e,r=+r,i!==null){var a=Math.PI/180,s=t+e*Math.cos(-r*a),u=t+e*Math.cos(-i*a),c=n+e*Math.sin(-r*a),l=n+e*Math.sin(-i*a);o=[["M",s,c],["A",e,e,0,+(i-r>180),0,u,l]]}else o=[["M",t,n],["m",0,-r],["a",e,r,0,1,1,0,2*r],["a",e,r,0,1,1,0,-2*r],["z"]];return o},Nv=function(t){if(t=Eu(t),!t||!t.length)return[["M",0,0]];var n=[],e=0,r=0,i=0,o=0,a=0,s,u;t[0][0]==="M"&&(e=+t[0][1],r=+t[0][2],i=e,o=r,a++,n[0]=["M",e,r]);for(var c=t.length===3&&t[0][0]==="M"&&t[1][0].toUpperCase()==="R"&&t[2][0].toUpperCase()==="Z",l=void 0,h=void 0,f=a,d=t.length;f<d;f++){if(n.push(l=[]),h=t[f],s=h[0],s!==s.toUpperCase())switch(l[0]=s.toUpperCase(),l[0]){case"A":l[1]=h[1],l[2]=h[2],l[3]=h[3],l[4]=h[4],l[5]=h[5],l[6]=+h[6]+e,l[7]=+h[7]+r;break;case"V":l[1]=+h[1]+r;break;case"H":l[1]=+h[1]+e;break;case"R":u=[e,r].concat(h.slice(1));for(var p=2,g=u.length;p<g;p++)u[p]=+u[p]+e,u[++p]=+u[p]+r;n.pop(),n=n.concat(Ov(u,c));break;case"O":n.pop(),u=Zh(e,r,h[1],h[2]),u.push(u[0]),n=n.concat(u);break;case"U":n.pop(),n=n.concat(Zh(e,r,h[1],h[2],h[3])),l=["U"].concat(n[n.length-1].slice(-2));break;case"M":i=+h[1]+e,o=+h[2]+r;break;default:for(var p=1,g=h.length;p<g;p++)l[p]=+h[p]+(p%2?e:r)}else if(s==="R")u=[e,r].concat(h.slice(1)),n.pop(),n=n.concat(Ov(u,c)),l=["R"].concat(h.slice(-2));else if(s==="O")n.pop(),u=Zh(e,r,h[1],h[2]),u.push(u[0]),n=n.concat(u);else if(s==="U")n.pop(),n=n.concat(Zh(e,r,h[1],h[2],h[3])),l=["U"].concat(n[n.length-1].slice(-2));else for(var v=0,m=h.length;v<m;v++)l[v]=h[v];if(s=s.toUpperCase(),s!=="O")switch(l[0]){case"Z":e=+i,r=+o;break;case"H":e=l[1];break;case"V":r=l[1];break;case"M":i=l[l.length-2],o=l[l.length-1];break;default:e=l[l.length-2],r=l[l.length-1]}}return n},Kh=function(t,n,e,r){return[t,n,e,r,e,r]},Dw=function(t,n,e,r,i,o){var a=.3333333333333333,s=2/3;return[a*t+s*e,a*n+s*r,a*i+s*e,a*o+s*r,i,o]},CC=function(t,n,e,r,i,o,a,s,u,c){e===r&&(e+=1);var l=Math.PI*120/180,h=Math.PI/180*(+i||0),f=[],d,p,g,v,m,y=function(Vt,se,re){var ue=Vt*Math.cos(re)-se*Math.sin(re),de=Vt*Math.sin(re)+se*Math.cos(re);return{x:ue,y:de}};if(c)p=c[0],g=c[1],v=c[2],m=c[3];else{d=y(t,n,-h),t=d.x,n=d.y,d=y(s,u,-h),s=d.x,u=d.y,t===s&&n===u&&(s+=1,u+=1);var b=(t-s)/2,x=(n-u)/2,w=b*b/(e*e)+x*x/(r*r);w>1&&(w=Math.sqrt(w),e=w*e,r=w*r);var E=e*e,M=r*r,_=(o===a?-1:1)*Math.sqrt(Math.abs((E*M-E*x*x-M*b*b)/(E*x*x+M*b*b)));v=_*e*x/r+(t+s)/2,m=_*-r*b/e+(n+u)/2,p=Math.asin(((n-m)/r).toFixed(9)),g=Math.asin(((u-m)/r).toFixed(9)),p=t<v?Math.PI-p:p,g=s<v?Math.PI-g:g,p<0&&(p=Math.PI*2+p),g<0&&(g=Math.PI*2+g),a&&p>g&&(p=p-Math.PI*2),!a&&g>p&&(g=g-Math.PI*2)}var k=g-p;if(Math.abs(k)>l){var S=g,A=s,C=u;g=p+l*(a&&g>p?1:-1),s=v+e*Math.cos(g),u=m+r*Math.sin(g),f=CC(s,u,e,r,i,0,a,A,C,[g,S,v,m])}k=g-p;var I=Math.cos(p),N=Math.sin(p),D=Math.cos(g),P=Math.sin(g),j=Math.tan(k/4),L=4/3*e*j,R=4/3*r*j,V=[t,n],tt=[t+L*N,n-R*I],ut=[s+L*P,u-R*D],dt=[s,u];if(tt[0]=2*V[0]-tt[0],tt[1]=2*V[1]-tt[1],c)return[tt,ut,dt].concat(f);f=[tt,ut,dt].concat(f).join().split(",");for(var J=[],Et=0,Bt=f.length;Et<Bt;Et++)J[Et]=Et%2?y(f[Et-1],f[Et],h).y:y(f[Et],f[Et+1],h).x;return J},Dv=function(t,n){var e=Nv(t),r=n&&Nv(n),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=[],s=[],u="",c="",l,h=function(b,x,w){var E,M;if(!b)return["C",x.x,x.y,x.x,x.y,x.x,x.y];switch(!(b[0]in{T:1,Q:1})&&(x.qx=x.qy=null),b[0]){case"M":x.X=b[1],x.Y=b[2];break;case"A":b=["C"].concat(CC.apply(0,[x.x,x.y].concat(b.slice(1))));break;case"S":w==="C"||w==="S"?(E=x.x*2-x.bx,M=x.y*2-x.by):(E=x.x,M=x.y),b=["C",E,M].concat(b.slice(1));break;case"T":w==="Q"||w==="T"?(x.qx=x.x*2-x.qx,x.qy=x.y*2-x.qy):(x.qx=x.x,x.qy=x.y),b=["C"].concat(Dw(x.x,x.y,x.qx,x.qy,b[1],b[2]));break;case"Q":x.qx=b[1],x.qy=b[2],b=["C"].concat(Dw(x.x,x.y,b[1],b[2],b[3],b[4]));break;case"L":b=["C"].concat(Kh(x.x,x.y,b[1],b[2]));break;case"H":b=["C"].concat(Kh(x.x,x.y,b[1],x.y));break;case"V":b=["C"].concat(Kh(x.x,x.y,x.x,b[1]));break;case"Z":b=["C"].concat(Kh(x.x,x.y,x.X,x.Y));break}return b},f=function(b,x){if(b[x].length>7){b[x].shift();for(var w=b[x];w.length;)a[x]="A",r&&(s[x]="A"),b.splice(x++,0,["C"].concat(w.splice(0,6)));b.splice(x,1),l=Math.max(e.length,r&&r.length||0)}},d=function(b,x,w,E,M){b&&x&&b[M][0]==="M"&&x[M][0]!=="M"&&(x.splice(M,0,["M",E.x,E.y]),w.bx=0,w.by=0,w.x=b[M][1],w.y=b[M][2],l=Math.max(e.length,r&&r.length||0))};l=Math.max(e.length,r&&r.length||0);for(var p=0;p<l;p++){e[p]&&(u=e[p][0]),u!=="C"&&(a[p]=u,p&&(c=a[p-1])),e[p]=h(e[p],i,c),a[p]!=="A"&&u==="C"&&(a[p]="C"),f(e,p),r&&(r[p]&&(u=r[p][0]),u!=="C"&&(s[p]=u,p&&(c=s[p-1])),r[p]=h(r[p],o,c),s[p]!=="A"&&u==="C"&&(s[p]="C"),f(r,p)),d(e,r,i,o,p),d(r,e,o,i,p);var g=e[p],v=r&&r[p],m=g.length,y=r&&v.length;i.x=g[m-2],i.y=g[m-1],i.bx=parseFloat(g[m-4])||i.x,i.by=parseFloat(g[m-3])||i.y,o.bx=r&&(parseFloat(v[y-4])||o.x),o.by=r&&(parseFloat(v[y-3])||o.y),o.x=r&&v[y-2],o.y=r&&v[y-1]}return r?[e,r]:e},lz=/,?([a-z]),?/gi,IC=function(t){return t.join(",").replace(lz,"$1")},Pw=function(t,n,e,r,i){var o=-3*n+9*e-9*r+3*i,a=t*o+6*n-12*e+6*r;return t*a-3*n+3*e},Lw=function(t,n,e,r,i,o,a,s,u){u===null&&(u=1),u=u>1?1:u<0?0:u;for(var c=u/2,l=12,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],f=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,p=0;p<l;p++){var g=c*h[p]+c,v=Pw(g,t,e,i,a),m=Pw(g,n,r,o,s),y=v*v+m*m;d+=f[p]*Math.sqrt(y)}return c*d},hz=function(t,n,e,r,i,o,a,s){for(var u=[],c=[[],[]],l,h,f,d,p=0;p<2;++p){if(p===0?(h=6*t-12*e+6*i,l=-3*t+9*e-9*i+3*a,f=3*e-3*t):(h=6*n-12*r+6*o,l=-3*n+9*r-9*o+3*s,f=3*r-3*n),Math.abs(l)<1e-12){if(Math.abs(h)<1e-12)continue;d=-f/h,d>0&&d<1&&u.push(d);continue}var g=h*h-4*f*l,v=Math.sqrt(g);if(!(g<0)){var m=(-h+v)/(2*l);m>0&&m<1&&u.push(m);var y=(-h-v)/(2*l);y>0&&y<1&&u.push(y)}}for(var b=u.length,x=b,w;b--;)d=u[b],w=1-d,c[0][b]=w*w*w*t+3*w*w*d*e+3*w*d*d*i+d*d*d*a,c[1][b]=w*w*w*n+3*w*w*d*r+3*w*d*d*o+d*d*d*s;return c[0][x]=t,c[1][x]=n,c[0][x+1]=a,c[1][x+1]=s,c[0].length=c[1].length=x+2,{min:{x:Math.min.apply(0,c[0]),y:Math.min.apply(0,c[1])},max:{x:Math.max.apply(0,c[0]),y:Math.max.apply(0,c[1])}}},fz=function(t,n,e,r,i,o,a,s){if(!(Math.max(t,e)<Math.min(i,a)||Math.min(t,e)>Math.max(i,a)||Math.max(n,r)<Math.min(o,s)||Math.min(n,r)>Math.max(o,s))){var u=(t*r-n*e)*(i-a)-(t-e)*(i*s-o*a),c=(t*r-n*e)*(o-s)-(n-r)*(i*s-o*a),l=(t-e)*(o-s)-(n-r)*(i-a);if(l){var h=u/l,f=c/l,d=+h.toFixed(2),p=+f.toFixed(2);if(!(d<+Math.min(t,e).toFixed(2)||d>+Math.max(t,e).toFixed(2)||d<+Math.min(i,a).toFixed(2)||d>+Math.max(i,a).toFixed(2)||p<+Math.min(n,r).toFixed(2)||p>+Math.max(n,r).toFixed(2)||p<+Math.min(o,s).toFixed(2)||p>+Math.max(o,s).toFixed(2)))return{x:h,y:f}}}},ca=function(t,n,e){return n>=t.x&&n<=t.x+t.width&&e>=t.y&&e<=t.y+t.height},TC=function(t,n,e,r,i){if(i)return[["M",+t+ +i,n],["l",e-i*2,0],["a",i,i,0,0,1,i,i],["l",0,r-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-e,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-r],["a",i,i,0,0,1,i,-i],["z"]];var o=[["M",t,n],["l",e,0],["l",0,r],["l",-e,0],["z"]];return o.parsePathArray=IC,o},Pv=function(t,n,e,r){return t===null&&(t=n=e=r=0),n===null&&(n=t.y,e=t.width,r=t.height,t=t.x),{x:t,y:n,width:e,w:e,height:r,h:r,x2:t+e,y2:n+r,cx:t+e/2,cy:n+r/2,r1:Math.min(e,r)/2,r2:Math.max(e,r)/2,r0:Math.sqrt(e*e+r*r)/2,path:TC(t,n,e,r),vb:[t,n,e,r].join(" ")}},dz=function(t,n){return t=Pv(t),n=Pv(n),ca(n,t.x,t.y)||ca(n,t.x2,t.y)||ca(n,t.x,t.y2)||ca(n,t.x2,t.y2)||ca(t,n.x,n.y)||ca(t,n.x2,n.y)||ca(t,n.x,n.y2)||ca(t,n.x2,n.y2)||(t.x<n.x2&&t.x>n.x||n.x<t.x2&&n.x>t.x)&&(t.y<n.y2&&t.y>n.y||n.y<t.y2&&n.y>t.y)},jw=function(t,n,e,r,i,o,a,s){ve(t)||(t=[t,n,e,r,i,o,a,s]);var u=hz.apply(null,t);return Pv(u.min.x,u.min.y,u.max.x-u.min.x,u.max.y-u.min.y)},Rw=function(t,n,e,r,i,o,a,s,u){var c=1-u,l=Math.pow(c,3),h=Math.pow(c,2),f=u*u,d=f*u,p=l*t+h*3*u*e+c*3*u*u*i+d*a,g=l*n+h*3*u*r+c*3*u*u*o+d*s,v=t+2*u*(e-t)+f*(i-2*e+t),m=n+2*u*(r-n)+f*(o-2*r+n),y=e+2*u*(i-e)+f*(a-2*i+e),b=r+2*u*(o-r)+f*(s-2*o+r),x=c*t+u*e,w=c*n+u*r,E=c*i+u*a,M=c*o+u*s,_=90-Math.atan2(v-y,m-b)*180/Math.PI;return{x:p,y:g,m:{x:v,y:m},n:{x:y,y:b},start:{x,y:w},end:{x:E,y:M},alpha:_}},pz=function(t,n,e){var r=jw(t),i=jw(n);if(!dz(r,i))return e?0:[];for(var o=Lw.apply(0,t),a=Lw.apply(0,n),s=~~(o/8),u=~~(a/8),c=[],l=[],h={},f=e?0:[],d=0;d<s+1;d++){var p=Rw.apply(0,t.concat(d/s));c.push({x:p.x,y:p.y,t:d/s})}for(var d=0;d<u+1;d++){var p=Rw.apply(0,n.concat(d/u));l.push({x:p.x,y:p.y,t:d/u})}for(var d=0;d<s;d++)for(var g=0;g<u;g++){var v=c[d],m=c[d+1],y=l[g],b=l[g+1],x=Math.abs(m.x-v.x)<.001?"y":"x",w=Math.abs(b.x-y.x)<.001?"y":"x",E=fz(v.x,v.y,m.x,m.y,y.x,y.y,b.x,b.y);if(E){if(h[E.x.toFixed(4)]===E.y.toFixed(4))continue;h[E.x.toFixed(4)]=E.y.toFixed(4);var M=v.t+Math.abs((E[x]-v[x])/(m[x]-v[x]))*(m.t-v.t),_=y.t+Math.abs((E[w]-y[w])/(b[w]-y[w]))*(b.t-y.t);M>=0&&M<=1&&_>=0&&_<=1&&(e?f+=1:f.push({x:E.x,y:E.y,t1:M,t2:_}))}}return f},gz=function(t,n,e){t=Dv(t),n=Dv(n);for(var r,i,o,a,s,u,c,l,h,f,d=e?0:[],p=0,g=t.length;p<g;p++){var v=t[p];if(v[0]==="M")r=s=v[1],i=u=v[2];else{v[0]==="C"?(h=[r,i].concat(v.slice(1)),r=h[6],i=h[7]):(h=[r,i,r,i,s,u,s,u],r=s,i=u);for(var m=0,y=n.length;m<y;m++){var b=n[m];if(b[0]==="M")o=c=b[1],a=l=b[2];else{b[0]==="C"?(f=[o,a].concat(b.slice(1)),o=f[6],a=f[7]):(f=[o,a,o,a,c,l,c,l],o=c,a=l);var x=pz(h,f,e);if(e)d+=x;else{for(var w=0,E=x.length;w<E;w++)x[w].segment1=p,x[w].segment2=m,x[w].bez1=h,x[w].bez2=f;d=d.concat(x)}}}}}return d},vz=function(t,n){return gz(t,n)};function mz(t,n){var e=[],r=[];function i(o,a){if(o.length===1)e.push(o[0]),r.push(o[0]);else{for(var s=[],u=0;u<o.length-1;u++)u===0&&e.push(o[0]),u===o.length-2&&r.push(o[u+1]),s[u]=[(1-a)*o[u][0]+a*o[u+1][0],(1-a)*o[u][1]+a*o[u+1][1]];i(s,a)}}return t.length&&i(t,n),{left:e,right:r.reverse()}}function yz(t,n,e){var r=[[t[1],t[2]]];e=e||2;var i=[];n[0]==="A"?(r.push(n[6]),r.push(n[7])):n[0]==="C"?(r.push([n[1],n[2]]),r.push([n[3],n[4]]),r.push([n[5],n[6]])):n[0]==="S"||n[0]==="Q"?(r.push([n[1],n[2]]),r.push([n[3],n[4]])):r.push([n[1],n[2]]);for(var o=r,a=1/e,s=0;s<e-1;s++){var u=a/(1-a*s),c=mz(o,u);i.push(c.left),o=c.right}i.push(o);var l=i.map(function(h){var f=[];return h.length===4&&(f.push("C"),f=f.concat(h[2])),h.length>=3&&(h.length===3&&f.push("Q"),f=f.concat(h[1])),h.length===2&&f.push("L"),f=f.concat(h[h.length-1]),f});return l}var bz=function(t,n,e){if(e===1)return[[].concat(t)];var r=[];if(n[0]==="L"||n[0]==="C"||n[0]==="Q")r=r.concat(yz(t,n,e));else{var i=[].concat(t);i[0]==="M"&&(i[0]="L");for(var o=0;o<=e-1;o++)r.push(i)}return r},xz=function(t,n){if(t.length===1)return t;var e=t.length-1,r=n.length-1,i=e/r,o=[];if(t.length===1&&t[0][0]==="M"){for(var a=0;a<r-e;a++)t.push(t[0]);return t}for(var a=0;a<r;a++){var s=Math.floor(i*a);o[s]=(o[s]||0)+1}var u=o.reduce(function(c,l,h){return h===e?c.concat(t[e]):c.concat(bz(t[h],t[h+1],l))},[]);return u.unshift(t[0]),(n[r]==="Z"||n[r]==="z")&&u.push("Z"),u},wz=function(t,n){if(t.length!==n.length)return!1;var e=!0;return mt(t,function(r,i){if(r!==n[i])return e=!1,!1}),e};function Ez(t,n,e){var r=null,i=e;return n<i&&(i=n,r="add"),t<i&&(i=t,r="del"),{type:r,min:i}}var Mz=function(t,n){var e=t.length,r=n.length,i,o,a=0;if(e===0||r===0)return null;for(var s=[],u=0;u<=e;u++)s[u]=[],s[u][0]={min:u};for(var c=0;c<=r;c++)s[0][c]={min:c};for(var u=1;u<=e;u++){i=t[u-1];for(var c=1;c<=r;c++){o=n[c-1],wz(i,o)?a=0:a=1;var l=s[u-1][c].min+1,h=s[u][c-1].min+1,f=s[u-1][c-1].min+a;s[u][c]=Ez(l,h,f)}}return s},OC=function(t,n){var e=Mz(t,n),r=t.length,i=n.length,o=[],a=1,s=1;if(e[r][i].min!==r){for(var u=1;u<=r;u++){var c=e[u][u].min;s=u;for(var l=a;l<=i;l++)e[u][l].min<c&&(c=e[u][l].min,s=l);a=s,e[u][a].type&&o.push({index:u-1,type:e[u][a].type})}for(var u=o.length-1;u>=0;u--)a=o[u].index,o[u].type==="add"?t.splice(a,0,[].concat(t[a])):t.splice(a,1)}r=t.length;var h=i-r;if(r<i)for(var u=0;u<h;u++)t[r-1][0]==="z"||t[r-1][0]==="Z"?t.splice(r-2,0,t[r-2]):t.push(t[r-1]),r+=1;return t};function m0(t,n,e){for(var r=[].concat(t),i,o=1/(e+1),a=NC(n)[0],s=1;s<=e;s++)o*=s,i=Math.floor(t.length*o),i===0?r.unshift([a[0]*o+t[i][0]*(1-o),a[1]*o+t[i][1]*(1-o)]):r.splice(i,0,[a[0]*o+t[i][0]*(1-o),a[1]*o+t[i][1]*(1-o)]);return r}function NC(t){var n=[];switch(t[0]){case"M":n.push([t[1],t[2]]);break;case"L":n.push([t[1],t[2]]);break;case"A":n.push([t[6],t[7]]);break;case"Q":n.push([t[3],t[4]]),n.push([t[1],t[2]]);break;case"T":n.push([t[1],t[2]]);break;case"C":n.push([t[5],t[6]]),n.push([t[1],t[2]]),n.push([t[3],t[4]]);break;case"S":n.push([t[3],t[4]]),n.push([t[1],t[2]]);break;case"H":n.push([t[1],t[1]]);break;case"V":n.push([t[1],t[1]]);break}return n}var Lv=function(t,n){if(t.length<=1)return t;for(var e,r=0;r<n.length;r++)if(t[r][0]!==n[r][0])switch(e=NC(t[r]),n[r][0]){case"M":t[r]=["M"].concat(e[0]);break;case"L":t[r]=["L"].concat(e[0]);break;case"A":t[r]=[].concat(n[r]),t[r][6]=e[0][0],t[r][7]=e[0][1];break;case"Q":if(e.length<2)if(r>0)e=m0(e,t[r-1],1);else{t[r]=n[r];break}t[r]=["Q"].concat(e.reduce(function(i,o){return i.concat(o)},[]));break;case"T":t[r]=["T"].concat(e[0]);break;case"C":if(e.length<3)if(r>0)e=m0(e,t[r-1],2);else{t[r]=n[r];break}t[r]=["C"].concat(e.reduce(function(i,o){return i.concat(o)},[]));break;case"S":if(e.length<2)if(r>0)e=m0(e,t[r-1],1);else{t[r]=n[r];break}t[r]=["S"].concat(e.reduce(function(i,o){return i.concat(o)},[]));break;default:t[r]=n[r]}return t};const Sz=Object.freeze(Object.defineProperty({__proto__:null,catmullRomToBezier:Ov,fillPath:xz,fillPathByDiff:OC,formatPath:Lv,intersection:vz,parsePathArray:IC,parsePathString:Eu,pathToAbsolute:Nv,pathToCurve:Dv,rectPath:TC},Symbol.toStringTag,{value:"Module"}));var DC=function(){function t(n,e){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=n,this.name=n,this.originalEvent=e,this.timeStamp=e.timeStamp}return t.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t.prototype.toString=function(){var n=this.type;return"[Event (type="+n+")]"},t.prototype.save=function(){},t.prototype.restore=function(){},t}();function PC(t,n){var e=t.indexOf(n);e!==-1&&t.splice(e,1)}var Fw=typeof window<"u"&&typeof window.document<"u";function LC(t,n){if(t.isCanvas())return!0;for(var e=n.getParent(),r=!1;e;){if(e===t){r=!0;break}e=e.getParent()}return r}function jv(t){return t.cfg.visible&&t.cfg.capture}var _z=function(t){Te(n,t);function n(e){var r=t.call(this)||this;r.destroyed=!1;var i=r.getDefaultCfg();return r.cfg=ye(i,e),r}return n.prototype.getDefaultCfg=function(){return{}},n.prototype.get=function(e){return this.cfg[e]},n.prototype.set=function(e,r){this.cfg[e]=r},n.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},n}(Tk),Bw=globalThis&&globalThis.__spreadArray||function(t,n,e){if(e||arguments.length===2)for(var r=0,i=n.length,o;r<i;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},kz=function(){function t(n,e,r){this.name=n,this.version=e,this.os=r,this.type="browser"}return t}(),Az=function(){function t(n){this.version=n,this.type="node",this.name="node",this.os=process.platform}return t}(),Cz=function(){function t(n,e,r,i){this.name=n,this.version=e,this.os=r,this.bot=i,this.type="bot-device"}return t}(),Iz=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Tz=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Oz=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Nz=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,zw=3,Dz=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Oz]],Gw=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function jC(t){return t?Uw(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Tz:typeof navigator<"u"?Uw(navigator.userAgent):jz()}function Pz(t){return t!==""&&Dz.reduce(function(n,e){var r=e[0],i=e[1];if(n)return n;var o=i.exec(t);return!!o&&[r,o]},!1)}function Uw(t){var n=Pz(t);if(!n)return null;var e=n[0],r=n[1];if(e==="searchbot")return new Iz;var i=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);i?i.length<zw&&(i=Bw(Bw([],i,!0),Rz(zw-i.length),!0)):i=[];var o=i.join("."),a=Lz(t),s=Nz.exec(t);return s&&s[1]?new Cz(e,o,a,s[1]):new kz(e,o,a)}function Lz(t){for(var n=0,e=Gw.length;n<e;n++){var r=Gw[n],i=r[0],o=r[1],a=o.exec(t);if(a)return i}return null}function jz(){var t=typeof process<"u"&&process.version;return t?new Az(process.version.slice(1)):null}function Rz(t){for(var n=[],e=0;e<t;e++)n.push("0");return n}function Yw(t,n){var e=[],r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=n[0],d=n[1],p=n[2],g=n[3],v=n[4],m=n[5],y=n[6],b=n[7],x=n[8];return e[0]=f*r+d*a+p*c,e[1]=f*i+d*s+p*l,e[2]=f*o+d*u+p*h,e[3]=g*r+v*a+m*c,e[4]=g*i+v*s+m*l,e[5]=g*o+v*u+m*h,e[6]=y*r+b*a+x*c,e[7]=y*i+b*s+x*l,e[8]=y*o+b*u+x*h,e}function ds(t,n){var e=[],r=n[0],i=n[1];return e[0]=t[0]*r+t[3]*i+t[6],e[1]=t[1]*r+t[4]*i+t[7],e}function RC(t){var n=[],e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=l*a-s*c,f=-l*o+s*u,d=c*o-a*u,p=e*h+r*f+i*d;return p?(p=1/p,n[0]=h*p,n[1]=(-l*r+i*c)*p,n[2]=(s*r-i*a)*p,n[3]=f*p,n[4]=(l*e-i*u)*p,n[5]=(-s*e+i*o)*p,n[6]=d*p,n[7]=(-c*e+r*u)*p,n[8]=(a*e-r*o)*p,n):null}var wc=yi,y0="matrix",Fz=["zIndex","capture","visible","type"],Bz=["repeat"],zz=":",Gz="*";function Uz(t){for(var n=[],e=0;e<t.length;e++)ve(t[e])?n.push([].concat(t[e])):n.push(t[e]);return n}function Yz(t,n){var e={},r=n.attrs;for(var i in t)e[i]=r[i];return e}function Vz(t,n){var e={},r=n.attr();return mt(t,function(i,o){Bz.indexOf(o)===-1&&!Aa(r[o],i)&&(e[o]=i)}),e}function Wz(t,n){if(n.onFrame)return t;var e=n.startTime,r=n.delay,i=n.duration,o=Object.prototype.hasOwnProperty;return mt(t,function(a){e+r<a.startTime+a.delay+a.duration&&i>a.delay&&mt(n.toAttrs,function(s,u){o.call(a.toAttrs,u)&&(delete a.toAttrs[u],delete a.fromAttrs[u])})}),t}var FC=function(t){Te(n,t);function n(e){var r=t.call(this,e)||this;r.attrs={};var i=r.getDefaultAttrs();return ye(i,e.attrs),r.attrs=i,r.initAttrs(i),r.initAnimate(),r}return n.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},n.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},n.prototype.onCanvasChange=function(e){},n.prototype.initAttrs=function(e){},n.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},n.prototype.isGroup=function(){return!1},n.prototype.getParent=function(){return this.get("parent")},n.prototype.getCanvas=function(){return this.get("canvas")},n.prototype.attr=function(){for(var e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=r[0],a=r[1];if(!o)return this.attrs;if(yr(o)){for(var s in o)this.setAttr(s,o[s]);return this.afterAttrsChange(o),this}return r.length===2?(this.setAttr(o,a),this.afterAttrsChange((e={},e[o]=a,e)),this):this.attrs[o]},n.prototype.isClipped=function(e,r){var i=this.getClip();return i&&!i.isHit(e,r)},n.prototype.setAttr=function(e,r){var i=this.attrs[e];i!==r&&(this.attrs[e]=r,this.onAttrChange(e,r,i))},n.prototype.onAttrChange=function(e,r,i){e==="matrix"&&this.set("totalMatrix",null)},n.prototype.afterAttrsChange=function(e){if(this.cfg.isClipShape){var r=this.cfg.applyTo;r&&r.onCanvasChange("clip")}else this.onCanvasChange("attr")},n.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},n.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},n.prototype.setZIndex=function(e){this.set("zIndex",e);var r=this.getParent();return r&&r.sort(),this},n.prototype.toFront=function(){var e=this.getParent();if(e){var r=e.getChildren();this.get("el");var i=r.indexOf(this);r.splice(i,1),r.push(this),this.onCanvasChange("zIndex")}},n.prototype.toBack=function(){var e=this.getParent();if(e){var r=e.getChildren();this.get("el");var i=r.indexOf(this);r.splice(i,1),r.unshift(this),this.onCanvasChange("zIndex")}},n.prototype.remove=function(e){e===void 0&&(e=!0);var r=this.getParent();r?(PC(r.getChildren(),this),r.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),e&&this.destroy()},n.prototype.resetMatrix=function(){this.attr(y0,this.getDefaultMatrix()),this.onCanvasChange("matrix")},n.prototype.getMatrix=function(){return this.attr(y0)},n.prototype.setMatrix=function(e){this.attr(y0,e),this.onCanvasChange("matrix")},n.prototype.getTotalMatrix=function(){var e=this.cfg.totalMatrix;if(!e){var r=this.attr("matrix"),i=this.cfg.parentMatrix;i&&r?e=Yw(i,r):e=r||i,this.set("totalMatrix",e)}return e},n.prototype.applyMatrix=function(e){var r=this.attr("matrix"),i=null;e&&r?i=Yw(e,r):i=r||e,this.set("totalMatrix",i),this.set("parentMatrix",e)},n.prototype.getDefaultMatrix=function(){return null},n.prototype.applyToMatrix=function(e){var r=this.attr("matrix");return r?ds(r,e):e},n.prototype.invertFromMatrix=function(e){var r=this.attr("matrix");if(r){var i=RC(r);if(i)return ds(i,e)}return e},n.prototype.setClip=function(e){var r=this.getCanvas(),i=null;if(e){var o=this.getShapeBase(),a=Du(e.type),s=o[a];s&&(i=new s({type:e.type,isClipShape:!0,applyTo:this,attrs:e.attrs,canvas:r}))}return this.set("clipShape",i),this.onCanvasChange("clip"),i},n.prototype.getClip=function(){var e=this.cfg.clipShape;return e||null},n.prototype.clone=function(){var e=this,r=this.attrs,i={};mt(r,function(s,u){ve(r[u])?i[u]=Uz(r[u]):i[u]=r[u]});var o=this.constructor,a=new o({attrs:i});return mt(Fz,function(s){a.set(s,e.get(s))}),a},n.prototype.destroy=function(){var e=this.destroyed;e||(this.attrs={},t.prototype.destroy.call(this))},n.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},n.prototype.animate=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var i=this.get("timeline");i||(i=this.get("canvas").get("timeline"),this.set("timeline",i));var o=this.get("animations")||[];i.timer||i.initTimer();var a=e[0],s=e[1],u=e[2],c=u===void 0?"easeLinear":u,l=e[3],h=l===void 0?Bc:l,f=e[4],d=f===void 0?0:f,p,g,v,m,y;An(a)?(p=a,a={}):yr(a)&&a.onFrame&&(p=a.onFrame,g=a.repeat),yr(s)?(y=s,s=y.duration,c=y.easing||"easeLinear",d=y.delay||0,g=y.repeat||g||!1,h=y.callback||Bc,v=y.pauseCallback||Bc,m=y.resumeCallback||Bc):(pe(h)&&(d=h,h=null),An(c)?(h=c,c="easeLinear"):c=c||"easeLinear");var b=Vz(a,this),x={fromAttrs:Yz(b,this),toAttrs:b,duration:s,easing:c,repeat:g,callback:h,pauseCallback:v,resumeCallback:m,delay:d,startTime:i.getTime(),id:vo(),onFrame:p,pathFormatted:!1};o.length>0?o=Wz(o,x):i.addAnimator(this),o.push(x),this.set("animations",o),this.set("_pause",{isPaused:!1})}},n.prototype.stopAnimate=function(e){var r=this;e===void 0&&(e=!0);var i=this.get("animations");mt(i,function(o){e&&(o.onFrame?r.attr(o.onFrame(1)):r.attr(o.toAttrs)),o.callback&&o.callback()}),this.set("animating",!1),this.set("animations",[])},n.prototype.pauseAnimate=function(){var e=this.get("timeline"),r=this.get("animations"),i=e.getTime();return mt(r,function(o){o._paused=!0,o._pauseTime=i,o.pauseCallback&&o.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:i}),this},n.prototype.resumeAnimate=function(){var e=this.get("timeline"),r=e.getTime(),i=this.get("animations"),o=this.get("_pause").pauseTime;return mt(i,function(a){a.startTime=a.startTime+(r-o),a._paused=!1,a._pauseTime=null,a.resumeCallback&&a.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",i),this},n.prototype.emitDelegation=function(e,r){var i=this,o=r.propagationPath;this.getEvents();var a;e==="mouseenter"?a=r.fromShape:e==="mouseleave"&&(a=r.toShape);for(var s=function(h){var f=o[h],d=f.get("name");if(d){if((f.isGroup()||f.isCanvas&&f.isCanvas())&&a&&LC(f,a))return"break";ve(d)?mt(d,function(p){i.emitDelegateEvent(f,p,r)}):u.emitDelegateEvent(f,d,r)}},u=this,c=0;c<o.length;c++){var l=s(c);if(l==="break")break}},n.prototype.emitDelegateEvent=function(e,r,i){var o=this.getEvents(),a=r+zz+i.type;(o[a]||o[Gz])&&(i.name=a,i.currentTarget=e,i.delegateTarget=this,i.delegateObject=e.get("delegateObject"),this.emit(a,i))},n.prototype.translate=function(e,r){e===void 0&&(e=0),r===void 0&&(r=0);var i=this.getMatrix(),o=wc(i,[["t",e,r]]);return this.setMatrix(o),this},n.prototype.move=function(e,r){var i=this.attr("x")||0,o=this.attr("y")||0;return this.translate(e-i,r-o),this},n.prototype.moveTo=function(e,r){return this.move(e,r)},n.prototype.scale=function(e,r){var i=this.getMatrix(),o=wc(i,[["s",e,r||e]]);return this.setMatrix(o),this},n.prototype.rotate=function(e){var r=this.getMatrix(),i=wc(r,[["r",e]]);return this.setMatrix(i),this},n.prototype.rotateAtStart=function(e){var r=this.attr(),i=r.x,o=r.y,a=this.getMatrix(),s=wc(a,[["t",-i,-o],["r",e],["t",i,o]]);return this.setMatrix(s),this},n.prototype.rotateAtPoint=function(e,r,i){var o=this.getMatrix(),a=wc(o,[["t",-e,-r],["r",i],["t",e,r]]);return this.setMatrix(a),this},n}(_z),Vw={},Rv="_INDEX";function BC(t,n){if(t.set("canvas",n),t.isGroup()){var e=t.get("children");e.length&&e.forEach(function(r){BC(r,n)})}}function zC(t,n){if(t.set("timeline",n),t.isGroup()){var e=t.get("children");e.length&&e.forEach(function(r){zC(r,n)})}}function Xz(t,n,e){e===void 0&&(e=!0),e?n.destroy():(n.set("parent",null),n.set("canvas",null)),PC(t.getChildren(),n)}function Hz(t){return function(n,e){var r=t(n,e);return r===0?n[Rv]-e[Rv]:r}}var GC=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.isCanvas=function(){return!1},n.prototype.getBBox=function(){var e=1/0,r=-1/0,i=1/0,o=-1/0,a=this.getChildren().filter(function(u){return u.get("visible")&&(!u.isGroup()||u.isGroup()&&u.getChildren().length>0)});a.length>0?mt(a,function(u){var c=u.getBBox(),l=c.minX,h=c.maxX,f=c.minY,d=c.maxY;l<e&&(e=l),h>r&&(r=h),f<i&&(i=f),d>o&&(o=d)}):(e=0,r=0,i=0,o=0);var s={x:e,y:i,minX:e,minY:i,maxX:r,maxY:o,width:r-e,height:o-i};return s},n.prototype.getCanvasBBox=function(){var e=1/0,r=-1/0,i=1/0,o=-1/0,a=this.getChildren().filter(function(u){return u.get("visible")&&(!u.isGroup()||u.isGroup()&&u.getChildren().length>0)});a.length>0?mt(a,function(u){var c=u.getCanvasBBox(),l=c.minX,h=c.maxX,f=c.minY,d=c.maxY;l<e&&(e=l),h>r&&(r=h),f<i&&(i=f),d>o&&(o=d)}):(e=0,r=0,i=0,o=0);var s={x:e,y:i,minX:e,minY:i,maxX:r,maxY:o,width:r-e,height:o-i};return s},n.prototype.getDefaultCfg=function(){var e=t.prototype.getDefaultCfg.call(this);return e.children=[],e},n.prototype.onAttrChange=function(e,r,i){if(t.prototype.onAttrChange.call(this,e,r,i),e==="matrix"){var o=this.getTotalMatrix();this._applyChildrenMarix(o)}},n.prototype.applyMatrix=function(e){var r=this.getTotalMatrix();t.prototype.applyMatrix.call(this,e);var i=this.getTotalMatrix();i!==r&&this._applyChildrenMarix(i)},n.prototype._applyChildrenMarix=function(e){var r=this.getChildren();mt(r,function(i){i.applyMatrix(e)})},n.prototype.addShape=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=e[0],o=e[1];yr(i)?o=i:o.type=i;var a=Vw[o.type];a||(a=Du(o.type),Vw[o.type]=a);var s=this.getShapeBase(),u=new s[a](o);return this.add(u),u},n.prototype.addGroup=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=e[0],o=e[1],a;if(An(i))o?a=new i(o):a=new i({parent:this});else{var s=i||{},u=this.getGroupBase();a=new u(s)}return this.add(a),a},n.prototype.getCanvas=function(){var e;return this.isCanvas()?e=this:e=this.get("canvas"),e},n.prototype.getShape=function(e,r,i){if(!jv(this))return null;var o=this.getChildren(),a;if(this.isCanvas())a=this._findShape(o,e,r,i);else{var s=[e,r,1];s=this.invertFromMatrix(s),this.isClipped(s[0],s[1])||(a=this._findShape(o,s[0],s[1],i))}return a},n.prototype._findShape=function(e,r,i,o){for(var a=null,s=e.length-1;s>=0;s--){var u=e[s];if(jv(u)&&(u.isGroup()?a=u.getShape(r,i,o):u.isHit(r,i)&&(a=u)),a)break}return a},n.prototype.add=function(e){var r=this.getCanvas(),i=this.getChildren(),o=this.get("timeline"),a=e.getParent();a&&Xz(a,e,!1),e.set("parent",this),r&&BC(e,r),o&&zC(e,o),i.push(e),e.onCanvasChange("add"),this._applyElementMatrix(e)},n.prototype._applyElementMatrix=function(e){var r=this.getTotalMatrix();r&&e.applyMatrix(r)},n.prototype.getChildren=function(){return this.get("children")},n.prototype.sort=function(){var e=this.getChildren();mt(e,function(r,i){return r[Rv]=i,r}),e.sort(Hz(function(r,i){return r.get("zIndex")-i.get("zIndex")})),this.onCanvasChange("sort")},n.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var e=this.getChildren(),r=e.length-1;r>=0;r--)e[r].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},n.prototype.destroy=function(){this.get("destroyed")||(this.clear(),t.prototype.destroy.call(this))},n.prototype.getFirst=function(){return this.getChildByIndex(0)},n.prototype.getLast=function(){var e=this.getChildren();return this.getChildByIndex(e.length-1)},n.prototype.getChildByIndex=function(e){var r=this.getChildren();return r[e]},n.prototype.getCount=function(){var e=this.getChildren();return e.length},n.prototype.contain=function(e){var r=this.getChildren();return r.indexOf(e)>-1},n.prototype.removeChild=function(e,r){r===void 0&&(r=!0),this.contain(e)&&e.remove(r)},n.prototype.findAll=function(e){var r=[],i=this.getChildren();return mt(i,function(o){e(o)&&r.push(o),o.isGroup()&&(r=r.concat(o.findAll(e)))}),r},n.prototype.find=function(e){var r=null,i=this.getChildren();return mt(i,function(o){if(e(o)?r=o:o.isGroup()&&(r=o.find(e)),r)return!1}),r},n.prototype.findById=function(e){return this.find(function(r){return r.get("id")===e})},n.prototype.findByClassName=function(e){return this.find(function(r){return r.get("className")===e})},n.prototype.findAllByName=function(e){return this.findAll(function(r){return r.get("name")===e})},n}(FC),Pu=0,Gc=0,Ec=0,UC=1e3,Sd,Uc,_d=0,ks=0,pp=0,ml=typeof performance=="object"&&performance.now?performance:Date,YC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function VC(){return ks||(YC(qz),ks=ml.now()+pp)}function qz(){ks=0}function Fv(){this._call=this._time=this._next=null}Fv.prototype=WC.prototype={constructor:Fv,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?VC():+e)+(n==null?0:+n),!this._next&&Uc!==this&&(Uc?Uc._next=this:Sd=this,Uc=this),this._call=t,this._time=e,Bv()},stop:function(){this._call&&(this._call=null,this._time=1/0,Bv())}};function WC(t,n,e){var r=new Fv;return r.restart(t,n,e),r}function Zz(){VC(),++Pu;for(var t=Sd,n;t;)(n=ks-t._time)>=0&&t._call.call(null,n),t=t._next;--Pu}function Ww(){ks=(_d=ml.now())+pp,Pu=Gc=0;try{Zz()}finally{Pu=0,Qz(),ks=0}}function Kz(){var t=ml.now(),n=t-_d;n>UC&&(pp-=n,_d=t)}function Qz(){for(var t,n=Sd,e,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Sd=e);Uc=t,Bv(r)}function Bv(t){if(!Pu){Gc&&(Gc=clearTimeout(Gc));var n=t-ks;n>24?(t<1/0&&(Gc=setTimeout(Ww,t-ml.now()-pp)),Ec&&(Ec=clearInterval(Ec))):(Ec||(_d=ml.now(),Ec=setInterval(Kz,UC)),Pu=1,YC(Ww))}}function jy(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function XC(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Bl(){}var yl=.7,kd=1/yl,ku="\\s*([+-]?\\d+)\\s*",bl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ho="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Jz=/^#([0-9a-f]{3,8})$/,$z=new RegExp(`^rgb\\(${ku},${ku},${ku}\\)$`),t8=new RegExp(`^rgb\\(${ho},${ho},${ho}\\)$`),e8=new RegExp(`^rgba\\(${ku},${ku},${ku},${bl}\\)$`),n8=new RegExp(`^rgba\\(${ho},${ho},${ho},${bl}\\)$`),r8=new RegExp(`^hsl\\(${bl},${ho},${ho}\\)$`),i8=new RegExp(`^hsla\\(${bl},${ho},${ho},${bl}\\)$`),Xw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};jy(Bl,xl,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Hw,formatHex:Hw,formatHex8:o8,formatHsl:a8,formatRgb:qw,toString:qw});function Hw(){return this.rgb().formatHex()}function o8(){return this.rgb().formatHex8()}function a8(){return HC(this).formatHsl()}function qw(){return this.rgb().formatRgb()}function xl(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Jz.exec(t))?(e=n[1].length,n=parseInt(n[1],16),e===6?Zw(n):e===3?new Fr(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):e===8?Qh(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):e===4?Qh(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=$z.exec(t))?new Fr(n[1],n[2],n[3],1):(n=t8.exec(t))?new Fr(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=e8.exec(t))?Qh(n[1],n[2],n[3],n[4]):(n=n8.exec(t))?Qh(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=r8.exec(t))?Jw(n[1],n[2]/100,n[3]/100,1):(n=i8.exec(t))?Jw(n[1],n[2]/100,n[3]/100,n[4]):Xw.hasOwnProperty(t)?Zw(Xw[t]):t==="transparent"?new Fr(NaN,NaN,NaN,0):null}function Zw(t){return new Fr(t>>16&255,t>>8&255,t&255,1)}function Qh(t,n,e,r){return r<=0&&(t=n=e=NaN),new Fr(t,n,e,r)}function s8(t){return t instanceof Bl||(t=xl(t)),t?(t=t.rgb(),new Fr(t.r,t.g,t.b,t.opacity)):new Fr}function zv(t,n,e,r){return arguments.length===1?s8(t):new Fr(t,n,e,r??1)}function Fr(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}jy(Fr,zv,XC(Bl,{brighter(t){return t=t==null?kd:Math.pow(kd,t),new Fr(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?yl:Math.pow(yl,t),new Fr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Fr(ms(this.r),ms(this.g),ms(this.b),Ad(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kw,formatHex:Kw,formatHex8:u8,formatRgb:Qw,toString:Qw}));function Kw(){return`#${ps(this.r)}${ps(this.g)}${ps(this.b)}`}function u8(){return`#${ps(this.r)}${ps(this.g)}${ps(this.b)}${ps((isNaN(this.opacity)?1:this.opacity)*255)}`}function Qw(){const t=Ad(this.opacity);return`${t===1?"rgb(":"rgba("}${ms(this.r)}, ${ms(this.g)}, ${ms(this.b)}${t===1?")":`, ${t})`}`}function Ad(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ms(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function ps(t){return t=ms(t),(t<16?"0":"")+t.toString(16)}function Jw(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new Ti(t,n,e,r)}function HC(t){if(t instanceof Ti)return new Ti(t.h,t.s,t.l,t.opacity);if(t instanceof Bl||(t=xl(t)),!t)return new Ti;if(t instanceof Ti)return t;t=t.rgb();var n=t.r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=NaN,s=o-i,u=(o+i)/2;return s?(n===o?a=(e-r)/s+(e<r)*6:e===o?a=(r-n)/s+2:a=(n-e)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new Ti(a,s,u,t.opacity)}function c8(t,n,e,r){return arguments.length===1?HC(t):new Ti(t,n,e,r??1)}function Ti(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}jy(Ti,c8,XC(Bl,{brighter(t){return t=t==null?kd:Math.pow(kd,t),new Ti(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?yl:Math.pow(yl,t),new Ti(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new Fr(b0(t>=240?t-240:t+120,i,r),b0(t,i,r),b0(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Ti($w(this.h),Jh(this.s),Jh(this.l),Ad(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ad(this.opacity);return`${t===1?"hsl(":"hsla("}${$w(this.h)}, ${Jh(this.s)*100}%, ${Jh(this.l)*100}%${t===1?")":`, ${t})`}`}}));function $w(t){return t=(t||0)%360,t<0?t+360:t}function Jh(t){return Math.max(0,Math.min(1,t||0))}function b0(t,n,e){return(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)*255}const Ry=t=>()=>t;function l8(t,n){return function(e){return t+e*n}}function h8(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}function f8(t){return(t=+t)==1?qC:function(n,e){return e-n?h8(n,e,t):Ry(isNaN(n)?e:n)}}function qC(t,n){var e=n-t;return e?l8(t,e):Ry(isNaN(t)?n:t)}const t2=function t(n){var e=f8(n);function r(i,o){var a=e((i=zv(i)).r,(o=zv(o)).r),s=e(i.g,o.g),u=e(i.b,o.b),c=qC(i.opacity,o.opacity);return function(l){return i.r=a(l),i.g=s(l),i.b=u(l),i.opacity=c(l),i+""}}return r.gamma=t,r}(1);function ZC(t,n){n||(n=[]);var e=t?Math.min(n.length,t.length):0,r=n.slice(),i;return function(o){for(i=0;i<e;++i)r[i]=t[i]*(1-o)+n[i]*o;return r}}function KC(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function d8(t,n){return(KC(n)?ZC:QC)(t,n)}function QC(t,n){var e=n?n.length:0,r=t?Math.min(e,t.length):0,i=new Array(r),o=new Array(e),a;for(a=0;a<r;++a)i[a]=Cd(t[a],n[a]);for(;a<e;++a)o[a]=n[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function p8(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function Gv(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function g8(t,n){var e={},r={},i;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(i in n)i in t?e[i]=Cd(t[i],n[i]):r[i]=n[i];return function(o){for(i in e)r[i]=e[i](o);return r}}var Uv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x0=new RegExp(Uv.source,"g");function v8(t){return function(){return t}}function m8(t){return function(n){return t(n)+""}}function y8(t,n){var e=Uv.lastIndex=x0.lastIndex=0,r,i,o,a=-1,s=[],u=[];for(t=t+"",n=n+"";(r=Uv.exec(t))&&(i=x0.exec(n));)(o=i.index)>e&&(o=n.slice(e,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,u.push({i:a,x:Gv(r,i)})),e=x0.lastIndex;return e<n.length&&(o=n.slice(e),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?m8(u[0].x):v8(n):(n=u.length,function(c){for(var l=0,h;l<n;++l)s[(h=u[l]).i]=h.x(c);return s.join("")})}function Cd(t,n){var e=typeof n,r;return n==null||e==="boolean"?Ry(n):(e==="number"?Gv:e==="string"?(r=xl(n))?(n=r,t2):y8:n instanceof xl?t2:n instanceof Date?p8:KC(n)?ZC:Array.isArray(n)?QC:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?g8:Gv)(t,n)}function b8(t){return+t}function x8(t){return t*t}function w8(t){return t*(2-t)}function e2(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function E8(t){return t*t*t}function M8(t){return--t*t*t+1}function n2(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Fy=3,S8=function t(n){n=+n;function e(r){return Math.pow(r,n)}return e.exponent=t,e}(Fy),_8=function t(n){n=+n;function e(r){return 1-Math.pow(1-r,n)}return e.exponent=t,e}(Fy),r2=function t(n){n=+n;function e(r){return((r*=2)<=1?Math.pow(r,n):2-Math.pow(2-r,n))/2}return e.exponent=t,e}(Fy),JC=Math.PI,$C=JC/2;function k8(t){return+t==1?1:1-Math.cos(t*$C)}function A8(t){return Math.sin(t*$C)}function i2(t){return(1-Math.cos(JC*t))/2}function Ca(t){return(Math.pow(2,-10*t)-.0009765625)*1.0009775171065494}function C8(t){return Ca(1-+t)}function I8(t){return 1-Ca(t)}function o2(t){return((t*=2)<=1?Ca(1-t):2-Ca(t-1))/2}function T8(t){return 1-Math.sqrt(1-t*t)}function O8(t){return Math.sqrt(1- --t*t)}function a2(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var Yv=4/11,N8=6/11,D8=8/11,P8=3/4,L8=9/11,j8=10/11,R8=15/16,F8=21/22,B8=63/64,$h=1/Yv/Yv;function z8(t){return 1-wl(1-t)}function wl(t){return(t=+t)<Yv?$h*t*t:t<D8?$h*(t-=N8)*t+P8:t<j8?$h*(t-=L8)*t+R8:$h*(t-=F8)*t+B8}function G8(t){return((t*=2)<=1?1-wl(1-t):wl(t-1)+1)/2}var By=1.70158,U8=function t(n){n=+n;function e(r){return(r=+r)*r*(n*(r-1)+r)}return e.overshoot=t,e}(By),Y8=function t(n){n=+n;function e(r){return--r*r*((r+1)*n+r)+1}return e.overshoot=t,e}(By),s2=function t(n){n=+n;function e(r){return((r*=2)<1?r*r*((n+1)*r-n):(r-=2)*r*((n+1)*r+n)+2)/2}return e.overshoot=t,e}(By),Lu=2*Math.PI,zy=1,Gy=.3,V8=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=Lu);function i(o){return n*Ca(- --o)*Math.sin((r-o)/e)}return i.amplitude=function(o){return t(o,e*Lu)},i.period=function(o){return t(n,o)},i}(zy,Gy),u2=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=Lu);function i(o){return 1-n*Ca(o=+o)*Math.sin((o+r)/e)}return i.amplitude=function(o){return t(o,e*Lu)},i.period=function(o){return t(n,o)},i}(zy,Gy),W8=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=Lu);function i(o){return((o=o*2-1)<0?n*Ca(-o)*Math.sin((r-o)/e):2-n*Ca(o)*Math.sin((r+o)/e))/2}return i.amplitude=function(o){return t(o,e*Lu)},i.period=function(o){return t(n,o)},i}(zy,Gy);const X8=Object.freeze(Object.defineProperty({__proto__:null,easeBack:s2,easeBackIn:U8,easeBackInOut:s2,easeBackOut:Y8,easeBounce:wl,easeBounceIn:z8,easeBounceInOut:G8,easeBounceOut:wl,easeCircle:a2,easeCircleIn:T8,easeCircleInOut:a2,easeCircleOut:O8,easeCubic:n2,easeCubicIn:E8,easeCubicInOut:n2,easeCubicOut:M8,easeElastic:u2,easeElasticIn:V8,easeElasticInOut:W8,easeElasticOut:u2,easeExp:o2,easeExpIn:C8,easeExpInOut:o2,easeExpOut:I8,easeLinear:b8,easePoly:r2,easePolyIn:S8,easePolyInOut:r2,easePolyOut:_8,easeQuad:e2,easeQuadIn:x8,easeQuadInOut:e2,easeQuadOut:w8,easeSin:i2,easeSinIn:k8,easeSinInOut:i2,easeSinOut:A8},Symbol.toStringTag,{value:"Module"}));var H8={};function q8(t){return H8[t.toLowerCase()]||X8[t]}var Z8=function(t){return["fill","stroke","fillStyle","strokeStyle"].includes(t)},K8=function(t){return/^[r,R,L,l]{1}[\s]*\(/.test(t)},c2=[1,0,0,0,1,0,0,0,1];function Q8(t,n,e){var r={},i=n.fromAttrs,o=n.toAttrs;if(!t.destroyed){var a;for(var s in o)if(!Aa(i[s],o[s]))if(s==="path"){var u=o[s],c=i[s];u.length>c.length?(u=Eu(o[s]),c=Eu(i[s]),c=OC(c,u),c=Lv(c,u),n.fromAttrs.path=c,n.toAttrs.path=u):n.pathFormatted||(u=Eu(o[s]),c=Eu(i[s]),c=Lv(c,u),n.fromAttrs.path=c,n.toAttrs.path=u,n.pathFormatted=!0),r[s]=[];for(var l=0;l<u.length;l++){for(var h=u[l],f=c[l],d=[],p=0;p<h.length;p++)pe(h[p])&&f&&pe(f[p])?(a=Cd(f[p],h[p]),d.push(a(e))):d.push(h[p]);r[s].push(d)}}else if(s==="matrix"){var g=d8(i[s]||c2,o[s]||c2),v=g(e);r[s]=v}else Z8(s)&&K8(o[s])?r[s]=o[s]:An(o[s])||(a=Cd(i[s],o[s]),r[s]=a(e));t.attr(r)}}function J8(t,n,e){var r=n.startTime,i=n.delay;if(e<r+i||n._paused)return!1;var o,a=n.duration,s=n.easing,u=q8(s);if(e=e-r-n.delay,n.repeat)o=e%a/a,o=u(o);else if(o=e/a,o<1)o=u(o);else return n.onFrame?t.attr(n.onFrame(1)):t.attr(n.toAttrs),!0;if(n.onFrame){var c=n.onFrame(o);t.attr(c)}else Q8(t,n,o);return!1}var $8=function(){function t(n){this.animators=[],this.current=0,this.timer=null,this.canvas=n}return t.prototype.initTimer=function(){var n=this,e=!1,r,i,o;this.timer=WC(function(a){if(n.current=a,n.animators.length>0){for(var s=n.animators.length-1;s>=0;s--){if(r=n.animators[s],r.destroyed){n.removeAnimator(s);continue}if(!r.isAnimatePaused()){i=r.get("animations");for(var u=i.length-1;u>=0;u--)o=i[u],e=J8(r,o,a),e&&(i.splice(u,1),e=!1,o.callback&&o.callback())}i.length===0&&n.removeAnimator(s)}var c=n.canvas.get("autoDraw");c||n.canvas.draw()}})},t.prototype.addAnimator=function(n){this.animators.push(n)},t.prototype.removeAnimator=function(n){this.animators.splice(n,1)},t.prototype.isAnimating=function(){return!!this.animators.length},t.prototype.stop=function(){this.timer&&this.timer.stop()},t.prototype.stopAllAnimations=function(n){n===void 0&&(n=!0),this.animators.forEach(function(e){e.stopAnimate(n)}),this.animators=[],this.canvas.draw()},t.prototype.getTime=function(){return this.current},t}(),t9=40,l2=0,h2=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function f2(t,n,e){e.name=n,e.target=t,e.currentTarget=t,e.delegateTarget=t,t.emit(n,e)}function e9(t,n,e){if(e.bubbles){var r=void 0,i=!1;if(n==="mouseenter"?(r=e.fromShape,i=!0):n==="mouseleave"&&(i=!0,r=e.toShape),t.isCanvas()&&i)return;if(r&&LC(t,r)){e.bubbles=!1;return}e.name=n,e.currentTarget=t,e.delegateTarget=t,t.emit(n,e)}}var n9=function(){function t(n){var e=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(r){var i=r.type;e._triggerEvent(i,r)},this._onDocumentMove=function(r){var i=e.canvas,o=i.get("el");if(o!==r.target&&(e.dragging||e.currentShape)){var a=e._getPointInfo(r);e.dragging&&e._emitEvent("drag",r,a,e.draggingShape)}},this._onDocumentMouseUp=function(r){var i=e.canvas,o=i.get("el");if(o!==r.target&&e.dragging){var a=e._getPointInfo(r);e.draggingShape&&e._emitEvent("drop",r,a,null),e._emitEvent("dragend",r,a,e.draggingShape),e._afterDrag(e.draggingShape,a,r)}},this.canvas=n.canvas}return t.prototype.init=function(){this._bindEvents()},t.prototype._bindEvents=function(){var n=this,e=this.canvas.get("el");mt(h2,function(r){e.addEventListener(r,n._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},t.prototype._clearEvents=function(){var n=this,e=this.canvas.get("el");mt(h2,function(r){e.removeEventListener(r,n._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},t.prototype._getEventObj=function(n,e,r,i,o,a){var s=new DC(n,e);return s.fromShape=o,s.toShape=a,s.x=r.x,s.y=r.y,s.clientX=r.clientX,s.clientY=r.clientY,s.propagationPath.push(i),s},t.prototype._getShape=function(n,e){return this.canvas.getShape(n.x,n.y,e)},t.prototype._getPointInfo=function(n){var e=this.canvas,r=e.getClientByEvent(n),i=e.getPointByEvent(n);return{x:i.x,y:i.y,clientX:r.x,clientY:r.y}},t.prototype._triggerEvent=function(n,e){var r=this._getPointInfo(e),i=this._getShape(r,e),o=this["_on"+n],a=!1;if(o)o.call(this,r,i,e);else{var s=this.currentShape;n==="mouseenter"||n==="dragenter"||n==="mouseover"?(this._emitEvent(n,e,r,null,null,i),i&&this._emitEvent(n,e,r,i,null,i),n==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",e,r,null)):n==="mouseleave"||n==="dragleave"||n==="mouseout"?(a=!0,s&&this._emitEvent(n,e,r,s,s,null),this._emitEvent(n,e,r,null,s,null),n==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",e,r,null)):this._emitEvent(n,e,r,i,null,null)}if(a||(this.currentShape=i),i&&!i.get("destroyed")){var u=this.canvas,c=u.get("el");c.style.cursor=i.attr("cursor")||u.get("cursor")}},t.prototype._onmousedown=function(n,e,r){r.button===l2&&(this.mousedownShape=e,this.mousedownPoint=n,this.mousedownTimeStamp=r.timeStamp),this._emitEvent("mousedown",r,n,e,null,null)},t.prototype._emitMouseoverEvents=function(n,e,r,i){var o=this.canvas.get("el");r!==i&&(r&&(this._emitEvent("mouseout",n,e,r,r,i),this._emitEvent("mouseleave",n,e,r,r,i),(!i||i.get("destroyed"))&&(o.style.cursor=this.canvas.get("cursor"))),i&&(this._emitEvent("mouseover",n,e,i,r,i),this._emitEvent("mouseenter",n,e,i,r,i)))},t.prototype._emitDragoverEvents=function(n,e,r,i,o){i?(i!==r&&(r&&this._emitEvent("dragleave",n,e,r,r,i),this._emitEvent("dragenter",n,e,i,r,i)),o||this._emitEvent("dragover",n,e,i)):r&&this._emitEvent("dragleave",n,e,r,r,i),o&&this._emitEvent("dragover",n,e,i)},t.prototype._afterDrag=function(n,e,r){n&&(n.set("capture",!0),this.draggingShape=null),this.dragging=!1;var i=this._getShape(e,r);i!==n&&this._emitMouseoverEvents(r,e,n,i),this.currentShape=i},t.prototype._onmouseup=function(n,e,r){if(r.button===l2){var i=this.draggingShape;this.dragging?(i&&this._emitEvent("drop",r,n,e),this._emitEvent("dragend",r,n,i),this._afterDrag(i,n,r)):(this._emitEvent("mouseup",r,n,e),e===this.mousedownShape&&this._emitEvent("click",r,n,e),this.mousedownShape=null,this.mousedownPoint=null)}},t.prototype._ondragover=function(n,e,r){r.preventDefault();var i=this.currentShape;this._emitDragoverEvents(r,n,i,e,!0)},t.prototype._onmousemove=function(n,e,r){var i=this.canvas,o=this.currentShape,a=this.draggingShape;if(this.dragging)a&&this._emitDragoverEvents(r,n,o,e,!1),this._emitEvent("drag",r,n,a);else{var s=this.mousedownPoint;if(s){var u=this.mousedownShape,c=r.timeStamp,l=c-this.mousedownTimeStamp,h=s.clientX-n.clientX,f=s.clientY-n.clientY,d=h*h+f*f;l>120||d>t9?u&&u.get("draggable")?(a=this.mousedownShape,a.set("capture",!1),this.draggingShape=a,this.dragging=!0,this._emitEvent("dragstart",r,n,a),this.mousedownShape=null,this.mousedownPoint=null):!u&&i.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",r,n,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(r,n,o,e),this._emitEvent("mousemove",r,n,e)):(this._emitMouseoverEvents(r,n,o,e),this._emitEvent("mousemove",r,n,e))}else this._emitMouseoverEvents(r,n,o,e),this._emitEvent("mousemove",r,n,e)}},t.prototype._emitEvent=function(n,e,r,i,o,a){var s=this._getEventObj(n,e,r,i,o,a);if(i){s.shape=i,f2(i,n,s);for(var u=i.getParent();u;)u.emitDelegation(n,s),s.propagationStopped||e9(u,n,s),s.propagationPath.push(u),u=u.getParent()}else{var c=this.canvas;f2(c,n,s)}},t.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},t}(),d2="px",p2=jC(),r9=p2&&p2.name==="firefox",tI=function(t){Te(n,t);function n(e){var r=t.call(this,e)||this;return r.initContainer(),r.initDom(),r.initEvents(),r.initTimeline(),r}return n.prototype.getDefaultCfg=function(){var e=t.prototype.getDefaultCfg.call(this);return e.cursor="default",e.supportCSSTransform=!1,e},n.prototype.initContainer=function(){var e=this.get("container");Dt(e)&&(e=document.getElementById(e),this.set("container",e))},n.prototype.initDom=function(){var e=this.createDom();this.set("el",e);var r=this.get("container");r.appendChild(e),this.setDOMSize(this.get("width"),this.get("height"))},n.prototype.initEvents=function(){var e=new n9({canvas:this});e.init(),this.set("eventController",e)},n.prototype.initTimeline=function(){var e=new $8(this);this.set("timeline",e)},n.prototype.setDOMSize=function(e,r){var i=this.get("el");Fw&&(i.style.width=e+d2,i.style.height=r+d2)},n.prototype.changeSize=function(e,r){this.setDOMSize(e,r),this.set("width",e),this.set("height",r),this.onCanvasChange("changeSize")},n.prototype.getRenderer=function(){return this.get("renderer")},n.prototype.getCursor=function(){return this.get("cursor")},n.prototype.setCursor=function(e){this.set("cursor",e);var r=this.get("el");Fw&&r&&(r.style.cursor=e)},n.prototype.getPointByEvent=function(e){var r=this.get("supportCSSTransform");if(r){if(r9&&!fe(e.layerX)&&e.layerX!==e.offsetX)return{x:e.layerX,y:e.layerY};if(!fe(e.offsetX))return{x:e.offsetX,y:e.offsetY}}var i=this.getClientByEvent(e),o=i.x,a=i.y;return this.getPointByClient(o,a)},n.prototype.getClientByEvent=function(e){var r=e;return e.touches&&(e.type==="touchend"?r=e.changedTouches[0]:r=e.touches[0]),{x:r.clientX,y:r.clientY}},n.prototype.getPointByClient=function(e,r){var i=this.get("el"),o=i.getBoundingClientRect();return{x:e-o.left,y:r-o.top}},n.prototype.getClientByPoint=function(e,r){var i=this.get("el"),o=i.getBoundingClientRect();return{x:e+o.left,y:r+o.top}},n.prototype.draw=function(){},n.prototype.removeDom=function(){var e=this.get("el");e.parentNode.removeChild(e)},n.prototype.clearEvents=function(){var e=this.get("eventController");e.destroy()},n.prototype.isCanvas=function(){return!0},n.prototype.getParent=function(){return null},n.prototype.destroy=function(){var e=this.get("timeline");this.get("destroyed")||(this.clear(),e&&e.stop(),this.clearEvents(),this.removeDom(),t.prototype.destroy.call(this))},n}(GC),eI=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.isGroup=function(){return!0},n.prototype.isEntityGroup=function(){return!1},n.prototype.clone=function(){for(var e=t.prototype.clone.call(this),r=this.getChildren(),i=0;i<r.length;i++){var o=r[i];e.add(o.clone())}return e},n}(GC),nI=function(t){Te(n,t);function n(e){return t.call(this,e)||this}return n.prototype._isInBBox=function(e,r){var i=this.getBBox();return i.minX<=e&&i.maxX>=e&&i.minY<=r&&i.maxY>=r},n.prototype.afterAttrsChange=function(e){t.prototype.afterAttrsChange.call(this,e),this.clearCacheBBox()},n.prototype.getBBox=function(){var e=this.cfg.bbox;return e||(e=this.calculateBBox(),this.set("bbox",e)),e},n.prototype.getCanvasBBox=function(){var e=this.cfg.canvasBBox;return e||(e=this.calculateCanvasBBox(),this.set("canvasBBox",e)),e},n.prototype.applyMatrix=function(e){t.prototype.applyMatrix.call(this,e),this.set("canvasBBox",null)},n.prototype.calculateCanvasBBox=function(){var e=this.getBBox(),r=this.getTotalMatrix(),i=e.minX,o=e.minY,a=e.maxX,s=e.maxY;if(r){var u=ds(r,[e.minX,e.minY]),c=ds(r,[e.maxX,e.minY]),l=ds(r,[e.minX,e.maxY]),h=ds(r,[e.maxX,e.maxY]);i=Math.min(u[0],c[0],l[0],h[0]),a=Math.max(u[0],c[0],l[0],h[0]),o=Math.min(u[1],c[1],l[1],h[1]),s=Math.max(u[1],c[1],l[1],h[1])}var f=this.attrs;if(f.shadowColor){var d=f.shadowBlur,p=d===void 0?0:d,g=f.shadowOffsetX,v=g===void 0?0:g,m=f.shadowOffsetY,y=m===void 0?0:m,b=i-p+v,x=a+p+v,w=o-p+y,E=s+p+y;i=Math.min(i,b),a=Math.max(a,x),o=Math.min(o,w),s=Math.max(s,E)}return{x:i,y:o,minX:i,minY:o,maxX:a,maxY:s,width:a-i,height:s-o}},n.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},n.prototype.isClipShape=function(){return this.get("isClipShape")},n.prototype.isInShape=function(e,r){return!1},n.prototype.isOnlyHitBox=function(){return!1},n.prototype.isHit=function(e,r){var i=this.get("startArrowShape"),o=this.get("endArrowShape"),a=[e,r,1];a=this.invertFromMatrix(a);var s=a[0],u=a[1],c=this._isInBBox(s,u);return this.isOnlyHitBox()?c:!!(c&&!this.isClipped(s,u)&&(this.isInShape(s,u)||i&&i.isHit(s,u)||o&&o.isHit(s,u)))},n}(FC),rI=new Map;function yo(t,n){rI.set(t,n)}function iI(t){return rI.get(t)}function oI(t){var n=t.attr(),e=n.x,r=n.y,i=n.width,o=n.height;return{x:e,y:r,width:i,height:o}}function aI(t){var n=t.attr(),e=n.x,r=n.y,i=n.r;return{x:e-i,y:r-i,width:i*2,height:i*2}}function Ar(t,n,e,r){var i=t-e,o=n-r;return Math.sqrt(i*i+o*o)}function Qf(t,n){return Math.abs(t-n)<.001}function Ju(t,n){var e=go(t),r=go(n),i=po(t),o=po(n);return{x:e,y:r,width:i-e,height:o-r}}function gp(t){return(t+Math.PI*2)%(Math.PI*2)}const mr={box:function(t,n,e,r){return Ju([t,e],[n,r])},length:function(t,n,e,r){return Ar(t,n,e,r)},pointAt:function(t,n,e,r,i){return{x:(1-i)*t+i*e,y:(1-i)*n+i*r}},pointDistance:function(t,n,e,r,i,o){var a=(e-t)*(i-t)+(r-n)*(o-n);if(a<0)return Ar(t,n,i,o);var s=(e-t)*(e-t)+(r-n)*(r-n);return a>s?Ar(e,r,i,o):this.pointToLine(t,n,e,r,i,o)},pointToLine:function(t,n,e,r,i,o){var a=[e-t,r-n];if(My(a,[0,0]))return Math.sqrt((i-t)*(i-t)+(o-n)*(o-n));var s=[-a[1],a[0]];_a(s,s);var u=[i-t,o-n];return Math.abs(Ey(u,s))},tangentAngle:function(t,n,e,r){return Math.atan2(r-n,e-t)}};var i9=1e-4;function sI(t,n,e,r,i,o){var a,s=1/0,u=[e,r],c=20;o&&o>200&&(c=o/10);for(var l=1/c,h=l/10,f=0;f<=c;f++){var d=f*l,p=[i.apply(null,t.concat([d])),i.apply(null,n.concat([d]))],g=Ar(u[0],u[1],p[0],p[1]);g<s&&(a=d,s=g)}if(a===0)return{x:t[0],y:n[0]};if(a===1){var v=t.length;return{x:t[v-1],y:n[v-1]}}s=1/0;for(var f=0;f<32&&!(h<i9);f++){var m=a-h,y=a+h,p=[i.apply(null,t.concat([m])),i.apply(null,n.concat([m]))],g=Ar(u[0],u[1],p[0],p[1]);if(m>=0&&g<s)a=m,s=g;else{var b=[i.apply(null,t.concat([y])),i.apply(null,n.concat([y]))],x=Ar(u[0],u[1],b[0],b[1]);y<=1&&x<s?(a=y,s=x):h*=.5}}return{x:i.apply(null,t.concat([a])),y:i.apply(null,n.concat([a]))}}function o9(t,n){for(var e=0,r=t.length,i=0;i<r;i++){var o=t[i],a=n[i],s=t[(i+1)%r],u=n[(i+1)%r];e+=Ar(o,a,s,u)}return e/2}function ma(t,n,e,r){var i=1-r;return i*i*t+2*r*i*n+r*r*e}function g2(t,n,e){var r=t+e-2*n;if(Qf(r,0))return[.5];var i=(t-n)/r;return i<=1&&i>=0?[i]:[]}function v2(t,n,e,r){return 2*(1-r)*(n-t)+2*r*(e-n)}function uI(t,n,e,r,i,o,a){var s=ma(t,e,i,a),u=ma(n,r,o,a),c=mr.pointAt(t,n,e,r,a),l=mr.pointAt(e,r,i,o,a);return[[t,n,c.x,c.y,s,u],[s,u,l.x,l.y,i,o]]}function Vv(t,n,e,r,i,o,a){if(a===0)return(Ar(t,n,e,r)+Ar(e,r,i,o)+Ar(t,n,i,o))/2;var s=uI(t,n,e,r,i,o,.5),u=s[0],c=s[1];return u.push(a-1),c.push(a-1),Vv.apply(null,u)+Vv.apply(null,c)}const cI={box:function(t,n,e,r,i,o){var a=g2(t,e,i)[0],s=g2(n,r,o)[0],u=[t,i],c=[n,o];return a!==void 0&&u.push(ma(t,e,i,a)),s!==void 0&&c.push(ma(n,r,o,s)),Ju(u,c)},length:function(t,n,e,r,i,o){return Vv(t,n,e,r,i,o,3)},nearestPoint:function(t,n,e,r,i,o,a,s){return sI([t,e,i],[n,r,o],a,s,ma)},pointDistance:function(t,n,e,r,i,o,a,s){var u=this.nearestPoint(t,n,e,r,i,o,a,s);return Ar(u.x,u.y,a,s)},interpolationAt:ma,pointAt:function(t,n,e,r,i,o,a){return{x:ma(t,e,i,a),y:ma(n,r,o,a)}},divide:function(t,n,e,r,i,o,a){return uI(t,n,e,r,i,o,a)},tangentAngle:function(t,n,e,r,i,o,a){var s=v2(t,e,i,a),u=v2(n,r,o,a),c=Math.atan2(u,s);return gp(c)}};function ya(t,n,e,r,i){var o=1-i;return o*o*o*t+3*n*i*o*o+3*e*i*i*o+r*i*i*i}function m2(t,n,e,r,i){var o=1-i;return 3*(o*o*(n-t)+2*o*i*(e-n)+i*i*(r-e))}function w0(t,n,e,r){var i=-3*t+9*n-9*e+3*r,o=6*t-12*n+6*e,a=3*n-3*t,s=[],u,c,l;if(Qf(i,0))Qf(o,0)||(u=-a/o,u>=0&&u<=1&&s.push(u));else{var h=o*o-4*i*a;Qf(h,0)?s.push(-o/(2*i)):h>0&&(l=Math.sqrt(h),u=(-o+l)/(2*i),c=(-o-l)/(2*i),u>=0&&u<=1&&s.push(u),c>=0&&c<=1&&s.push(c))}return s}function lI(t,n,e,r,i,o,a,s,u){var c=ya(t,e,i,a,u),l=ya(n,r,o,s,u),h=mr.pointAt(t,n,e,r,u),f=mr.pointAt(e,r,i,o,u),d=mr.pointAt(i,o,a,s,u),p=mr.pointAt(h.x,h.y,f.x,f.y,u),g=mr.pointAt(f.x,f.y,d.x,d.y,u);return[[t,n,h.x,h.y,p.x,p.y,c,l],[c,l,g.x,g.y,d.x,d.y,a,s]]}function Wv(t,n,e,r,i,o,a,s,u){if(u===0)return o9([t,e,i,a],[n,r,o,s]);var c=lI(t,n,e,r,i,o,a,s,.5),l=c[0],h=c[1];return l.push(u-1),h.push(u-1),Wv.apply(null,l)+Wv.apply(null,h)}const Qc={extrema:w0,box:function(t,n,e,r,i,o,a,s){for(var u=[t,a],c=[n,s],l=w0(t,e,i,a),h=w0(n,r,o,s),f=0;f<l.length;f++)u.push(ya(t,e,i,a,l[f]));for(var f=0;f<h.length;f++)c.push(ya(n,r,o,s,h[f]));return Ju(u,c)},length:function(t,n,e,r,i,o,a,s){return Wv(t,n,e,r,i,o,a,s,3)},nearestPoint:function(t,n,e,r,i,o,a,s,u,c,l){return sI([t,e,i,a],[n,r,o,s],u,c,ya,l)},pointDistance:function(t,n,e,r,i,o,a,s,u,c,l){var h=this.nearestPoint(t,n,e,r,i,o,a,s,u,c,l);return Ar(h.x,h.y,u,c)},interpolationAt:ya,pointAt:function(t,n,e,r,i,o,a,s,u){return{x:ya(t,e,i,a,u),y:ya(n,r,o,s,u)}},divide:function(t,n,e,r,i,o,a,s,u){return lI(t,n,e,r,i,o,a,s,u)},tangentAngle:function(t,n,e,r,i,o,a,s,u){var c=m2(t,e,i,a,u),l=m2(n,r,o,s,u);return gp(Math.atan2(l,c))}};function y2(t,n){var e=Math.abs(t);return n>0?e:e*-1}const a9={box:function(t,n,e,r){return{x:t-e,y:n-r,width:e*2,height:r*2}},length:function(t,n,e,r){return Math.PI*(3*(e+r)-Math.sqrt((3*e+r)*(e+3*r)))},nearestPoint:function(t,n,e,r,i,o){var a=e,s=r;if(a===0||s===0)return{x:t,y:n};for(var u=i-t,c=o-n,l=Math.abs(u),h=Math.abs(c),f=a*a,d=s*s,p=Math.PI/4,g,v,m=0;m<4;m++){g=a*Math.cos(p),v=s*Math.sin(p);var y=(f-d)*Math.pow(Math.cos(p),3)/a,b=(d-f)*Math.pow(Math.sin(p),3)/s,x=g-y,w=v-b,E=l-y,M=h-b,_=Math.hypot(w,x),k=Math.hypot(M,E),S=_*Math.asin((x*M-w*E)/(_*k)),A=S/Math.sqrt(f+d-g*g-v*v);p+=A,p=Math.min(Math.PI/2,Math.max(0,p))}return{x:t+y2(g,u),y:n+y2(v,c)}},pointDistance:function(t,n,e,r,i,o){var a=this.nearestPoint(t,n,e,r,i,o);return Ar(a.x,a.y,i,o)},pointAt:function(t,n,e,r,i){var o=2*Math.PI*i;return{x:t+e*Math.cos(o),y:n+r*Math.sin(o)}},tangentAngle:function(t,n,e,r,i){var o=2*Math.PI*i,a=Math.atan2(r*Math.cos(o),-e*Math.sin(o));return gp(a)}};function s9(t,n,e,r,i,o,a,s){return-1*e*Math.cos(i)*Math.sin(s)-r*Math.sin(i)*Math.cos(s)}function u9(t,n,e,r,i,o,a,s){return-1*e*Math.sin(i)*Math.sin(s)+r*Math.cos(i)*Math.cos(s)}function c9(t,n,e){return Math.atan(-n/t*Math.tan(e))}function l9(t,n,e){return Math.atan(n/(t*Math.tan(e)))}function b2(t,n,e,r,i,o){return e*Math.cos(i)*Math.cos(o)-r*Math.sin(i)*Math.sin(o)+t}function x2(t,n,e,r,i,o){return e*Math.sin(i)*Math.cos(o)+r*Math.cos(i)*Math.sin(o)+n}function h9(t,n,e,r){var i=Math.atan2(r*t,e*n);return(i+Math.PI*2)%(Math.PI*2)}function w2(t,n,e){return{x:t*Math.cos(e),y:n*Math.sin(e)}}function E2(t,n,e){var r=Math.cos(e),i=Math.sin(e);return[t*r-n*i,t*i+n*r]}const f9={box:function(t,n,e,r,i,o,a){for(var s=c9(e,r,i),u=1/0,c=-1/0,l=[o,a],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var f=s+h;o<a?o<f&&f<a&&l.push(f):a<f&&f<o&&l.push(f)}for(var h=0;h<l.length;h++){var d=b2(t,n,e,r,i,l[h]);d<u&&(u=d),d>c&&(c=d)}for(var p=l9(e,r,i),g=1/0,v=-1/0,m=[o,a],h=-Math.PI*2;h<=Math.PI*2;h+=Math.PI){var y=p+h;o<a?o<y&&y<a&&m.push(y):a<y&&y<o&&m.push(y)}for(var h=0;h<m.length;h++){var b=x2(t,n,e,r,i,m[h]);b<g&&(g=b),b>v&&(v=b)}return{x:u,y:g,width:c-u,height:v-g}},length:function(t,n,e,r,i,o,a){},nearestPoint:function(t,n,e,r,i,o,a,s,u){var c=E2(s-t,u-n,-i),l=c[0],h=c[1],f=a9.nearestPoint(0,0,e,r,l,h),d=h9(e,r,f.x,f.y);d<o?f=w2(e,r,o):d>a&&(f=w2(e,r,a));var p=E2(f.x,f.y,i);return{x:p[0]+t,y:p[1]+n}},pointDistance:function(t,n,e,r,i,o,a,s,u){var c=this.nearestPoint(t,n,e,r,s,u);return Ar(c.x,c.y,s,u)},pointAt:function(t,n,e,r,i,o,a,s){var u=(a-o)*s+o;return{x:b2(t,n,e,r,i,u),y:x2(t,n,e,r,i,u)}},tangentAngle:function(t,n,e,r,i,o,a,s){var u=(a-o)*s+o,c=s9(t,n,e,r,i,o,a,u),l=u9(t,n,e,r,i,o,a,u);return gp(Math.atan2(l,c))}};function hI(t){for(var n=0,e=[],r=0;r<t.length-1;r++){var i=t[r],o=t[r+1],a=Ar(i[0],i[1],o[0],o[1]),s={from:i,to:o,length:a};e.push(s),n+=a}return{segments:e,totalLength:n}}function d9(t){if(t.length<2)return 0;for(var n=0,e=0;e<t.length-1;e++){var r=t[e],i=t[e+1];n+=Ar(r[0],r[1],i[0],i[1])}return n}function p9(t,n){if(n>1||n<0||t.length<2)return null;var e=hI(t),r=e.segments,i=e.totalLength;if(i===0)return{x:t[0][0],y:t[0][1]};for(var o=0,a=null,s=0;s<r.length;s++){var u=r[s],c=u.from,l=u.to,h=u.length/i;if(n>=o&&n<=o+h){var f=(n-o)/h;a=mr.pointAt(c[0],c[1],l[0],l[1],f);break}o+=h}return a}function g9(t,n){if(n>1||n<0||t.length<2)return 0;for(var e=hI(t),r=e.segments,i=e.totalLength,o=0,a=0,s=0;s<r.length;s++){var u=r[s],c=u.from,l=u.to,h=u.length/i;if(n>=o&&n<=o+h){a=Math.atan2(l[1]-c[1],l[0]-c[0]);break}o+=h}return a}function v9(t,n,e){for(var r=1/0,i=0;i<t.length-1;i++){var o=t[i],a=t[i+1],s=mr.pointDistance(o[0],o[1],a[0],a[1],n,e);s<r&&(r=s)}return r}const fI={box:function(t){for(var n=[],e=[],r=0;r<t.length;r++){var i=t[r];n.push(i[0]),e.push(i[1])}return Ju(n,e)},length:function(t){return d9(t)},pointAt:function(t,n){return p9(t,n)},pointDistance:function(t,n,e){return v9(t,n,e)},tangentAngle:function(t,n){return g9(t,n)}};function M2(t,n){return!t||!n?t||n:{minX:Math.min(t.minX,n.minX),minY:Math.min(t.minY,n.minY),maxX:Math.max(t.maxX,n.maxX),maxY:Math.max(t.maxY,n.maxY)}}function Uy(t,n){var e=t.get("startArrowShape"),r=t.get("endArrowShape"),i=null,o=null;return e&&(i=e.getCanvasBBox(),n=M2(n,i)),r&&(o=r.getCanvasBBox(),n=M2(n,o)),n}function m9(t){for(var n=t.attr(),e=n.points,r=[],i=[],o=0;o<e.length;o++){var a=e[o];r.push(a[0]),i.push(a[1])}var s=Ju(r,i),u=s.x,c=s.y,l=s.width,h=s.height,f={minX:u,minY:c,maxX:u+l,maxY:c+h};return f=Uy(t,f),{x:f.minX,y:f.minY,width:f.maxX-f.minX,height:f.maxY-f.minY}}function y9(t){for(var n=t.attr(),e=n.points,r=[],i=[],o=0;o<e.length;o++){var a=e[o];r.push(a[0]),i.push(a[1])}return Ju(r,i)}var E0=null;function dI(){if(!E0){var t=document.createElement("canvas");t.width=1,t.height=1,E0=t.getContext("2d")}return E0}function pI(t,n,e){var r=1;if(Dt(t)&&(r=t.split(`
`).length),r>1){var i=b9(n,e);return n*r+i*(r-1)}return n}function b9(t,n){return n?n-t:t*.14}function x9(t,n){var e=dI(),r=0;if(fe(t)||t==="")return r;if(e.save(),e.font=n,Dt(t)&&t.includes(`
`)){var i=t.split(`
`);mt(i,function(o){var a=e.measureText(o).width;r<a&&(r=a)})}else r=e.measureText(t).width;return e.restore(),r}function gI(t){var n=t.fontSize,e=t.fontFamily,r=t.fontWeight,i=t.fontStyle,o=t.fontVariant;return[i,o,r,n+"px",e].join(" ").trim()}function w9(t){var n=t.attr(),e=n.x,r=n.y,i=n.text,o=n.fontSize,a=n.lineHeight,s=n.font;s||(s=gI(n));var u=x9(i,s),c;if(!u)c={x:e,y:r,width:0,height:0};else{var l=n.textAlign,h=n.textBaseline,f=pI(i,o,a),d={x:e,y:r-f};l&&(l==="end"||l==="right"?d.x-=u:l==="center"&&(d.x-=u/2)),h&&(h==="top"?d.y+=f:h==="middle"&&(d.y+=f/2)),c={x:d.x,y:d.y,width:u,height:f}}return c}var E9=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,M9=/[^\s\,]+/ig;function S9(t){var n=t||[];if(ve(n))return n;if(Dt(n))return n=n.match(E9),mt(n,function(e,r){if(e=e.match(M9),e[0].length>1){var i=e[0].charAt(0);e.splice(1,0,e[0].substr(1)),e[0]=i}mt(e,function(o,a){isNaN(o)||(e[a]=+o)}),n[r]=e}),n}function _9(t,n,e,r){var i=[],o=!!r,a,s,u,c,l,h,f;if(o){u=r[0],c=r[1];for(var d=0,p=t.length;d<p;d+=1){var g=t[d];u=pa([0,0],u,g),c=ga([0,0],c,g)}}for(var d=0,v=t.length;d<v;d+=1){var g=t[d];if(d===0&&!e)f=g;else if(d===v-1&&!e)h=g,i.push(f),i.push(h);else{var m=[d?d-1:v-1,d-1][e?0:1];a=t[m],s=t[e?(d+1)%v:d+1];var y=[0,0];y=Wf(y,s,a),y=kr(y,y,n);var b=yd(g,a),x=yd(g,s),w=b+x;w!==0&&(b/=w,x/=w);var E=kr([0,0],y,-b),M=kr([0,0],y,x);h=pr([0,0],g,E),l=pr([0,0],g,M),l=pa([0,0],l,ga([0,0],s,g)),l=ga([0,0],l,pa([0,0],s,g)),E=Wf([0,0],l,g),E=kr([0,0],E,-b/x),h=pr([0,0],g,E),h=pa([0,0],h,ga([0,0],a,g)),h=ga([0,0],h,pa([0,0],a,g)),M=Wf([0,0],g,h),M=kr([0,0],M,x/b),l=pr([0,0],g,M),o&&(h=ga([0,0],h,u),h=pa([0,0],h,c),l=ga([0,0],l,u),l=pa([0,0],l,c)),i.push(f),i.push(h),f=l}}return e&&i.push(i.shift()),i}function vI(t,n,e){n===void 0&&(n=!1),e===void 0&&(e=[[0,0],[1,1]]);for(var r=!!n,i=[],o=0,a=t.length;o<a;o+=2)i.push([t[o],t[o+1]]);for(var s=_9(i,.4,r,e),u=i.length,c=[],l,h,f,o=0;o<u-1;o+=1)l=s[o*2],h=s[o*2+1],f=i[o+1],c.push(["C",l[0],l[1],h[0],h[1],f[0],f[1]]);return r&&(l=s[u],h=s[u+1],f=i[0],c.push(["C",l[0],l[1],h[0],h[1],f[0],f[1]])),c}var Jc=`	
\v\f\r   ᠎             　\u2028\u2029`,k9=new RegExp("([a-z])["+Jc+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Jc+"]*,?["+Jc+"]*)+)","ig"),A9=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Jc+"]*,?["+Jc+"]*","ig");function Xv(t){if(!t)return null;if(ve(t))return t;var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},e=[];return String(t).replace(k9,function(r,i,o){var a=[],s=i.toLowerCase();if(o.replace(A9,function(u,c){c&&a.push(+c)}),s==="m"&&a.length>2&&(e.push([i].concat(a.splice(0,2))),s="l",i=i==="m"?"l":"L"),s==="o"&&a.length===1&&e.push([i,a[0]]),s==="r")e.push([i].concat(a));else for(;a.length>=n[s]&&(e.push([i].concat(a.splice(0,n[s]))),!!n[s]););return""}),e}var C9=/[a-z]/;function S2(t,n){return[n[0]+(n[0]-t[0]),n[1]+(n[1]-t[1])]}function mI(t){var n=Xv(t);if(!n||!n.length)return[["M",0,0]];for(var e=!1,r=0;r<n.length;r++){var i=n[r][0];if(C9.test(i)||["V","H","T","S"].indexOf(i)>=0){e=!0;break}}if(!e)return n;var o=[],a=0,s=0,u=0,c=0,l=0,h=n[0];(h[0]==="M"||h[0]==="m")&&(a=+h[1],s=+h[2],u=a,c=s,l++,o[0]=["M",a,s]);for(var r=l,f=n.length;r<f;r++){var d=n[r],p=o[r-1],g=[],i=d[0],v=i.toUpperCase();if(i!==v)switch(g[0]=v,v){case"A":g[1]=d[1],g[2]=d[2],g[3]=d[3],g[4]=d[4],g[5]=d[5],g[6]=+d[6]+a,g[7]=+d[7]+s;break;case"V":g[1]=+d[1]+s;break;case"H":g[1]=+d[1]+a;break;case"M":u=+d[1]+a,c=+d[2]+s,g[1]=u,g[2]=c;break;default:for(var m=1,y=d.length;m<y;m++)g[m]=+d[m]+(m%2?a:s)}else g=n[r];switch(v){case"Z":a=+u,s=+c;break;case"H":a=g[1],g=["L",a,s];break;case"V":s=g[1],g=["L",a,s];break;case"T":a=g[1],s=g[2];var b=S2([p[1],p[2]],[p[3],p[4]]);g=["Q",b[0],b[1],a,s];break;case"S":a=g[g.length-2],s=g[g.length-1];var x=p.length,w=S2([p[x-4],p[x-3]],[p[x-2],p[x-1]]);g=["C",w[0],w[1],g[1],g[2],a,s];break;case"M":u=g[g.length-2],c=g[g.length-1];break;default:a=g[g.length-2],s=g[g.length-1]}o.push(g)}return o}function tf(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Hv(t,n){return tf(t)*tf(n)?(t[0]*n[0]+t[1]*n[1])/(tf(t)*tf(n)):1}function _2(t,n){return(t[0]*n[1]<t[1]*n[0]?-1:1)*Math.acos(Hv(t,n))}function qv(t,n){return t[0]===n[0]&&t[1]===n[1]}function I9(t,n){var e=n[1],r=n[2],i=up(cp(n[3]),Math.PI*2),o=n[4],a=n[5],s=t[0],u=t[1],c=n[6],l=n[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(u-l)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(u-l)/2,d=h*h/(e*e)+f*f/(r*r);d>1&&(e*=Math.sqrt(d),r*=Math.sqrt(d));var p=e*e*(f*f)+r*r*(h*h),g=p?Math.sqrt((e*e*(r*r)-p)/p):1;o===a&&(g*=-1),isNaN(g)&&(g=0);var v=r?g*e*f/r:0,m=e?g*-r*h/e:0,y=(s+c)/2+Math.cos(i)*v-Math.sin(i)*m,b=(u+l)/2+Math.sin(i)*v+Math.cos(i)*m,x=[(h-v)/e,(f-m)/r],w=[(-1*h-v)/e,(-1*f-m)/r],E=_2([1,0],x),M=_2(x,w);return Hv(x,w)<=-1&&(M=Math.PI),Hv(x,w)>=1&&(M=0),a===0&&M>0&&(M=M-2*Math.PI),a===1&&M<0&&(M=M+2*Math.PI),{cx:y,cy:b,rx:qv(t,[c,l])?0:e,ry:qv(t,[c,l])?0:r,startAngle:E,endAngle:E+M,xRotation:i,arcFlag:o,sweepFlag:a}}function k2(t,n){return[n[0]+(n[0]-t[0]),n[1]+(n[1]-t[1])]}function yI(t){t=S9(t);for(var n=[],e=null,r=null,i=null,o=0,a=t.length,s=0;s<a;s++){var u=t[s];r=t[s+1];var c=u[0],l={command:c,prePoint:e,params:u,startTangent:null,endTangent:null};switch(c){case"M":i=[u[1],u[2]],o=s;break;case"A":var h=I9(e,u);l.arcParams=h;break}if(c==="Z")e=i,r=t[o+1];else{var f=u.length;e=[u[f-2],u[f-1]]}r&&r[0]==="Z"&&(r=t[o],n[o]&&(n[o].prePoint=e)),l.currentPoint=e,n[o]&&qv(e,n[o].currentPoint)&&(n[o].prePoint=l.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;l.nextPoint=d;var p=l.prePoint;if(["L","H","V"].includes(c))l.startTangent=[p[0]-e[0],p[1]-e[1]],l.endTangent=[e[0]-p[0],e[1]-p[1]];else if(c==="Q"){var g=[u[1],u[2]];l.startTangent=[p[0]-g[0],p[1]-g[1]],l.endTangent=[e[0]-g[0],e[1]-g[1]]}else if(c==="T"){var v=n[s-1],g=k2(v.currentPoint,p);v.command==="Q"?(l.command="Q",l.startTangent=[p[0]-g[0],p[1]-g[1]],l.endTangent=[e[0]-g[0],e[1]-g[1]]):(l.command="TL",l.startTangent=[p[0]-e[0],p[1]-e[1]],l.endTangent=[e[0]-p[0],e[1]-p[1]])}else if(c==="C"){var m=[u[1],u[2]],y=[u[3],u[4]];l.startTangent=[p[0]-m[0],p[1]-m[1]],l.endTangent=[e[0]-y[0],e[1]-y[1]],l.startTangent[0]===0&&l.startTangent[1]===0&&(l.startTangent=[m[0]-y[0],m[1]-y[1]]),l.endTangent[0]===0&&l.endTangent[1]===0&&(l.endTangent=[y[0]-m[0],y[1]-m[1]])}else if(c==="S"){var v=n[s-1],m=k2(v.currentPoint,p),y=[u[1],u[2]];v.command==="C"?(l.command="C",l.startTangent=[p[0]-m[0],p[1]-m[1]],l.endTangent=[e[0]-y[0],e[1]-y[1]]):(l.command="SQ",l.startTangent=[p[0]-y[0],p[1]-y[1]],l.endTangent=[e[0]-y[0],e[1]-y[1]])}else if(c==="A"){var b=.001,x=l.arcParams||{},w=x.cx,E=w===void 0?0:w,M=x.cy,_=M===void 0?0:M,k=x.rx,S=k===void 0?0:k,A=x.ry,C=A===void 0?0:A,I=x.sweepFlag,N=I===void 0?0:I,D=x.startAngle,P=D===void 0?0:D,j=x.endAngle,L=j===void 0?0:j;N===0&&(b*=-1);var R=S*Math.cos(P-b)+E,V=C*Math.sin(P-b)+_;l.startTangent=[R-i[0],V-i[1]];var tt=S*Math.cos(P+L+b)+E,ut=C*Math.sin(P+L-b)+_;l.endTangent=[p[0]-tt,p[1]-ut]}n.push(l)}return n}function T9(t,n){for(var e=[],r=[],i=[],o=0;o<t.length;o++){var a=t[o],s=a.currentPoint,u=a.params,c=a.prePoint,l=void 0;switch(a.command){case"Q":l=cI.box(c[0],c[1],u[1],u[2],u[3],u[4]);break;case"C":l=Qc.box(c[0],c[1],u[1],u[2],u[3],u[4],u[5],u[6]);break;case"A":var h=a.arcParams;l=f9.box(h.cx,h.cy,h.rx,h.ry,h.xRotation,h.startAngle,h.endAngle);break;default:e.push(s[0]),r.push(s[1]);break}l&&(a.box=l,e.push(l.x,l.x+l.width),r.push(l.y,l.y+l.height)),n&&(a.command==="L"||a.command==="M")&&a.prePoint&&a.nextPoint&&i.push(a)}e=e.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0}),r=r.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0});var f=go(e),d=go(r),p=po(e),g=po(r);if(i.length===0)return{x:f,y:d,width:p-f,height:g-d};for(var o=0;o<i.length;o++){var a=i[o],s=a.currentPoint,v=void 0;s[0]===f?(v=ef(a,n),f=f-v.xExtra):s[0]===p&&(v=ef(a,n),p=p+v.xExtra),s[1]===d?(v=ef(a,n),d=d-v.yExtra):s[1]===g&&(v=ef(a,n),g=g+v.yExtra)}return{x:f,y:d,width:p-f,height:g-d}}function ef(t,n){var e=t.prePoint,r=t.currentPoint,i=t.nextPoint,o=Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2),a=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2),u=Math.acos((o+a-s)/(2*Math.sqrt(o)*Math.sqrt(a)));if(!u||Math.sin(u)===0||xk(u,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),l=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));c=c>Math.PI/2?Math.PI-c:c,l=l>Math.PI/2?Math.PI-l:l;var h={xExtra:Math.cos(u/2-c)*(n/2*(1/Math.sin(u/2)))-n/2||0,yExtra:Math.cos(l-u/2)*(n/2*(1/Math.sin(u/2)))-n/2||0};return h}function O9(t){var n=t.attr(),e=n.path,r=n.stroke,i=r?n.lineWidth:0,o=t.get("segments")||yI(e),a=T9(o,i),s=a.x,u=a.y,c=a.width,l=a.height,h={minX:s,minY:u,maxX:s+c,maxY:u+l};return h=Uy(t,h),{x:h.minX,y:h.minY,width:h.maxX-h.minX,height:h.maxY-h.minY}}function N9(t){var n=t.attr(),e=n.x1,r=n.y1,i=n.x2,o=n.y2,a=Math.min(e,i),s=Math.max(e,i),u=Math.min(r,o),c=Math.max(r,o),l={minX:a,maxX:s,minY:u,maxY:c};return l=Uy(t,l),{x:l.minX,y:l.minY,width:l.maxX-l.minX,height:l.maxY-l.minY}}function D9(t){var n=t.attr(),e=n.x,r=n.y,i=n.rx,o=n.ry;return{x:e-i,y:r-o,width:i*2,height:o*2}}yo("rect",oI);yo("image",oI);yo("circle",aI);yo("marker",aI);yo("polyline",m9);yo("polygon",y9);yo("text",w9);yo("path",O9);yo("line",N9);yo("ellipse",D9);var P9=function(t){Te(n,t);function n(e,r){var i=t.call(this,e,r)||this;return i.item=r.item,i.canvasX=r.canvasX,i.canvasY=r.canvasY,i.wheelDelta=r.wheelDelta,i.detail=r.detail,i}return n}(DC),Zv=function(t){return"".concat(t,"-").concat(Math.random()).concat(Date.now())},Yy=function(t){if(ve(t))switch(t.length){case 4:return t;case 3:return t.push(t[1]),t;case 2:return t.concat(t);case 1:return[t[0],t[0],t[0],t[0]];default:return[0,0,0,0]}if(pe(t))return[t,t,t,t];if(Dt(t)){var n=parseInt(t,10);return[n,n,n,n]}return[0,0,0,0]},L9=function(t){var n=new P9(t.type,t);return n.clientX=t.clientX,n.clientY=t.clientY,n.x=t.x,n.y=t.y,n.target=t.target,n.currentTarget=t.currentTarget,n.bubbles=!0,n.item=t.item,n},j9=function(t){if(!t)return!1;for(var n=9,e=[1,0,0,0,1,0,0,0,1],r=0;r<n;r++)if(t[r]!==e[r])return!0;return!1},eo=function(t){return Number.isNaN(Number(t))},bI=function(t){for(var n=1/0,e=-1/0,r=1/0,i=-1/0,o=0;o<t.length;o++){var a=t[o],s=a.getBBox(),u=s.minX,c=s.minY,l=s.maxX,h=s.maxY;u<n&&(n=u),c<r&&(r=c),l>e&&(e=l),h>i&&(i=h)}var f=Math.floor(n),d=Math.floor(r),p=Math.ceil(e)-Math.floor(n),g=Math.ceil(i)-Math.floor(r);return{x:f,y:d,width:p,height:g,minX:n,minY:r,maxX:e,maxY:i}},R9=function(t,n,e,r,i){n===void 0&&(n=15),e===void 0&&(e="quadratic"),r===void 0&&(r=void 0),i===void 0&&(i=void 0);for(var o=t.length,a=n*2,s=["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left"],u={},c=[],l={},h=0;h<o;h++){var f=t[h],d=f.source,p=f.target,g="".concat(d,"-").concat(p);if(!c[h]){u[g]||(u[g]=[]),c[h]=!0,u[g].push(f);for(var v=0;v<o;v++)if(h!==v){var m=t[v],y=m.source,b=m.target;c[v]||(d===b&&p===y?(u[g].push(m),c[v]=!0,l["".concat(y,"|").concat(b,"|").concat(u[g].length-1)]=!0):d===y&&p===b&&(u[g].push(m),c[v]=!0))}}}for(var x in u)for(var w=u[x],E=w.length,M=0;M<E;M++){var _=w[M];if(_.source===_.target){i&&(_.type=i),_.loopCfg={position:s[M%8],dist:Math.floor(M/8)*20+50};continue}if(E===1&&r&&_.source!==_.target){_.type=r;continue}_.type=e;var k=(M%2===0?1:-1)*(l["".concat(_.source,"|").concat(_.target,"|").concat(M)]?-1:1);E%2===1?_.curveOffset=k*Math.ceil(M/2)*a:_.curveOffset=k*(Math.floor(M/2)*a+n)}return t};const F9=Object.freeze(Object.defineProperty({__proto__:null,calculationItemsBBox:bI,cloneEvent:L9,formatPadding:Yy,isNaN:eo,isViewportChanged:j9,processParallelEdges:R9,uniqueId:Zv},Symbol.toStringTag,{value:"Module"}));var bt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function xo(t){if(t.__esModule)return t;var n=t.default;if(typeof n=="function"){var e=function r(){if(this instanceof r){var i=[null];i.push.apply(i,arguments);var o=Function.bind.apply(n,i);return new o}return n.apply(this,arguments)};e.prototype=n.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),e}var La={};const B9=xo(hB);Object.defineProperty(La,"__esModule",{value:!0});var Ia=B9;function xI(t,n,e){var r=[0,0,0,0,0,0,0,0,0];return Ia.mat3.fromTranslation(r,e),Ia.mat3.multiply(t,r,n)}La.leftTranslate=xI;function wI(t,n,e){var r=[0,0,0,0,0,0,0,0,0];return Ia.mat3.fromRotation(r,e),Ia.mat3.multiply(t,r,n)}La.leftRotate=wI;function EI(t,n,e){var r=[0,0,0,0,0,0,0,0,0];return Ia.mat3.fromScaling(r,e),Ia.mat3.multiply(t,r,n)}La.leftScale=EI;function z9(t,n,e){return Ia.mat3.multiply(t,e,n)}function G9(t,n){for(var e=t?[].concat(t):[1,0,0,0,1,0,0,0,1],r=0,i=n.length;r<i;r++){var o=n[r];switch(o[0]){case"t":xI(e,e,[o[1],o[2]]);break;case"s":EI(e,e,[o[1],o[2]]);break;case"r":wI(e,e,o[1]);break;case"m":z9(e,e,o[1]);break}}return e}var A2=La.transform=G9;function MI(t,n){return t[0]*n[1]-n[0]*t[1]}La.direction=MI;function U9(t,n,e){var r=Ia.vec2.angle(t,n),i=MI(t,n)>=0;return e?i?Math.PI*2-r:r:i?r:Math.PI*2-r}La.angleTo=U9;function Y9(t,n,e){return e?(t[0]=n[1],t[1]=-1*n[0]):(t[0]=-1*n[1],t[1]=n[0]),t}La.vertical=Y9;var V9=function(){function t(n){this.destroyed=!1,this.graph=n,this.destroyed=!1}return t.prototype.getViewCenter=function(){var n=this.getFormatPadding(),e=this.graph,r=this.graph.get("width"),i=e.get("height");return{x:(r-n[1]-n[3])/2+n[3],y:(i-n[0]-n[2])/2+n[0]}},t.prototype.fitCenter=function(n,e){var r=this.graph,i=r.get("group"),o,a=r.getNodes();if(a.length>r.get("optimizeThreshold")){var s=1/0,u=1/0,c=-1/0,l=-1/0;a.forEach(function(x){var w=x.getModel(),E=w.x,M=w.y;s>E&&(s=E),u>M&&(u=M),c<E&&(c=E),l<M&&(l=M)});var h=i.getMatrix()||[1,0,0,0,1,0,0,0,1],f=_u({x:s,y:u},h),d=f.x,p=f.y,g=_u({x:c,y:l},h),v=g.x,m=g.y;o={minX:d,maxX:v,minY:p,maxY:m,width:v-d,height:m-p,x:d,y:p}}else o=i.getCanvasBBox();if(!(o.width===0||o.height===0)){var y=this.getViewCenter(),b={x:o.x+o.width/2,y:o.y+o.height/2};r.translate(y.x-b.x,y.y-b.y,n,e)}},t.prototype.animatedFitView=function(n,e,r,i,o,a,s,u){var c=this.graph;r=r||{duration:500,easing:"easeCubic"};var l=[1,0,0,0,1,0,0,0,1],h=i.x+o.x-a.x-i.minX,f=i.y+o.y-a.y-i.minY;if(!(eo(h)||eo(f))){var d=A2(l,[["t",h,f]]);if(!u){var p=vl({animateCfg:r,callback:function(){c.emit("viewportchange",{action:"translate",matrix:d})}});n.animate(function(x){return{matrix:kv(e,d,x)}},p);return}var g=c.get("minZoom"),v=c.get("maxZoom"),m=s;g&&s<g?(m=g,console.warn("fitview failed, ratio out of range, ratio: %f",s,"graph minzoom has been used instead")):v&&s>v&&(m=v,console.warn("fitview failed, ratio out of range, ratio: %f",s,"graph maxzoom has been used instead"));var y=A2(d,[["t",-o.x,-o.y],["s",m,m],["t",o.x,o.y]]),b=vl({animateCfg:r,callback:function(){n.setMatrix(y),c.emit("viewportchange",{action:"translate",matrix:d}),c.emit("viewportchange",{action:"zoom",matrix:y})}});n.stopAnimate(),n.setMatrix(e),n.animate(function(x){return{matrix:kv(e,y,x)}},b)}},t.prototype.fitView=function(n,e){var r=this.graph,i=this.getFormatPadding(),o=r.get("width"),a=r.get("height"),s=r.get("group"),u=s.getMatrix()||[1,0,0,0,1,0,0,0,1];s.resetMatrix();var c,l=r.getNodes();if(l.length>r.get("optimizeThreshold")){var h=1/0,f=1/0,d=-1/0,p=-1/0;l.forEach(function(E){var M=E.getModel(),_=M.x,k=M.y;h>_&&(h=_),f>k&&(f=k),d<_&&(d=_),p<k&&(p=k)}),c={minX:h,maxX:d,minY:f,maxY:p,width:d-h,height:p-f,x:h,y:f}}else c=s.getCanvasBBox();if(!(c.width===0||c.height===0)){var g=this.getViewCenter(),v={x:c.x+c.width/2,y:c.y+c.height/2},m=(o-i[1]-i[3])/c.width,y=(a-i[0]-i[2])/c.height,b=m;if(m>y&&(b=y),n)this.animatedFitView(s,u,e,c,g,v,b,!0);else{var x=g.x-v.x,w=g.y-v.y;if(eo(x)||eo(w))return;r.translate(x,w),r.zoom(b,g)||console.warn("zoom failed, ratio out of range, ratio: %f",b)}}},t.prototype.fitViewByRules=function(n,e,r){var i=n.onlyOutOfViewPort,o=i===void 0?!1:i,a=n.direction,s=a===void 0?"both":a,u=n.ratioRule,c=u===void 0?"min":u,l=this.graph,h=this.getFormatPadding(),f=l.get("width"),d=l.get("height"),p=l.get("group"),g=p.getMatrix()||[1,0,0,0,1,0,0,0,1];p.resetMatrix();var v,m=l.getNodes();if(m.length>l.get("optimizeThreshold")){var y=1/0,b=1/0,x=-1/0,w=-1/0;m.forEach(function(N){var D=N.getModel(),P=D.x,j=D.y;y>P&&(y=P),b>j&&(b=j),x<P&&(x=P),w<j&&(w=j)}),v={minX:y,maxX:x,minY:b,maxY:w,width:x-y,height:w-b,x:y,y:b}}else v=p.getCanvasBBox();if(!(v.width===0||v.height===0)){var E=this.getViewCenter(),M={x:v.x+v.width/2,y:v.y+v.height/2},_=(f-h[1]-h[3])/v.width,k=(d-h[0]-h[2])/v.height,S;if(s==="x"?S=_:s==="y"?S=k:S=c==="max"?Math.max(_,k):Math.min(_,k),o&&(S=S<1?S:1),e)this.animatedFitView(p,g,r,v,E,M,S,!0);else{var A=l.getZoom(),C=A*S,I=l.get("minZoom");C<I&&(C=I,console.warn("fitview failed, ratio out of range, ratio: %f",S,"graph minzoom has been used instead")),l.translate(E.x-M.x,E.y-M.y),l.zoomTo(C,E)}}},t.prototype.getFormatPadding=function(){var n=this.graph.get("fitViewPadding");return Yy(n)},t.prototype.focusPoint=function(n,e,r){var i=this,o=this.getViewCenter(),a=this.getPointByCanvas(o.x,o.y),s=this.graph.get("group").getMatrix();if(s||(s=[1,0,0,0,1,0,0,0,1]),e){var u=(a.x-n.x)*s[0],c=(a.y-n.y)*s[4],l=0,h=0,f=0,d=0;this.graph.get("canvas").animate(function(p){f=u*p,d=c*p,i.graph.translate(f-l,d-h),l=f,h=d},B({},r))}else this.graph.translate((a.x-n.x)*s[0],(a.y-n.y)*s[4])},t.prototype.getPointByCanvas=function(n,e){var r=this.graph.get("group").getMatrix();r||(r=[1,0,0,0,1,0,0,0,1]);var i=pC({x:n,y:e},r);return i},t.prototype.getPointByClient=function(n,e){var r=this.graph.get("canvas"),i=r.getPointByClient(n,e);return this.getPointByCanvas(i.x,i.y)},t.prototype.getClientByPoint=function(n,e){var r=this.graph.get("canvas"),i=this.getCanvasByPoint(n,e),o=r.getClientByPoint(i.x,i.y);return{x:o.x,y:o.y}},t.prototype.getCanvasByPoint=function(n,e){var r=this.graph.get("group").getMatrix();return r||(r=[1,0,0,0,1,0,0,0,1]),_u({x:n,y:e},r)},t.prototype.focus=function(n,e,r){if(Dt(n)&&(n=this.graph.findById(n)),n){var i=0,o=0;if(n.getType&&n.getType()==="edge"){var a=n.getSource().get("group").getMatrix(),s=n.getTarget().get("group").getMatrix();a&&s?(i=(a[6]+s[6])/2,o=(a[7]+s[7])/2):(a||s)&&(i=a?a[6]:s[6],o=a?a[7]:s[7])}else{var u=n.get("group"),c=u.getMatrix();c||(c=[1,0,0,0,1,0,0,0,1]),i=c[6],o=c[7]}this.focusPoint({x:i,y:o},e,r)}},t.prototype.focusItems=function(n,e,r,i){if(n.length){var o=this.graph,a=this.getFormatPadding(),s=o.get("width"),u=o.get("height"),c=o.get("group"),l=c.getMatrix()||[1,0,0,0,1,0,0,0,1];c.resetMatrix();for(var h={x:0,y:0,minX:Number.MAX_SAFE_INTEGER,minY:Number.MAX_SAFE_INTEGER,maxX:Number.MIN_SAFE_INTEGER,maxY:Number.MIN_SAFE_INTEGER,width:0,height:0},f=0,d=n;f<d.length;f++){var p=d[f],g=p.getBBox();g.minX<h.minX&&(h.minX=g.minX),g.minY<h.minY&&(h.minY=g.minY),g.maxX>h.maxX&&(h.maxX=g.maxX),g.maxY>h.maxY&&(h.maxY=g.maxY)}if(h.x=h.minX,h.y=h.minY,h.width=h.maxX-h.minX,h.height=h.maxY-h.minY,!(h.width===0||h.height===0)){var v=this.getViewCenter(),m={x:h.x+h.width/2,y:h.y+h.height/2},y=(s-a[1]-a[3])/h.width,b=(u-a[0]-a[2])/h.height,x=y;y>b&&(x=b),r?this.animatedFitView(c,l,i,h,v,m,x,e):(o.translate(v.x-m.x,v.y-m.y),e&&!o.zoom(x,v)&&console.warn("zoom failed, ratio out of range, ratio: %f",x))}}},t.prototype.changeSize=function(n,e){var r=this.graph;if(!pe(n)||!pe(e))throw Error("invalid canvas width & height, please make sure width & height type is number");r.set({width:n,height:e});var i=r.get("canvas");i.changeSize(n,e);var o=r.get("plugins");o.forEach(function(a){a.get("gridContainer")&&a.positionInit()})},t.prototype.destroy=function(){this.graph=null,this.destroyed=!1},t}();function Kv(t){"@babel/helpers - typeof";return Kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Kv(t)}function C2(t){if(typeof t!="string")return t;var n=function(E){if(typeof E!="string")return E;try{return JSON.parse(E.trim())}catch{return E.trim()}},e=n(t);if(typeof e!="string")return e;for(var r=function(E){return E[E.length-1]},i=t.trim(),o=[],a=[],s=function(){for(var E=[],M=0;M<arguments.length;M++)E[M]=arguments[M];return E.some(function(_){return r(a)===_})},u=function(){return r(o)},c=null,l=0,h="";l<i.length;){var f=i[l],d=s('"',"'");if(!d&&!f.trim()){l+=1;continue}var p=i[l-1]==="\\",g=s("}"),v=s("]"),m=s(","),y=u();if(d)if(r(a)===f&&!p){a.pop();var b=n(h);y.push(b),c=b,h=""}else h+=f;else if(v&&f===",")h&&(y.push(n(h)),h="");else if(g&&f===":")a.push(","),h&&(y.push(h),h="");else if(m&&f===",")h&&(y.push(n(h)),h=""),a.pop();else if(f==="}"&&(g||m)){h&&(y.push(n(h)),h=""),m&&a.pop();for(var x={},w=1;w<y.length;w+=2)x[y[w-1]]=y[w];o.pop(),o.length&&r(o).push(x),a.pop(),c=x}else f==="]"&&v?(h&&(y.push(n(h)),h=""),o.pop(),o.length&&r(o).push(y),a.pop(),c=y):f==="{"?(o.push([]),a.push("}")):f==="["?(o.push([]),a.push("]")):f==='"'?a.push('"'):f==="'"?a.push("'"):h+=f;l+=1}return c||h}var W9=function(t){return t.split("-").reduce(function(n,e){return n+e.charAt(0).toUpperCase()+e.slice(1)})},X9=function(t){return function(n){for(var e=t.length,r=[],i=0,o="";i<e;)if(t[i]==="{"&&t[i+1]==="{")r.push(o),o="",i+=2;else if(t[i]==="}"&&t[i+1]==="}"){if(r.length){var a=r.pop();o=Bo(n,o,a.endsWith("=")?'"{'.concat(o,'}"'):o),r.push(a+o)}i+=2,o=""}else o+=t[i],i+=1;return r.push(o),r.map(function(s,u){return r[u-1]&&r[u-1].endsWith("=")?'"{'.concat(s,'}"'):s}).join("")}};function SI(t,n){var e={},r=t.getAttributeNames&&t.getAttributeNames()||[],i=t.children&&Array.from(t.children).map(function(s){return SI(s,n)}),o={},a=t.tagName?t.tagName.toLowerCase():"group";return a==="text"&&(e.text=t.innerText),o.type=a,a==="img"&&(o.type="image"),Array.from(r).forEach(function(s){var u=W9(s),c=t.getAttribute(s);try{if(u==="style"||u==="attrs"){var l=C2(c);e=B(B({},e),l)}else o[u]=C2(c)}catch(h){if(u==="style")throw h;o[u]=c}}),o.attrs=e,n&&n.style&&o.name&&Kv(n.style[o.name])==="object"&&(o.attrs=B(B({},o.attrs),n.style[o.name])),n&&n.style&&o.keyshape&&(o.attrs=B(B({},o.attrs),n.style)),i.length&&(o.children=i),o}function H9(t,n,e){var r=t.attrs,i=r===void 0?{}:r,o={x:n.x||0,y:n.y||0,width:e.width||0,height:e.height||0},a,s;switch(t.type){case"maker":case"circle":i.r&&(s=2*i.r,a=2*i.r);break;case"text":i.text&&(s=kC(i.text,i.fontSize||12)[0],a=16,o.y+=a,o.height=a,o.width=s,t.attrs=B({fontSize:12,fill:"#000"},i));break;default:i.width&&(s=i.width),i.height&&(a=i.height)}return a>=0&&(o.height=a),s>=0&&(o.width=s),i.marginTop&&(o.y+=i.marginTop),i.marginLeft&&(o.x+=i.marginLeft),o}function _I(t,n){var e;n===void 0&&(n={x:0,y:0});var r=B({x:0,y:0,width:0,height:0},n);if(!((e=t.children)===null||e===void 0)&&e.length){var i=t.attrs,o=i===void 0?{}:i,a=o.marginTop,s=B({},n);a&&(s.y+=a);for(var u=0;u<t.children.length;u++){t.children[u].attrs.key="".concat(o.key||"root"," -").concat(u," ");var c=_I(t.children[u],s);if(c.bbox){var l=c.bbox;c.attrs.next==="inline"?s.x+=c.bbox.width:s.y+=c.bbox.height,l.width+l.x>r.width&&(r.width=l.width+l.x),l.height+l.y>r.height&&(r.height=l.height+l.y)}}}return t.bbox=H9(t,n,r),t.attrs=B(B({},t.attrs),t.bbox),t}function kI(t,n){var e,r,i,o,a=(t||{}).type,s=((n==null?void 0:n.attrs)||{}).key;if(s&&t&&(t.attrs.key=s),!t&&n)return{action:"delete",val:n,type:a,key:s};if(t&&!n)return{action:"add",val:t,type:a};if(!t&&!n)return{action:"same",type:a};var u=[];if(((e=t.children)===null||e===void 0?void 0:e.length)>0||((r=n.children)===null||r===void 0?void 0:r.length)>0)for(var c=Math.max((i=t.children)===null||i===void 0?void 0:i.length,(o=n.children)===null||o===void 0?void 0:o.length),l=n.children||[],h=t.children||[],f=0;f<c;f+=1)u.push(kI(h[f],l[f]));var d=Object.keys(n.attrs),p=Object.keys(t.attrs);return n.type!==t.type?{action:"restructure",nowTarget:t,formerTarget:n,key:s,children:u}:d.filter(function(g){return g!=="children"}).some(function(g){return t.attrs[g]!==n.attrs[g]||!p.includes(g)})?{action:"change",val:t,children:u,type:a,key:s}:{action:"same",children:u,type:a,key:s}}function I2(t){var n={},e=function(r){var i=typeof t=="function"?t(r):t,o=X9(i)(r),a=document.createElement("div");a.innerHTML=o;var s=a.children[0],u=_I(SI(s,r));return a.remove(),u};return{draw:function(r,i){var o=e(r),a=i,s=function u(c){var l=c.attrs,h=l===void 0?{}:l,f=c.bbox,d=c.type,p=c.children,g=or(c,["attrs","bbox","type","children"]);if(c.type!=="group"){var v=i.addShape(c.type,B({attrs:h,origin:{bbox:f,type:d,children:p}},g));c.keyshape&&(a=v)}c.children&&c.children.forEach(function(m){return u(m)})};return s(o),n[r.id]=[o],a},update:function(r,i){n[r.id]||(n[r.id]=[]);var o=i.getContainer(),a=o.get("children"),s=e(r),u=n[r.id].pop(),c=kI(s,u),l=function d(p){var g;p.type!=="group"&&o.addShape(p.type,{attrs:p.attrs}),!((g=p.children)===null||g===void 0)&&g.length&&p.children.map(function(v){return d(v)})},h=function d(p){var g,v=a.find(function(m){return m.attrs.key===p.attrs.key});v&&o.removeChild(v),!((g=p.children)===null||g===void 0)&&g.length&&p.children.map(function(m){return d(m)})},f=function d(p){var g=p.key;if(p.type!=="group"){var v=a.find(function(y){return y.attrs.key===g});switch(p.action){case"change":if(v){var m=p.val.keyshape?i.getOriginStyle():{};v.attr(B(B({},m),p.val.attrs))}break;case"add":l(p.val);break;case"delete":h(p.val);break;case"restructure":h(p.formerTarget),l(p.nowTarget);break}}p.children&&p.children.forEach(function(y){return d(y)})};f(c),n[r.id].push(s)},getAnchorPoints:function(){return[[0,.5],[1,.5],[.5,1],[.5,0]]}}}var M0={};function T2(t){return M0[t]||(M0[t]=Du(t)),M0[t]}var q9={defaultShapeType:"defaultType",className:null,getShape:function(t){var n=this,e=n[t]||n[n.defaultShapeType]||n["simple-circle"];return e},draw:function(t,n,e){var r=this.getShape(t);e.shapeMap={};var i=r.draw(n,e);return r.afterDraw&&r.afterDraw(n,e,i),i},baseUpdate:function(t,n,e,r){var i,o,a=this.getShape(t);a.update&&(a.mergeStyle=(i=a.getOptions)===null||i===void 0?void 0:i.call(a,n,r),(o=a.update)===null||o===void 0||o.call(a,n,e,r)),a.afterUpdate&&a.afterUpdate(n,e)},setState:function(t,n,e,r){var i=this.getShape(t);i.setState(n,e,r)},shouldUpdate:function(t){var n=this.getShape(t);return!!n.update},getControlPoints:function(t,n){var e=this.getShape(t);return e.getControlPoints(n)},getAnchorPoints:function(t,n){var e=this.getShape(t);return e.getAnchorPoints(n)}},S0={options:{},draw:function(t,n){return this.drawShape(t,n)},drawShape:function(){},afterDraw:function(){},afterUpdate:function(){},setState:function(){},getControlPoints:function(t){return t.controlPoints},getAnchorPoints:function(t){var n=this.options.anchorPoints,e=t.anchorPoints||n;return e}},Sn=function(){function t(){}return t.registerFactory=function(n,e){var r=T2(n),i=q9,o=B(B({},i),e);return t[r]=o,o.className=r,o},t.getFactory=function(n){var e=T2(n);return t[e]},t.registerNode=function(n,e,r){var i=t.Node,o;if(typeof e=="string"||typeof e=="function"){var a=I2(e);o=B(B({},i.getShape("single-node")),a)}else if(e.jsx){var s=e.jsx,a=I2(s);o=B(B(B({},i.getShape("single-node")),a),e)}else{i.getShape(r);var u=r?i.getShape(r):S0;o=B(B({},u),e)}return o.type=n,o.itemType="node",i[n]=o,o},t.registerEdge=function(n,e,r){var i=t.Edge,o=r?i.getShape(r):S0,a=B(B({},o),e);return a.type=n,a.itemType="edge",i[n]=a,a},t.registerCombo=function(n,e,r){var i=t.Combo,o=r?i.getShape(r):S0,a=B(B({},o),e);return a.type=n,a.itemType="combo",i[n]=a,a},t}();Sn.registerFactory("node",{defaultShapeType:"circle"});Sn.registerFactory("edge",{defaultShapeType:"line"});Sn.registerFactory("combo",{defaultShapeType:"circle"});var _0="bboxCache",k0="bboxCanvasCache",AI=function(){function t(n){this._cfg={},this.destroyed=!1,this.optimize=!1;var e={id:void 0,type:"item",model:{},group:void 0,animate:!1,visible:!0,locked:!1,event:!0,keyShape:void 0,states:[]};this._cfg=Object.assign(e,this.getDefaultCfg(),n);var r=this.get("model"),i=r.id,o=this.get("type");typeof i>"u"?i=Zv(o):typeof i!="string"&&(i=String(i)),this.get("model").id=i,this.set("id",i);var a=n.group;a&&(a.set("item",this),a.set("id",i)),this.init(),this.draw();var s=r.shape||r.type||(o==="edge"?"line":"circle"),u=this.get("shapeFactory");if(u&&u[s]){var c=u[s].options;if(c&&c.stateStyles){var l=this.get("styles")||r.stateStyles;l=mn({},c.stateStyles,l),this.set("styles",l)}}}return t.prototype.calculateBBox=function(){var n=this.get("keyShape"),e=this.get("group"),r=Md(n,e);return r.x=r.minX,r.y=r.minY,r.width=r.maxX-r.minX,r.height=r.maxY-r.minY,r.centerX=(r.minX+r.maxX)/2,r.centerY=(r.minY+r.maxY)/2,r},t.prototype.calculateCanvasBBox=function(){var n=this.get("keyShape"),e=this.get("group"),r=Md(n,e);return r.x=r.minX,r.y=r.minY,r.width=r.maxX-r.minX,r.height=r.maxY-r.minY,r.centerX=(r.minX+r.maxX)/2,r.centerY=(r.minY+r.maxY)/2,r},t.prototype.drawInner=function(){var n=this,e=n.get("shapeFactory"),r=n.get("group"),i=n.get("model");r.clear();var o=i.visible;if(o!==void 0&&!o&&n.changeVisibility(o),!!e){n.updatePosition(i);var a=n.getShapeCfg(i),s=a.type,u=e.draw(s,a,r);u&&(n.set("keyShape",u),u.set("isKeyShape",!0),u.set("draggable",!0)),this.setOriginStyle(),this.set("currentShape",s),this.restoreStates(e,s)}},t.prototype.setOriginStyle=function(){var n=this.get("group"),e=n.get("children"),r=this.getKeyShape(),i=this,o=r.get("name");if(this.get("originStyle")){var a=this.get("originStyle");o&&!a[o]&&(a[o]={});for(var s=this.getCurrentStatesStyle(),u=function(v){var m=e[v],y=m.get("name"),b=m.attr();if(y&&y!==o){var x=s[y];a[y]||(a[y]={}),x?Object.keys(b).forEach(function(M){var _=b[M];_!==x[M]&&(a[y][M]=_)}):a[y]=m.get("type")!=="image"?Xe(b):i.getShapeStyleByName(y)}else{var w=m.attr(),E={};Object.keys(s).forEach(function(M){var _=s[M];(M===o||!vr(_))&&(E[M]=_)}),Object.keys(w).forEach(function(M){var _=w[M];E[M]!==_&&(o?a[o][M]=_:a[M]=_)})}},c=0;c<e.length;c++)u(c);delete a.path,delete a.matrix,delete a.x,delete a.y,a[o]&&(delete a[o].x,delete a[o].y,delete a[o].matrix,delete a[o].path),i.set("originStyle",a)}else{for(var l={},c=0;c<e.length;c++){var h=e[c],f=h.get("type"),d=h.get("name");if(d&&d!==o)l[d]=f!=="image"?Xe(h.attr()):i.getShapeStyleByName(d),f==="text"&&l[d]&&(delete l[d].x,delete l[d].y,delete l[d].matrix);else{var p=i.getShapeStyleByName();if(delete p.path,delete p.matrix,!o)Object.assign(l,p);else if(d)l[o]=p;else{var g=Zv("shape");h.set("name",g),n.shapeMap[g]=h,l[g]=f!=="image"?Xe(h.attr()):i.getShapeStyleByName(d)}}}i.set("originStyle",l)}},t.prototype.restoreStates=function(n,e){var r=this,i=r.get("states");mt(i,function(o){n.setState(e,o,!0,r)})},t.prototype.init=function(){var n=Sn.getFactory(this.get("type"));this.set("shapeFactory",n)},t.prototype.get=function(n){return this._cfg[n]},t.prototype.set=function(n,e){vr(n)?this._cfg=B(B({},this._cfg),n):this._cfg[n]=e},t.prototype.getDefaultCfg=function(){return{}},t.prototype.clearCache=function(){this.set(_0,null),this.set(k0,null)},t.prototype.beforeDraw=function(){},t.prototype.afterDraw=function(){},t.prototype.afterUpdate=function(){},t.prototype.draw=function(){this.beforeDraw(),this.drawInner(),this.afterDraw()},t.prototype.getShapeStyleByName=function(n){var e=this.get("group"),r;if(n?r=e.shapeMap[n]||e.find(function(o){return o.get("name")===n}):r=this.getKeyShape(),r){var i={};return mt(r.attr(),function(o,a){(a!=="img"||Dt(o))&&(i[a]=o)}),i}return{}},t.prototype.getShapeCfg=function(n,e){var r=this.get("styles");if(r){var i=n;return i.style=B(B({},r),n.style),i}return n},t.prototype.getStateStyle=function(n){var e=this.get("styles"),r=e&&e[n];return r},t.prototype.getOriginStyle=function(){return this.get("originStyle")},t.prototype.getCurrentStatesStyle=function(){var n=this,e={},r=n.getStates();return!r||!r.length?this.get("originStyle"):(mt(n.getStates(),function(i){e=Object.assign(e,n.getStateStyle(i))}),e)},t.prototype.setState=function(n,e){var r=this.get("states"),i=this.get("shapeFactory"),o=n,a=n;Dt(e)&&(o="".concat(n,":").concat(e),a="".concat(n,":"));var s=r;if(Rl(e)){var u=r.indexOf(a);if(e){if(u>-1)return;r.push(o)}else u>-1&&r.splice(u,1)}else if(Dt(e)){var c=r.filter(function(f){return f.includes(a)});c.length>0&&this.clearStates(c),s=s.filter(function(f){return!f.includes(a)}),s.push(o),this.set("states",s)}if(i){var l=this.get("model"),h=l.type;i.setState(h,n,e,this)}},t.prototype.clearStates=function(n){var e=this,r=e.getStates(),i=e.get("shapeFactory"),o=e.get("model"),a=o.type;n||(n=r),Dt(n)&&(n=[n]);var s=r.filter(function(u){return n.indexOf(u)===-1});e.set("states",s),n.forEach(function(u){i.setState(a,u,!1,e)})},t.prototype.setOptimize=function(n){this.optimize=n},t.prototype.getContainer=function(){return this.get("group")},t.prototype.getKeyShape=function(){return this.get("keyShape")},t.prototype.getModel=function(){return this.get("model")},t.prototype.getType=function(){return this.get("type")},t.prototype.getID=function(){return this.get("id")},t.prototype.isItem=function(){return!0},t.prototype.getStates=function(){return this.get("states")},t.prototype.hasState=function(n){var e=this.getStates();return e.indexOf(n)>=0},t.prototype.refresh=function(n){var e=this.get("model");this.updatePosition(e),this.updateShape(n),this.afterUpdate(),this.clearCache()},t.prototype.getUpdateType=function(n){},t.prototype.update=function(n,e){e===void 0&&(e=void 0);var r=this.get("model");if(e==="move")this.updatePosition(n);else{var i=r.visible,o=n.visible;i!==o&&o!==void 0&&this.changeVisibility(o);var a={x:r.x,y:r.y};n.x=isNaN(+n.x)?r.x:+n.x,n.y=isNaN(+n.y)?r.y:+n.y;var s=this.get("styles");if(n.stateStyles){var u=n.stateStyles;ye(s,u),delete n.stateStyles}Object.assign(r,n),(a.x!==n.x||a.y!==n.y)&&this.updatePosition(n),this.updateShape(e)}this.afterUpdate(),this.clearCache()},t.prototype.updateShape=function(n){var e=this.get("shapeFactory"),r=this.get("model"),i=r.type;if(e.shouldUpdate(i)&&i===this.get("currentShape")){var o=this.getShapeCfg(r,n);e.baseUpdate(i,o,this,n),n!=="move"&&this.setOriginStyle()}else this.draw();this.restoreStates(e,i)},t.prototype.updatePosition=function(n){var e=this.get("model"),r=isNaN(+n.x)?+e.x:+n.x,i=isNaN(+n.y)?+e.y:+n.y,o=this.get("group");if(isNaN(r)||isNaN(i))return!1;e.x=r,e.y=i;var a=o.getMatrix();return a&&a[6]===r&&a[7]===i?!1:(o.resetMatrix(),gC(o,{x:r,y:i}),this.clearCache(),!0)},t.prototype.getBBox=function(){var n=this.get(_0);return n||(n=this.calculateBBox(),this.set(_0,n)),n},t.prototype.getCanvasBBox=function(){var n=this.get(k0);return n||(n=this.calculateCanvasBBox(),this.set(k0,n)),n},t.prototype.toFront=function(){var n=this.get("group");n.toFront()},t.prototype.toBack=function(){var n=this.get("group");n.toBack()},t.prototype.show=function(){this.changeVisibility(!0)},t.prototype.hide=function(){this.changeVisibility(!1)},t.prototype.changeVisibility=function(n){var e=this.get("group");n?e.show():e.hide(),this.set("visible",n)},t.prototype.isVisible=function(){return this.get("visible")},t.prototype.enableCapture=function(n){var e=this.get("group");e&&e.set("capture",n)},t.prototype.destroy=function(){if(!this.destroyed){var n=this.get("animate"),e=this.get("group");n&&e.stopAnimate(),e.shapeMap={},this.clearCache(),e.remove(),this._cfg=null,this.destroyed=!0}},t}(),nf={source:"start",target:"end"},Xi="Node",eu="Point",Z9="Anchor",K9=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultCfg=function(){return{type:"edge",sourceNode:null,targetNode:null,startPoint:null,endPoint:null,linkCenter:!1}},n.prototype.setEnd=function(e,r){var i=nf[e]+eu,o=e+Xi,a=this.get(o);a&&!a.destroyed&&a.removeEdge(this),vr(r)?(this.set(i,r),this.set(o,null)):r&&(r.addEdge(this),this.set(o,r),this.set(i,null))},n.prototype.getLinkPoint=function(e,r,i){var o=nf[e]+eu,a=e+Xi,s=this.get(o);if(!s){var u=this.get(a),c=e+Z9,l=this.getPrePoint(e,i),h=r[c];fe(h)||(s=u.getLinkPointByAnchor(h)),s=s||u.getLinkPoint(l),fe(s.index)||this.set("".concat(e,"AnchorIndex"),s.index)}return s},n.prototype.getPrePoint=function(e,r){if(r&&r.length){var i=e==="source"?0:r.length-1;return r[i]}var o=e==="source"?"target":"source";return this.getEndPoint(o)},n.prototype.getEndPoint=function(e){var r=e+Xi,i=nf[e]+eu,o=this.get(r);return o&&!o.destroyed?o.get("model"):this.get(i)},n.prototype.getControlPointsByCenter=function(e){var r=this.getEndPoint("source"),i=this.getEndPoint("target"),o=this.get("shapeFactory"),a=e.type;return o.getControlPoints(a,{startPoint:r,endPoint:i})},n.prototype.getEndCenter=function(e){var r=e+Xi,i=nf[e]+eu,o=this.get(r);if(o){var a=o.getBBox();return{x:a.centerX,y:a.centerY}}return this.get(i)},n.prototype.init=function(){t.prototype.init.call(this),this.setSource(this.get("source")),this.setTarget(this.get("target"))},n.prototype.getShapeCfg=function(e,r){var i=this,o=i.get("linkCenter"),a=r!=null&&r.includes("move")?e:t.prototype.getShapeCfg.call(this,e);if(o)a.startPoint=i.getEndCenter("source"),a.endPoint=i.getEndCenter("target");else{var s=a.controlPoints||i.getControlPointsByCenter(a);a.startPoint=i.getLinkPoint("source",e,s),a.endPoint=i.getLinkPoint("target",e,s)}return a.sourceNode=i.get("sourceNode"),a.targetNode=i.get("targetNode"),a},n.prototype.getModel=function(){var e=this.get("model"),r=this.get("source".concat(Xi)),i=this.get("target".concat(Xi));return r?delete e["source".concat(Xi)]:e.source=this.get("start".concat(eu)),i?delete e["target".concat(Xi)]:e.target=this.get("end".concat(eu)),!Dt(e.source)&&!vr(e.source)&&(e.source=e.source.getID()),!Dt(e.target)&&!vr(e.target)&&(e.target=e.target.getID()),e},n.prototype.setSource=function(e){this.setEnd("source",e),this.set("source",e)},n.prototype.setTarget=function(e){this.setEnd("target",e),this.set("target",e)},n.prototype.getSource=function(){return this.get("source")},n.prototype.getTarget=function(){return this.get("target")},n.prototype.updatePosition=function(){return!1},n.prototype.update=function(e,r){r===void 0&&(r=void 0);var i=this.get("model"),o=i.visible,a=e.visible;o!==a&&a!==void 0&&this.changeVisibility(a);var s=this.get("source"),u=this.get("target");if(!(!s||s.destroyed||!u||u.destroyed)){var c=this.get("styles");if(e.stateStyles){var l=e.stateStyles;ye(c,l),delete e.stateStyles}Object.assign(i,e),this.updateShape(r),this.afterUpdate(),this.clearCache()}},n.prototype.destroy=function(){var e=this.get("source".concat(Xi)),r=this.get("target".concat(Xi));e&&!e.destroyed&&e.removeEdge(this),r&&!r.destroyed&&r.removeEdge(this),t.prototype.destroy.call(this)},n}(AI),A0="anchorPointsCache",Q9="bboxCache",CI=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getNearestPoint=function(e,r){for(var i=0,o=e[0],a=wd(e[0],r),s=0;s<e.length;s++){var u=e[s],c=wd(u,r);c<a&&(o=u,a=c,i=s)}return o.anchorIndex=i,o},n.prototype.getDefaultCfg=function(){return{type:"node",edges:[]}},n.prototype.getEdges=function(){return this.get("edges")},n.prototype.getInEdges=function(){var e=this;return this.get("edges").filter(function(r){return r.get("target")===e})},n.prototype.getOutEdges=function(){var e=this;return this.get("edges").filter(function(r){return r.get("source")===e})},n.prototype.getNeighbors=function(e){var r=this,i=this.get("edges");if(e==="target"){var o=function(u){return u.getSource()===r};return i.filter(o).map(function(u){return u.getTarget()})}if(e==="source"){var a=function(u){return u.getTarget()===r};return i.filter(a).map(function(u){return u.getSource()})}var s=function(u){return u.getSource()===r?u.getTarget():u.getSource()};return i.map(s)},n.prototype.getLinkPointByAnchor=function(e){var r=this.getAnchorPoints();return r[e]},n.prototype.getLinkPoint=function(e){var r=this.get("keyShape"),i=r.get("type"),o=this.get("type"),a,s,u=this.getBBox();o==="combo"?(a=u.centerX||(u.maxX+u.minX)/2,s=u.centerY||(u.maxY+u.minY)/2):(a=u.centerX,s=u.centerY);var c=this.getAnchorPoints(),l;switch(i){case"circle":l=fC({x:a,y:s,r:u.width/2},e);break;case"ellipse":l=dC({x:a,y:s,rx:u.width/2,ry:u.height/2},e);break;default:l=hC(u,e)}var h=l;return c.length&&(h||(h=e),h=this.getNearestPoint(c,h)),h||(h={x:a,y:s}),h},n.prototype.getAnchorPoints=function(){var e=this.get(A0);if(!e){e=[];var r=this.get("shapeFactory"),i=this.getBBox(),o=this.get("model"),a=this.getShapeCfg(o),s=o.type,u=r.getAnchorPoints(s,a)||[];mt(u,function(c,l){var h={x:i.minX+c[0]*i.width,y:i.minY+c[1]*i.height,anchorIndex:l};e.push(h)}),this.set(A0,e)}return e},n.prototype.addEdge=function(e){this.get("edges").push(e)},n.prototype.lock=function(){this.set("locked",!0)},n.prototype.unlock=function(){this.set("locked",!1)},n.prototype.hasLocked=function(){return this.get("locked")},n.prototype.removeEdge=function(e){var r=this.getEdges(),i=r.indexOf(e);i>-1&&r.splice(i,1)},n.prototype.clearCache=function(){this.set(Q9,null),this.set(A0,null)},n.prototype.getUpdateType=function(e){var r,i,o,a,s;if(e){var u=!fe(e.x),c=!fe(e.y),l=Object.keys(e);if(l.length===1&&(u||c)||l.length===2&&u&&c)return"move";if(pe(e.x)||pe(e.y)||e.type||e.anchorPoints||e.size||e!=null&&e.style&&(!((r=e==null?void 0:e.style)===null||r===void 0)&&r.r||!((i=e==null?void 0:e.style)===null||i===void 0)&&i.width||!((o=e==null?void 0:e.style)===null||o===void 0)&&o.height||!((a=e==null?void 0:e.style)===null||a===void 0)&&a.rx||!((s=e==null?void 0:e.style)===null||s===void 0)&&s.ry))return"bbox|label";var h=l.includes("label")||l.includes("labelCfg");return h?"style|label":"style"}},n.prototype.setState=function(e,r){var i=this;if(this.optimize){t.prototype.setState.call(this,e,r);return}this.runWithBBoxAffected(function(){return t.prototype.setState.call(i,e,r)})},n.prototype.clearStates=function(e){var r=this;if(this.optimize){t.prototype.clearStates.call(this,e);return}this.runWithBBoxAffected(function(){return t.prototype.clearStates.call(r,e)})},n.prototype.runWithBBoxAffected=function(e){var r=["r","width","height","rx","ry","lineWidth"],i=this.getKeyShape().attr(),o={};Object.keys(this.getKeyShape().attr()).forEach(function(c){r.includes(c)&&(o[c]=i[c])}),e();for(var a=this.getKeyShape().attr(),s=0;s<r.length;s++){var u=r[s];if(a[u]!==o[u]){this.clearCache(),this.getEdges().forEach(function(c){return c.refresh()});break}}},n}(AI),O2="bboxCache",N2="bboxCanvasCache",rf="sizeCache",D2="anchorPointsCache",J9=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultCfg=function(){return{type:"combo",nodes:[],edges:[],combos:[]}},n.prototype.getShapeCfg=function(e){var r=this.get("styles"),i=this.get("bbox");if(r&&i){var o=e,a=pe(e.size)?[e.size,e.size]:e.size,s=pe(e.fixSize)?[e.fixSize,e.fixSize]:e.fixSize,u=a||s||he.defaultCombo.size,c={r:(Math.max(i.width,i.height)||Math.max(u[0],u[1]))/2,width:i.width||u[0],height:i.height||u[1]};o.style=B(B(B({},r),e.style),c);var l=e.padding||he.defaultCombo.padding;return pe(l)?(c.r+=l,c.width+=l*2,c.height+=l*2):(c.r=c.r+Math.max.apply(Math,l),c.width+=l[1]+l[3]||l[1]*2,c.height+=l[0]+l[2]||l[0]*2),this.set(rf,c),o}return e},n.prototype.calculateCanvasBBox=function(){if(!this.destroyed){var e=this.get("keyShape"),r=this.get("group"),i=this.get(O2)||{},o=i.x,a=i.x,s=this.get(rf),u=Md(e,r);if(u.centerX=(u.minX+u.maxX)/2,u.centerY=(u.minY+u.maxY)/2,s){s.width=Math.max(s.width,u.width),s.height=Math.max(s.height,u.height),this.set(rf,s);var c=e.get("type");c==="circle"?(u.width=s.r*2,u.height=s.r*2):(u.width=s.width,u.height=s.height),u.minX=u.centerX-u.width/2,u.minY=u.centerY-u.height/2,u.maxX=u.centerX+u.width/2,u.maxY=u.centerY+u.height/2}else u.width=u.maxX-u.minX,u.height=u.maxY-u.minY,u.centerX=(u.minX+u.maxX)/2,u.centerY=(u.minY+u.maxY)/2;return u.x=u.minX,u.y=u.minY,(u.x!==o||u.y!==a)&&this.set(D2,null),u}},n.prototype.getChildren=function(){var e=this;return{nodes:e.getNodes(),combos:e.getCombos()}},n.prototype.getNodes=function(){var e=this;return e.get("nodes")},n.prototype.getCombos=function(){var e=this;return e.get("combos")},n.prototype.addChild=function(e){var r=this,i=e.getType();switch(i){case"node":r.addNode(e);break;case"combo":r.addCombo(e);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},n.prototype.addCombo=function(e){var r=this;return r.get("combos").push(e),!0},n.prototype.addNode=function(e){var r=this;return r.get("nodes").push(e),!0},n.prototype.removeChild=function(e){var r=this,i=e.getType();switch(i){case"node":r.removeNode(e);break;case"combo":r.removeCombo(e);break;default:return console.warn("Only node or combo items are allowed to be added into a combo"),!1}return!0},n.prototype.removeCombo=function(e){if(e){var r=this.getCombos(),i=r.indexOf(e);return i>-1?(r.splice(i,1),!0):!1}},n.prototype.removeNode=function(e){if(e){var r=this.getNodes(),i=r.indexOf(e);return i>-1?(r.splice(i,1),!0):!1}},n.prototype.getUpdateType=function(e){},n.prototype.getBBox=function(){this.set(N2,null);var e=this.calculateCanvasBBox();return e},n.prototype.clearCache=function(){this.set(O2,null),this.set(N2,null),this.set(D2,null)},n.prototype.destroy=function(){if(!this.destroyed){var e=this.get("animate"),r=this.get("group");e&&r.stopAnimate(),r.shapeMap={},this.clearCache(),this.set(rf,null),this.set("bbox",null),r.remove(),this._cfg=null,this.destroyed=!0}},n}(CI),of="node",af="edge",P2="vedge",Mc="combo",$9="default",L2="Mapper",No="stateStyles",tG=function(){function t(n){var e=this;this.edgeToBeUpdateMap={},this.throttleRefresh=fl(function(r){var i=e.graph;if(!(!i||i.get("destroyed"))){var o=e.edgeToBeUpdateMap;if(o){var a=Object.values(o);a.length&&(a.forEach(function(s){var u=s.edge;if(!(!u||u.destroyed)){var c=u.getSource(),l=u.getTarget();!c||c.destroyed||!l||l.destroyed||u.refresh(s.updateType)}}),e.edgeToBeUpdateMap={})}}},16,{trailing:!0,leading:!0}),this.graph=n,this.destroyed=!1}return t.prototype.addItem=function(n,e){var r=this.graph,i=n===P2?af:n,o=r.get("".concat(i,"Group"))||r.get("group"),a=Du(i),s=null,u=r.get(i+Du(No))||{},c=r.get($9+a);e[No]&&(u=e[No]),c&&mt(c,function(E,M){yr(E)&&!ve(E)?e[M]=mn({},E,e[M]):ve(E)?e[M]=e[M]||Xe(c[M]):e[M]=e[M]||c[M]});var l=r.get(i+L2);if(l){var h=l(e);h[No]&&(u=h[No],delete h[No]),mt(h,function(E,M){yr(E)&&!ve(E)?e[M]=mn({},e[M],E):e[M]=h[M]||e[M]})}if(r.emit("beforeadditem",{type:n,model:e}),n===af||n===P2){var f=void 0,d=void 0;if(f=e.source,d=e.target,f&&Dt(f)&&(f=r.findById(f)),d&&Dt(d)&&(d=r.findById(d)),!f||!d){console.warn("The source or target node of edge ".concat(e.id," does not exist!"));return}f.getType&&f.getType()==="combo"&&(e.isComboEdge=!0),d.getType&&d.getType()==="combo"&&(e.isComboEdge=!0),s=new K9({model:e,source:f,target:d,styles:u,linkCenter:r.get("linkCenter"),group:o.addGroup()})}else if(n===of)s=new CI({model:e,styles:u,group:o.addGroup()});else if(n===Mc){var p=e.children,g=Zf(p,r),v=void 0,m=void 0;if(isNaN(g.x)?isNaN(e.x)&&(v=Math.random()*100):v=g.x,isNaN(g.y)?isNaN(e.y)&&(m=Math.random()*100):m=g.y,isNaN(e.x)||isNaN(e.y))e.x=v,e.y=m;else{var y=e.x-v,b=e.y-m;this.updateComboSucceeds(e.id,y,b,p)}var x=o.addGroup();x.setZIndex(e.depth),s=new J9({model:e,styles:u,animate:r.get("animate"),bbox:e.collapsed?Zf([],r):g,group:x}),!e.collapsed&&s.getKeyShape().get("type")==="circle"&&(g.width=Math.hypot(g.height,g.width),g.height=g.width,s.set("bbox",g),s.refresh());var w=s.getModel();(p||[]).forEach(function(E){var M=r.findById(E.id);s.addChild(M),E.depth=w.depth+2})}if(s)return s.setOptimize(r.getNodes().length>r.get("optimizeThreshold")),r.get("".concat(n,"s")).push(s),r.get("itemMap")[s.get("id")]=s,r.emit("afteradditem",{item:s,model:e}),s},t.prototype.updateItem=function(n,e){var r=this,i,o,a=this.graph;if(Dt(n)&&(n=a.findById(n)),!(!n||n.destroyed)){var s="";n.getType&&(s=n.getType());var u=a.get(s+L2),c=n.getModel(),l=c.x,h=c.y,f=n.getUpdateType(e);if(u){var d=mn({},c,e),p=u(d),g=mn({},c,p,e);p[No]&&(n.set("styles",g[No]),delete g[No]),mt(g,function(S,A){e[A]=S})}else mt(e,function(S,A){c[A]&&yr(S)&&!ve(S)&&(e[A]=B(B({},c[A]),e[A]))});if(a.emit("beforeupdateitem",{item:n,cfg:e}),s===af){if(e.source){var v=e.source;Dt(v)&&(v=a.findById(v)),n.setSource(v)}if(e.target){var m=e.target;Dt(m)&&(m=a.findById(m)),n.setTarget(m)}n.update(e)}else if(s===of){n.update(e,f);var y=n.getEdges();f==="move"?mt(y,function(S){r.edgeToBeUpdateMap[S.getID()]={edge:S,updateType:f},r.throttleRefresh()}):f!=null&&f.includes("bbox")&&mt(y,function(S){S.refresh(f)})}else if(s===Mc){if(n.update(e,f),!isNaN(e.x)||!isNaN(e.y)){var b=e.x-l||0,x=e.y-h||0;this.updateComboSucceeds(c.id,b,x)}var w=n.getEdges(),E=(f==null?void 0:f.includes("bbox"))||f==="move";if(E&&s===Mc){var M=n.get("shapeFactory"),_=c.type||"circle",k=c.animate===void 0||e.animate===void 0?(o=(i=M[_])===null||i===void 0?void 0:i.options)===null||o===void 0?void 0:o.animate:c.animate||e.animate;k?setTimeout(function(){if(!(!n||n.destroyed)){var S=n.getKeyShape();!S||S.destroyed||mt(w,function(A){A&&!A.destroyed&&A.refresh()})}},201):mt(w,function(S){S.refresh()})}}n.setOptimize(a.getNodes().length>a.get("optimizeThreshold")),a.emit("afterupdateitem",{item:n,cfg:e})}},t.prototype.updateCombo=function(n,e,r){var i=this,o,a,s=this.graph;if(Dt(n)&&(n=s.findById(n)),!(!n||n.destroyed)){var u=n.getModel(),c=Zf(e,s,n),l=c.x,h=c.y;n.set("bbox",c);var f=l,d=h;r?(f=isNaN(u.x)?l:u.x,d=isNaN(u.y)?h:u.y):(f=isNaN(l)?u.x:l,d=isNaN(h)?u.y:h),n.update({x:f,y:d});var p=n.get("shapeFactory"),g=u.type||"circle",v=u.animate===void 0?(a=(o=p[g])===null||o===void 0?void 0:o.options)===null||a===void 0?void 0:a.animate:u.animate;v?setTimeout(function(){if(!(!n||n.destroyed)){var m=n.getKeyShape();!m||m.destroyed||(n.getShapeCfg(u),i.updateComboEdges(n))}},201):this.updateComboEdges(n)}},t.prototype.updateComboEdges=function(n){for(var e,r,i=n.getEdges()||[],o=0;o<i.length;o++){var a=i[o];!(a!=null&&a.destroyed)&&!(!((e=a==null?void 0:a.getSource())===null||e===void 0)&&e.destroyed)&&!(!((r=a==null?void 0:a.getTarget())===null||r===void 0)&&r.destroyed)&&a.refresh()}},t.prototype.collapseCombo=function(n,e){e===void 0&&(e=!0);var r=this.graph;Dt(n)&&(n=r.findById(n));var i=n.getChildren();i.nodes.forEach(function(o){r.hideItem(o,e)}),i.combos.forEach(function(o){r.hideItem(o,e)})},t.prototype.updateComboSucceeds=function(n,e,r,i){var o=this;i===void 0&&(i=[]);var a=this.graph;if(!(!e&&!r)){var s=i;if(!(s!=null&&s.length)){var u=a.get("comboTrees");u==null||u.forEach(function(c){_r(c,function(l){return l.id===n?(s=l.children,!1):!0})})}s==null||s.forEach(function(c){var l=a.findById(c.id);if(l){var h=l.getModel();o.updateItem(c.id,{x:(h.x||0)+e,y:(h.y||0)+r})}})}},t.prototype.expandCombo=function(n,e){e===void 0&&(e=!0);var r=this.graph;Dt(n)&&(n=r.findById(n));var i=n.getChildren(),o=new Set;i.nodes.forEach(function(a){r.showItem(a,e),a.getEdges().forEach(function(s){return o.add(s)})}),i.combos.forEach(function(a){a.getModel().collapsed?a.show():r.showItem(a,e),a.getEdges().forEach(function(s){return o.add(s)})}),o.forEach(function(a){return a.refresh()})},t.prototype.removeItem=function(n){var e=this,r=this.graph;if(Dt(n)&&(n=r.findById(n)),!(!n||n.destroyed)){var i=Xe(n.getModel()),o="";n.getType&&(o=n.getType()),r.emit("beforeremoveitem",{item:i,type:o});var a=r.get("".concat(o,"s")),s=a.indexOf(n);if(s>-1&&a.splice(s,1),o===af){var u=r.get("v".concat(o,"s")),c=u.indexOf(n);c>-1&&u.splice(c,1)}var l=n.get("id"),h=r.get("itemMap");delete h[l];var f=r.get("comboTrees"),d=n.get("id");if(o===of){var p=n.getModel().comboId;if(f&&p){var g=f,v=!1;f.forEach(function(E){v||_r(E,function(M){if(M.id===d&&g){var _=g.indexOf(M);return g.splice(_,1),v=!0,!1}return g=M.children,!0})})}for(var m=n.getEdges(),y=m.length-1;y>=0;y--)r.removeItem(m[y],!1);p&&r.updateCombo(p)}else if(o===Mc){var b=n.getModel().parentId,x,w=!1;(f||[]).forEach(function(E){w||_r(E,function(M){return M.id===d?(x=M,w=!0,!1):!0})}),x.removed=!0,x&&x.children&&x.children.forEach(function(E){e.removeItem(E.id)});for(var m=n.getEdges(),y=m.length;y>=0;y--)r.removeItem(m[y],!1);b&&r.updateCombo(b)}n.destroy(),r.emit("afterremoveitem",{item:i,type:o})}},t.prototype.setItemState=function(n,e,r){var i=this.graph,o=e;Dt(r)&&(o="".concat(e,":").concat(r)),!(n.hasState(o)===r&&r||Dt(r)&&n.hasState(o))&&(i.emit("beforeitemstatechange",{item:n,state:o,enabled:r}),n.setState(e,r),i.autoPaint(),i.emit("afteritemstatechange",{item:n,state:o,enabled:r}))},t.prototype.priorityState=function(n,e){var r=this.graph,i=n;Dt(n)&&(i=r.findById(n)),this.setItemState(i,e,!1),this.setItemState(i,e,!0)},t.prototype.clearItemStates=function(n,e){var r=this.graph;Dt(n)&&(n=r.findById(n)),r.emit("beforeitemstatesclear",{item:n,states:e}),n.clearStates(e),r.emit("afteritemstatesclear",{item:n,states:e})},t.prototype.refreshItem=function(n){var e=this.graph;Dt(n)&&(n=e.findById(n)),e.emit("beforeitemrefresh",{item:n}),n.refresh(),e.emit("afteritemrefresh",{item:n})},t.prototype.addCombos=function(n,e){var r=this,i=this.graph;(n||[]).forEach(function(a){$i(a,function(s){var u;return e.forEach(function(c){c.id===s.id&&(c.children=s.children,c.depth=s.depth,u=c)}),u&&r.addItem("combo",u),!0})});var o=i.get("comboGroup");o&&o.sort()},t.prototype.changeItemVisibility=function(n,e){var r=this,i=this.graph;if(Dt(n)&&(n=i.findById(n)),!n){console.warn("The item to be shown or hidden does not exist!");return}if(i.emit("beforeitemvisibilitychange",{item:n,visible:e}),n.changeVisibility(e),n.getType&&n.getType()===of){var o=n.getEdges();mt(o,function(l){e&&!(l.get("source").isVisible()&&l.get("target").isVisible())||r.changeItemVisibility(l,e)})}else if(n.getType&&n.getType()===Mc){var a=i.get("comboTrees"),s=n.get("id"),u=[],c=!1;(a||[]).forEach(function(h){c||!h.children||h.children.length===0||_r(h,function(f){return f.id===s?(u=f.children,c=!0,!1):!0})}),u&&(!e||e&&!n.getModel().collapsed)&&u.forEach(function(h){var f=i.findById(h.id);r.changeItemVisibility(f,e)});var o=n.getEdges();mt(o,function(h){e&&!(h.get("source").isVisible()&&h.get("target").isVisible())||r.changeItemVisibility(h,e)})}return i.emit("afteritemvisibilitychange",{item:n,visible:e}),n},t.prototype.destroy=function(){this.graph=null,this.destroyed=!0},t}(),eG=function(){function t(n){this.graph=n,this.destroyed=!1}return t.prototype.updateState=function(n,e,r){var i=this.graph.get("states"),o=e;Dt(r)&&(o="".concat(e,":").concat(r)),i[o]||(i[o]=[]),r?i[o].push(n):i[o]=i[o].filter(function(a){return a!==n}),this.graph.set("states",i),this.graph.emit("graphstatechange",{states:i})},t.prototype.updateStates=function(n,e,r){var i=this.graph.get("states"),o=Dt(e)?[e]:e;o.forEach(function(a){var s=a;i[s]||(i[s]=[]),Dt(r)&&(s="".concat(a,":").concat(r)),r?i[s].push(n):i[s]=i[s].filter(function(u){return u!==n})}),this.graph.set("states",i),this.graph.emit("graphstatechange",{states:e})},t.prototype.destroy=function(){this.graph=null,this.destroyed=!0},t}(),nG=function(t,n){return!t||!n?t:t.replace(/\\?\{([^{}]+)\}/g,function(e,r){if(e.charAt(0)==="\\")return e.slice(1);var i=n[r];return i===0&&(i="0"),i||""})},II=function(t){var n=[];if(t.length<2)throw new Error("point length must largn than 2, now it's ".concat(t.length));for(var e=0,r=t;e<r.length;e++){var i=r[e],o=i.x,a=i.y;n.push(o),n.push(a)}var s=vI(n);return s.unshift(["M",t[0].x,t[0].y]),s},Id=function(t,n,e,r){e===void 0&&(e=0),r===void 0&&(r=0);var i={x:(1-e)*t.x+e*n.x,y:(1-e)*t.y+e*n.y},o=[0,0];_a(o,[n.x-t.x,n.y-t.y]),(!o||!o[0]&&!o[1])&&(o=[0,0]);var a=[-o[1]*r,o[0]*r];return i.x+=a[0],i.y+=a[1],i},rG=function(t,n){var e=t.length;if(!e)return"";for(var r="",i="",o=0;o<e;o++){var a=t[o];o===0?i="M{x} {y}":i="L{x} {y}",r+=nG(i,a)}return n&&(r+="Z"),r},Qv=function(t){var n=[];return t.forEach(function(e){var r=e[0];if(r!=="A")for(var i=1;i<e.length;i=i+2)n.push([e[i],e[i+1]]);else{var o=e.length;n.push([e[o-2],e[o-1]])}}),n},Jv=function(t){if(t.length<2)throw new Error("point length must largn than 2, now it's ".concat(t.length));var n=t[0],e=t[1],r=t[t.length-1],i=t[t.length-2];t.unshift(r),t.unshift(i),t.push(n),t.push(e);for(var o=[],a=1;a<t.length-2;a+=1){var s=t[a-1].x,u=t[a-1].y,c=t[a].x,l=t[a].y,h=t[a+1].x,f=t[a+1].y,d=a!==t.length-2?t[a+2].x:h,p=a!==t.length-2?t[a+2].y:f,g=c+(h-s)/6,v=l+(f-u)/6,m=h-(d-c)/6,y=f-(p-l)/6;o.push(["C",g,v,m,y,h,f])}return o.unshift(["M",r.x,r.y]),o},j2=function(t,n){return kr([0,0],_a([0,0],t),n)},R2=function(t,n){var e=[t[1]-n[1],n[0]-t[0]],r=Math.sqrt(e[0]*e[0]+e[1]*e[1]);if(r===0)throw new Error("p0 should not be equal to p1");return[e[0]/r,e[1]/r]},F2=function(t,n){return[n[0]-t[0],n[1]-t[1]]};function $v(t,n){var e=function(l){var h=[l[0][0],l[0][1]-n],f=[l[0][0],l[0][1]+n];return"M ".concat(h," A ").concat(n,",").concat(n,",0,0,0,").concat(f," A ").concat(n,",").concat(n,",0,0,0,").concat(h)},r=function(l){var h=kr([0,0],R2(l[0],l[1]),n),f=kr([0,0],h,-1),d=pr([0,0],l[0],h),p=pr([0,0],l[1],h),g=pr([0,0],l[1],f),v=pr([0,0],l[0],f);return"M ".concat(d," L ").concat(p," A ").concat([n,n,"0,0,0",g].join(",")," L ").concat(v," A ").concat([n,n,"0,0,0",d].join(","))};if(!t||t.length<1)return"";if(t.length===1)return e(t);if(t.length===2)return r(t);for(var i=new Array(t.length),o=0;o<i.length;++o){var a=o===0?t[t.length-1]:t[o-1],s=t[o],u=kr([0,0],R2(a,s),n);i[o]=[pr([0,0],a,u),pr([0,0],s,u)]}var c="A ".concat([n,n,"0,0,0,"].join(","));return i=i.map(function(l,h){var f="";return h===0&&(f="M ".concat(i[i.length-1][1]," ")),f+="".concat(c+l[0]," L ").concat(l[1]),f}),i.join(" ")}function TI(t,n){var e=t.length,r=function(c){var l=[c[0][0],c[0][1]-n],h=[c[0][0],c[0][1]+n];return"M ".concat(l," A ").concat([n,n,"0,0,0",h].join(",")," A ").concat([n,n,"0,0,0",l].join(","))},i=function(c){var l=F2(c[0],c[1]),h=j2(l,n),f=pr([0,0],c[0],kr([0,0],h,-1)),d=pr([0,0],c[1],h),p=1.2*n,g=j2(_a([0,0],l),p),v=kr([0,0],g,-1),m=pr([0,0],f,v),y=pr([0,0],d,v),b=pr([0,0],f,g);return"M ".concat(f," C ").concat([m,y,d].join(",")," S ").concat([b,f].join(",")," Z")};if(!t||e<1)return"";if(e===1)return r(t);if(e===2)return i(t);for(var o=t.map(function(c,l){var h=t[(l+1)%e];return{p:c,v:_a([0,0],F2(c,h))}}),a=0;a<o.length;++a){var s=a>0?a-1:e-1,u=_a([0,0],pr([0,0],o[s].v,kr([0,0],o[a].v,-1)));o[a].p=pr([0,0],o[a].p,kr([0,0],u,n))}return o.map(function(c){var l=c.p;return{x:l[0],y:l[1]}})}var iG=function(t,n){for(var e=[],r=0;r<5;r++){var i=Math.cos((18+72*r)/180*Math.PI)*t,o=Math.sin((18+72*r)/180*Math.PI)*t,a=Math.cos((54+72*r)/180*Math.PI)*n,s=Math.sin((54+72*r)/180*Math.PI)*n;r===0?e.push(["M",i,-o]):e.push(["L",i,-o]),e.push(["L",a,-s])}return e.push(["Z"]),e};const oG=Object.freeze(Object.defineProperty({__proto__:null,getClosedSpline:Jv,getControlPoint:Id,getSpline:II,getStarPath:iG,paddedHull:TI,pathToPoints:Qv,pointsToPolygon:rG,roundedHull:$v},Symbol.toStringTag,{value:"Module"}));var B2=function(t,n,e){return(t.y-e.y)*(n.x-e.x)-(t.x-e.x)*(n.y-e.y)},z2=function(t){var n=t.map(function(l){return{x:l.getModel().x,y:l.getModel().y}});n.sort(function(l,h){return l.x===h.x?l.y-h.y:l.x-h.x});for(var e={},r=n.length-1;r>=0;r--){var i=n[r],o=i.x,a=i.y;e["".concat(o,"-").concat(a)]&&n.splice(r,1),e["".concat(o,"-").concat(a)]=!0}if(n.length===1)return n;for(var s=[],r=0;r<n.length;r++){for(;s.length>=2&&B2(s[s.length-2],s[s.length-1],n[r])<=0;)s.pop();s.push(n[r])}for(var u=[],r=n.length-1;r>=0;r--){for(;u.length>=2&&B2(u[u.length-2],u[u.length-1],n[r])<=0;)u.pop();u.push(n[r])}u.pop(),s.pop();var c=s.concat(u);return c},aG={maxRoutingIterations:100,maxMarchingIterations:100,pixelGroupSize:2,edgeR0:10,edgeR1:10,nodeR0:5,nodeR1:10,morphBuffer:5,threshold:.001,skip:16,nodeInfluenceFactor:1,edgeInfluenceFactor:1,negativeNodeInfluenceFactor:-.5};function sG(t,n,e){var r=!1,i=function(s,u){return n.cells[s+u*n.width]},o=function(s,u){var c=0;return i(s-1,u-1)>=e&&(c+=1),i(s,u-1)>e&&(c+=2),i(s-1,u)>e&&(c+=4),i(s,u)>e&&(c+=8),c},a=function(s,u){for(var c=s,l=u,h,f,d=0;d<n.width*n.height;d++){if(h=c,f=l,t.findIndex(function(g){return g.x===c&&g.y===l})>-1){if(!(t[0].x!==c||t[0].y!==l))return!0}else t.push({x:c,y:l});var p=o(c,l);switch(p){case-1:return console.warn("Marched out of bounds"),!0;case 0:case 3:case 2:case 7:c++;break;case 12:case 14:case 4:c--;break;case 6:h===0&&(f===-1?c-=1:c+=1);break;case 1:case 13:case 5:l--;break;case 9:h===1&&(f===0?l-=1:l+=1);break;case 10:case 8:case 11:l++;break;default:return console.warn("Marching squares invalid state: ".concat(p)),!0}}};this.march=function(){for(var s=0;s<n.width&&!r;s+=1)for(var u=0;u<n.height&&!r;u+=1)i(s,u)>e&&o(s,u)!==15&&(r=a(s,u));return r}}var uG=function(t,n,e){var r=Math.ceil(t/e),i=Math.ceil(n/e),o=new Float32Array(Math.max(0,r*i)).fill(0);return{cells:o,width:r,height:i}},cG=function(t,n,e){var r=null,i=Number.POSITIVE_INFINITY;return n.forEach(function(o){var a={x:t.getModel().x,y:t.getModel().y},s={x:o.getModel().x,y:o.getModel().y},u=Ed(a,s),c=new _s(a.x,a.y,s.x,s.y),l=e.reduce(function(h,f){return Py(f,c)>0?h+1:h},0);u*Math.pow(l+1,2)<i&&(r=o,i=u*Math.pow(l+1,2))}),r},OI=function(t,n){var e=Number.POSITIVE_INFINITY,r=null;return t.forEach(function(i){var o=Py(i,n);o>=0&&o<e&&(r=i,e=o)}),r},lG=function(t,n,e,r){var i=[],o=[];o.push(t);for(var a=!0,s=0,u=function(h,f){var d=!1;return f.forEach(function(p){d||(_v(h,{x:p.x1,y:p.y1})||_v(h,{x:p.x2,y:p.y2}))&&(d=!0)}),d},c=function(h,f){for(var d=0,p=f;d<p.length;d++){var g=p[d],v=g.getBBox(),m=[[v.x,v.y],[v.x+v.width,v.y],[v.x,v.y+v.height],[v.x+v.width,v.y+v.height]];if(gl(m,h.x,h.y))return!0}return!1};a&&s<e;){a=!1;for(var l=function(){var h=o.pop(),f=OI(n,h);if(f){var d=yC(f,h),p=d[0],g=d[1];if(g===2){var v=function(m){for(var y=r,b=G2(f,y,p,m),x=u(b,o)||u(b,i),w=c(b,n);!x&&w&&y>=1;)y/=1.5,b=G2(f,y,p,m),x=u(b,o)||u(b,i),w=c(b,n);b&&!x&&(!m||!w)&&(o.push(new _s(h.x1,h.y1,b.x,b.y)),o.push(new _s(b.x,b.y,h.x2,h.y2)),a=!0)};v(!0),a||v(!1)}}a||i.push(h),s+=1};!a&&o.length;)l()}for(;o.length;)i.push(o.pop());return i};function hG(t,n,e,r,i){var o=cG(t,e,n);if(o===null)return[];var a=function(l){for(var h=[];l.length>0;){var f=l.pop();if(l.length===0){h.push(f);break}var d=l.pop(),p=new _s(f.x1,f.y1,d.x2,d.y2),g=OI(n,p);g?(h.push(f),l.push(d)):l.push(p)}return h},s=new _s(t.getModel().x,t.getModel().y,o.getModel().x,o.getModel().y),u=lG(s,n,r,i),c=a(u);return c}var fG=function(t,n,e){var r=Object.assign(aG,e),i=bC(t.map(function(m){return{x:m.getModel().x,y:m.getModel().y}}));t=t.sort(function(m,y){return Ed({x:m.getModel().x,y:m.getModel().y},i)-Ed({x:y.getModel().x,y:y.getModel().y},i)});var o=[],a=[];t.forEach(function(m){var y=hG(m,n,o,r.maxRoutingIterations,r.morphBuffer);y.forEach(function(b){a.push(b)}),o.push(m)});for(var s=dG(t,a,r.nodeR0),u=uG(s.width,s.height,r.pixelGroupSize),c=[],l=[],h=0;h<r.maxMarchingIterations;h++)if(pG(t,n,a,s,u,r),c=[],l=[],!!new sG(c,u,r.threshold).march()){var f=c.map(function(m){return{x:Math.round(m.x*r.pixelGroupSize+s.minX),y:Math.round(m.y*r.pixelGroupSize+s.minY)}});if(f){var d=f.length;if(r.skip>1)for(d=Math.floor(f.length/r.skip);d<3&&r.skip>1;)r.skip-=1,d=Math.floor(f.length/r.skip);for(var p=0,g=0;g<d;g+=1,p+=r.skip)l.push({x:f[p].x,y:f[p].y})}var v=function(){for(var m=0,y=t;m<y.length;m++){var b=y[m],x=l.map(function(w){return[w.x,w.y]});if(!gl(x,b.getBBox().centerX,b.getBBox().centerY))return!1}return!0};if(l&&v())return l;if(r.threshold*=.9,h<=r.maxMarchingIterations*.5)r.memberInfluenceFactor*=1.2,r.edgeInfluenceFactor*=1.2;else if(r.nonMemberInfluenceFactor!==0&&n.length>0)r.nonMemberInfluenceFactor*=.8;else break}return l};function dG(t,n,e){var r={minX:Number.POSITIVE_INFINITY,minY:Number.POSITIVE_INFINITY,maxX:Number.NEGATIVE_INFINITY,maxY:Number.NEGATIVE_INFINITY,width:0,height:0,x:0,y:0},i=[];t.forEach(function(u){i.push(u.getBBox())}),n.forEach(function(u){i.push(u.getBBox())});for(var o=0,a=i;o<a.length;o++){var s=a[o];r.minX=(s.minX<r.minX?s.minX:r.minX)-e,r.minY=(s.minY<r.minY?s.minY:r.minY)-e,r.maxX=(s.maxX>r.maxX?s.maxX:r.maxX)+e,r.maxY=(s.maxY>r.maxY?s.maxY:r.maxY)+e}return r.width=r.maxX-r.minX,r.height=r.maxY-r.minY,r.x=r.minX,r.y=r.minY,r}function pG(t,n,e,r,i,o){function a(d,p){var g=Math.floor((d-p)/o.pixelGroupSize);return g<0?0:g}function s(d,p){return d*o.pixelGroupSize+p}var u=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),c=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1),l=function(d,p){var g=Math.min(a(d.minX,p+r.minX),i.width),v=Math.min(a(d.minY,p+r.minY),i.height),m=Math.min(a(d.maxX,-p+r.minX),i.width),y=Math.min(a(d.maxY,-p+r.minY),i.height);return[g,v,m,y]},h=function(d,p){for(var g=d.getBBox(),v=l(g,o.nodeR1),m=v[0],y=v[1],b=v[2],x=v[3],w=y;w<x;w+=1)for(var E=m;E<b;E+=1)if(!(p<0&&i[E+w*i.width]<=0)){var M=s(E,r.minX),_=s(w,r.minY),k=wC({x:M,y:_},{x:g.minX,y:g.minY,width:g.width,height:g.height});if(k<Math.pow(o.nodeR1,2)){var S=Math.sqrt(k)-o.nodeR1;i.cells[E+w*i.width]+=p*S*S}}},f=function(d,p){for(var g=d.getBBox(),v=l(g,o.edgeR1),m=v[0],y=v[1],b=v[2],x=v[3],w=y;w<x;w+=1)for(var E=m;E<b;E+=1)if(!(p<0&&i.cells[E+w*i.width]<=0)){var M=s(E,r.minX),_=s(w,r.minY),k=xC({x:M,y:_},d);if(k<Math.pow(o.edgeR1,2)){var S=Math.sqrt(k)-o.edgeR1;i.cells[E+w*i.width]+=p*S*S}}};o.nodeInfluenceFactor&&t.forEach(function(d){h(d,o.nodeInfluenceFactor/u)}),o.edgeInfluenceFactor&&e.forEach(function(d){f(d,o.edgeInfluenceFactor/c)}),o.negativeNodeInfluenceFactor&&n.forEach(function(d){h(d,o.negativeNodeInfluenceFactor/u)})}function G2(t,n,e,r){var i=t.getBBox(),o=e[0],a=e[1],s=e[2],u=e[3],c={topLeft:{x:i.minX-n,y:i.minY-n},topRight:{x:i.maxX+n,y:i.minY-n},bottomLeft:{x:i.minX-n,y:i.maxY+n},bottomRight:{x:i.maxX+n,y:i.maxY+n}},l=i.height*i.width;function h(p,g){return i.width*((p.y-i.minY+(g.y-i.minY))*.5)}if(a){if(o)return r?c.topLeft:c.bottomRight;if(s)return r?c.bottomLeft:c.topRight;var f=h(a,u);return f<l*.5?a.y>u.y?r?c.topLeft:c.bottomRight:r?c.topRight:c.bottomLeft:a.y<u.y?r?c.bottomLeft:c.topRight:r?c.bottomRight:c.topLeft}if(u){if(o)return r?c.topRight:c.bottomLeft;if(s)return r?c.bottomRight:c.topLeft}var d=h(o,s);return d<l*.5?o.x>s.x?r?c.topLeft:c.bottomRight:r?c.bottomLeft:c.topRight:o.x<s.x?r?c.topRight:c.bottomLeft:r?c.bottomRight:c.topLeft}var gG=function(){function t(n,e){this.cfg=mn(this.getDefaultCfg(),e),this.graph=n,this.id=this.cfg.id,this.group=this.cfg.group,this.members=this.cfg.members.map(function(r){return Dt(r)?n.findById(r):r}),this.nonMembers=this.cfg.nonMembers.map(function(r){return Dt(r)?n.findById(r):r}),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()}return t.prototype.getDefaultCfg=function(){return{id:"g6-hull",type:"round-convex",members:[],nonMembers:[],style:{fill:"lightblue",stroke:"blue",opacity:.2},padding:10}},t.prototype.setPadding=function(){var n=this.members.length&&this.members[0].getKeyShape().getCanvasBBox().width/2;this.padding=this.cfg.padding>0?this.cfg.padding+n:10+n,this.cfg.bubbleCfg={nodeR0:this.padding-n,nodeR1:this.padding-n,morphBuffer:this.padding-n}},t.prototype.setType=function(){this.type=this.cfg.type,this.members.length<3&&(this.type="round-convex"),this.type!=="round-convex"&&this.type!=="smooth-convex"&&this.type!=="bubble"&&(console.warn("The hull type should be either round-convex, smooth-convex or bubble, round-convex is used by default."),this.type="round-convex")},t.prototype.calcPath=function(n,e){var r,i,o;switch(this.type){case"round-convex":r=z2(n),o=$v(r.map(function(a){return[a.x,a.y]}),this.padding),i=Xv(o);break;case"smooth-convex":r=z2(n),r.length===2?(o=$v(r.map(function(a){return[a.x,a.y]}),this.padding),i=Xv(o)):r.length>2&&(o=TI(r.map(function(a){return[a.x,a.y]}),this.padding),i=Jv(o));break;case"bubble":r=fG(n,e,this.cfg.bubbleCfg),i=r.length>=2&&Jv(r);break}return i},t.prototype.render=function(){this.group.addShape("path",{attrs:B({path:this.path},this.cfg.style),id:this.id,name:this.cfg.id,capture:!1}),this.group.toBack()},t.prototype.addMember=function(n){if(n){Dt(n)&&(n=this.graph.findById(n)),this.members.push(n);var e=this.nonMembers.indexOf(n);return e>-1&&this.nonMembers.splice(e,1),this.updateData(this.members,this.nonMembers),!0}},t.prototype.addNonMember=function(n){if(n){Dt(n)&&(n=this.graph.findById(n)),this.nonMembers.push(n);var e=this.members.indexOf(n);return e>-1&&this.members.splice(e,1),this.updateData(this.members,this.nonMembers),!0}},t.prototype.removeMember=function(n){if(n){Dt(n)&&(n=this.graph.findById(n));var e=this.members.indexOf(n);return e>-1?(this.members.splice(e,1),this.updateData(this.members,this.nonMembers),!0):!1}},t.prototype.removeNonMember=function(n){if(n){Dt(n)&&(n=this.graph.findById(n));var e=this.nonMembers.indexOf(n);return e>-1?(this.nonMembers.splice(e,1),this.updateData(this.members,this.nonMembers),!0):!1}},t.prototype.updateData=function(n,e){var r=this;this.group.findById(this.id).remove(),n&&(this.members=n.map(function(i){return Dt(i)?r.graph.findById(i):i})),e&&(this.nonMembers=e.map(function(i){return Dt(i)?r.graph.findById(i):i})),this.path=this.calcPath(this.members,this.nonMembers),this.render()},t.prototype.updateStyle=function(n){var e=this.group.findById(this.id);e.attr(B({},n))},t.prototype.updateCfg=function(n){var e=this;this.cfg=mn(this.cfg,n),this.id=this.cfg.id,this.group=this.cfg.group,n.members&&(this.members=this.cfg.members.map(function(r){return Dt(r)?e.graph.findById(r):r})),n.nonMembers&&(this.nonMembers=this.cfg.nonMembers.map(function(r){return Dt(r)?e.graph.findById(r):r})),this.setPadding(),this.setType(),this.path=this.calcPath(this.members,this.nonMembers),this.render()},t.prototype.contain=function(n){var e=this,r;Dt(n)?r=this.graph.findById(n):r=n;var i,o=r.getKeyShape();if(r.get("type")==="path")i=Qv(o.attr("path"));else{var a=o.getCanvasBBox();i=[[a.minX,a.minY],[a.maxX,a.minY],[a.maxX,a.maxY],[a.minX,a.maxY]]}return i=i.map(function(s){var u=e.graph.getPointByCanvas(s[0],s[1]);return[u.x,u.y]}),mC(i,Qv(this.path))},t.prototype.destroy=function(){this.group.remove(),this.cfg=null},t}(),Sc=yi,vG="node",mG=function(t){Te(n,t);function n(e){var r=t.call(this)||this;return r.sortCombos=Fl(function(){var i=r.get("comboSorted");if(!(!r||r.destroyed||i)){r.set("comboSorted",!0);var o=[],a={},s=r.get("comboTrees");(s||[]).forEach(function(c){_r(c,function(l){return o[l.depth]?o[l.depth].push(l.id):o[l.depth]=[l.id],a[l.id]=l.depth,!0})});var u=r.getEdges().concat(r.get("vedges"));(u||[]).forEach(function(c){var l=c.getModel(),h=a[l.source]||0,f=a[l.target]||0,d=Math.max(h,f);o[d]?o[d].push(l.id):o[d]=[l.id]}),o.forEach(function(c){if(!(!c||!c.length))for(var l=c.length-1;l>=0;l--){var h=r.findById(c[l]);h&&h.toFront()}})}},500,!1),r.cfg=mn(r.getDefaultCfg(),e),r.init(),r.animating=!1,r.destroyed=!1,r.cfg.enabledStack&&(r.undoStack=new wu(r.cfg.maxStep),r.redoStack=new wu(r.cfg.maxStep)),r}return n.prototype.init=function(){this.initCanvas();var e=new V9(this),r=new sz(this),i=new tG(this),o=new eG(this);this.set({viewController:e,modeController:r,itemController:i,stateController:o}),this.initLayoutController(),this.initEventController(),this.initGroups(),this.initPlugins()},n.prototype.initGroups=function(){var e=this.get("canvas");if(e){var r=e.get("el"),i=(r||{}).id,o=i===void 0?"g6":i,a=e.addGroup({id:"".concat(o,"-root"),className:he.rootContainerClassName});if(this.get("groupByTypes")){var s=a.addGroup({id:"".concat(o,"-edge"),className:he.edgeContainerClassName}),u=a.addGroup({id:"".concat(o,"-node"),className:he.nodeContainerClassName}),c=a.addGroup({id:"".concat(o,"-combo"),className:he.comboContainerClassName});c.toBack(),this.set({nodeGroup:u,edgeGroup:s,comboGroup:c})}var l=a.addGroup({id:"".concat(o,"-delegate"),className:he.delegateContainerClassName});this.set({delegateGroup:l}),this.set("group",a)}},n.prototype.getDefaultCfg=function(){return{container:void 0,width:void 0,height:void 0,renderer:"canvas",modes:{},plugins:[],data:{},fitViewPadding:10,minZoom:.02,maxZoom:10,event:!0,groupByTypes:!0,directed:!1,autoPaint:!0,nodes:[],edges:[],combos:[],vedges:[],itemMap:{},linkCenter:!1,defaultNode:{},defaultEdge:{},nodeStateStyles:{},edgeStateStyles:{},states:{},animate:!1,animateCfg:{onFrame:void 0,duration:500,easing:"easeLinear"},callback:void 0,enabledStack:!1,maxStep:10,tooltips:[],optimizeThreshold:1e3}},n.prototype.set=function(e,r){return vr(e)?this.cfg=B(B({},this.cfg),e):this.cfg[e]=r,e==="enabledStack"&&r&&!this.undoStack&&!this.redoStack&&(this.undoStack=new wu(this.cfg.maxStep),this.redoStack=new wu(this.cfg.maxStep)),this},n.prototype.get=function(e){var r;return(r=this.cfg)===null||r===void 0?void 0:r[e]},n.prototype.getGroup=function(){return this.get("group")},n.prototype.getContainer=function(){return this.get("container")},n.prototype.getMinZoom=function(){return this.get("minZoom")},n.prototype.setMinZoom=function(e){return this.set("minZoom",e)},n.prototype.getMaxZoom=function(){return this.get("maxZoom")},n.prototype.setMaxZoom=function(e){return this.set("maxZoom",e)},n.prototype.getWidth=function(){return this.get("width")},n.prototype.getHeight=function(){return this.get("height")},n.prototype.clearItemStates=function(e,r){Dt(e)&&(e=this.findById(e));var i=this.get("itemController");r||(r=e.get("states")),i.clearItemStates(e,r);var o=this.get("stateController");o.updateStates(e,r,!1)},n.prototype.node=function(e){typeof e=="function"&&this.set("nodeMapper",e)},n.prototype.edge=function(e){typeof e=="function"&&this.set("edgeMapper",e)},n.prototype.combo=function(e){typeof e=="function"&&this.set("comboMapper",e)},n.prototype.findById=function(e){return this.get("itemMap")[e]},n.prototype.find=function(e,r){var i,o=this.get("".concat(e,"s"));return mt(o,function(a,s){if(r(a,s))return i=a,i}),i},n.prototype.findAll=function(e,r){var i=[];return mt(this.get("".concat(e,"s")),function(o,a){r(o,a)&&i.push(o)}),i},n.prototype.findAllByState=function(e,r,i){return i?this.findAll(e,function(o){return o.hasState(r)&&i(o)}):this.findAll(e,function(o){return o.hasState(r)})},n.prototype.translate=function(e,r,i,o){var a=this,s=this.get("group"),u=Xe(s.getMatrix());if(u||(u=[1,0,0,0,1,0,0,0,1]),i){var c=vl({animateCfg:o,callback:function(){return a.emit("viewportchange",{action:"translate",matrix:s.getMatrix()})}});Sv(s,{x:s.getCanvasBBox().x+e,y:s.getCanvasBBox().y+r},i,c||{duration:500,easing:"easeCubic"})}else u=Sc(u,[["t",e,r]]),s.setMatrix(u),this.emit("viewportchange",{action:"translate",matrix:u}),this.autoPaint()},n.prototype.moveTo=function(e,r,i,o){var a=this.get("group");Sv(a,{x:e,y:r},i,o||{duration:500,easing:"easeCubic"}),this.emit("viewportchange",{action:"move",matrix:a.getMatrix()})},n.prototype.fitView=function(e,r,i,o){e&&this.set("fitViewPadding",e);var a=this.get("viewController");r?a.fitViewByRules(r,i,o):a.fitView(i,o),this.autoPaint()},n.prototype.fitCenter=function(e,r){var i=this.get("viewController");i.fitCenter(e,r),this.autoPaint()},n.prototype.addBehaviors=function(e,r){var i=this.get("modeController");return i.manipulateBehaviors(e,r,!0),this},n.prototype.removeBehaviors=function(e,r){var i=this.get("modeController");return i.manipulateBehaviors(e,r,!1),this},n.prototype.updateBehavior=function(e,r,i){var o=this.get("modeController");return o.updateBehavior(e,r,i),this},n.prototype.zoom=function(e,r,i,o){var a=this,s=this.get("group"),u=Xe(s.getMatrix())||[1,0,0,0,1,0,0,0,1],c=this.get("minZoom"),l=this.get("maxZoom"),h=this.getZoom()||1,f=h*e,d=e,p=!1;if(c&&f<c?(d=c/h,p=!0):l&&f>l&&(d=l/h,p=!0),r?u=Sc(u,[["t",-r.x,-r.y],["s",d,d],["t",r.x,r.y]]):u=Sc(u,[["s",d,d]]),i){var g=Xe(s.getMatrix());g||(g=[1,0,0,0,1,0,0,0,1]);var v=g[0],m=v*d,y=vl({animateCfg:o,callback:function(){return a.emit("viewportchange",{action:"zoom",matrix:s.getMatrix()})}});s.animate(function(b){if(b===1)g=u;else{var x=Ly(v,m,b)/g[0];r?g=Sc(g,[["t",-r.x,-r.y],["s",x,x],["t",r.x,r.y]]):g=Sc(g,[["s",x,x]])}return{matrix:g}},y)}else s.setMatrix(u),this.emit("viewportchange",{action:"zoom",matrix:u}),this.autoPaint();return!p},n.prototype.zoomTo=function(e,r,i,o){var a=e/this.getZoom();return this.zoom(a,r,i,o)},n.prototype.focusItem=function(e,r,i){var o=this.get("viewController"),a=!1;r?a=!0:r===void 0&&(a=this.get("animate"));var s={};i?s=i:i===void 0&&(s=this.get("animateCfg")),o.focus(e,a,s),this.autoPaint()},n.prototype.focusItems=function(e,r,i,o){var a=this.get("viewController");a.focusItems(e,r,i,o)},n.prototype.autoPaint=function(){this.get("autoPaint")&&this.paint()},n.prototype.paint=function(){this.emit("beforepaint"),this.get("canvas").draw(),this.emit("afterpaint")},n.prototype.getPointByClient=function(e,r){var i=this.get("viewController");return i.getPointByClient(e,r)},n.prototype.getClientByPoint=function(e,r){var i=this.get("viewController");return i.getClientByPoint(e,r)},n.prototype.getPointByCanvas=function(e,r){var i=this.get("viewController");return i.getPointByCanvas(e,r)},n.prototype.getCanvasByPoint=function(e,r){var i=this.get("viewController");return i.getCanvasByPoint(e,r)},n.prototype.getGraphCenterPoint=function(){var e=this.get("group").getCanvasBBox();return{x:(e.minX+e.maxX)/2,y:(e.minY+e.maxY)/2}},n.prototype.getViewPortCenterPoint=function(){return this.getPointByCanvas(this.get("width")/2,this.get("height")/2)},n.prototype.showItem=function(e,r){r===void 0&&(r=!0);var i=this.get("itemController"),o=i.changeItemVisibility(e,!0);if(r&&this.get("enabledStack")){var a=o.getID(),s=o.getType(),u={},c={};switch(s){case"node":u.nodes=[{id:a,visible:!1}],c.nodes=[{id:a,visible:!0}];break;case"edge":u.nodes=[{id:a,visible:!1}],c.edges=[{id:a,visible:!0}];break;case"combo":u.nodes=[{id:a,visible:!1}],c.combos=[{id:a,visible:!0}];break}this.pushStack("visible",{before:u,after:c})}},n.prototype.hideItem=function(e,r){r===void 0&&(r=!0);var i=this.get("itemController"),o=i.changeItemVisibility(e,!1);if(r&&this.get("enabledStack")){var a=o.getID(),s=o.getType(),u={},c={};switch(s){case"node":u.nodes=[{id:a,visible:!0}],c.nodes=[{id:a,visible:!1}];break;case"edge":u.nodes=[{id:a,visible:!0}],c.edges=[{id:a,visible:!1}];break;case"combo":u.nodes=[{id:a,visible:!0}],c.combos=[{id:a,visible:!1}];break}this.pushStack("visible",{before:u,after:c})}},n.prototype.refreshItem=function(e){var r=this.get("itemController");r.refreshItem(e)},n.prototype.setAutoPaint=function(e){var r=this;r.set("autoPaint",e);var i=r.get("canvas");i.set("autoDraw",e)},n.prototype.remove=function(e,r){r===void 0&&(r=!0),this.removeItem(e,r)},n.prototype.removeItem=function(e,r){r===void 0&&(r=!0);var i=e;if(Dt(e)&&(i=this.findById(e)),!i&&Dt(e))console.warn("The item ".concat(e," to be removed does not exist!"));else if(i){var o="";if(i.getType&&(o=i.getType()),r&&this.get("enabledStack")){var a=B(B({},i.getModel()),{itemType:o}),s={};switch(o){case"node":{s.nodes=[a],s.edges=[];for(var u=i.getEdges(),c=u.length-1;c>=0;c--)s.edges.push(B(B({},u[c].getModel()),{itemType:"edge"}));break}case"edge":s.edges=[a];break;case"combo":s.combos=[a];break}this.pushStack("delete",{before:s,after:{}})}if(o==="node"){var l=i.getModel();l.comboId&&this.updateComboTree(i,void 0,!1)}var h=this.get("itemController");if(h.removeItem(i),o==="combo"){var f=Tv(this.get("comboTrees"));this.set("comboTrees",f)}}},n.prototype.innerAddItem=function(e,r,i){if(!az(e,r))return!1;if(r.id&&this.findById(r.id)){console.warn("This item exists already. Be sure the id %c".concat(r.id,"%c is unique."),"font-size: 20px; color: red;","");return}var o,a=this.get("comboTrees")||[];if(e==="combo"){var s=this.get("itemMap"),u=!1;if(a.forEach(function(p){u||$i(p,function(g){if(r.parentId===g.id){u=!0;var v=B({id:r.id,depth:g.depth+2},r);g.children?g.children.push(v):g.children=[v],r.depth=v.depth,o=i.addItem(e,r)}var m=s[g.id];return u&&m&&m.getType&&m.getType()==="combo"&&i.updateCombo(m,g.children),!0})}),!u){var c=B({id:r.id,depth:0},r);r.depth=c.depth,a.push(c),o=i.addItem(e,r)}this.set("comboTrees",a),r.collapsed&&(this.collapseCombo(o,!1),this.updateCombo(o))}else if(e==="node"&&Dt(r.comboId)&&a){var l=this.findById(r.comboId);l&&l.getType&&l.getType()!=="combo"&&console.warn("'".concat(r.comboId,"' is not a id of a combo in the graph, the node will be added without combo.")),o=i.addItem(e,r);var h=this.get("itemMap"),f=!1,d=!1;a.forEach(function(p){d||f||$i(p,function(g){if(g.id===r.id)return d=!0,!1;if(r.comboId===g.id&&!d){f=!0;var v=Xe(r);v.itemType="node",g.children?g.children.push(v):g.children=[v],v.depth=g.depth+1}return f&&h[g.id].getType&&h[g.id].getType()==="combo"&&i.updateCombo(h[g.id],g.children),!0})})}else o=i.addItem(e,r);if(e==="node"&&r.comboId||e==="combo"&&r.parentId){var l=this.findById(r.comboId||r.parentId);l&&l.getType&&l.getType()==="combo"&&l.addChild(o)}return o},n.prototype.addItem=function(e,r,i,o){i===void 0&&(i=!0),o===void 0&&(o=!0);var a=this.get("comboSorted");this.set("comboSorted",a&&!o);var s=this.get("itemController"),u=this.innerAddItem(e,r,s);if(u===!1||u===!0)return u;var c=this.get("combos");if(c&&c.length>0&&this.sortCombos(),this.autoPaint(),i&&this.get("enabledStack")){var l=B(B({},u.getModel()),{itemType:e}),h={};switch(e){case"node":h.nodes=[l];break;case"edge":h.edges=[l];break;case"combo":h.combos=[l];break}this.pushStack("add",{before:{},after:h})}return u},n.prototype.addItems=function(e,r,i){e===void 0&&(e=[]),r===void 0&&(r=!0),i===void 0&&(i=!0);var o=this.get("comboSorted");this.set("comboSorted",o&&!i);for(var a=this.get("itemController"),s=[],u=0;u<e.length;u++){var c=e[u];c.type!=="edge"&&c.type!=="vedge"?s.push(this.innerAddItem(c.type,c.model,a)):s.push(void 0)}for(var u=0;u<e.length;u++){var c=e[u];(c.type==="edge"||c.type==="vedge")&&(s[u]=this.innerAddItem(c.type,c.model,a))}if(i){var l=this.get("combos");l&&l.length>0&&this.sortCombos()}if(this.autoPaint(),r&&this.get("enabledStack")){for(var h={nodes:[],edges:[],combos:[]},u=0;u<e.length;u++){var f=e[u].type,d=s[u];if(d&&d!==!0){var p=B(B({},d.getModel()),{itemType:f});switch(f){case"node":h.nodes.push(p);break;case"edge":h.edges.push(p);break;case"combo":h.combos.push(p);break}}}this.pushStack("addItems",{before:{},after:h})}return s},n.prototype.add=function(e,r,i,o){return i===void 0&&(i=!0),o===void 0&&(o=!0),this.addItem(e,r,i,o)},n.prototype.updateItem=function(e,r,i){var o=this;i===void 0&&(i=!0);var a=this.get("itemController"),s;Dt(e)?s=this.findById(e):s=e;var u=i&&this.get("enabledStack"),c;u&&(c=Xe(s.getModel()));var l="";s.getType&&(l=s.getType());var h=Di([],s.getStates(),!0);if(l==="combo"&&mt(h,function(g){return o.setItemState(s,g,!1)}),a.updateItem(s,r),l==="combo"&&mt(h,function(g){return o.setItemState(s,g,!0)}),u){var f={nodes:[],edges:[],combos:[]},d={nodes:[],edges:[],combos:[]},p=B({id:c.id},r);switch(l){case"node":f.nodes.push(c),d.nodes.push(p);break;case"edge":f.edges.push(c),d.edges.push(p);break;case"combo":f.combos.push(c),d.combos.push(p);break}this.pushStack("update",{before:f,after:d})}},n.prototype.update=function(e,r,i){i===void 0&&(i=!0),this.updateItem(e,r,i)},n.prototype.setItemState=function(e,r,i){Dt(e)&&(e=this.findById(e));var o=this.get("itemController");o.setItemState(e,r,i);var a=this.get("stateController");a.updateState(e,r,i)},n.prototype.priorityState=function(e,r){var i=this.get("itemController");i.priorityState(e,r)},n.prototype.data=function(e){Nw(e),this.set("data",e)},n.prototype.render=function(){var e=this;this.set("comboSorted",!1);var r=this.get("data");if(this.get("enabledStack")&&this.clearStack(),!r)throw new Error("data must be defined first");var i=r.nodes,o=i===void 0?[]:i,a=r.edges,s=a===void 0?[]:a,u=r.combos,c=u===void 0?[]:u;if(this.clear(!0),this.emit("beforerender"),e.addItems(o.map(function(v){return{type:"node",model:v}}),!1,!1),(c==null?void 0:c.length)!==0){var l=Iv(c,o);this.set("comboTrees",l),e.addCombos(c)}e.addItems(s.map(function(v){return{type:"edge",model:v}}),!1,!1);var h=e.get("animate");(e.get("fitView")||e.get("fitCenter"))&&e.set("animate",!1);var f=e.get("layoutController");if(f){if(f.layout(d),this.destroyed)return}else d();function d(){(e.get("comboTrees")||[]).forEach(function(v){$i(v,function(m){var y=e.findById(m.id);return y.getType()==="combo"&&m.collapsed&&(e.collapseCombo(m.id,!1),e.updateCombo(y)),!0})}),e.get("fitView")?e.fitView():e.get("fitCenter")&&e.fitCenter(),e.autoPaint(),e.emit("afterrender"),(e.get("fitView")||e.get("fitCenter"))&&e.set("animate",h),setTimeout(function(){var v;(v=e.getCombos())===null||v===void 0||v.forEach(function(m){m.set("animate",!0)})},0)}if(!this.get("groupByTypes"))if(c&&c.length!==0)this.sortCombos();else if(r.nodes&&r.edges&&r.nodes.length<r.edges.length){var p=this.getNodes();p.forEach(function(v){v.toFront()})}else{var g=this.getEdges();g.forEach(function(v){v.toBack()})}},n.prototype.read=function(e){this.data(e),this.render()},n.prototype.diffItems=function(e,r,i){var o=this,a,s=this.get("itemMap");mt(i,function(u){if(a=s[u.id],a){if(o.get("animate")&&e===vG){var c=a.getContainer().getMatrix();c||(c=[1,0,0,0,1,0,0,0,1]),a.set("originAttrs",{x:c[6],y:c[7]})}o.updateItem(a,u,!1)}else a=o.addItem(e,u,!1);a&&r["".concat(e,"s")].push(a)})},n.prototype.changeData=function(e,r){var i=this,o;r===void 0&&(r=!0);var a=this,s=e||a.get("data");if(!Nw(s))return this;this.emit("beforechangedata"),r&&this.get("enabledStack")&&this.pushStack("changedata",{before:a.save(),after:s}),this.set("comboSorted",!1),this.removeHulls(),this.getNodes().map(function(y){return a.clearItemStates(y)}),this.getEdges().map(function(y){return a.clearItemStates(y)});var u=this.get("canvas"),c=u.get("localRefresh");u.set("localRefresh",!1),a.get("data")||(a.data(s),a.render());var l=this.get("itemMap"),h={nodes:[],edges:[]},f=s.combos;if(f){var d=Iv(f,s.nodes);this.set("comboTrees",d)}else this.set("comboTrees",[]);this.diffItems("node",h,s.nodes),mt(l,function(y,b){l[b].getModel().depth=0,!(y.getType&&y.getType()==="edge")&&(y.getType&&y.getType()==="combo"?(delete l[b],y.destroy()):h.nodes.indexOf(y)<0&&(delete l[b],a.remove(y,!1)))});for(var p=this.getCombos(),g=p.length,v=g-1;v>=0;v--)p[v].destroyed&&p.splice(v,1);f&&(a.addCombos(f),this.get("groupByTypes")||this.sortCombos()),this.diffItems("edge",h,s.edges),mt(l,function(y,b){y.getType&&(y.getType()==="node"||y.getType()==="combo")||h.edges.indexOf(y)<0&&(delete l[b],a.remove(y,!1))}),(this.get("comboTrees")||[]).forEach(function(y){$i(y,function(b){var x=i.findById(b.id);return x.getType()==="combo"&&b.collapsed&&i.collapseCombo(b.id,!1),!0})}),this.set({nodes:h.nodes,edges:h.edges});var m=this.get("layoutController");return m&&(m.changeData(function(){setTimeout(function(){var y;(y=a.getCombos())===null||y===void 0||y.forEach(function(b){b.set("animate",!0)})},0)}),a.get("animate")&&!m.getLayoutType()?(a.positionsAnimate(),(o=a.getCombos())===null||o===void 0||o.forEach(function(y){return y.set("animate",!0)})):a.autoPaint()),setTimeout(function(){u.set("localRefresh",c)},16),this.set("data",s),this.emit("afterchangedata"),this},n.prototype.addCombos=function(e){var r=this,i=r.get("comboTrees"),o=this.get("itemController");o.addCombos(i,e)},n.prototype.createCombo=function(e,r,i){var o=this;i===void 0&&(i=!0);var a=this.get("itemController");this.set("comboSorted",!1);var s="",u;if(e){if(Dt(e))s=e,u={id:e};else{if(s=e.id,!s){console.warn("Create combo failed. Please assign a unique string id for the adding combo.");return}u=e}var c=i&&this.get("enabledStack"),l={nodes:[],combos:[]};c&&r.forEach(function(m){var y=o.findById(m),b=y.getType();if(!(b!=="node"&&b!=="combo")){var x=y.getModel();l["".concat(b,"s")].push({id:m,parentId:b==="node"?x.comboId:x.parentId})}});var h=this.get("comboTrees"),f=new Set(r),d=new Map;h&&(h.forEach(function(m){$i(m,function(y,b,x){if(f.has(y.id)){if(b){var w=o.findById(b.id),E=o.findById(y.id);b.children.splice(x,1),w.removeChild(E),a.updateCombo(w,b.children)}y.itemType==="combo"&&d.set(y.id,y)}return!0})}),h=h.filter(function(m){return!f.has(m.id)}),this.set("comboTrees",h));var p={nodes:[],combos:[]},g=r.map(function(m){var y=o.findById(m),b=y.getModel(),x="";y.getType&&(x=y.getType());var w=d.get(m)||{id:y.getID(),itemType:x};return x==="combo"?(w.parentId=s,b.parentId=s):x==="node"&&(w.comboId=s,b.comboId=s),c&&p["".concat(x,"s")].push({id:b.id,parentId:s}),w});u.children=g,this.addItem("combo",u,!1),this.set("comboSorted",!1),h&&(h.forEach(function(m){_r(m,function(y){return y.id===s?(y.itemType="combo",y.children=g,!1):!0})}),this.sortCombos()),c&&(p.combos.push(u),this.pushStack("createCombo",{before:l,after:p}));var v=this.findById(s);!v.getModel().parentId&&v.getChildren().combos.length&&this.updateComboTree(v,void 0,!1),setTimeout(function(){v.set("animate",!0)},0)}},n.prototype.uncombo=function(e,r){var i=this,o,a;r===void 0&&(r=!0);var s=this,u=e;if(Dt(e)&&(u=this.findById(e)),!u||u.getType&&u.getType()!=="combo"){console.warn("The item is not a combo!");return}var c=u.getModel(),l=u.getModel().parentId,h=s.get("comboTrees");h||(h=[]);var f=this.get("itemMap"),d=u.get("id"),p,g=[],v=this.get("combos"),m=this.findById(l),y=r&&this.get("enabledStack"),b={};if(y&&(b=Xe(c),b.children=[]),h.forEach(function(M){p||$i(M,function(_){var k;if(_.id===d){p=_;var S=u.getEdges().map(function(I){return I.getID()});S.forEach(function(I){i.removeItem(I,!1)});var A=v.indexOf(u);v.splice(A,1),delete f[d];var C=Xe(u.getModel());u.destroy(),i.emit("afterremoveitem",{item:C,type:"combo"})}if(l&&p&&_.id===l){m.removeCombo(u),g=_.children;var A=g.indexOf(p);return A!==-1&&g.splice(A,1),(k=p.children)===null||k===void 0||k.forEach(function(N){var D=i.findById(N.id),P=D.getModel();D.getType&&D.getType()==="combo"?(N.parentId=l,delete N.comboId,P.parentId=l,delete P.comboId):D.getType&&D.getType()==="node"&&(N.comboId=l,P.comboId=l),m.addChild(D),g.push(N)}),i.updateCombo(m),!1}return!0})}),!l&&p){var x=h.indexOf(p);h.splice(x,1),(o=p.children)===null||o===void 0||o.forEach(function(M){M.parentId=void 0;var _=i.findById(M.id).getModel();delete _.parentId,delete _.comboId,M.itemType!=="node"&&h.push(M)})}if(y){var w={nodes:[],combos:[]},E={nodes:[],combos:[]};(a=p.children)===null||a===void 0||a.forEach(function(M){var _=i.findById(M.id),k=_.getType();k!=="node"&&k!=="combo"||(w["".concat(k,"s")].push({id:M.id,parentId:d}),E["".concat(k,"s")].push({id:M.id,parentId:l}))}),w.combos.push(b),this.pushStack("uncombo",{before:w,after:E})}},n.prototype.updateCombos=function(e){var r=this;e===void 0&&(e=!1);var i=this,o=this.get("comboTrees"),a=i.get("itemController"),s=i.get("itemMap");(o||[]).forEach(function(u){$i(u,function(c){var l;if(!c)return!0;var h=s[c.id];if(((l=h==null?void 0:h.getType)===null||l===void 0?void 0:l.call(h))==="combo"){var f=Di([],h.getStates(),!0);mt(f,function(d){return r.setItemState(h,d,!1)}),a.updateCombo(h,c.children,e),mt(f,function(d){return r.setItemState(h,d,!0)})}return!0})}),i.sortCombos()},n.prototype.updateCombo=function(e){var r=this,i=this,o=e,a;if(Dt(e)&&(o=this.findById(e)),!o||o.getType&&o.getType()!=="combo"){console.warn("The item to be updated is not a combo!");return}a=o.get("id");var s=this.get("comboTrees"),u=i.get("itemController"),c=i.get("itemMap");(s||[]).forEach(function(l){$i(l,function(h){if(!h)return!0;var f=c[h.id];if(a===h.id&&f&&f.getType&&f.getType()==="combo"){var d=Di([],f.getStates(),!0);mt(d,function(p){f.getStateStyle(p)&&r.setItemState(f,p,!1)}),u.updateCombo(f,h.children),mt(d,function(p){f.getStateStyle(p)&&r.setItemState(f,p,!0)}),a&&(a=h.parentId)}return!0})})},n.prototype.updateComboTree=function(e,r,i){i===void 0&&(i=!0);var o=this;this.set("comboSorted",!1);var a;Dt(e)?a=o.findById(e):a=e;var s=a.getModel(),u=s.comboId||s.parentId,c="";if(a.getType&&(c=a.getType()),r&&c==="combo"){var l=this.get("comboTrees"),h=!0,f;if((l||[]).forEach(function(y){f||_r(y,function(b){if(!f)return b.id===a.getID()&&(f=b),!0})}),_r(f,function(y){return y.id===r?(h=!1,!1):!0}),!h){console.warn("Failed to update the combo tree! The parentId points to a descendant of the combo!");return}}if(i&&this.get("enabledStack")){var d={},p={};c==="combo"?(d.combos=[{id:s.id,parentId:s.parentId}],p.combos=[{id:s.id,parentId:r}]):c==="node"&&(d.nodes=[{id:s.id,parentId:s.comboId}],p.nodes=[{id:s.id,parentId:r}]),this.pushStack("updateComboTree",{before:d,after:p})}if(s.parentId||s.comboId){var g=this.findById(s.parentId||s.comboId);g&&g.removeChild(a)}if(c==="combo"?s.parentId=r:c==="node"&&(s.comboId=r),r){var v=this.findById(r);v&&v.addChild(a)}if(u){var v=this.findById(u);v&&v.removeChild(a)}var m=Tv(this.get("comboTrees"),s.id,r);this.set("comboTrees",m),this.updateCombos()},n.prototype.save=function(){var e=[],r=[],i=[];return mt(this.get("nodes"),function(o){e.push(o.getModel())}),mt(this.get("edges"),function(o){r.push(o.getModel())}),mt(this.get("combos"),function(o){i.push(o.getModel())}),{nodes:e,edges:r,combos:i}},n.prototype.changeSize=function(e,r){var i=this.get("viewController");return i.changeSize(e,r),this},n.prototype.refresh=function(){var e=this;if(e.emit("beforegraphrefresh"),e.get("animate"))e.positionsAnimate();else{var r=e.get("nodes"),i=e.get("edges"),o=e.get("edges");mt(r,function(a){a.refresh()}),mt(i,function(a){a.refresh()}),mt(o,function(a){a.refresh()})}e.emit("aftergraphrefresh"),e.autoPaint()},n.prototype.getNodes=function(){return this.get("nodes")},n.prototype.getEdges=function(){return this.get("edges")},n.prototype.getCombos=function(){return this.get("combos")},n.prototype.getComboChildren=function(e){if(Dt(e)&&(e=this.findById(e)),!e||e.getType&&e.getType()!=="combo"){console.warn("The combo does not exist!");return}return e.getChildren()},n.prototype.positionsAnimate=function(e){var r=this;r.emit("beforeanimate");var i=r.get("animateCfg"),o=i.onFrame,a=e?r.getNodes().concat(r.getCombos()):r.getNodes(),s=a.map(function(c){var l=c.getModel();return{id:l.id,x:l.x,y:l.y}});r.stopAnimate();var u=r.get("canvas");r.animating=!0,setTimeout(function(){u.animate(function(c){mt(s,function(l){var h=r.findById(l.id);if(!(!h||h.destroyed)){var f=h.get("originAttrs"),d=h.get("model"),p=h.getContainer().getMatrix();if(f==null&&(p&&(f={x:p[6],y:p[7]}),h.set("originAttrs",f||0)),o){var g=o(h,c,l,f||{x:0,y:0});h.set("model",Object.assign(d,g))}else f?(d.x=f.x+(l.x-f.x)*c,d.y=f.y+(l.y-f.y)*c):(d.x=l.x,d.y=l.y)}}),r.refreshPositions(e)},{duration:i.duration,easing:i.easing,callback:function(){mt(a,function(c){c.set("originAttrs",null)}),i.callback&&i.callback(),r.emit("afteranimate"),r.animating=!1}})},0)},n.prototype.refreshPositions=function(e){var r=this;r.emit("beforegraphrefreshposition");var i=r.get("nodes"),o=r.get("edges"),a=r.get("vedges"),s=r.get("combos"),u,c={},l=function(h){mt(h,function(f){u=f.getModel();var d=f.get("originAttrs");if(!(d&&u.x===d.x&&u.y===d.y)){var p=f.updatePosition({x:u.x,y:u.y});c[u.id]=p,u.comboId&&(c[u.comboId]=c[u.comboId]||p),u.parentId&&(c[u.parentId]=c[u.parentId]||p)}})};l(s),l(i),s&&s.length!==0&&(e&&l(s),r.updateCombos()),mt(o,function(h){var f=h.getSource().getModel(),d=h.getTarget();if(!vr(d)){var p=d.getModel();(c[f.id]||c[p.id]||h.getModel().isComboEdge)&&h.refresh()}}),mt(a,function(h){h.refresh()}),r.emit("aftergraphrefreshposition"),r.autoPaint()},n.prototype.stopAnimate=function(){var e=this.get("canvas"),r=e.cfg.timeline;r&&r.stopAllAnimations()},n.prototype.isAnimating=function(){return this.animating},n.prototype.getZoom=function(){var e=this.get("group").getMatrix();return e?e[0]:1},n.prototype.getCurrentMode=function(){var e=this.get("modeController");return e.getMode()},n.prototype.setMode=function(e){var r=this.get("modeController");return r.setMode(e),this},n.prototype.clear=function(e){var r;return e===void 0&&(e=!1),(r=this.get("canvas"))===null||r===void 0||r.clear(),this.initGroups(),this.set({itemMap:{},nodes:[],edges:[],vedges:[],groups:[],combos:[],comboTrees:[]}),e||this.emit("afterrender"),this},n.prototype.updateLayout=function(e,r,i,o){var a=this;e===void 0&&(e={}),o===void 0&&(o=!0);var s=this.get("layoutController");if(Dt(e)&&(e={type:e}),r){var u=i;u||(r==="begin"?u={x:0,y:0}:u={x:this.getWidth()/2,y:this.getHeight()/2}),u=this.getPointByCanvas(u.x,u.y);var c=["force","gForce","fruchterman","force2"];c.includes(e.type)||!e.type&&c.includes(s==null?void 0:s.layoutType)?e.center=[u.x,u.y]:this.once("afterlayout",function(f){var d=a.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];u.x=u.x*d[0]+d[6],u.y=u.y*d[0]+d[7];var p=a.getGroup().getCanvasBBox(),g=p.minX,v=p.maxX,m=p.minY,y=p.maxY,b={x:(g+v)/2,y:(m+y)/2};r==="begin"&&(b.x=g,b.y=m),a.translate(u.x-b.x,u.y-b.y)})}var l=B({},this.get("layout")),h={};Object.assign(h,l,e),e.pipes&&!e.type?delete h.type:!e.pipes&&h.type&&delete h.pipes,this.set("layout",h),s&&(s.isLayoutTypeSame(h)&&h.gpuEnabled===l.gpuEnabled?s.updateLayoutCfg(h):s.changeLayout(h),o&&this.get("enabledStack")&&this.pushStack("layout",{before:l,after:h}))},n.prototype.destroyLayout=function(){var e=this.get("layoutController");e==null||e.destroyLayout()},n.prototype.layout=function(){var e,r=this.get("layoutController"),i=this.get("layout");if(!(!i||!r)){if(i.workerEnabled){r.layout();return}!((e=r.layoutMethods)===null||e===void 0)&&e.length?r.relayout(!0):r.layout()}},n.prototype.collapseCombo=function(e,r){var i=this;if(r===void 0&&(r=!0),!this.destroyed){if(Dt(e)&&(e=this.findById(e)),!e){console.warn("The combo to be collapsed does not exist!");return}this.emit("beforecollapseexpandcombo",{action:"collapse",item:e});var o=e.getModel(),a=this.get("itemController");a.collapseCombo(e,r),o.collapsed=!0;var s=this.getEdges().concat(this.get("vedges")),u=[],c=this.get("comboTrees"),l=!1;(c||[]).forEach(function(f){l||_r(f,function(d){if(l&&d.depth<=o.depth)return!1;if(o.id===d.id&&(l=!0),l){var p=i.findById(d.id);p&&p.getType&&p.getType()==="combo"&&(u=u.concat(p.getNodes()),u=u.concat(p.getCombos()))}return!0})});var h={};s.forEach(function(f){var d=f.getModel(),p=d.isVEdge,g=d.size,v=g===void 0?1:g;if(!(f.isVisible()&&!p)){var m=f.getSource(),y=f.getTarget(),b=null,x;if(m.getModel().id===o.id||u.includes(m)&&!u.includes(y)?(b=y,x=!1):(y.getModel().id===o.id||!u.includes(m)&&u.includes(y))&&(b=m,x=!0),b){if(p){i.removeItem(f,!1);return}for(var w=b.getModel();!b.isVisible();){var E=w.parentId,M=w.comboId,_=E||M;if(b=i.findById(_),!b||!_)return;w=b.getModel()}var k=w.id,S=x?{source:k,target:o.id,size:v,isVEdge:!0}:{source:o.id,target:k,size:v,isVEdge:!0},A="".concat(S.source,"-").concat(S.target);if(h[A]){h[A].size+=v;return}h[A]=S}}}),this.addItems(Object.values(h).map(function(f){return{type:"vedge",model:f}}),!1),this.emit("aftercollapseexpandcombo",{action:"collapse",item:e})}},n.prototype.expandCombo=function(e,r){var i=this;if(r===void 0&&(r=!0),Dt(e)&&(e=this.findById(e)),!e||e.getType&&e.getType()!=="combo"){console.warn("The combo to be collapsed does not exist!");return}this.emit("beforecollapseexpandcombo",{action:"expand",item:e});var o=e.getModel(),a=this.get("itemController");a.expandCombo(e,r),o.collapsed=!1;var s=this.getEdges().concat(this.get("vedges")),u=[],c=this.get("comboTrees"),l=!1;(c||[]).forEach(function(f){l||_r(f,function(d){if(l&&d.depth<=o.depth)return!1;if(o.id===d.id&&(l=!0),l){var p=i.findById(d.id);p&&p.getType&&p.getType()==="combo"&&(u=u.concat(p.getNodes()),u=u.concat(p.getCombos()))}return!0})});var h={};s.forEach(function(f){if(!(f.isVisible()&&!f.getModel().isVEdge)){var d=f.getSource(),p=f.getTarget(),g=d.get("id"),v=p.get("id"),m=null,y;if(g===o.id||u.includes(d)&&!u.includes(p)?(m=p,y=!1):v===o.id||!u.includes(d)&&u.includes(p)?(m=d,y=!0):u.includes(d)&&u.includes(p)&&d.isVisible()&&p.isVisible()&&f.show(),m){var b=f.getModel(),x=b.isVEdge,w=b.size,E=w===void 0?1:w;if(x){i.removeItem(f,!1);return}for(var M=m.getModel();!m.isVisible();){var _=M.parentId,k=M.comboId,S=_||k;if(m=i.findById(S),!m||!S)return;M=m.getModel()}for(var A=M.id,C=y?p:d,I=C.getModel();!C.isVisible();){var N=I.parentId,D=I.comboId,P=N||D;if(C=i.findById(P),!C||!P)return;if(I.comboId===o.id||I.parentId===o.id)break;I=C.getModel()}var j=I.id;if(A){var L=y?{source:A,target:j,isVEdge:!0,size:E}:{source:j,target:A,isVEdge:!0,size:E},R="".concat(L.source,"-").concat(L.target);if(h[R]){h[R].size+=E;return}h[R]=L}}}}),this.addItems(Object.values(h).map(function(f){return{type:"vedge",model:f}}),!1),this.emit("aftercollapseexpandcombo",{action:"expand",item:e})},n.prototype.collapseExpandCombo=function(e,r){if(r===void 0&&(r=!0),Dt(e)&&(e=this.findById(e)),!(!e||e.getType&&e.getType()!=="combo")){for(var i=e.getModel(),o=this.findById(i.parentId);o;){var a=o.getModel();if(a.collapsed){console.warn("Fail to expand the combo since it's ancestor combo is collapsed."),o=void 0;return}o=this.findById(a.parentId)}var s=i.collapsed;s?this.expandCombo(e,r):this.collapseCombo(e,r),this.updateCombo(e)}},n.prototype.getNeighbors=function(e,r){var i=e;return Dt(e)&&(i=this.findById(e)),i.getNeighbors(r)},n.prototype.getNodeDegree=function(e,r,i){r===void 0&&(r=void 0),i===void 0&&(i=!1);var o=e;Dt(e)&&(o=this.findById(e));var a=this.get("degrees");(!a||i)&&(a=qo(this.save()),this.set("degrees",a));var s=a[o.getID()],u=0;if(!s)return 0;switch(r){case"in":u=s.inDegree;break;case"out":u=s.outDegree;break;case"all":u=s;break;default:u=s.degree;break}return u},n.prototype.getUndoStack=function(){return this.undoStack},n.prototype.getRedoStack=function(){return this.redoStack},n.prototype.getStackData=function(){return this.get("enabledStack")?{undoStack:this.undoStack.toArray(),redoStack:this.redoStack.toArray()}:null},n.prototype.clearStack=function(){this.get("enabledStack")&&(this.undoStack.clear(),this.redoStack.clear(),this.emit("stackchange",{undoStack:this.undoStack,redoStack:this.redoStack}))},n.prototype.pushStack=function(e,r,i){if(e===void 0&&(e="update"),i===void 0&&(i="undo"),!this.get("enabledStack")){console.warn("请先启用 undo & redo 功能，在实例化 Graph 时候配置 enabledStack: true !");return}var o=r?Xe(r):{before:{},after:Xe(this.save())};i==="redo"?this.redoStack.push({action:e,data:o}):this.undoStack.push({action:e,data:o}),this.emit("stackchange",{action:e,stackType:i,undoStack:this.undoStack,redoStack:this.redoStack})},n.prototype.getAdjMatrix=function(e,r){e===void 0&&(e=!0),r===void 0&&(r=this.get("directed"));var i=this.get("adjMatrix");return(!i||!e)&&(i=Ss(this.save(),r),this.set("adjMatrix",i)),i},n.prototype.getShortestPathMatrix=function(e,r){e===void 0&&(e=!0),r===void 0&&(r=this.get("directed"));var i=this.get("adjMatrix"),o=this.get("shortestPathMatrix");return(!i||!e)&&(i=Ss(this.save(),r),this.set("adjMatrix",i)),(!o||!e)&&(o=pl(this.save(),r),this.set("shortestPathMatrix",o)),o},n.prototype.on=function(e,r,i){return t.prototype.on.call(this,e,r,i)},n.prototype.destroy=function(){var e,r,i,o,a;this.emit("beforedestroy"),this.clear(),this.clearStack(),(e=this.get("itemController"))===null||e===void 0||e.destroy(),(r=this.get("modeController"))===null||r===void 0||r.destroy(),(i=this.get("viewController"))===null||i===void 0||i.destroy(),(o=this.get("stateController"))===null||o===void 0||o.destroy(),(a=this.get("canvas"))===null||a===void 0||a.destroy(),this.cfg=null,this.destroyed=!0,this.redoStack=null,this.undoStack=null,this.emit("afterdestroy")},n.prototype.createHull=function(e){if(!e.members||e.members.length<1){console.warn("Create hull failed! The members is empty.");return}var r=this.get("hullGroup"),i=this.get("hullMap");if(i||(i={},this.set("hullMap",i)),(!r||r.get("destroyed"))&&(r=this.get("group").addGroup({id:"hullGroup"}),r.toBack(),this.set("hullGroup",r)),i[e.id])return console.warn("Existed hull id."),i[e.id];var o=r.addGroup({id:"".concat(e.id,"-container")}),a=new gG(this,B(B({},e),{group:o})),s=a.id;return i[s]=a,a},n.prototype.getHulls=function(){return this.get("hullMap")},n.prototype.getHullById=function(e){return this.get("hullMap")[e]},n.prototype.removeHull=function(e){var r,i;Dt(e)?i=this.getHullById(e):i=e,(r=this.get("hullMap"))===null||r===void 0||delete r[i.id],i.destroy()},n.prototype.removeHulls=function(){var e=this.getHulls();!e||!Object.keys(e).length||(Object.keys(e).forEach(function(r){var i=e[r];i.destroy()}),this.set("hullMap",{}))},n}(Tk);function tm(t){"@babel/helpers - typeof";return tm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},tm(t)}var nu=yi,U2="-shape",C0="-label",sf=["startArrow","endArrow"],Y2={lineWidth:1,stroke:void 0,fill:void 0,lineAppendWidth:1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,x:0,y:0,r:10,width:20,height:20,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},yG={lineWidth:1,stroke:"#000",lineDash:void 0,startArrow:!1,endArrow:!1,opacity:void 0,strokeOpacity:void 0,fillOpacity:void 0,shadowColor:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0},uf={edge:yG,node:Y2,combo:Y2},em="-label-bg",Vy={options:{labelCfg:{style:{fontFamily:he.windowFontFamily}},descriptionCfg:{style:{fontFamily:he.windowFontFamily}}},itemType:"",type:"",getCustomConfig:function(t){return{}},getOptions:function(t,n){return n==="move"||n!=null&&n.includes("bbox")?t:mn({},this.options,this.getCustomConfig(t)||{},t)},draw:function(t,n){n.shapeMap={},this.mergeStyle=this.getOptions(t);var e=this.drawShape(t,n);if(e.set("className",this.itemType+U2),n.shapeMap[this.itemType+U2]=e,t.label){var r=this.drawLabel(t,n);r.set("className",this.itemType+C0),n.shapeMap[this.itemType+C0]=r}return e},afterDraw:function(t,n,e){},drawShape:function(t,n){return null},drawLabel:function(t,n){var e=(this.mergeStyle||this.getOptions(t)||{}).labelCfg,r=e||{},i=this.getLabelStyle(t,r,n),o=i.rotate;delete i.rotate;var a=n.addShape("text",{attrs:i,draggable:!0,className:"text-shape",name:"text-shape",labelRelated:!0});if(n.shapeMap["text-shape"]=a,!isNaN(o)&&o!==""){var s=a.getBBox(),u=[1,0,0,0,1,0,0,0,1];if(i.rotateCenter)switch(i.rotateCenter){case"center":u=nu(u,[["t",-s.width/2,-s.height/2],["r",o],["t",s.width/2,s.height/2]]);break;case"lefttop":u=nu(u,[["t",-i.x,-i.y],["r",o],["t",i.x,i.y]]);break;case"leftcenter":u=nu(u,[["t",-i.x,-i.y-s.height/2],["r",o],["t",i.x,i.y+s.height/2]]);break;default:u=nu(u,[["t",-s.width/2,-s.height/2],["r",o],["t",s.width/2,s.height/2]]);break}else u=nu(u,[["t",-i.x,-i.y-s.height/2],["r",o],["t",i.x,i.y+s.height/2]]);a.setMatrix(u)}if(i.background){var c=this.drawLabelBg(t,n,a),l=this.itemType+em;c.set("classname",l),n.shapeMap[l]=c,a.toFront()}return a},drawLabelBg:function(t,n,e){var r=this.options.labelCfg,i=ye({},r,t.labelCfg),o=this.getLabelBgStyleByPosition(e,i),a=n.addShape("rect",{name:"text-bg-shape",attrs:o,labelRelated:!0});return n.shapeMap["text-bg-shape"]=a,a},getLabelStyleByPosition:function(t,n,e){return{text:t.label}},getLabelBgStyleByPosition:function(t,n){return{}},getLabelStyle:function(t,n,e){var r=this.getLabelStyleByPosition(t,n,e),i="".concat(this.itemType,"Label"),o=he[i]?he[i].style:null;return B(B(B({},o),r),n.style)},getShapeStyle:function(t){return t.style},update:function(t,n,e){this.updateShapeStyle(t,n,e),this.updateLabel(t,n,e)},updateShapeStyle:function(t,n,e){var r,i=n.getContainer(),o=n.getKeyShape(),a=ye({},o.attr(),t.style),s=function(c){var l,h=a[c];if(vr(h)){var f=((r=i.shapeMap)===null||r===void 0?void 0:r[c])||i.find(function(d){return d.get("name")===c});f==null||f.attr(h)}else o.attr((l={},l[c]=h,l))};for(var u in a)s(u)},updateLabel:function(t,n,e){var r,i,o=n.getContainer(),a=(this.mergeStyle||this.getOptions({},e)||{}).labelCfg,s=a===void 0?{}:a,u=this.itemType+C0,c=o.shapeMap[u]||o.find(function(b){return b.get("className")===u}),l=this.itemType+em,h=o.shapeMap[l]||o.find(function(b){return b.get("className")===l});if(c&&t.label===void 0&&(o.removeChild(c),delete o.shapeMap[u],h&&(o.removeChild(h),delete o.shapeMap[l])),t.label||t.label==="")if(c){(!e||e==="bbox|label"||this.itemType==="edge"&&e!=="style")&&(s=mn(s,t.labelCfg));var f=this.getLabelStyleByPosition(t,s,o),d=(r=t.labelCfg)===null||r===void 0?void 0:r.style,p=B(B({},f),d),g=p.rotate;if(delete p.rotate,!isNaN(g)&&g!==""){var v=[1,0,0,0,1,0,0,0,1];v=nu(v,[["t",-p.x,-p.y],["r",g],["t",p.x,p.y]]),p.matrix=v,c.attr(p)}else((i=c.getMatrix())===null||i===void 0?void 0:i[4])!==1&&c.resetMatrix(),c.attr(p);if(!h)p.background&&(h=this.drawLabelBg(t,o,c),h.set("classname",l),o.shapeMap[l]=h,c.toFront());else if(p.background){var m=this.getLabelBgStyleByPosition(c,s);h.attr(m)}else o.removeChild(h)}else{var y=this.drawLabel(t,o);y.set("className",u),o.shapeMap[u]=y}},afterUpdate:function(t,n){},setState:function(t,n,e){var r,i,o,a=e.get("keyShape");if(!(!a||a.destroyed)){var s=e.getType(),u=Rl(n)?t:"".concat(t,":").concat(n),c=this.getStateStyle(u,e),l=e.getStateStyle(u);if(!(!l&&!c)){var h=ye({},l||c),f=e.getContainer(),d={x:1,y:1,cx:1,cy:1,matrix:1};if(s==="combo"&&(d.r=1,d.width=1,d.height=1),n){var p=function(N){var D,P=h[N];if(vr(P)&&!sf.includes(N)){var j=((o=f.shapeMap)===null||o===void 0?void 0:o[N])||f.find(function(L){return L.get("name")===N});j==null||j.attr(P)}else a.attr((D={},D[N]=P,D))};for(var g in h)p(g)}else{var v=Kf(e.getCurrentStatesStyle()),m=e.getModel(),y=ye({},m.style,Kf(e.getOriginStyle())),b=a.get("name"),x=a.attr(),w={};Object.keys(x).forEach(function(N){if(N!=="img"){var D=x[N];D&&tm(D)==="object"?w[N]=Xe(D):w[N]=D}});var E={},M=function(N){var D=h[N];if(vr(D)&&!sf.includes(N)){var P=f.shapeMap[N]||f.find(function(R){return R.get("name")===N});if(P){var j=Kf(P.attr());mt(D,function(R,V){if(N===b&&w[V]&&!d[V]){delete w[V];var tt=y[N][V]||uf[s][V];a.attr(V,tt)}else if(j[V]||j[V]===0){delete j[V];var ut=y[N][V]||uf[s][V];P.attr(V,ut)}}),E[N]=j}}else if(w[N]&&!d[N]){delete w[N];var L=y[N]||(y[b]?y[b][N]:void 0)||uf[s][N];a.attr(N,L)}};for(var _ in h)M(_);b?E[b]=w:ye(E,w);for(var g in v)if(!d[g]){var k=v[g];(!vr(k)||sf.includes(g))&&(b?(ye(y[b],(i={},i[g]=k,i)),delete y[g]):ye(y,(r={},r[g]=k,r)),delete v[g])}var S={};mn(S,y,E,v);var A=!1,C=function(N){var D,P,j=S[N];if(vr(j)&&!sf.includes(N)){var L=f.shapeMap[N]||f.find(function(V){return V.get("name")===N});L&&((L.get("type")==="text"||L.get("labelRelated"))&&(delete j.x,delete j.y,delete j.matrix),N===b&&(s==="combo"&&(delete j.r,delete j.width,delete j.height),A=!0),L.attr(j))}else if(!A){var R=j||uf[s][N];s==="combo"?b||a.attr((D={},D[N]=R,D)):a.attr((P={},P[N]=R,P))}};for(var I in S)C(I)}}}},getStateStyle:function(t,n){var e=n.getModel(),r=n.getType(),i=this.getOptions(e),o=i.stateStyles,a=i.style,s=a===void 0?{}:a,u=e.stateStyles?e.stateStyles[t]:o&&o[t];return r==="combo"?Xe(u):ye({},s,u)},getControlPoints:function(t){return t.controlPoints},getAnchorPoints:function(t){var n,e,r=(t==null?void 0:t.anchorPoints)||((n=this.getCustomConfig(t))===null||n===void 0?void 0:n.anchorPoints)||((e=this.options)===null||e===void 0?void 0:e.anchorPoints);return r}},bG={itemType:"node",shapeType:"single-node",labelPosition:"center",offset:he.nodeLabel.offset,getSize:function(t){var n,e=((n=this.mergeStyle)===null||n===void 0?void 0:n.size)||t.size||this.getOptions({}).size||he.defaultNode.size;return ve(e)&&e.length===1&&(e=[e[0],e[0]]),ve(e)||(e=[e,e]),e},getLabelStyleByPosition:function(t,n){var e=n.maxLength,r=t.label;e&&(r=AC(r,e));var i=n.position||this.labelPosition;if(i==="center")return{x:0,y:0,text:r,textBaseline:"middle",textAlign:"center"};var o=n.offset;fe(o)&&(o=this.offset);var a=this.getSize(t),s;switch(i){case"top":s={x:0,y:-a[1]/2-o,textBaseline:"bottom",textAlign:"center"};break;case"bottom":s={x:0,y:a[1]/2+o,textBaseline:"top",textAlign:"center"};break;case"left":s={x:-a[0]/2-o,y:0,textBaseline:"middle",textAlign:"right"};break;default:s={x:a[0]/2+o,y:0,textBaseline:"middle",textAlign:"left"};break}return s.text=r,s},getLabelBgStyleByPosition:function(t,n){var e;if(!t)return{};var r=(e=n.style)===null||e===void 0?void 0:e.background;if(!r)return{};var i=t.getBBox(),o=Yy(r.padding),a=i.width+o[1]+o[3],s=i.height+o[0]+o[2];return B(B({x:i.minX-o[3],y:i.minY-o[0]},r),{width:a,height:s})},drawShape:function(t,n){var e=this.shapeType,r=this.getShapeStyle(t),i=n.addShape(e,{attrs:r,draggable:!0,name:"node-shape"});return n.shapeMap["node-shape"]=i,i},updateLinkPoints:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).linkPoints,r=n.shapeMap["link-point-left"]||n.find(function(S){return S.get("className")==="link-point-left"}),i=n.shapeMap["link-point-right"]||n.find(function(S){return S.get("className")==="link-point-right"}),o=n.shapeMap["link-point-top"]||n.find(function(S){return S.get("className")==="link-point-top"}),a=n.shapeMap["link-point-bottom"]||n.find(function(S){return S.get("className")==="link-point-bottom"}),s;r&&(s=r.attr()),i&&!s&&(s=i.attr()),o&&!s&&(s=o.attr()),a&&!s&&(s=a.attr()),s||(s=e);var u=ye({},s,t.linkPoints),c=u.fill,l=u.stroke,h=u.lineWidth,f=u.size/2;f||(f=u.r);var d=t.linkPoints?t.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},p=d.left,g=d.right,v=d.top,m=d.bottom,y=this.getSize(t),b=y[0],x=y[1],w={r:f,fill:c,stroke:l,lineWidth:h};if(r)!p&&p!==void 0?(r.remove(),delete n.shapeMap["link-point-left"]):r.attr(B(B({},w),{x:-b/2,y:0}));else if(p){var E="link-point-left";n.shapeMap[E]=n.addShape("circle",{attrs:B(B({},w),{x:-b/2,y:0}),className:E,name:E,isAnchorPoint:!0})}if(i)!g&&g!==void 0&&(i.remove(),delete n.shapeMap["link-point-right"]),i.attr(B(B({},w),{x:b/2,y:0}));else if(g){var M="link-point-right";n.shapeMap[M]=n.addShape("circle",{attrs:B(B({},w),{x:b/2,y:0}),className:M,name:M,isAnchorPoint:!0})}if(o)!v&&v!==void 0&&(o.remove(),delete n.shapeMap["link-point-top"]),o.attr(B(B({},w),{x:0,y:-x/2}));else if(v){var _="link-point-top";n.shapeMap[_]=n.addShape("circle",{attrs:B(B({},w),{x:0,y:-x/2}),className:_,name:_,isAnchorPoint:!0})}if(a)!m&&m!==void 0?(a.remove(),delete n.shapeMap["link-point-bottom"]):a.attr(B(B({},w),{x:0,y:x/2}));else if(m){var k="link-point-bottom";n.shapeMap[k]=n.addShape("circle",{attrs:B(B({},w),{x:0,y:x/2}),className:k,name:k,isAnchorPoint:!0})}},updateShape:function(t,n,e,r,i){var o=n.get("keyShape");o.attr(B({},e)),this.updateLabel(t,n,i),r&&this.updateIcon(t,n)},updateIcon:function(t,n){var e=this,r=n.getContainer(),i=(this.mergeStyle||this.getOptions(t)).icon,o=t.icon?t.icon:{show:void 0,text:void 0},a=o.show,s=o.text,u=r.shapeMap["".concat(this.type,"-icon")]||r.find(function(v){return v.get("name")==="".concat(e.type,"-icon")});if(u)if(a||a===void 0){var c=ye({},u.attr(),i),l=c.width,h=l===void 0?20:l,f=c.height,d=f===void 0?20:f;(c.fontFamily==="iconfont"||c.hasOwnProperty("text"))&&(h=0,d=0),u.attr(B(B({},c),{x:-h/2,y:-d/2}))}else u.remove(),delete r.shapeMap["".concat(this.type,"-icon")];else if(a){var p="".concat(this.type,"-icon");if(s)r.shapeMap[p]=r.addShape("text",{attrs:B({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:p,name:p});else{var h=i.width,d=i.height;r.shapeMap[p]=r.addShape("image",{attrs:B(B({},i),{x:-h/2,y:-d/2}),className:p,name:p})}var g=r.shapeMap["node-label"]||r.find(function(v){return v.get("name")==="node-label"});g&&g.toFront()}}},xG=B(B({},Vy),bG);Sn.registerNode("single-node",xG);var cf="edge-shape";function wG(t){var n=t;return t==="start"?n="end":t==="end"&&(n="start"),n}var EG={itemType:"edge",labelPosition:"center",refX:0,refY:0,labelAutoRotate:!1,options:{size:he.defaultEdge.size,style:{x:0,y:0,stroke:he.defaultEdge.style.stroke,lineAppendWidth:he.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:he.edgeLabel.style.fill,fontSize:he.edgeLabel.style.fontSize,fontFamily:he.windowFontFamily}},stateStyles:B({},he.edgeStateStyles)},getPath:function(t){var n=[];return mt(t,function(e,r){r===0?n.push(["M",e.x,e.y]):n.push(["L",e.x,e.y])}),n},getShapeStyle:function(t){var n=this.options.style,e={stroke:t.color},r=ye({},n,e,t.style),i=t.size||he.defaultEdge.size;t=this.getPathPoints(t);var o=t.startPoint,a=t.endPoint,s=this.getControlPoints(t),u=[o];s&&(u=u.concat(s)),u.push(a);var c=this.getPath(u),l=ye({},he.defaultEdge.style,{stroke:he.defaultEdge.color,lineWidth:i,path:c},r);return l},updateShapeStyle:function(t,n,e){var r,i=n.getContainer(),o=((r=n.getKeyShape)===null||r===void 0?void 0:r.call(n))||i.shapeMap["edge-shape"],a=t.size;t=this.getPathPoints(t);var s=t.startPoint,u=t.endPoint,c=this.getControlPoints(t),l=[s];c&&(l=l.concat(c)),l.push(u);var h=o.attr(),f=t.style||{};f.stroke===void 0&&(f.stroke=t.color);var d=t.sourceNode,p=t.targetNode,g={radius:f.radius};c||(g={source:d,target:p,offset:f.offset,radius:f.radius});var v=this.getPath(l,g),m={};e==="move"?m={path:v}:(h.endArrow&&f.endArrow===!1&&(t.style.endArrow={path:""}),h.startArrow&&f.startArrow===!1&&(t.style.startArrow={path:""}),m=B({},t.style),m.lineWidth===void 0&&(m.lineWdith=(pe(a)?a:a==null?void 0:a[0])||h.lineWidth),m.path===void 0&&(m.path=v),m.stroke===void 0&&(m.stroke=h.stroke||t.color)),o&&o.attr(m)},getLabelStyleByPosition:function(t,n,e){var r=n.position||this.labelPosition,i={},o=e==null?void 0:e.shapeMap[cf],a;r==="start"?a=0:r==="end"?a=1:a=.5;var s=n.refX||this.refX,u=n.refY||this.refY;if(t.startPoint.x===t.endPoint.x&&t.startPoint.y===t.endPoint.y)return i.x=t.startPoint.x+s,i.y=t.startPoint.y+u,i.text=t.label,i;var c;fe(n.autoRotate)?c=this.labelAutoRotate:c=n.autoRotate;var l=SC(o,a,s,u,c);return i.x=l.x,i.y=l.y,i.rotate=l.rotate,i.textAlign=this._getTextAlign(r,l.angle),i.text=t.label,i},getLabelBgStyleByPosition:function(t,n){if(!t)return{};var e=t.getBBox(),r=n.style&&n.style.background;if(!r)return{};var i=r.padding,o=e.width+i[1]+i[3],a=e.height+i[0]+i[2],s=B(B({},r),{width:o,height:a,x:e.minX-i[3],y:e.minY-i[0],matrix:[1,0,0,0,1,0,0,0,1]}),u;return fe(n.autoRotate)?u=this.labelAutoRotate:u=n.autoRotate,u&&(s.matrix=t.attr("matrix")||[1,0,0,0,1,0,0,0,1]),s},_getTextAlign:function(t,n){var e="center";return n?(n=n%(Math.PI*2),t!=="center"&&(n>=0&&n<=Math.PI/2||n>=3/2*Math.PI&&n<2*Math.PI?e=t:e=wG(t)),e):t},getControlPoints:function(t){return t.controlPoints},getPathPoints:function(t){return t},drawShape:function(t,n){var e=this.getShapeStyle(t),r=n.addShape("path",{className:cf,name:cf,attrs:e});return n.shapeMap[cf]=r,r},drawLabel:function(t,n){var e=this.options.labelCfg,r=mn({},e,t.labelCfg),i=this.getLabelStyle(t,r,n),o=i.rotate;delete i.rotate;var a=n.addShape("text",{attrs:i,name:"text-shape",labelRelated:!0,draggable:!0});if(n.shapeMap["text-shape"]=a,!isNaN(o)&&o!==""&&a.rotateAtStart(o),i.background){var s=this.drawLabelBg(t,n,a,i,o),u=this.itemType+em;s.set("classname",u),n.shapeMap[u]=s,a.toFront()}return a},drawLabelBg:function(t,n,e,r,i){var o=this.options.labelCfg,a=mn({},o,t.labelCfg),s=this.getLabelBgStyleByPosition(e,a),u=n.addShape("rect",{name:"text-bg-shape",attrs:s,labelRelated:!0});return n.shapeMap["text-bg-shape"]=u,u}},MG=B(B({},Vy),EG);Sn.registerEdge("single-edge",MG);Sn.registerEdge("line",{getControlPoints:function(){}},"single-edge");Sn.registerEdge("spline",{getPath:function(t){var n=II(t);return n}},"single-edge");Sn.registerEdge("arc",{curveOffset:20,clockwise:1,getControlPoints:function(t){var n=t.startPoint,e=t.endPoint,r={x:(n.x+e.x)/2,y:(n.y+e.y)/2},i,o;if(t.controlPoints!==void 0){if(o=t.controlPoints[0],i=Mv(n,o,e),n.x<=e.x&&n.y>e.y?this.clockwise=i.x>o.x?0:1:n.x<=e.x&&n.y<e.y?this.clockwise=i.x>o.x?1:0:n.x>e.x&&n.y<=e.y?this.clockwise=i.y<o.y?0:1:this.clockwise=i.y<o.y?1:0,(o.x-n.x)/(o.y-n.y)===(e.x-n.x)/(e.y-n.y))return[]}else{t.curveOffset===void 0&&(t.curveOffset=this.curveOffset),ve(t.curveOffset)&&(t.curveOffset=t.curveOffset[0]),t.curveOffset<0?this.clockwise=0:this.clockwise=1;var a={x:e.x-n.x,y:e.y-n.y},s=Math.atan2(a.y,a.x);o={x:t.curveOffset*Math.cos(-Math.PI/2+s)+r.x,y:t.curveOffset*Math.sin(-Math.PI/2+s)+r.y},i=Mv(n,o,e)}var u=wd(n,i),c=[{x:u,y:u}];return c},getPath:function(t){var n=[];return n.push(["M",t[0].x,t[0].y]),t.length===2?n.push(["L",t[1].x,t[1].y]):n.push(["A",t[1].x,t[1].y,0,0,this.clockwise,t[2].x,t[2].y]),n}},"single-edge");Sn.registerEdge("quadratic",{curvePosition:.5,curveOffset:-20,getControlPoints:function(t){var n=t.controlPoints;if(!n||!n.length){var e=t.startPoint,r=t.endPoint;t.curveOffset===void 0&&(t.curveOffset=this.curveOffset),t.curvePosition===void 0&&(t.curvePosition=this.curvePosition),ve(t.curveOffset)&&(t.curveOffset=t.curveOffset[0]),ve(t.curvePosition)&&(t.curvePosition=t.curveOffset[0]);var i=Id(e,r,t.curvePosition,t.curveOffset);n=[i]}return n},getPath:function(t){var n=[];return n.push(["M",t[0].x,t[0].y]),n.push(["Q",t[1].x,t[1].y,t[2].x,t[2].y]),n}},"single-edge");Sn.registerEdge("cubic",{curvePosition:[1/2,1/2],curveOffset:[-20,20],getControlPoints:function(t){var n=t.controlPoints;if(t.curveOffset===void 0&&(t.curveOffset=this.curveOffset),t.curvePosition===void 0&&(t.curvePosition=this.curvePosition),pe(t.curveOffset)&&(t.curveOffset=[t.curveOffset,-t.curveOffset]),pe(t.curvePosition)&&(t.curvePosition=[t.curvePosition,1-t.curvePosition]),!n||!n.length||n.length<2){var e=t.startPoint,r=t.endPoint,i=Id(e,r,t.curvePosition[0],t.curveOffset[0]),o=Id(e,r,t.curvePosition[1],t.curveOffset[1]);n=[i,o]}return n},getPath:function(t){var n=[];return n.push(["M",t[0].x,t[0].y]),n.push(["C",t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y]),n}},"single-edge");Sn.registerEdge("cubic-vertical",{curvePosition:[1/2,1/2],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(t){var n=t.startPoint,e=t.endPoint;t.curvePosition===void 0&&(t.curvePosition=this.curvePosition),t.curveOffset===void 0&&(t.curveOffset=this.curveOffset),t.minCurveOffset===void 0&&(t.minCurveOffset=this.minCurveOffset),pe(t.curveOffset)&&(t.curveOffset=[t.curveOffset,-t.curveOffset]),pe(t.minCurveOffset)&&(t.minCurveOffset=[t.minCurveOffset,-t.minCurveOffset]),pe(t.curvePosition)&&(t.curvePosition=[t.curvePosition,1-t.curvePosition]);var r=e.y-n.y,i=[0,0];t.curveOffset?i=t.curveOffset:Math.abs(r)<Math.abs(t.minCurveOffset[0])&&(i=t.minCurveOffset);var o={x:n.x,y:n.y+r*this.curvePosition[0]+i[0]},a={x:e.x,y:e.y-r*this.curvePosition[1]+i[1]};return[o,a]}},"cubic");Sn.registerEdge("cubic-horizontal",{curvePosition:[1/2,1/2],minCurveOffset:[0,0],curveOffset:void 0,getControlPoints:function(t){var n=t.startPoint,e=t.endPoint;t.curvePosition===void 0&&(t.curvePosition=this.curvePosition),t.curveOffset===void 0&&(t.curveOffset=this.curveOffset),t.minCurveOffset===void 0&&(t.minCurveOffset=this.minCurveOffset),pe(t.curveOffset)&&(t.curveOffset=[t.curveOffset,-t.curveOffset]),pe(t.minCurveOffset)&&(t.minCurveOffset=[t.minCurveOffset,-t.minCurveOffset]),pe(t.curvePosition)&&(t.curvePosition=[t.curvePosition,1-t.curvePosition]);var r=e.x-n.x,i=[0,0];t.curveOffset?i=t.curveOffset:Math.abs(r)<Math.abs(t.minCurveOffset[0])&&(i=t.minCurveOffset);var o={x:n.x+r*this.curvePosition[0]+i[0],y:n.y},a={x:e.x-r*this.curvePosition[1]+i[1],y:e.y},s=[o,a];return s}},"cubic");Sn.registerEdge("loop",{getPathPoints:function(t){return MC(t)},getControlPoints:function(t){return t.controlPoints},afterDraw:function(t){t.controlPoints=void 0},afterUpdate:function(t){t.controlPoints=void 0}},"cubic");var SG={itemType:"combo",shapeType:"single-combo",labelPosition:"top",refX:he.comboLabel.refX,refY:he.comboLabel.refY,options:{style:{stroke:he.defaultCombo.style.stroke,fill:he.defaultCombo.style.fill,lineWidth:he.defaultCombo.style.lineWidth},labelCfg:{style:{fill:he.comboLabel.style.fill,fontSize:he.comboLabel.style.fontSize,fontFamily:he.windowFontFamily}},stateStyles:B({},he.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},getSize:function(t){var n=Xe(t.size||this.options.size||he.defaultCombo.size);return ve(n)&&n.length===1&&(n=[n[0],n[0]]),ve(n)||(n=[n,n]),n},getLabelStyleByPosition:function(t,n){var e=n.position||this.labelPosition,r=t.style,i=t.padding||this.options.padding;ve(i)&&(i=Math.max.apply(Math,i));var o=n.refX,a=n.refY;fe(o)&&(o=this.refX),fe(a)&&(a=this.refY);var s=this.getSize(t),u=Math.max(r.r,s[0]/2)||s[0]/2,c=u+i,l;switch(e){case"top":l={x:0,y:-c-a,textBaseline:"bottom",textAlign:"center"};break;case"bottom":l={x:0,y:c+a,textBaseline:"bottom",textAlign:"center"};break;case"left":l={x:-c+o,y:0,textAlign:"left"};break;case"center":l={x:0,y:0,text:t.label,textAlign:"center"};break;default:l={x:c+o,y:0,textAlign:"right"};break}return l.text=t.label,l},drawShape:function(t,n){var e=this.shapeType,r=this.getShapeStyle(t),i=n.addShape(e,{attrs:r,draggable:!0,name:"combo-shape"});return i},updateCollapsedIcon:function(t,n,e){var r=t.collapsed,i=t.collapsedSubstituteIcon,o=i===void 0?{}:i,a=Object.assign({},this.options.collapsedSubstituteIcon,o),s=a.show,u=a.img,c=a.width,l=a.height,h=n.getContainer(),f=h.find(function(v){return v.get("name")==="combo-collapsed-substitute-icon"}),d=f&&!f.destroyed,p=n.get("keyShape");if(r&&s){if(d)f.show();else{var g={width:c||e.r*2||e.width,height:l||e.r*2||e.height};f=h.addShape("image",{attrs:B({img:u,x:-g.width/2,y:-g.height/2},g),name:"combo-collapsed-substitute-icon",draggable:!0})}p.hide()}else d&&(f.hide(),p.show())},updateShape:function(t,n,e){var r=this,i=n.get("keyShape"),o=n.get("animate"),a=o&&(t.animate===void 0?this.options.animate:t.animate);a&&i.animate?(t.collapsed||this.updateCollapsedIcon(t,n,e),i.animate(e,{duration:200,easing:"easeLinear",callback:function(){t.collapsed&&r.updateCollapsedIcon(t,n,e)}})):(i.attr(B({},e)),this.updateCollapsedIcon(t,n,e)),this.updateLabel(t,n)}},_G=B(B({},Vy),SG);Sn.registerCombo("single-combo",_G);Sn.registerCombo("circle",{options:{size:[he.defaultCombo.size[0],he.defaultCombo.size[0]],padding:Math.max.apply(Math,he.defaultCombo.padding),animate:!0,style:{stroke:he.defaultCombo.style.stroke,fill:he.defaultCombo.style.fill,lineWidth:he.defaultCombo.style.lineWidth},labelCfg:{style:{fill:he.comboLabel.style.fill,fontSize:he.comboLabel.style.fontSize},refX:0,refY:0},stateStyles:B({},he.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},shapeType:"circle",labelPosition:"top",drawShape:function(t,n){var e=this.getShapeStyle(t);delete e.height,delete e.width;var r=n.addShape("circle",{attrs:e,className:"circle-combo",name:"circle-combo",draggable:!0});return r},getShapeStyle:function(t){var n=this.options.style,e=t.padding||this.options.padding;ve(e)&&(e=Math.max.apply(Math,e));var r={stroke:t.color},i=ye({},n,r,t.style),o=t.collapsed&&t.fixCollapseSize?t.fixCollapseSize:t.fixSize,a;if(o)a=pe(o)?o/2:o[0]/2;else{var s=this.getSize(t);!pe(i.r)||isNaN(i.r)?a=s[0]/2||he.defaultCombo.style.r:a=Math.max(i.r,s[0]/2)||s[0]/2}i.r=a+e;var u=B({x:0,y:0},i);return t.style?t.style.r=a:t.style={r:a},u},update:function(t,n){var e=this.getSize(t),r=t.padding||this.options.padding;ve(r)&&(r=Math.max.apply(Math,r));var i=Xe(t.style),o=t.collapsed&&t.fixCollapseSize?t.fixCollapseSize:t.fixSize,a;o?a=pe(o)?o/2:o[0]/2:a=Math.max(i.r,e[0]/2)||e[0]/2,i.r=a+r;var s=n.get("sizeCache");s&&(s.r=i.r);var u={stroke:t.color},c=n.get("keyShape"),l=ye({},c.attr(),u,i);t.style?t.style.r=a:t.style={r:a},this.updateShape(t,n,l,!0)}},"single-combo");Sn.registerCombo("rect",{options:{size:[40,5],padding:[25,20,15,20],animate:!0,style:{radius:0,stroke:he.defaultCombo.style.stroke,fill:he.defaultCombo.style.fill,lineWidth:he.defaultCombo.style.lineWidth},labelCfg:{style:{fill:he.comboLabel.style.fill,fontSize:he.comboLabel.style.fontSize,fontFamily:he.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:B({},he.comboStateStyles),collapsedSubstituteIcon:{show:!1,img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"}},shapeType:"rect",labelPosition:"top",drawShape:function(t,n){var e=this.getShapeStyle(t),r=n.addShape("rect",{attrs:e,className:"rect-combo",name:"rect-combo",draggable:!0});return r},getLabelStyleByPosition:function(t,n){var e=n.position||this.labelPosition,r=t.style,i=t.padding||this.options.padding;pe(i)&&(i=[i,i,i,i]);var o=n.refX,a=n.refY;fe(o)&&(o=this.refX),fe(a)&&(a=this.refY);var s=-r.width/2-i[3],u=r.width/2+i[1],c=-r.height/2-i[0],l=r.height/2+i[2],h;switch(e){case"top":h={x:s+o,y:c+a,textBaseline:"top",textAlign:"left"};break;case"bottom":h={x:0,y:l+a,textBaseline:"top",textAlign:"center"};break;case"left":h={x:s+a,y:0,textAlign:"left"};break;case"center":h={x:0,y:0,text:t.label,textAlign:"center"};break;case"top-center":h={x:0,y:c+a,textBaseline:"top",textAlign:"center"};break;default:h={x:u+o,y:0,textAlign:"right"};break}return h.text=t.label,h},getShapeStyle:function(t){var n=this.options.style,e=t.padding||this.options.padding;pe(e)&&(e=[e,e,e,e]);var r={stroke:t.color},i=ye({},n,r,t.style),o=this.getSize(t),a,s,u=t.collapsed&&t.fixCollapseSize?t.fixCollapseSize:t.fixSize;u?pe(u)?(a=u,s=u):(a=u[0],s=u[1]):(!pe(i.width)||isNaN(i.width)?a=o[0]||he.defaultCombo.style.width:a=Math.max(i.width,o[0])||o[0],!pe(i.height)||isNaN(i.height)?s=o[1]||he.defaultCombo.style.height:s=Math.max(i.height,o[1])||o[1]);var c=-a/2-e[3],l=-s/2-e[0];i.width=a+e[1]+e[3],i.height=s+e[0]+e[2];var h=B({x:c,y:l},i);return t.style?(t.style.width=a,t.style.height=s):t.style={width:a,height:s},h},update:function(t,n){var e=this.getSize(t),r=t.padding||this.options.padding;pe(r)&&(r=[r,r,r,r]);var i=Xe(t.style),o,a,s=t.collapsed&&t.fixCollapseSize?t.fixCollapseSize:t.fixSize;s?pe(s)?(o=s,a=s):(o=s[0],a=s[1]):(o=Math.max(i.width,e[0])||e[0],a=Math.max(i.height,e[1])||e[1]),i.width=o+r[1]+r[3],i.height=a+r[0]+r[2];var u=n.get("sizeCache");u&&(u.width=i.width,u.height=i.height),i.x=-o/2-r[3],i.y=-a/2-r[0];var c={stroke:t.color},l=n.get("keyShape"),h=ye({},l.attr(),c,i);t.style?(t.style.width=o,t.style.height=a):t.style={width:o,height:a},this.updateShape(t,n,h,!1)}},"single-combo");Sn.registerNode("simple-circle",{options:{size:he.defaultNode.size,style:{x:0,y:0,stroke:he.defaultNode.style.stroke,fill:he.defaultNode.style.fill,lineWidth:he.defaultNode.style.lineWidth},labelCfg:{style:{fill:he.nodeLabel.style.fill,fontSize:he.nodeLabel.style.fontSize,fontFamily:he.windowFontFamily}},stateStyles:B({},he.nodeStateStyles)},shapeType:"simple-circle",labelPosition:"center",shapeMap:{},drawShape:function(t,n){var e=this.getShapeStyle(t),r="".concat(this.type,"-keyShape"),i=n.addShape("circle",{attrs:e,className:"".concat(this.type,"-keyShape"),name:r,draggable:!0});return n.shapeMap[r]=i,i},getShapeStyle:function(t){var n=(this.mergeStyle||this.getOptions(t)).style,e={stroke:t.color},r=mn({},n,e),i=this.getSize(t),o=i[0]/2,a=B({x:0,y:0,r:o},r);return a},update:function(t,n,e){var r=this.getSize(t),i={stroke:t.color,r:r[0]/2},o=n.get("keyShape"),a=mn({},o.attr(),i,t.style);this.updateShape(t,n,a,!0,e)}},"single-node");Sn.registerNode("simple-rect",{options:{size:[100,30],style:{radius:0,stroke:he.defaultNode.style.stroke,fill:he.defaultNode.style.fill,lineWidth:he.defaultNode.style.lineWidth},labelCfg:{style:{fill:he.nodeLabel.style.fill,fontSize:he.nodeLabel.style.fontSize,fontFamily:he.windowFontFamily}},anchorPoints:[[0,.5],[1,.5]],stateStyles:B({},he.nodeStateStyles)},shapeType:"simple-rect",labelPosition:"center",drawShape:function(t,n){var e=this.getShapeStyle(t),r=n.addShape("rect",{attrs:e,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return r},getShapeStyle:function(t){var n=(this.mergeStyle||this.getOptions(t)).style,e={stroke:t.color},r=ye({},n,e),i=this.getSize(t),o=r.width||i[0],a=r.height||i[1],s=B({x:-o/2,y:-a/2,width:o,height:a},r);return s},update:function(t,n,e){n.getContainer();var r=(this.mergeStyle||this.getOptions(t)).style,i=this.getSize(t),o=n.get("keyShape");t.size||(i[0]=o.attr("width")||r.width,i[1]=o.attr("height")||r.height);var a={stroke:t.color,x:-i[0]/2,y:-i[1]/2,width:i[0],height:i[1]},s=ye({},r,o.attr(),a);s=ye(s,t.style),this.updateShape(t,n,s,!1,e)}},"single-node");Sn.registerNode("image",{options:{img:"https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*eD7nT6tmYgAAAAAAAAAAAABkARQnAQ",size:200,labelCfg:{style:{fontFamily:he.windowFontFamily}},clipCfg:{show:!1,type:"circle",r:50,rx:50,ry:35,width:50,height:35,points:[[30,12],[12,30],[30,48],[48,30]],path:[["M",25,25],["L",50,25],["A",12.5,12.5,0,1,1,50,50],["A",12.5,12.5,0,1,0,50,50],["L",25,75],["Z"]],x:0,y:0}},shapeType:"image",labelPosition:"bottom",drawShape:function(t,n){var e=this.shapeType,r=this.getShapeStyle(t);delete r.fill;var i=n.addShape(e,{attrs:r,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return this.drawClip(t,i),i},drawClip:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).clipCfg;if(e.show){var r=e.type,i=e.x,o=e.y,a=e.style;if(r==="circle"){var s=e.r;n.setClip({type:"circle",attrs:B({r:s,x:i,y:o},a)})}else if(r==="rect"){var u=e.width,c=e.height,l=i-u/2,h=o-c/2;n.setClip({type:"rect",attrs:B({x:l,y:h,width:u,height:c},a)})}else if(r==="ellipse"){var f=e.rx,d=e.ry;n.setClip({type:"ellipse",attrs:B({x:i,y:o,rx:f,ry:d},a)})}else if(r==="polygon"){var p=e.points;n.setClip({type:"polygon",attrs:B({points:p},a)})}else if(r==="path"){var g=e.path;n.setClip({type:"path",attrs:B({path:g},a)})}}},getShapeStyle:function(t){var n=this.mergeStyle||this.getOptions(t),e=n.style,r=n.img,i=this.getSize(t),o=i[0],a=i[1];e&&(o=e.width||i[0],a=e.height||i[1]);var s=B({x:-o/2,y:-a/2,width:o,height:a,img:r},e);return s},updateShapeStyle:function(t,n){var e=n.getContainer(),r="".concat(this.itemType,"-shape"),i=e.shapeMap[r]||e.find(function(a){return a.get("className")===r})||n.getKeyShape(),o=this.getShapeStyle(t);i&&!i.destroyed&&i.attr(o)}},"single-node");var kG=["#5F95FF","#61DDAA","#65789B","#F6BD16","#7262FD","#78D3F8","#9661BC","#F6903D","#008685","#F08BB4"];const AG=Object.freeze(Object.defineProperty({__proto__:null,defaultSubjectColors:kG},Symbol.toStringTag,{value:"Module"}));var NI=function(t){return t==="force"||t==="g6force"||t==="gForce"||t==="force2"};const CG=Object.freeze(Object.defineProperty({__proto__:null,isForce:NI},Symbol.toStringTag,{value:"Module"}));var IG=yi,Cr=B(B(B(B(B(B(B({},F9),oz),oG),KB),AG),CG),{transform:IG,mat3:Rk}),TG=function(){function t(n){this.graph=n,this.layoutCfg=n.get("layout")||{},this.layoutType=this.getLayoutType(),this.layoutMethods=[],this.initLayout()}return t.prototype.initLayout=function(){},t.prototype.getLayoutType=function(){return this.getLayoutCfgType(this.layoutCfg)},t.prototype.getLayoutCfgType=function(n){var e=n.type;if(e)return e;var r=n.pipes;return Array.isArray(r)?r.map(function(i){return(i==null?void 0:i.type)||""}):null},t.prototype.isLayoutTypeSame=function(n){var e=this.getLayoutCfgType(n),r=Array.isArray(this.layoutType),i=Array.isArray(e);return r&&i?this.layoutType.every(function(o,a){return o===e[a]}):Array.isArray(e)||Array.isArray(this.layoutType)?!1:(n==null?void 0:n.type)===this.layoutType},t.prototype.refreshLayout=function(){var n=this,e=n.graph,r=n.layoutType,i=n.layoutCfg,o=i===void 0?{}:i;if(e){var a=o.animate,s=a===void 0&&(r==="force"||r==="force2"),u=NI(r)&&(a||s);e.get("animate")&&!u?e.positionsAnimate(r==="comboCombined"):e.refreshPositions(r==="comboCombined")}},t.prototype.changeLayout=function(n){var e=n.disableTriggerLayout,r=or(n,["disableTriggerLayout"]);this.layoutCfg=r,this.layoutType=r.type||this.layoutType,!e&&this.layout()},t.prototype.changeData=function(n){this.layout(n)},t.prototype.destoryLayoutMethods=function(){var n=this.layoutMethods,e=[];return n==null||n.forEach(function(r){var i,o=(i=r.getType)===null||i===void 0?void 0:i.call(r);o&&e.push(o),r.destroy()}),this.layoutMethods=[],e},t.prototype.destroyLayout=function(){this.destoryLayoutMethods();var n=this.graph;n&&!n.get("destroyed")&&n.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0},t.prototype.setDataFromGraph=function(){for(var n,e=[],r=[],i=[],o=[],a=[],s=[],u=[],c=this.graph.getNodes(),l=this.graph.getEdges(),h=this.graph.getCombos(),f=c.length,d=0;d<f;d++){var p=c[d];if(!(!p||p.destroyed)){var g=p.getModel();if(!p.isVisible()){r.push(g);continue}e.push(g)}}for(var v=l.length,d=0;d<v;d++){var m=l[d];if(!(!m||m.destroyed)){var g=m.getModel();if(!m.isVisible()){o.push(g);continue}g.isComboEdge?a.push(g):i.push(g)}}for(var y=h.length,d=0;d<y;d++){var b=h[d];if(!b.destroyed){var g=b.getModel();if(!b.isVisible()){u.push(g);continue}s.push(g)}}return{nodes:e,hiddenNodes:r,edges:i,hiddenEdges:o,combos:s,hiddenCombos:u,comboEdges:a,vedges:(n=this.graph.get("vedges"))===null||n===void 0?void 0:n.map(function(x){return x.getModel()})}},t.prototype.relayout=function(n){var e=this,r=this,i=r.graph,o=r.layoutMethods,a=r.layoutCfg;if(!(!i||i.get("destroyed"))){var s=Promise.resolve();if(n){this.data=this.setDataFromGraph();var u=this.data.nodes;if(!u)return!1;s=this.initPositions(a.center,u)}i.emit("beforelayout"),o==null||o.forEach(function(c,l){var h=a[l]||a;s=s.then(function(){var f,d=e.execLayoutMethod(h,l);return l===o.length-1&&((f=a.onAllLayoutEnd)===null||f===void 0||f.call(a)),d})})}},t.prototype.filterLayoutData=function(n,e){var r=n.nodes,i=n.edges,o=or(n,["nodes","edges"]);if(!r)return n;var a,s;An(e==null?void 0:e.nodesFilter)?a=e.nodesFilter:a=function(){return!0};var u=r.filter(a);if(An(e==null?void 0:e.edgesFilter))s=e.edgesFilter;else{var c=u.reduce(function(l,h){return l[h.id]=!0,l},{});s=function(l){return c[l.source]&&c[l.target]}}return B({nodes:u,edges:i.filter(s)},o)},t.prototype.getLayoutBBox=function(n){var e=this.graph,r=vd(e.getNodes(),function(a){return a.getModel().layoutOrder}),i=Object.values(r).map(function(a){var s=bI(a);return s.size=[s.width,s.height],s}),o=Object.values(vd(n,"layoutOrder"));return{groupNodes:o,layoutNodes:i}},t.prototype.layoutAnimate=function(){},t.prototype.moveToZero=function(){var n=this.graph,e=n.get("data"),r=e.nodes;if(!(r[0].x===void 0||r[0].x===null||eo(r[0].x))){for(var i=[0,0],o=r.length,a=0;a<o;a++){var s=r[a];i[0]+=s.x,i[1]+=s.y}i[0]/=r.length,i[1]/=r.length;for(var a=0;a<o;a++){var s=r[a];s.x-=i[0],s.y-=i[1]}}},t.prototype.initPositions=function(n,e){var r;return Hr(this,void 0,void 0,function(){var i,o,a;return qr(this,function(s){return i=this.graph,e!=null&&e.length?(o=e.filter(function(u){return eo(u.x)||eo(u.y)}),a=o?o.length:0,a?[2,(r=this.initWithPreset)===null||r===void 0?void 0:r.call(this,function(){},function(){var u=i.get("width")*.85,c=i.get("height")*.85,l=Math.ceil(Math.sqrt(a)*(u/c)),h=Math.ceil(a/l),f=u/(l-1),d=c/(h-1);(!isFinite(f)||!f)&&(f=0),(!isFinite(d)||!f)&&(d=0);for(var p=n[0]-u/2,g=n[1]-c/2,v=0;v<a;v++){var m=o[v];eo(+m.x)&&(m.x=v%l*f+p),eo(+m.y)&&(m.y=Math.floor(v/l)*d+g)}})]:[2]):[2,Promise.resolve()]})})},t.prototype.destroy=function(){this.graph=null,this.destoryLayoutMethods(),this.destroyed=!0},t}(),OG=function(){function t(n){this.graph=n,this.destroyed=!1,this.initEvents()}return t}(),ja=Sn.registerNode,NG=Sn.registerEdge;Sn.registerCombo;var DG=Ik.registerBehavior,Jt=he;Sn.registerNode,Sn.registerEdge,Sn.registerCombo;var Wy={},Je={},vp={},Ta={};Object.defineProperty(Ta,"__esModule",{value:!0});Ta.MESSAGE=Ta.ALGORITHM=void 0;var PG={pageRank:"pageRank",breadthFirstSearch:"breadthFirstSearch",connectedComponent:"connectedComponent",depthFirstSearch:"depthFirstSearch",detectCycle:"detectCycle",detectDirectedCycle:"detectDirectedCycle",detectAllCycles:"detectAllCycles",detectAllDirectedCycle:"detectAllDirectedCycle",detectAllUndirectedCycle:"detectAllUndirectedCycle",dijkstra:"dijkstra",findAllPath:"findAllPath",findShortestPath:"findShortestPath",floydWarshall:"floydWarshall",getAdjMatrix:"getAdjMatrix",getDegree:"getDegree",getInDegree:"getInDegree",getNeighbors:"getNeighbors",getOutDegree:"getOutDegree",labelPropagation:"labelPropagation",louvain:"louvain",GADDI:"GADDI",minimumSpanningTree:"minimumSpanningTree",SUCCESS:"SUCCESS",FAILURE:"FAILURE"};Ta.ALGORITHM=PG;var LG={SUCCESS:"SUCCESS",FAILURE:"FAILURE"};Ta.MESSAGE=LG;var mp={},DI={},Ds={};Object.defineProperty(Ds,"__esModule",{value:!0});Ds.default=void 0;var jG=function(t,n){var e=t.nodes,r=t.edges,i=[],o={};if(!e)throw new Error("invalid nodes data!");return e&&e.forEach(function(a,s){o[a.id]=s;var u=[];i.push(u)}),r&&r.forEach(function(a){var s=a.source,u=a.target,c=o[s],l=o[u];!c&&c!==0||!l&&l!==0||(i[c][l]=1,n||(i[l][c]=1))}),i},RG=jG;Ds.default=RG;var yp={},bp={},ju={};Object.defineProperty(ju,"__esModule",{value:!0});ju.default=ju.LinkedListNode=void 0;var FG=function(t,n){return t===n},nm=function(){function t(n,e){e===void 0&&(e=null),this.value=n,this.next=e}return t.prototype.toString=function(n){return n?n(this.value):"".concat(this.value)},t}();ju.LinkedListNode=nm;var BG=function(){function t(n){n===void 0&&(n=FG),this.head=null,this.tail=null,this.compare=n}return t.prototype.prepend=function(n){var e=new nm(n,this.head);return this.head=e,this.tail||(this.tail=e),this},t.prototype.append=function(n){var e=new nm(n);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},t.prototype.delete=function(n){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,n);)e=this.head,this.head=this.head.next;var r=this.head;if(r!==null)for(;r.next;)this.compare(r.next.value,n)?(e=r.next,r.next=r.next.next):r=r.next;return this.compare(this.tail.value,n)&&(this.tail=r),e},t.prototype.find=function(n){var e=n.value,r=e===void 0?void 0:e,i=n.callback,o=i===void 0?void 0:i;if(!this.head)return null;for(var a=this.head;a;){if(o&&o(a.value)||r!==void 0&&this.compare(a.value,r))return a;a=a.next}return null},t.prototype.deleteTail=function(){var n=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,n;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,n},t.prototype.deleteHead=function(){if(!this.head)return null;var n=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),n},t.prototype.fromArray=function(n){var e=this;return n.forEach(function(r){return e.append(r)}),this},t.prototype.toArray=function(){for(var n=[],e=this.head;e;)n.push(e),e=e.next;return n},t.prototype.reverse=function(){for(var n=this.head,e=null,r=null;n;)r=n.next,n.next=e,e=n,n=r;this.tail=this.head,this.head=e},t.prototype.toString=function(n){return n===void 0&&(n=void 0),this.toArray().map(function(e){return e.toString(n)}).toString()},t}(),zG=BG;ju.default=zG;Object.defineProperty(bp,"__esModule",{value:!0});bp.default=void 0;var GG=UG(ju);function UG(t){return t&&t.__esModule?t:{default:t}}var YG=function(){function t(){this.linkedList=new GG.default}return t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},t.prototype.enqueue=function(n){this.linkedList.append(n)},t.prototype.dequeue=function(){var n=this.linkedList.deleteHead();return n?n.value:null},t.prototype.toString=function(n){return this.linkedList.toString(n)},t}(),VG=YG;bp.default=VG;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.uniqueId=tr.getOutEdgesNodeId=tr.getNeighbors=tr.getEdgesByNodeId=void 0;var WG=function(t,n,e){n===void 0&&(n=[]);var r=n.filter(function(s){return s.source===t||s.target===t});if(e==="target"){var i=function(s){return s.source===t};return r.filter(i).map(function(s){return s.target})}if(e==="source"){var o=function(s){return s.target===t};return r.filter(o).map(function(s){return s.source})}var a=function(s){return s.source===t?s.target:s.source};return r.map(a)};tr.getNeighbors=WG;var XG=function(t,n){return n.filter(function(e){return e.source===t})};tr.getOutEdgesNodeId=XG;var HG=function(t,n){return n.filter(function(e){return e.source===t||e.target===t})};tr.getEdgesByNodeId=HG;var qG=function(t){t===void 0&&(t=0);var n="".concat(Math.random()).split(".")[1].substr(0,5),e="".concat(Math.random()).split(".")[1].substr(0,5);return"".concat(t,"-").concat(n).concat(e)};tr.uniqueId=qG;Object.defineProperty(yp,"__esModule",{value:!0});yp.default=void 0;var ZG=QG(bp),KG=tr;function QG(t){return t&&t.__esModule?t:{default:t}}function JG(t){t===void 0&&(t={});var n=t,e=function(){},r=function(){var i={};return function(o){var a=o.next,s=a;return i[s]?!1:(i[s]=!0,!0)}}();return n.allowTraversal=t.allowTraversal||r,n.enter=t.enter||e,n.leave=t.leave||e,n}var $G=function(t,n,e,r){r===void 0&&(r=!0);var i=JG(e),o=new ZG.default,a=t.edges,s=a===void 0?[]:a;o.enqueue(n);for(var u="",c=function(){var l=o.dequeue();i.enter({current:l,previous:u}),(0,KG.getNeighbors)(l,s,r?"target":void 0).forEach(function(h){i.allowTraversal({previous:u,current:l,next:h})&&o.enqueue(h)}),i.leave({current:l,previous:u}),u=l};!o.isEmpty();)c()},t7=$G;yp.default=t7;var Oa={};Object.defineProperty(Oa,"__esModule",{value:!0});Oa.default=e7;Oa.detectStrongConnectComponents=Oa.detectConnectedComponents=void 0;var PI=tr,LI=function(t){for(var n=t.nodes,e=n===void 0?[]:n,r=t.edges,i=r===void 0?[]:r,o=[],a={},s=[],u=function f(d){s.push(d),a[d.id]=!0;for(var p=(0,PI.getNeighbors)(d.id,i),g=function(m){var y=p[m];if(!a[y]){var b=e.filter(function(x){return x.id===y});b.length>0&&f(b[0])}},v=0;v<p.length;++v)g(v)},c=0;c<e.length;c++){var l=e[c];if(!a[l.id]){u(l);for(var h=[];s.length>0;)h.push(s.pop());o.push(h)}}return o};Oa.detectConnectedComponents=LI;var jI=function(t){for(var n=t.nodes,e=n===void 0?[]:n,r=t.edges,i=r===void 0?[]:r,o=[],a={},s={},u={},c=[],l=0,h=function g(v){s[v.id]=l,u[v.id]=l,l+=1,o.push(v),a[v.id]=!0;for(var m=(0,PI.getNeighbors)(v.id,i,"target").filter(function(E){return e.map(function(M){return M.id}).indexOf(E)>-1}),y=function(E){var M=m[E];if(!s[M]&&s[M]!==0){var _=e.filter(function(k){return k.id===M});_.length>0&&g(_[0]),u[v.id]=Math.min(u[v.id],u[M])}else a[M]&&(u[v.id]=Math.min(u[v.id],s[M]))},b=0;b<m.length;b++)y(b);if(u[v.id]===s[v.id]){for(var x=[];o.length>0;){var w=o.pop();if(a[w.id]=!1,x.push(w),w===v)break}x.length>0&&c.push(x)}},f=0,d=e;f<d.length;f++){var p=d[f];!s[p.id]&&s[p.id]!==0&&h(p)}return c};Oa.detectStrongConnectComponents=jI;function e7(t,n){return n?jI(t):LI(t)}var Xo={};Object.defineProperty(Xo,"__esModule",{value:!0});Xo.getOutDegree=Xo.getInDegree=Xo.default=void 0;var El=function(t){var n={},e=t.nodes,r=e===void 0?[]:e,i=t.edges,o=i===void 0?[]:i;return r.forEach(function(a){n[a.id]={degree:0,inDegree:0,outDegree:0}}),o.forEach(function(a){n[a.source].degree++,n[a.source].outDegree++,n[a.target].degree++,n[a.target].inDegree++}),n},n7=El;Xo.default=n7;var r7=function(t,n){var e=El(t);return e[n]?El(t)[n].inDegree:0};Xo.getInDegree=r7;var i7=function(t,n){var e=El(t);return e[n]?El(t)[n].outDegree:0};Xo.getOutDegree=i7;var io={},xp={};Object.defineProperty(xp,"__esModule",{value:!0});xp.default=s7;var o7=tr;function a7(t){t===void 0&&(t={});var n=t,e=function(){},r=function(){var i={};return function(o){var a=o.next;return i[a]?!1:(i[a]=!0,!0)}}();return n.allowTraversal=t.allowTraversal||r,n.enter=t.enter||e,n.leave=t.leave||e,n}function RI(t,n,e,r){r.enter({current:n,previous:e});var i=t.edges,o=i===void 0?[]:i;(0,o7.getNeighbors)(n,o,"target").forEach(function(a){r.allowTraversal({previous:e,current:n,next:a})&&RI(t,a,n,r)}),r.leave({current:n,previous:e})}function s7(t,n,e){RI(t,n,"",a7(e))}function rm(t){"@babel/helpers - typeof";return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},rm(t)}Object.defineProperty(io,"__esModule",{value:!0});io.detectAllUndirectedCycle=io.detectAllDirectedCycle=io.detectAllCycles=io.default=void 0;var u7=l7(xp),FI=c7(Oa),BI=tr;function zI(t){if(typeof WeakMap!="function")return null;var n=new WeakMap,e=new WeakMap;return(zI=function(r){return r?e:n})(t)}function c7(t,n){if(!n&&t&&t.__esModule)return t;if(t===null||rm(t)!=="object"&&typeof t!="function")return{default:t};var e=zI(n);if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}function l7(t){return t&&t.__esModule?t:{default:t}}var h7=function(t){var n=null,e=t.nodes,r=e===void 0?[]:e,i={},o={},a={},s={};r.forEach(function(l){o[l.id]=l});for(var u={enter:function(l){var h=l.current,f=l.previous;if(a[h]){n={};for(var d=h,p=f;p!==h;)n[d]=p,d=p,p=i[p];n[d]=p}else a[h]=h,delete o[h],i[h]=f},leave:function(l){var h=l.current;s[h]=h,delete a[h]},allowTraversal:function(l){var h=l.next;return n?!1:!s[h]}};Object.keys(o).length;){var c=Object.keys(o)[0];(0,u7.default)(t,c,u)}return n},GI=function(t,n,e){var r,i;e===void 0&&(e=!0);for(var o=[],a=(0,FI.default)(t,!1),s=0,u=a;s<u.length;s++){var c=u[s];if(c.length)for(var l=c[0],h=l.id,f=[l],d=(r={},r[h]=l,r),p=(i={},i[h]=new Set,i);f.length>0;)for(var g=f.pop(),v=g.id,m=(0,BI.getNeighbors)(v,t.edges),y=function(x){var w,E=m[x],M=t.nodes.find(function(I){return I.id===E});if(E===v)o.push((w={},w[E]=g,w));else if(!(E in p))d[E]=g,f.push(M),p[E]=new Set([g]);else if(!p[v].has(M)){for(var _=!0,k=[M,g],S=d[v];p[E].size&&!p[E].has(S)&&(k.push(S),S!==d[S.id]);)S=d[S.id];if(k.push(S),n&&e?(_=!1,k.findIndex(function(I){return n.indexOf(I.id)>-1})>-1&&(_=!0)):n&&!e&&k.findIndex(function(I){return n.indexOf(I.id)>-1})>-1&&(_=!1),_){for(var A={},C=1;C<k.length;C+=1)A[k[C-1].id]=k[C];k.length&&(A[k[k.length-1].id]=k[0]),o.push(A)}p[E].add(g)}},b=0;b<m.length;b+=1)y(b)}return o};io.detectAllUndirectedCycle=GI;var UI=function(t,n,e){e===void 0&&(e=!0);for(var r=[],i=new Set,o=[],a=[],s={},u={},c=function(S){for(var A=[S];A.length>0;){var C=A.pop();i.has(C)&&(i.delete(C),o[C.id].forEach(function(I){A.push(I)}),o[C.id].clear())}},l=function S(A,C,I){var N=!1;if(n&&e===!1&&n.indexOf(A.id)>-1)return N;r.push(A),i.add(A);for(var D=I[A.id],P=0;P<D.length;P+=1){var j=s[D[P]];if(j===C){for(var L={},R=1;R<r.length;R+=1)L[r[R-1].id]=r[R];r.length&&(L[r[r.length-1].id]=r[0]),a.push(L),N=!0}else i.has(j)||S(j,C,I)&&(N=!0)}if(N)c(A);else for(var P=0;P<D.length;P+=1){var j=s[D[P]];o[j.id].has(A)||o[j.id].add(A)}return r.pop(),N},h=t.nodes,f=h===void 0?[]:h,d=0;d<f.length;d+=1){var p=f[d],g=p.id;u[g]=d,s[d]=p}if(n&&e)for(var v=function(A){var C=n[A];u[f[A].id]=u[C],u[C]=0,s[0]=f.find(function(I){return I.id===C}),s[u[f[A].id]]=f[A]},d=0;d<n.length;d++)v(d);for(var m=function(S){for(var A,C,I=1/0,N=0;N<S.length;N+=1)for(var D=S[N],P=0;P<D.length;P++){var j=u[D[P].id];j<I&&(I=j,C=N)}for(var L=S[C],R=[],N=0;N<L.length;N+=1){var V=L[N];R[V.id]=[];for(var tt=0,ut=(0,BI.getNeighbors)(V.id,t.edges,"target").filter(function(Et){return L.map(function(Bt){return Bt.id}).indexOf(Et)>-1});tt<ut.length;tt++){var dt=ut[tt];dt===V.id&&!(e===!1&&n.indexOf(V.id)>-1)?a.push((A={},A[V.id]=V,A)):R[V.id].push(u[dt])}}return{component:L,adjList:R,minIdx:I}},y=0;y<f.length;){var b=f.filter(function(S){return u[S.id]>=y}),x=(0,FI.detectStrongConnectComponents)({nodes:b,edges:t.edges}).filter(function(S){return S.length>1});if(x.length===0)break;var w=m(x),E=w.minIdx,M=w.adjList,_=w.component;if(_.length>1){_.forEach(function(S){o[S.id]=new Set});var k=s[E];if(n&&e&&n.indexOf(k.id)===-1)return a;l(k,k,M),y=E+1}else break}return a};io.detectAllDirectedCycle=UI;var f7=function(t,n,e,r){return r===void 0&&(r=!0),n?UI(t,e,r):GI(t,e,r)};io.detectAllCycles=f7;var d7=h7;io.default=d7;var $u={};const YI=xo($P),zl=xo(h4);Object.defineProperty($u,"__esModule",{value:!0});$u.default=void 0;var V2=YI,p7=zl,W2=tr,g7=function(t,n,e){for(var r=1/0,i,o=0;o<n.length;o++){var a=n[o].id;!e[a]&&t[a]<=r&&(r=t[a],i=n[o])}return i},v7=function(t,n,e,r){var i=t.nodes,o=i===void 0?[]:i,a=t.edges,s=a===void 0?[]:a,u={},c={},l={};o.forEach(function(m,y){var b=m.id;c[b]=1/0,b===n&&(c[b]=0)});for(var h=o.length,f=function(m){var y=g7(c,o,u),b=y.id;if(u[b]=!0,c[b]===1/0)return"continue";var x=[];e?x=(0,W2.getOutEdgesNodeId)(b,s):x=(0,W2.getEdgesByNodeId)(b,s),x.forEach(function(w){var E=w.target,M=w.source,_=E===b?M:E,k=r&&w[r]?w[r]:1;c[_]>c[y.id]+k?(c[_]=c[y.id]+k,l[_]=[y.id]):c[_]===c[y.id]+k&&l[_].push(y.id)})},d=0;d<h;d++)f();l[n]=[n];var p={};for(var g in c)c[g]!==1/0&&VI(n,g,l,p);var v={};for(var g in p)v[g]=p[g][0];return{length:c,path:v,allPath:p}},m7=v7;$u.default=m7;function VI(t,n,e,r){if(t===n)return[t];if(r[n])return r[n];for(var i=[],o=0,a=e[n];o<a.length;o++){var s=a[o],u=VI(t,s,e,r);if(!u)return;for(var c=0,l=u;c<l.length;c++){var h=l[c];(0,p7.isArray)(h)?i.push((0,V2.__spreadArray)((0,V2.__spreadArray)([],h,!0),[n],!1)):i.push([h,n])}}return r[n]=i,r[n]}var Ru={};Object.defineProperty(Ru,"__esModule",{value:!0});Ru.findShortestPath=Ru.findAllPath=void 0;var y7=b7($u),lf=tr;function b7(t){return t&&t.__esModule?t:{default:t}}var x7=function(t,n,e,r,i){var o=(0,y7.default)(t,n,r,i),a=o.length,s=o.path,u=o.allPath;return{length:a[e],path:s[e],allPath:u[e]}};Ru.findShortestPath=x7;var w7=function(t,n,e,r){var i;if(n===e)return[[n]];var o=t.edges,a=o===void 0?[]:o,s=[n],u=(i={},i[n]=!0,i),c=[],l=[],h=r?(0,lf.getNeighbors)(n,a,"target"):(0,lf.getNeighbors)(n,a);for(c.push(h);s.length>0&&c.length>0;){var f=c[c.length-1];if(f.length){var d=f.shift();d&&(s.push(d),u[d]=!0,h=r?(0,lf.getNeighbors)(d,a,"target"):(0,lf.getNeighbors)(d,a),c.push(h.filter(function(v){return!u[v]})))}else{var p=s.pop();u[p]=!1,c.pop();continue}if(s[s.length-1]===e){var g=s.map(function(m){return m});l.push(g);var p=s.pop();u[p]=!1,c.pop()}}return l};Ru.findAllPath=w7;var Gl={};Object.defineProperty(Gl,"__esModule",{value:!0});Gl.default=void 0;var E7=M7(Ds);function M7(t){return t&&t.__esModule?t:{default:t}}var S7=function(t,n){for(var e=(0,E7.default)(t,n),r=[],i=e.length,o=0;o<i;o+=1){r[o]=[];for(var a=0;a<i;a+=1)o===a?r[o][a]=0:e[o][a]===0||!e[o][a]?r[o][a]=1/0:r[o][a]=e[o][a]}for(var s=0;s<i;s+=1)for(var o=0;o<i;o+=1)for(var a=0;a<i;a+=1)r[o][a]>r[o][s]+r[s][a]&&(r[o][a]=r[o][s]+r[s][a]);return r},_7=S7;Gl.default=_7;var wp={};Object.defineProperty(wp,"__esModule",{value:!0});wp.default=void 0;var k7=C7(Ds),A7=tr;function C7(t){return t&&t.__esModule?t:{default:t}}var I7=function(t,n,e,r){n===void 0&&(n=!1),e===void 0&&(e="weight"),r===void 0&&(r=1e3);var i=t.nodes,o=i===void 0?[]:i,a=t.edges,s=a===void 0?[]:a,u={},c={};o.forEach(function(y,b){var x=(0,A7.uniqueId)();y.clusterId=x,u[x]={id:x,nodes:[y]},c[y.id]={node:y,idx:b}});var l=(0,k7.default)(t,n),h={};l.forEach(function(y,b){var x=o[b].id;h[x]={},y.forEach(function(w,E){if(w){var M=o[E].id;h[x][M]=w}})});for(var f=0,d=function(){var y=!1;if(o.forEach(function(b){var x={};Object.keys(h[b.id]).forEach(function(C){var I=h[b.id][C],N=c[C].node,D=N.clusterId;x[D]||(x[D]=0),x[D]+=I});var w=-1/0,E=[];if(Object.keys(x).forEach(function(C){w<x[C]?(w=x[C],E=[C]):w===x[C]&&E.push(C)}),!(E.length===1&&E[0]===b.clusterId)){var M=E.indexOf(b.clusterId);if(M>=0&&E.splice(M,1),E&&E.length){y=!0;var _=u[b.clusterId],k=_.nodes.indexOf(b);_.nodes.splice(k,1);var S=Math.floor(Math.random()*E.length),A=u[E[S]];A.nodes.push(b),b.clusterId=A.id}}}),!y)return"break";f++};f<r;){var p=d();if(p==="break")break}Object.keys(u).forEach(function(y){var b=u[y];(!b.nodes||!b.nodes.length)&&delete u[y]});var g=[],v={};s.forEach(function(y){var b=y.source,x=y.target,w=y[e]||1,E=c[b].node.clusterId,M=c[x].node.clusterId,_="".concat(E,"---").concat(M);if(v[_])v[_].weight+=w,v[_].count++;else{var k={source:E,target:M,weight:w,count:1};v[_]=k,g.push(k)}});var m=[];return Object.keys(u).forEach(function(y){m.push(u[y])}),{clusters:m,clusterEdges:g}},T7=I7;wp.default=T7;var Ep={},Ul={};Object.defineProperty(Ul,"__esModule",{value:!0});Ul.default=void 0;var O7=zl,N7=function(){function t(n){this.arr=n}return t.prototype.getArr=function(){return this.arr||[]},t.prototype.add=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length))return new t(r);if(!(r!=null&&r.length))return new t(this.arr);if(this.arr.length===r.length){var i=[];for(var o in this.arr)i[o]=this.arr[o]+r[o];return new t(i)}},t.prototype.subtract=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length))return new t(r);if(!(r!=null&&r.length))return new t(this.arr);if(this.arr.length===r.length){var i=[];for(var o in this.arr)i[o]=this.arr[o]-r[o];return new t(i)}},t.prototype.avg=function(n){var e=[];if(n!==0)for(var r in this.arr)e[r]=this.arr[r]/n;return new t(e)},t.prototype.negate=function(){var n=[];for(var e in this.arr)n[e]=-this.arr[e];return new t(n)},t.prototype.squareEuclideanDistance=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=Math.pow(this.arr[o]-n.arr[o],2);return i}},t.prototype.euclideanDistance=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=Math.pow(this.arr[o]-n.arr[o],2);return Math.sqrt(i)}else console.error("The two vectors are unequal in length.")},t.prototype.normalize=function(){var n=[],e=(0,O7.clone)(this.arr);e.sort(function(a,s){return a-s});var r=e[e.length-1],i=e[0];for(var o in this.arr)n[o]=(this.arr[o]-i)/(r-i);return new t(n)},t.prototype.norm2=function(){var n;if(!(!((n=this.arr)===null||n===void 0)&&n.length))return 0;var e=0;for(var r in this.arr)e+=Math.pow(this.arr[r],2);return Math.sqrt(e)},t.prototype.dot=function(n){var e,r=n.arr;if(!(!((e=this.arr)===null||e===void 0)&&e.length)||!(r!=null&&r.length))return 0;if(this.arr.length===r.length){var i=0;for(var o in this.arr)i+=this.arr[o]*n.arr[o];return i}else console.error("The two vectors are unequal in length.")},t.prototype.equal=function(n){var e,r=n.arr;if(((e=this.arr)===null||e===void 0?void 0:e.length)!==(r==null?void 0:r.length))return!1;for(var i in this.arr)if(this.arr[i]!==r[i])return!1;return!0},t}(),D7=N7;Ul.default=D7;var oo={},Fu={};Object.defineProperty(Fu,"__esModule",{value:!0});Fu.secondReg=Fu.dateReg=void 0;var P7=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/;Fu.secondReg=P7;var L7=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/;Fu.dateReg=L7;Object.defineProperty(oo,"__esModule",{value:!0});oo.getPropertyWeight=oo.getAllSortProperties=oo.getAllProperties=oo.default=void 0;var X2=Fu,Xy=function(t,n){t===void 0&&(t=[]),n===void 0&&(n=100);var e={};t.forEach(function(i){i.properties&&Object.keys(i.properties).forEach(function(o){if(o==="id"||!"".concat(i.properties[o]).match(X2.secondReg)&&!"".concat(i.properties[o]).match(X2.dateReg)&&isNaN(Number(i.properties[o]))){e.hasOwnProperty(o)&&delete e[o];return}e.hasOwnProperty(o)?e[o]+=1:e[o]=1})});var r=Object.keys(e).sort(function(i,o){return e[o]-e[i]});return r.length<n?r:r.slice(0,n)};oo.getAllSortProperties=Xy;var j7=function(t,n){return n.map(function(e){return t.hasOwnProperty(e)?t[e]:0})},WI=function(t){for(var n=Xy(t),e=[],r=0;r<t.length;r++)e[r]=j7(t[r].properties,n);return e};oo.getPropertyWeight=WI;var XI=function(t,n){n===void 0&&(n=void 0);var e=[];return t.forEach(function(r){n===void 0&&e.push(r),r[n]!==void 0&&e.push(r[n])}),e};oo.getAllProperties=XI;var R7={getAllSortProperties:Xy,getPropertyWeight:WI,getAllProperties:XI};oo.default=R7;var ao={},Yl={};Object.defineProperty(Yl,"__esModule",{value:!0});Yl.DistanceType=void 0;var im;Yl.DistanceType=im;(function(t){t.EuclideanDistance="euclideanDistance"})(im||(Yl.DistanceType=im={}));Object.defineProperty(ao,"__esModule",{value:!0});ao.oneHot=ao.getDistance=ao.getAllKeyValueMap=ao.default=void 0;var H2=zl,q2=Yl,Z2=F7(Ul);function F7(t){return t&&t.__esModule?t:{default:t}}var Hy=function(t,n,e){var r=[];n!=null&&n.length?r=n:(t.forEach(function(o){r=r.concat(Object.keys(o))}),r=(0,H2.uniq)(r));var i={};return r.forEach(function(o){var a=[];t.forEach(function(s){s[o]!==void 0&&s[o]!==""&&a.push(s[o])}),a.length&&!(e!=null&&e.includes(o))&&(i[o]=(0,H2.uniq)(a))}),i};ao.getAllKeyValueMap=Hy;var HI=function(t,n,e){var r=Hy(t,n,e),i=[];if(!Object.keys(r).length)return i;var o=Object.values(r),a=o.every(function(s){return s.every(function(u){return typeof u=="number"})});return t.forEach(function(s,u){var c=[];Object.keys(r).forEach(function(l){var h=s[l],f=r[l],d=f.findIndex(function(v){return h===v}),p=[];if(a)p.push(h);else for(var g=0;g<f.length;g++)g===d?p.push(1):p.push(0);c=c.concat(p)}),i[u]=c}),i};ao.oneHot=HI;var qI=function(t,n,e,r){e===void 0&&(e=q2.DistanceType.EuclideanDistance);var i=0;switch(e){case q2.DistanceType.EuclideanDistance:i=new Z2.default(t).euclideanDistance(new Z2.default(n));break}return i};ao.getDistance=qI;var B7={getAllKeyValueMap:Hy,oneHot:HI,getDistance:qI};ao.default=B7;Object.defineProperty(Ep,"__esModule",{value:!0});Ep.default=void 0;var z7=zl,G7=ZI(Ds),_c=ZI(Ul),U7=oo,Y7=ao;function ZI(t){return t&&t.__esModule?t:{default:t}}var K2=function(t,n,e,r){for(var i=n.length,o=2*r,a=0,s=0;s<i;s++)for(var u=t[s].clusterId,c=0;c<i;c++){var l=t[c].clusterId;if(u===l){var h=n[s][c]||0,f=e[s]||0,d=e[c]||0;a+=h-f*d/o}}return a*=1/o,a},I0=function(t,n){t===void 0&&(t=[]);for(var e=t.length,r=new _c.default([]),i=0;i<e;i++)r=r.add(new _c.default(n[i]));var o=r.avg(e);o.normalize();for(var a=0,i=0;i<e;i++){var s=new _c.default(n[i]),u=s.squareEuclideanDistance(o);a+=u}var c=[];t.forEach(function(){c.push([])});for(var i=0;i<e;i++){var s=new _c.default(n[i]);t[i].clusterInertial=0;for(var l=0;l<e;l++){if(i===l){c[i][l]=0;continue}var h=new _c.default(n[l]);c[i][l]=s.squareEuclideanDistance(h),t[i].clusterInertial+=c[i][l]}}for(var f=0,d=2*e*a,i=0;i<e;i++)for(var p=t[i].clusterId,l=0;l<e;l++){var g=t[l].clusterId;if(!(i===l||p!==g)){var v=t[i].clusterInertial*t[l].clusterInertial/Math.pow(d,2)-c[i][l]/d;f+=v}}return Number(f.toFixed(4))},V7=function(t,n,e,r,i,o,a,s,u){n===void 0&&(n=!1),e===void 0&&(e="weight"),r===void 0&&(r=1e-4),i===void 0&&(i=!1),o===void 0&&(o=void 0),a===void 0&&(a=[]),s===void 0&&(s=["id"]),u===void 0&&(u=1);var c=t.nodes,l=c===void 0?[]:c,h=t.edges,f=h===void 0?[]:h,d=[];if(i){l.forEach(function(L,R){L.properties=L.properties||{},L.originIndex=R});var p=[];l.every(function(L){return L.hasOwnProperty("nodeType")})&&(p=Array.from(new Set(l.map(function(L){return L.nodeType}))),l.forEach(function(L){L.properties.nodeType=p.findIndex(function(R){return R===L.nodeType})}));var g=(0,U7.getAllProperties)(l,o);d=(0,Y7.oneHot)(g,a,s)}var v=1,m={},y={};l.forEach(function(L,R){var V=String(v++);L.clusterId=V,m[V]={id:V,nodes:[L]},y[L.id]={node:L,idx:R}});var b=(0,G7.default)(t,n),x=[],w={},E=0;b.forEach(function(L,R){var V=0,tt=l[R].id;w[tt]={},L.forEach(function(ut,dt){if(ut){V+=ut;var J=l[dt].id;w[tt][J]=ut,E+=ut}}),x.push(V)}),E/=2;for(var M=1/0,_=1/0,k=0,S=[],A={};;){i&&l.every(function(L){return L.hasOwnProperty("properties")})?M=K2(l,b,x,E)+I0(l,d)*u:M=K2(l,b,x,E),k===0&&(_=M,S=l,A=m);var C=M>0&&M>_&&M-_<r;if(M>_&&(S=l.map(function(L){return{node:L,clusterId:L.clusterId}}),A=(0,z7.clone)(m),_=M),C||k>100)break;k++,Object.keys(m).forEach(function(L){var R=0;f.forEach(function(V){var tt=V.source,ut=V.target,dt=y[tt].node.clusterId,J=y[ut].node.clusterId;(dt===L&&J!==L||J===L&&dt!==L)&&(R=R+(V[e]||1))}),m[L].sumTot=R}),l.forEach(function(L,R){var V=m[L.clusterId],tt=0,ut,dt=x[R]/(2*E),J=0,Et=V.nodes;Et.forEach(function(Re){var pn=y[Re.id].idx;J+=b[R][pn]||0});var Bt=J-V.sumTot*dt,Vt=Et.filter(function(Re){return Re.id!==L.id});Vt.forEach(function(Re,pn){d[Re.originIndex]});var se=I0(Vt,d)*u,re=w[L.id];if(Object.keys(re).forEach(function(Re){var pn=y[Re].node,en=pn.clusterId;if(en!==L.clusterId){var fn=m[en],De=fn.nodes;if(!(!De||!De.length)){var Vn=0;De.forEach(function(ct){var Xt=y[ct.id].idx;Vn+=b[R][Xt]||0});var Wt=Vn-fn.sumTot*dt,ee=De.concat([L]);ee.forEach(function(ct,Xt){d[ct.originIndex]});var ot=I0(ee,d)*u,O=Wt-Bt;i&&(O=Wt+ot-(Bt+se)),O>tt&&(tt=O,ut=fn)}}}),tt>0){ut.nodes.push(L);var ue=L.clusterId;L.clusterId=ut.id;var de=V.nodes.indexOf(L);V.nodes.splice(de,1);var Ze=0,Ne=0;f.forEach(function(Re){var pn=Re.source,en=Re.target,fn=y[pn].node.clusterId,De=y[en].node.clusterId;(fn===ut.id&&De!==ut.id||De===ut.id&&fn!==ut.id)&&(Ze=Ze+(Re[e]||1)),(fn===ue&&De!==ue||De===ue&&fn!==ue)&&(Ne=Ne+(Re[e]||1))}),ut.sumTot=Ze,V.sumTot=Ne}})}var I={},N=0;Object.keys(A).forEach(function(L){var R=A[L];if(!R.nodes||!R.nodes.length){delete A[L];return}var V=String(N+1);V!==L&&(R.id=V,R.nodes=R.nodes.map(function(tt){return{id:tt.id,clusterId:V}}),A[V]=R,I[L]=V,delete A[L],N++)}),S.forEach(function(L){var R=L.node,V=L.clusterId;R&&(R.clusterId=V,R.clusterId&&I[R.clusterId]&&(R.clusterId=I[R.clusterId]))});var D=[],P={};f.forEach(function(L){var R=L.source,V=L.target,tt=L[e]||1,ut=y[R].node.clusterId,dt=y[V].node.clusterId;if(!(!ut||!dt)){var J="".concat(ut,"---").concat(dt);if(P[J])P[J].weight+=tt,P[J].count++;else{var Et={source:ut,target:dt,weight:tt,count:1};P[J]=Et,D.push(Et)}}});var j=[];return Object.keys(A).forEach(function(L){j.push(A[L])}),{clusters:j,clusterEdges:D}},W7=V7;Ep.default=W7;var Mp={},Sp={};Object.defineProperty(Sp,"__esModule",{value:!0});Sp.default=void 0;var X7=function(){function t(n){this.count=n.length,this.parent={};for(var e=0,r=n;e<r.length;e++){var i=r[e];this.parent[i]=i}}return t.prototype.find=function(n){for(;this.parent[n]!==n;)n=this.parent[n];return n},t.prototype.union=function(n,e){var r=this.find(n),i=this.find(e);r!==i&&(r<i?(this.parent[e]!==e&&this.union(this.parent[e],n),this.parent[e]=this.parent[n]):(this.parent[n]!==n&&this.union(this.parent[n],e),this.parent[n]=this.parent[e]))},t.prototype.connected=function(n,e){return this.find(n)===this.find(e)},t}(),H7=X7;Sp.default=H7;var _p={};Object.defineProperty(_p,"__esModule",{value:!0});_p.default=void 0;var q7=function(t,n){return t-n},Z7=function(){function t(n){n===void 0&&(n=q7),this.compareFn=n,this.list=[]}return t.prototype.getLeft=function(n){return 2*n+1},t.prototype.getRight=function(n){return 2*n+2},t.prototype.getParent=function(n){return n===0?null:Math.floor((n-1)/2)},t.prototype.isEmpty=function(){return this.list.length<=0},t.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},t.prototype.delMin=function(){var n=this.top(),e=this.list.pop();return this.list.length>0&&(this.list[0]=e,this.moveDown(0)),n},t.prototype.insert=function(n){if(n!==null){this.list.push(n);var e=this.list.length-1;return this.moveUp(e),!0}return!1},t.prototype.moveUp=function(n){for(var e=this.getParent(n);n&&n>0&&this.compareFn(this.list[e],this.list[n])>0;){var r=this.list[e];this.list[e]=this.list[n],this.list[n]=r,n=e,e=this.getParent(n)}},t.prototype.moveDown=function(n){var e,r=n,i=this.getLeft(n),o=this.getRight(n),a=this.list.length;i!==null&&i<a&&this.compareFn(this.list[r],this.list[i])>0?r=i:o!==null&&o<a&&this.compareFn(this.list[r],this.list[o])>0&&(r=o),n!==r&&(e=[this.list[r],this.list[n]],this.list[n]=e[0],this.list[r]=e[1],this.moveDown(r))},t}(),K7=Z7;_p.default=K7;Object.defineProperty(Mp,"__esModule",{value:!0});Mp.default=void 0;var Q7=KI(Sp),J7=KI(_p),T0=tr;function KI(t){return t&&t.__esModule?t:{default:t}}var $7=function(t,n){var e=[],r=t.nodes,i=r===void 0?[]:r,o=t.edges,a=o===void 0?[]:o;if(i.length===0)return e;var s=i[0],u=new Set;u.add(s);var c=function(p,g){return n?p.weight-g.weight:0},l=new J7.default(c);for((0,T0.getEdgesByNodeId)(s.id,a).forEach(function(p){l.insert(p)});!l.isEmpty();){var h=l.delMin(),f=h.source,d=h.target;u.has(f)&&u.has(d)||(e.push(h),u.has(f)||(u.add(f),(0,T0.getEdgesByNodeId)(f,a).forEach(function(p){l.insert(p)})),u.has(d)||(u.add(d),(0,T0.getEdgesByNodeId)(d,a).forEach(function(p){l.insert(p)})))}return e},Q2=function(t,n){var e=[],r=t.nodes,i=r===void 0?[]:r,o=t.edges,a=o===void 0?[]:o;if(i.length===0)return e;var s=a.map(function(f){return f});n&&s.sort(function(f,d){return f.weight-d.weight});for(var u=new Q7.default(i.map(function(f){return f.id}));s.length>0;){var c=s.shift(),l=c.source,h=c.target;u.connected(l,h)||(e.push(c),u.union(l,h))}return e},tU=function(t,n,e){var r={prim:$7,kruskal:Q2};return e?r[e](t,n):Q2(t,n)},eU=tU;Mp.default=eU;var kp={};Object.defineProperty(kp,"__esModule",{value:!0});kp.default=void 0;var nU=iU(Xo),rU=tr;function iU(t){return t&&t.__esModule?t:{default:t}}var oU=function(t,n,e){typeof n!="number"&&(n=1e-6),typeof e!="number"&&(e=.85);for(var r=1,i=0,o=1e3,a=t.nodes,s=a===void 0?[]:a,u=t.edges,c=u===void 0?[]:u,l=s.length,h,f={},d={},p=0;p<l;++p){var g=s[p],v=g.id;f[v]=1/l,d[v]=1/l}for(var m=(0,nU.default)(t);o>0&&r>n;){i=0;for(var p=0;p<l;++p){var g=s[p],v=g.id;if(h=0,m[g.id].inDegree===0)f[v]=0;else{for(var y=(0,rU.getNeighbors)(v,c,"source"),b=0;b<y.length;++b){var x=y[b],w=m[x].outDegree;w>0&&(h+=d[x]/w)}f[v]=e*h,i+=f[v]}}i=(1-i)/l,r=0;for(var p=0;p<l;++p){var g=s[p],v=g.id;h=f[v]+i,r+=Math.abs(h-d[v]),d[v]=h}o-=1}return d},aU=oU;kp.default=aU;var Ap={},Cp={},$n={};Object.defineProperty($n,"__esModule",{value:!0});$n.VACANT_NODE_LABEL=$n.VACANT_NODE_ID=$n.VACANT_GRAPH_ID=$n.VACANT_EDGE_LABEL=$n.VACANT_EDGE_ID=$n.Node=$n.Graph=$n.Edge=$n.AUTO_EDGE_ID=void 0;var QI=-1;$n.VACANT_EDGE_ID=QI;var Ml=-1;$n.VACANT_NODE_ID=Ml;var JI="-1";$n.VACANT_EDGE_LABEL=JI;var $I="-1";$n.VACANT_NODE_LABEL=$I;var sU=-1;$n.VACANT_GRAPH_ID=sU;var uU="-1";$n.AUTO_EDGE_ID=uU;var om=function(){function t(n,e,r,i){n===void 0&&(n=QI),e===void 0&&(e=Ml),r===void 0&&(r=Ml),i===void 0&&(i=JI),this.id=n,this.from=e,this.to=r,this.label=i}return t}();$n.Edge=om;var t3=function(){function t(n,e){n===void 0&&(n=Ml),e===void 0&&(e=$I),this.id=n,this.label=e,this.edges=[],this.edgeMap={}}return t.prototype.addEdge=function(n){this.edges.push(n),this.edgeMap[n.id]=n},t}();$n.Node=t3;var cU=function(){function t(n,e,r){n===void 0&&(n=Ml),e===void 0&&(e=!0),r===void 0&&(r=!1),this.id=n,this.edgeIdAutoIncrease=e,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=r}return t.prototype.getNodeNum=function(){return this.nodes.length},t.prototype.addNode=function(n,e){if(!this.nodeMap[n]){var r=new t3(n,e);this.nodes.push(r),this.nodeMap[n]=r,this.nodeLabelMap[e]||(this.nodeLabelMap[e]=[]),this.nodeLabelMap[e].push(n)}},t.prototype.addEdge=function(n,e,r,i){if((this.edgeIdAutoIncrease||n===void 0)&&(n=this.counter++),!(this.nodeMap[e]&&this.nodeMap[r]&&this.nodeMap[r].edgeMap[n])){var o=new om(n,e,r,i);if(this.edges.push(o),this.edgeMap[n]=o,this.nodeMap[e].addEdge(o),this.edgeLabelMap[i]||(this.edgeLabelMap[i]=[]),this.edgeLabelMap[i].push(o),!this.directed){var a=new om(n,r,e,i);this.nodeMap[r].addEdge(a),this.edgeLabelMap[i].push(a)}}},t}();$n.Graph=cU;Object.defineProperty(Cp,"__esModule",{value:!0});Cp.default=void 0;var lU=zl,jr=$n,us=function(){function t(n,e,r,i,o){this.fromNode=n,this.toNode=e,this.nodeEdgeNodeLabel={nodeLabel1:r||jr.VACANT_NODE_LABEL,edgeLabel:i||jr.VACANT_EDGE_LABEL,nodeLabel2:o||jr.VACANT_NODE_LABEL}}return t.prototype.equalTo=function(n){return this.fromNode===n.formNode&&this.toNode===n.toNode&&this.nodeEdgeNodeLabel===n.nodeEdgeNodeLabel},t.prototype.notEqualTo=function(n){return!this.equalTo(n)},t}(),J2=function(){function t(){this.rmpath=[],this.dfsEdgeList=[]}return t.prototype.equalTo=function(n){var e=this.dfsEdgeList.length,r=n.length;if(e!==r)return!1;for(var i=0;i<e;i++)if(this.dfsEdgeList[i]!==n[i])return!1;return!0},t.prototype.notEqualTo=function(n){return!this.equalTo(n)},t.prototype.pushBack=function(n,e,r,i,o){return this.dfsEdgeList.push(new us(n,e,r,i,o)),this.dfsEdgeList},t.prototype.toGraph=function(n,e){n===void 0&&(n=jr.VACANT_GRAPH_ID),e===void 0&&(e=!1);var r=new jr.Graph(n,!0,e);return this.dfsEdgeList.forEach(function(i){var o=i.fromNode,a=i.toNode,s=i.nodeEdgeNodeLabel,u=s.nodeLabel1,c=s.edgeLabel,l=s.nodeLabel2;u!==jr.VACANT_NODE_LABEL&&r.addNode(o,u),l!==jr.VACANT_NODE_LABEL&&r.addNode(a,l),u!==jr.VACANT_NODE_LABEL&&l!==u&&r.addEdge(void 0,o,a,c)}),r},t.prototype.buildRmpath=function(){this.rmpath=[];for(var n=void 0,e=this.dfsEdgeList.length,r=e-1;r>=0;r--){var i=this.dfsEdgeList[r],o=i.fromNode,a=i.toNode;o<a&&(n===void 0||a===n)&&(this.rmpath.push(r),n=o)}return this.rmpath},t.prototype.getNodeNum=function(){var n={};return this.dfsEdgeList.forEach(function(e){n[e.fromNode]||(n[e.fromNode]=!0),n[e.toNode]||(n[e.toNode]=!0)}),Object.keys(n).length},t}(),hf=function(){function t(n){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],!!n){for(;n;){var e=n.edge;this.edges.push(e),this.nodesUsed[e.from]=1,this.nodesUsed[e.to]=1,this.edgesUsed[e.id]=1,n=n.preNode}this.edges=this.edges.reverse()}}return t.prototype.hasNode=function(n){return this.nodesUsed[n.id]===1},t.prototype.hasEdge=function(n){return this.edgesUsed[n.id]===1},t}(),hU=function(){function t(n){var e=n.graphs,r=n.minSupport,i=r===void 0?2:r,o=n.minNodeNum,a=o===void 0?1:o,s=n.maxNodeNum,u=s===void 0?4:s,c=n.top,l=c===void 0?10:c,h=n.directed,f=h===void 0?!1:h,d=n.verbose,p=d===void 0?!1:d;this.graphs=e,this.dfsCode=new J2,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=i,this.top=l,this.directed=f,this.counter=0,this.maxNodeNum=u,this.minNodeNum=a,this.verbose=p,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return t.prototype.findForwardRootEdges=function(n,e){var r=this,i=[],o=n.nodeMap;return e.edges.forEach(function(a){(r.directed||e.label<=o[a.to].label)&&i.push(a)}),i},t.prototype.findBackwardEdge=function(n,e,r,i){if(!this.directed&&e===r)return null;for(var o=n.nodeMap,a=o[r.to],s=a.edges,u=s.length,c=0;c<u;c++){var l=s[c];if(!(i.hasEdge(l)||l.to!==e.from)){if(this.directed){if(o[e.from].label<o[r.to].label||o[e.from].label===o[r.to].label&&e.label<=l.label)return l}else if(e.label<l.label||e.label===l.label&&o[e.to].label<=o[r.to].label)return l}}return null},t.prototype.findForwardPureEdges=function(n,e,r,i){for(var o=[],a=e.to,s=n.nodeMap[a].edges,u=s.length,c=0;c<u;c++){var l=s[c],h=n.nodeMap[l.to];r<=h.label&&!i.hasNode(h)&&o.push(l)}return o},t.prototype.findForwardRmpathEdges=function(n,e,r,i){for(var o=[],a=n.nodeMap,s=a[e.to].label,u=a[e.from],c=u.edges,l=c.length,h=0;h<l;h++){var f=c[h],d=a[f.to].label;e.to===f.to||r>d||i.hasNode(a[f.to])||(e.label<f.label||e.label===f.label&&s<=d)&&o.push(f)}return o},t.prototype.getSupport=function(n){var e={};return n.forEach(function(r){e[r.graphId]||(e[r.graphId]=!0)}),Object.keys(e).length},t.prototype.findMinLabel=function(n){var e=void 0;return Object.keys(n).forEach(function(r){var i=n[r],o=i.nodeLabel1,a=i.edgeLabel,s=i.nodeLabel2;if(!e){e={nodeLabel1:o,edgeLabel:a,nodeLabel2:s};return}(o<e.nodeLabel1||o===e.nodeLabel1&&a<e.edgeLabel||o===e.nodeLabel1&&a===e.edgeLabel&&s<e.nodeLabel2)&&(e={nodeLabel1:o,edgeLabel:a,nodeLabel2:s})}),e},t.prototype.isMin=function(){var n=this,e=this.dfsCode;if(this.verbose&&console.log("isMin checking",e),e.dfsEdgeList.length===1)return!0;var r=this.directed,i=e.toGraph(jr.VACANT_GRAPH_ID,r),o=i.nodeMap,a=new J2,s={};i.nodes.forEach(function(h){var f=n.findForwardRootEdges(i,h);f.forEach(function(d){var p=o[d.to],g="".concat(h.label,"-").concat(d.label,"-").concat(p.label);s[g]||(s[g]={projected:[],nodeLabel1:h.label,edgeLabel:d.label,nodeLabel2:p.label});var v={graphId:i.id,edge:d,preNode:null};s[g].projected.push(v)})});var u=this.findMinLabel(s);if(u){a.dfsEdgeList.push(new us(0,1,u.nodeLabel1,u.edgeLabel,u.nodeLabel2));var c=function h(f){for(var d=a.buildRmpath(),p=a.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,g=a.dfsEdgeList[d[0]].toNode,v={},m=!1,y=0,b=r?-1:0,x=function(P){if(m)return"break";f.forEach(function(j){var L=new hf(j),R=n.findBackwardEdge(i,L.edges[d[P]],L.edges[d[0]],L);R&&(v[R.label]||(v[R.label]={projected:[],edgeLabel:R.label}),v[R.label].projected.push({graphId:i.id,edge:v,preNode:j}),y=a.dfsEdgeList[d[P]].fromNode,m=!0)})},w=d.length-1;w>b;w--){var E=x(w);if(E==="break")break}if(m){var M=n.findMinLabel(v);a.dfsEdgeList.push(new us(g,y,jr.VACANT_NODE_LABEL,M.edgeLabel,jr.VACANT_NODE_LABEL));var _=a.dfsEdgeList.length-1;return n.dfsCode.dfsEdgeList[_]!==a.dfsEdgeList[_]?!1:h(v[M.edgeLabel].projected)}var k={};m=!1;var S=0;f.forEach(function(P){var j=new hf(P),L=n.findForwardPureEdges(i,j.edges[d[0]],p,j);L.length>0&&(m=!0,S=g,L.forEach(function(R){var V="".concat(R.label,"-").concat(o[R.to].label);k[V]||(k[V]={projected:[],edgeLabel:R.label,nodeLabel2:o[R.to].label}),k[V].projected.push({graphId:i.id,edge:R,preNode:P})}))});for(var A=d.length,C=function(j){if(m)return"break";var L=d[j];f.forEach(function(R){var V=new hf(R),tt=n.findForwardRmpathEdges(i,V.edges[L],p,V);tt.length>0&&(m=!0,S=a.dfsEdgeList[L].fromNode,tt.forEach(function(ut){var dt="".concat(ut.label,"-").concat(o[ut.to].label);k[dt]||(k[dt]={projected:[],edgeLabel:ut.label,nodeLabel2:o[ut.to].label}),k[dt].projected.push({graphId:i.id,edge:ut,preNode:R})}))})},w=0;w<A;w++){var I=C(w);if(I==="break")break}if(!m)return!0;var N=n.findMinLabel(k);a.dfsEdgeList.push(new us(S,g+1,jr.VACANT_NODE_LABEL,N.edgeLabel,N.nodeLabel2));var D=a.dfsEdgeList.length-1;return e.dfsEdgeList[D]!==a.dfsEdgeList[D]?!1:h(k["".concat(N.edgeLabel,"-").concat(N.nodeLabel2)].projected)},l="".concat(u.nodeLabel1,"-").concat(u.edgeLabel,"-").concat(u.nodeLabel2);return c(s[l].projected)}},t.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var n=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push((0,lU.clone)(n))}},t.prototype.subGraphMining=function(n){var e=this,r=this.getSupport(n);if(!(r<this.minSupport)&&this.isMin()){this.report();var i=this.dfsCode.getNodeNum(),o=this.dfsCode.buildRmpath(),a=this.dfsCode.dfsEdgeList[o[0]].toNode,s=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,u={},c={};n.forEach(function(l){for(var h=e.graphs[l.graphId],f=h.nodeMap,d=new hf(l),p=o.length-1;p>=0;p--){var g=e.findBackwardEdge(h,d.edges[o[p]],d.edges[o[0]],d);if(g){var v="".concat(e.dfsCode.dfsEdgeList[o[p]].fromNode,"-").concat(g.label);c[v]||(c[v]={projected:[],toNodeId:e.dfsCode.dfsEdgeList[o[p]].fromNode,edgeLabel:g.label}),c[v].projected.push({graphId:l.graphId,edge:g,preNode:l})}}if(!(i>=e.maxNodeNum)){var m=e.findForwardPureEdges(h,d.edges[o[0]],s,d);m.forEach(function(b){var x="".concat(a,"-").concat(b.label,"-").concat(f[b.to].label);u[x]||(u[x]={projected:[],fromNodeId:a,edgeLabel:b.label,nodeLabel2:f[b.to].label}),u[x].projected.push({graphId:l.graphId,edge:b,preNode:l})});for(var y=function(x){var w=e.findForwardRmpathEdges(h,d.edges[o[x]],s,d);w.forEach(function(E){var M="".concat(e.dfsCode.dfsEdgeList[o[x]].fromNode,"-").concat(E.label,"-").concat(f[E.to].label);u[M]||(u[M]={projected:[],fromNodeId:e.dfsCode.dfsEdgeList[o[x]].fromNode,edgeLabel:E.label,nodeLabel2:f[E.to].label}),u[M].projected.push({graphId:l.graphId,edge:E,preNode:l})})},p=0;p<o.length;p++)y(p)}}),Object.keys(c).forEach(function(l){var h=c[l],f=h.toNodeId,d=h.edgeLabel;e.dfsCode.dfsEdgeList.push(new us(a,f,"-1",d,"-1")),e.subGraphMining(c[l].projected),e.dfsCode.dfsEdgeList.pop()}),Object.keys(u).forEach(function(l){var h=u[l],f=h.fromNodeId,d=h.edgeLabel,p=h.nodeLabel2;e.dfsCode.dfsEdgeList.push(new us(f,a+1,jr.VACANT_NODE_LABEL,d,p)),e.subGraphMining(u[l].projected),e.dfsCode.dfsEdgeList.pop()})}},t.prototype.generate1EdgeFrequentSubGraphs=function(){var n=this.graphs,e=this.directed,r=this.minSupport,i=this.frequentSize1Subgraphs,o={},a={},s={};return Object.keys(n).forEach(function(u){var c=n[u],l=c.nodeMap;c.nodes.forEach(function(h,f){var d=h.label,p="".concat(u,"-").concat(d);if(!s[p]){var g=o[d]||0;g++,o[d]=g}s[p]={graphKey:u,label:d},h.edges.forEach(function(v){var m=d,y=l[v.to].label;if(!e&&m>y){var b=y;y=m,m=b}var x=v.label,w="".concat(m,"-").concat(x,"-").concat(y);if(!a[w]){var E=a[w]||0;E++,a[w]=E}})})}),Object.keys(o).forEach(function(u){var c=o[u];if(!(c<r)){var l={nodes:[],edges:[]};l.nodes.push({id:"0",label:u}),i.push(l)}}),i},t.prototype.run=function(){var n=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var e=this.graphs;this.directed;var r={};Object.keys(e).forEach(function(i){var o=e[i],a=o.nodeMap;o.nodes.forEach(function(s){var u=n.findForwardRootEdges(o,s);u.forEach(function(c){var l=a[c.to],h="".concat(s.label,"-").concat(c.label,"-").concat(l.label);r[h]||(r[h]={projected:[],nodeLabel1:s.label,edgeLabel:c.label,nodeLabel2:l.label});var f={graphId:i,edge:c,preNode:null};r[h].projected.push(f)})})}),Object.keys(r).forEach(function(i){var o=r[i],a=o.projected,s=o.nodeLabel1,u=o.edgeLabel,c=o.nodeLabel2;n.dfsCode.dfsEdgeList.push(new us(0,1,s,u,c)),n.subGraphMining(a),n.dfsCode.dfsEdgeList.pop()})}},t}(),fU=function(t,n,e,r){var i={};return Object.keys(t).forEach(function(o,a){var s=t[o],u=new jr.Graph(a,!0,n),c={};s.nodes.forEach(function(l,h){u.addNode(h,l[e]),c[l.id]=h}),s.edges.forEach(function(l,h){var f=c[l.source],d=c[l.target];u.addEdge(-1,f,d,l[r])}),u&&u.getNodeNum()&&(i[u.id]=u)}),i},dU=function(t,n,e){var r=[];return t.forEach(function(i){var o={nodes:[],edges:[]};i.nodes.forEach(function(a){var s;o.nodes.push((s={id:"".concat(a.id)},s[n]=a.label,s))}),i.edges.forEach(function(a){var s;o.edges.push((s={source:"".concat(a.from),target:"".concat(a.to)},s[e]=a.label,s))}),r.push(o)}),r},$2="cluster",pU=function(t){var n=t.graphs,e=t.directed,r=e===void 0?!1:e,i=t.nodeLabelProp,o=i===void 0?$2:i,a=t.edgeLabelProp,s=a===void 0?$2:a,u=fU(n,r,o,s),c=t.minSupport,l=t.maxNodeNum,h=t.minNodeNum,f=t.verbose,d=t.top,p={graphs:u,minSupport:c,maxNodeNum:l,minNodeNum:h,top:d,verbose:f,directed:r},g=new hU(p);g.run();var v=dU(g.frequentSubgraphs,o,s);return v},gU=pU;Cp.default=gU;Object.defineProperty(Ap,"__esModule",{value:!0});Ap.default=void 0;var tE=YI,eE=qy(Gl),vU=qy(Cp),nE=qy($u),mU=tr;function qy(t){return t&&t.__esModule?t:{default:t}}var rE=function(t,n,e,r){e===void 0&&(e="cluster"),r===void 0&&(r=2);var i=[],o=t.nodes;return n.forEach(function(a,s){i.push(e3(o,a,s,e,r))}),i},e3=function(t,n,e,r,i){var o=[e],a=[],s={};return n.forEach(function(u,c){if(u<=i&&e!==c){o.push(c),a.push(t[c]);var l=t[c][r];s[l]?(s[l].count++,s[l].dists.push(u)):s[l]={count:1,dists:[u]}}}),Object.keys(s).forEach(function(u){s[u].dists=s[u].dists.sort(function(c,l){return c-l})}),{nodeIdx:e,nodeId:t[e].id,nodeIdxs:o,neighbors:a,neighborNum:o.length-1,nodeLabelCountMap:s}},yU=function(t,n,e,r,i){var o=Math.ceil(e/n),a={},s=0;return r.forEach(function(u,c){for(var l=0,h=0,f=u.nodeIdxs,d=u.neighborNum-1;l<o;){for(var p=f[1+Math.floor(Math.random()*d)],g=0;(a["".concat(c,"-").concat(p)]||a["".concat(p,"-").concat(c)])&&(p=Math.floor(Math.random()*n),g++,!(g>2*n)););if(g<2*n&&(a["".concat(c,"-").concat(p)]={start:c,end:p,distance:i[c][p]},l++,s++,s>=e))return a;if(h++,h>2*n)break}if(l<o){var v=o-l;o=(o+v)/(n-c-1)}}),a},Jf=function(t,n,e,r){var i=e.nodes;return r||(r={}),Object.keys(t).forEach(function(o){var a,s;if(!(r&&r[o])){r[o]={nodes:[],edges:[]};var u=t[o],c=(a=n[u.start])===null||a===void 0?void 0:a.nodeIdxs,l=(s=n[u.end])===null||s===void 0?void 0:s.nodeIdxs;if(!(!c||!l)){var h=new Set(l),f=c.filter(function(m){return h.has(m)});if(!(!f||!f.length)){for(var d={},p=f.length,g=0;g<p;g++){var v=i[f[g]];r[o].nodes.push(v),d[v.id]=!0}e.edges.forEach(function(m){d[m.source]&&d[m.target]&&r[o].edges.push(m)})}}}}),r},$f=function(t,n,e,r){var i,o,a={};t.nodes.forEach(function(u){a[u.id]=u});var s=0;return!(!((i=n==null?void 0:n.edges)===null||i===void 0)&&i.length)||((o=n==null?void 0:n.nodes)===null||o===void 0?void 0:o.length)<2?0:(t.edges.forEach(function(u){var c=a[u.source][e],l=a[u.target][e],h=n==null?void 0:n.nodes[0][e],f=n==null?void 0:n.nodes[1][e],d=n==null?void 0:n.edges[0][r];u[r]===d&&(c===h&&l===f||c===f&&l===h)&&s++}),s)},bU=function(t,n,e){for(var r=1/0,i=0,o=function(s){var u=t[s],c=Object.keys(u).sort(function(v,m){return u[v]-u[m]}),l=10,h=[];c.forEach(function(v,m){h[m%l]||(h[m%l]={graphs:[],totalCount:0,aveCount:0}),h[m%l].graphs.push(v),h[m%l].totalCount+=u[v]});var f=0,d=[];h.forEach(function(v){var m=v.totalCount/v.graphs.length;v.aveCount=m,d.push(m);var y=0,b=v.length;v.graphs.forEach(function(x,w){var E=u[x];v.graphs.forEach(function(M,_){w!==_&&(y+=Math.abs(E-u[M]))})}),y/=b*(b-1)/2,f+=y}),f/=h.length;var p=0;d.forEach(function(v,m){d.forEach(function(y,b){m!==b&&(p+=Math.abs(v-y))}),p/=d.length*(d.length-1)/2});var g=p-f;r<g&&(r=g,i=s)},a=0;a<n;a++)o(a);return{structure:e[i],structureCountMap:t[i]}},iE=function(t,n){var e={},r={};return t.forEach(function(i,o){e[i.id]={idx:o,node:i,degree:0,inDegree:0,outDegree:0};var a=i[n];r[a]||(r[a]=[]),r[a].push(i)}),{nodeMap:e,nodeLabelMap:r}},oE=function(t,n,e){var r={},i={};return t.forEach(function(o,a){r["".concat(mU.uniqueId)]={idx:a,edge:o};var s=o[n];i[s]||(i[s]=[]),i[s].push(o);var u=e[o.source];u&&(u.degree++,u.outDegree++);var c=e[o.target];c&&(c.degree++,c.inDegree++)}),{edgeMap:r,edgeLabelMap:i}},aE=function(t,n,e){var r=n.length,i={};return n.forEach(function(o,a){for(var s=e?0:a+1,u=t[a].id,c=s;c<r;c++)if(a!==c){var l=t[c].id,h=o[c];i["".concat(u,"-").concat(l)]=h,e||(i["".concat(l,"-").concat(u)]=h)}}),i},xU=function(t,n,e,r,i,o,a,s,u,c,l){var h,f="".concat(n.id,"-").concat(e.id);if(c&&c[f])return c[f];var d=l?l[f]:void 0;if(!d){var p=(h={},h[f]={start:r[n.id].idx,end:r[e.id].idx,distance:i},h);l=Jf(p,o,t,l),d=l[f]}return $f(d,a,s,u)},sE=function(t,n,e,r){var i,o,a,s=(i=t[n])===null||i===void 0?void 0:i.degree,u=(o=t[n])===null||o===void 0?void 0:o.inDegree,c=(a=t[n])===null||a===void 0?void 0:a.outDegree;return t[n]===void 0&&(s=1/0,u=1/0,c=1/0,r[n].forEach(function(l){var h=e[l.id].degree;s>h&&(s=h);var f=e[l.id].inDegree;u>f&&(u=f);var d=e[l.id].outDegree;c>d&&(c=d)}),t[n]={degree:s,inDegree:u,outDegree:c}),{minPatternNodeLabelDegree:s,minPatternNodeLabelInDegree:u,minPatternNodeLabelOutDegree:c}},wU=function(t,n,e,r,i,o,a){var s;if(e===void 0&&(e=!1),o===void 0&&(o="cluster"),a===void 0&&(a="cluster"),!(!t||!t.nodes)){var u=t.nodes.length;if(u){var c=(0,eE.default)(t,e),l=(0,eE.default)(n,e),h=aE(t.nodes,c,e),f=aE(n.nodes,l,e),d=iE(t.nodes,o),p=d.nodeMap,g=d.nodeLabelMap,v=iE(n.nodes,o),m=v.nodeMap,y=v.nodeLabelMap;oE(t.edges,a,p);var b=oE(n.edges,a,m).edgeLabelMap,x=[];l==null||l.forEach(function(Wt){x=x.concat(Wt)}),i||(i=Math.max.apply(Math,(0,tE.__spreadArray)((0,tE.__spreadArray)([],x,!1),[2],!1))),r||(r=i);var w=rE(t,c,o,r),E=rE(n,l,o,r),M=Math.min(100,u*(u-1)/2),_=yU(r,u,M,w,c),k=Jf(_,w,t),S=10,A=1,C=1,I=4,N={graphs:k,nodeLabelProp:o,edgeLabelProp:a,minSupport:A,minNodeNum:C,maxNodeNum:I,directed:e},D=(0,vU.default)(N).slice(0,S),P=D.length,j=[];D.forEach(function(Wt,ee){j[ee]={},Object.keys(k).forEach(function(ot){var O=k[ot],ct=$f(O,Wt,o,a);j[ee][ot]=ct})});var L=bU(j,P,D),R=L.structure,V=L.structureCountMap,tt=n.nodes[0],ut=[],dt=(s=n.nodes[0])===null||s===void 0?void 0:s[o],J=-1/0;n.nodes.forEach(function(Wt){var ee=Wt[o],ot=g[ee];(ot==null?void 0:ot.length)>J&&(J=ot.length,ut=ot,dt=ee,tt=Wt)});var Et={},Bt={},Vt={},se={},re={},ue={};Object.keys(y).forEach(function(Wt,ee){re[Wt]=[],e&&(ue[Wt]=[]);var ot=y[Wt],O={};ot.forEach(function(_t){var Zt=f["".concat(tt.id,"-").concat(_t.id)];if(Zt&&re[Wt].push(Zt),O["".concat(tt.id,"-").concat(_t.id)]={start:0,end:m[_t.id].idx,distance:Zt},e){var me=f["".concat(_t.id,"-").concat(tt.id)];me&&ue[Wt].push(me)}}),re[Wt]=re[Wt].sort(function(_t,Zt){return _t-Zt}),e&&(ue[Wt]=ue[Wt].sort(function(_t,Zt){return _t-Zt})),Bt=Jf(O,E,n,Bt);var ct=[];if(Object.keys(O).forEach(function(_t){if(Vt[_t]){ct.push(Vt[_t]);return}var Zt=Bt[_t];Vt[_t]=$f(Zt,R,o,a),ct.push(Vt[_t])}),ct=ct.sort(function(_t,Zt){return Zt-_t}),se["".concat(tt.id,"-").concat(Wt)]=ct,Wt!==dt)for(var Xt=(ut==null?void 0:ut.length)||0,jt=function(_t){var Zt=ut[_t],me=w[p[Zt.id].idx],Ce=me.nodeLabelCountMap[Wt],_e=y[Wt].length;if(!Ce||Ce.count<_e)return ut.splice(_t,1),"continue";for(var Qn=!1,dn=0;dn<_e;dn++)if(Ce.dists[dn]>re[Wt][dn]){Qn=!0;break}if(Qn)return ut.splice(_t,1),"continue";var He={};me.neighbors.forEach(function(hn){var bn=h["".concat(Zt.id,"-").concat(hn.id)];He["".concat(Zt.id,"-").concat(hn.id)]={start:p[Zt.id].idx,end:p[hn.id].idx,distance:bn}}),k=Jf(He,w,t,k);var un=[];Object.keys(He).forEach(function(hn){if(V[hn]){un.push(V[hn]);return}var bn=k[hn];V[hn]=$f(bn,R,o,a),un.push(V[hn])}),un=un.sort(function(hn,bn){return bn-hn});for(var yn=!1,dn=0;dn<_e;dn++)if(un[dn]<ct[dn]){yn=!0;break}if(yn)return ut.splice(_t,1),"continue"},te=Xt-1;te>=0;te--)jt(te)});var de=[];ut==null||ut.forEach(function(Wt){for(var ee=p[Wt.id].idx,ot=e3(t.nodes,c[ee],ee,o,i),O=ot.neighbors,ct=O.length,Xt=!1,jt=ct-1;jt>=0;jt--){if(O.length+1<n.nodes.length){Xt=!0;return}var te=O[jt],_t=te[o];if(!y[_t]||!y[_t].length){O.splice(jt,1);continue}if(!re[_t]||!re[_t].length){O.splice(jt,1);continue}var Zt="".concat(Wt.id,"-").concat(te.id),me=h[Zt],Ce=re[_t].length-1,_e=re[_t][Ce];if(me>_e){O.splice(jt,1);continue}if(e){var Qn="".concat(te.id,"-").concat(Wt.id),dn=h[Qn];Ce=ue[_t].length-1;var He=ue[_t][Ce];if(dn>He){O.splice(jt,1);continue}}var un=V[Zt]?V[Zt]:xU(t,Wt,te,p,me,w,R,o,a,V,k),yn="".concat(tt.id,"-").concat(_t),hn=se[yn][se[yn].length-1];if(un<hn){O.splice(jt,1);continue}var bn=sE(Et,_t,m,y),xr=bn.minPatternNodeLabelDegree;if(bn.minPatternNodeLabelInDegree,bn.minPatternNodeLabelOutDegree,p[te.id].degree<xr){O.splice(jt,1);continue}}Xt||de.push({nodes:[Wt].concat(O)})});var Ze=(0,nE.default)(n,tt.id,!1).length,Ne={};e?(Object.keys(Ze).forEach(function(Wt){var ee=m[Wt].node[o];Ne[ee]?Ne[ee].push(Ze[Wt]):Ne[ee]=[Ze[Wt]]}),Object.keys(Ne).forEach(function(Wt){Ne[Wt].sort(function(ee,ot){return ee-ot})})):Ne=re;for(var Re=de.length,pn=function(Wt){var ee=de[Wt],ot=ee.nodes[0],O={},ct={};ee.nodes.forEach(function(ke,gn){ct[ke.id]={idx:gn,node:ke,degree:0,inDegree:0,outDegree:0};var Ue=ke[o];O[Ue]?O[Ue]++:O[Ue]=1});var Xt=[],jt={};t.edges.forEach(function(ke){ct[ke.source]&&ct[ke.target]&&(Xt.push(ke),jt[ke[a]]?jt[ke[a]]++:jt[ke[a]]=1,ct[ke.source].degree++,ct[ke.target].degree++,ct[ke.source].outDegree++,ct[ke.target].inDegree++)});for(var te=Object.keys(b).length,_t=!1,Zt=0;Zt<te;Zt++){var me=Object.keys(b)[Zt];if(!jt[me]||jt[me]<b[me].length){_t=!0;break}}if(_t)return de.splice(Wt,1),"continue";var Ce=Xt.length;if(Ce<n.edges.length)return de.splice(Wt,1),"break";for(var _e=!1,Qn=function(gn){var Ue=Xt[gn],wn=Ue[a],Ke=b[wn];if(!Ke||!Ke.length)return jt[wn]--,Ke&&jt[wn]<Ke.length?(_e=!0,"break"):(Xt.splice(gn,1),ct[Ue.source].degree--,ct[Ue.target].degree--,ct[Ue.source].outDegree--,ct[Ue.target].inDegree--,"continue");var ko=ct[Ue.source].node[o],Ao=ct[Ue.target].node[o],wi=!1;if(Ke.forEach(function(Co){var Io=m[Co.source].node,Ui=m[Co.target].node;Io[o]===ko&&Ui[o]===Ao&&(wi=!0),!e&&Io[o]===Ao&&Ui[o]===ko&&(wi=!0)}),!wi)return jt[wn]--,Ke&&jt[wn]<Ke.length?(_e=!0,"break"):(Xt.splice(gn,1),ct[Ue.source].degree--,ct[Ue.target].degree--,ct[Ue.source].outDegree--,ct[Ue.target].inDegree--,"continue")},Zt=Ce-1;Zt>=0;Zt--){var dn=Qn(Zt);if(dn==="break")break}if(_e)return de.splice(Wt,1),"continue";ee.edges=Xt;var He=(0,nE.default)(ee,ee.nodes[0].id,!1).length;if(Object.keys(He).reverse().forEach(function(ke){if(!(ke===ee.nodes[0].id||_e)){if(He[ke]===1/0){var gn=ct[ke].node[o];if(O[gn]--,O[gn]<y[gn].length){_e=!0;return}var Ue=ee.nodes.indexOf(ct[ke].node);ee.nodes.splice(Ue,1),ct[ke]=void 0;return}var wn=p[ke].node[o];if(!Ne[wn]||!Ne[wn].length||He[ke]>Ne[wn][Ne[wn].length-1]){var gn=ct[ke].node[o];if(O[gn]--,O[gn]<y[gn].length){_e=!0;return}var Ue=ee.nodes.indexOf(ct[ke].node);ee.nodes.splice(Ue,1),ct[ke]=void 0}}}),_e)return de.splice(Wt,1),"continue";for(var un=!0,yn=0;un&&!_e;){un=!1;var hn=e?ct[ot.id].degree<m[tt.id].degree||ct[ot.id].inDegree<m[tt.id].inDegree||ct[ot.id].outDegree<m[tt.id].outDegree:ct[ot.id].degree<m[tt.id].degree;if(hn){_e=!0;break}if(O[ot[o]]<y[ot[o]].length){_e=!0;break}for(var bn=ee.nodes.length,xr=bn-1;xr>=0;xr--){var Wn=ee.nodes[xr],_o=ct[Wn.id].degree,ea=ct[Wn.id].inDegree,na=ct[Wn.id].outDegree,Ga=Wn[o],xi=sE(Et,Ga,m,y),jn=xi.minPatternNodeLabelDegree,Ua=xi.minPatternNodeLabelInDegree,Ya=xi.minPatternNodeLabelOutDegree,Va=e?_o<jn||ea<Ua||na<Ya:_o<jn;if(Va){if(O[Wn[o]]--,O[Wn[o]]<y[Wn[o]].length){_e=!0;break}ee.nodes.splice(xr,1),ct[Wn.id]=void 0,un=!0}}if(_e||!un&&yn!==0)break;Ce=Xt.length;for(var Ur=Ce-1;Ur>=0;Ur--){var On=Xt[Ur];if(!ct[On.source]||!ct[On.target]){Xt.splice(Ur,1);var Yr=On[a];if(jt[Yr]--,ct[On.source]&&(ct[On.source].degree--,ct[On.source].outDegree--),ct[On.target]&&(ct[On.target].degree--,ct[On.target].inDegree--),b[Yr]&&jt[Yr]<b[Yr].length){_e=!0;break}un=!0}}yn++}if(_e||_e||ee.nodes.length<n.nodes.length||Xt.length<n.edges.length)return de.splice(Wt,1),"continue"},en=Re-1;en>=0;en--){var fn=pn(en);if(fn==="break")break}for(var De=de.length,Vn=function(ee){var ot=de[ee],O={};ot.edges.forEach(function(jt){var te="".concat(jt.source,"-").concat(jt.target,"-").concat(jt.label);O[te]?O[te]++:O[te]=1});for(var ct=function(jt){var te=de[jt],_t={};te.edges.forEach(function(me){var Ce="".concat(me.source,"-").concat(me.target,"-").concat(me.label);_t[Ce]?_t[Ce]++:_t[Ce]=1});var Zt=!0;Object.keys(_t).length!==Object.keys(O).length?Zt=!1:Object.keys(O).forEach(function(me){_t[me]!==O[me]&&(Zt=!1)}),Zt&&de.splice(jt,1)},Xt=De-1;Xt>ee;Xt--)ct(Xt);De=de.length},en=0;en<=De-1;en++)Vn(en);return de}}},EU=wU;Ap.default=EU;(function(t){function n(x){"@babel/helpers - typeof";return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},n(x)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"GADDI",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"breadthFirstSearch",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"connectedComponent",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"depthFirstSearch",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"detectCycle",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"dijkstra",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"findAllPath",{enumerable:!0,get:function(){return c.findAllPath}}),Object.defineProperty(t,"findShortestPath",{enumerable:!0,get:function(){return c.findShortestPath}}),Object.defineProperty(t,"floydWarshall",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"getAdjMatrix",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"getDegree",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"getInDegree",{enumerable:!0,get:function(){return o.getInDegree}}),Object.defineProperty(t,"getNeighbors",{enumerable:!0,get:function(){return v.getNeighbors}}),Object.defineProperty(t,"getOutDegree",{enumerable:!0,get:function(){return o.getOutDegree}}),Object.defineProperty(t,"labelPropagation",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"louvain",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"minimumSpanningTree",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"pageRank",{enumerable:!0,get:function(){return p.default}});var e=b(Ds),r=b(yp),i=b(Oa),o=y(Xo),a=b(io),s=b(xp),u=b($u),c=Ru,l=b(Gl),h=b(wp),f=b(Ep),d=b(Mp),p=b(kp),g=b(Ap),v=tr;function m(x){if(typeof WeakMap!="function")return null;var w=new WeakMap,E=new WeakMap;return(m=function(M){return M?E:w})(x)}function y(x,w){if(!w&&x&&x.__esModule)return x;if(x===null||n(x)!=="object"&&typeof x!="function")return{default:x};var E=m(w);if(E&&E.has(x))return E.get(x);var M={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in x)if(k!=="default"&&Object.prototype.hasOwnProperty.call(x,k)){var S=_?Object.getOwnPropertyDescriptor(x,k):null;S&&(S.get||S.set)?Object.defineProperty(M,k,S):M[k]=x[k]}return M.default=x,E&&E.set(x,M),M}function b(x){return x&&x.__esModule?x:{default:x}}})(DI);function am(t){"@babel/helpers - typeof";return am=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},am(t)}Object.defineProperty(mp,"__esModule",{value:!0});mp.default=void 0;var O0=MU(DI),uE=Ta;function n3(t){if(typeof WeakMap!="function")return null;var n=new WeakMap,e=new WeakMap;return(n3=function(r){return r?e:n})(t)}function MU(t,n){if(!n&&t&&t.__esModule)return t;if(t===null||am(t)!=="object"&&typeof t!="function")return{default:t};var e=n3(n);if(e&&e.has(t))return e.get(t);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=t[o]}return r.default=t,e&&e.set(t,r),r}var N0=typeof self<"u"?self:{};N0.onmessage=function(t){var n=t.data,e=n._algorithmType,r=n.data;if(e){if(typeof O0[e]=="function"){var i=O0[e].apply(O0,r);N0.postMessage({_algorithmType:uE.MESSAGE.SUCCESS,data:i});return}N0.postMessage({_algorithmType:uE.MESSAGE.FAILURE})}};var SU=null;mp.default=SU;Object.defineProperty(vp,"__esModule",{value:!0});vp.default=void 0;var _U=Ta,kU=AU(mp);function AU(t){return t&&t.__esModule?t:{default:t}}var CU=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return new Promise(function(r,i){var o=new kU.default;o.postMessage({_algorithmType:t,data:n}),o.onmessage=function(a){var s=a.data,u=s.data,c=s._algorithmType;_U.MESSAGE.SUCCESS===c?r(u):i(),o.terminate()}})}},IU=CU;vp.default=IU;Object.defineProperty(Je,"__esModule",{value:!0});Je.pageRankAsync=Je.minimumSpanningTreeAsync=Je.louvainAsync=Je.labelPropagationAsync=Je.getOutDegreeAsync=Je.getNeighborsAsync=Je.getInDegreeAsync=Je.getDegreeAsync=Je.getAdjMatrixAsync=Je.floydWarshallAsync=Je.findShortestPathAsync=Je.findAllPathAsync=Je.dijkstraAsync=Je.detectCycleAsync=Je.detectAllUndirectedCycleAsync=Je.detectAllDirectedCycleAsync=Je.detectAllCyclesAsync=Je.connectedComponentAsync=Je.GADDIAsync=void 0;var sr=TU(vp),ur=Ta;function TU(t){return t&&t.__esModule?t:{default:t}}var OU=function(t,n){return(0,sr.default)(ur.ALGORITHM.getAdjMatrix).apply(void 0,[t,n])};Je.getAdjMatrixAsync=OU;var NU=function(t,n){return(0,sr.default)(ur.ALGORITHM.connectedComponent).apply(void 0,[t,n])};Je.connectedComponentAsync=NU;var DU=function(t){return(0,sr.default)(ur.ALGORITHM.getDegree)(t)};Je.getDegreeAsync=DU;var PU=function(t,n){return(0,sr.default)(ur.ALGORITHM.getInDegree)(t,n)};Je.getInDegreeAsync=PU;var LU=function(t,n){return(0,sr.default)(ur.ALGORITHM.getOutDegree)(t,n)};Je.getOutDegreeAsync=LU;var jU=function(t){return(0,sr.default)(ur.ALGORITHM.detectCycle)(t)};Je.detectCycleAsync=jU;var RU=function(t){return(0,sr.default)(ur.ALGORITHM.detectAllCycles)(t)};Je.detectAllCyclesAsync=RU;var FU=function(t){return(0,sr.default)(ur.ALGORITHM.detectAllDirectedCycle)(t)};Je.detectAllDirectedCycleAsync=FU;var BU=function(t){return(0,sr.default)(ur.ALGORITHM.detectAllUndirectedCycle)(t)};Je.detectAllUndirectedCycleAsync=BU;var zU=function(t,n,e,r){return(0,sr.default)(ur.ALGORITHM.dijkstra).apply(void 0,[t,n,e,r])};Je.dijkstraAsync=zU;var GU=function(t,n,e,r){return(0,sr.default)(ur.ALGORITHM.findAllPath).apply(void 0,[t,n,e,r])};Je.findAllPathAsync=GU;var UU=function(t,n,e,r,i){return(0,sr.default)(ur.ALGORITHM.findShortestPath).apply(void 0,[t,n,e,r,i])};Je.findShortestPathAsync=UU;var YU=function(t,n){return(0,sr.default)(ur.ALGORITHM.floydWarshall).apply(void 0,[t,n])};Je.floydWarshallAsync=YU;var VU=function(t,n,e,r){return r===void 0&&(r=1e3),(0,sr.default)(ur.ALGORITHM.labelPropagation)(t,n,e,r)};Je.labelPropagationAsync=VU;var WU=function(t,n,e,r){return(0,sr.default)(ur.ALGORITHM.louvain)(t,n,e,r)};Je.louvainAsync=WU;var XU=function(t,n,e){return(0,sr.default)(ur.ALGORITHM.minimumSpanningTree).apply(void 0,[t,n,e])};Je.minimumSpanningTreeAsync=XU;var HU=function(t,n,e){return(0,sr.default)(ur.ALGORITHM.pageRank).apply(void 0,[t,n,e])};Je.pageRankAsync=HU;var qU=function(t,n,e){return(0,sr.default)(ur.ALGORITHM.getNeighbors).apply(void 0,[t,n,e])};Je.getNeighborsAsync=qU;var ZU=function(t,n,e,r,i,o,a){return e===void 0&&(e=!1),o===void 0&&(o="cluster"),a===void 0&&(a="cluster"),(0,sr.default)(ur.ALGORITHM.GADDI).apply(void 0,[t,n,e,r,i,o,a])};Je.GADDIAsync=ZU;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"GADDIAsync",{enumerable:!0,get:function(){return n.GADDIAsync}}),Object.defineProperty(t,"connectedComponentAsync",{enumerable:!0,get:function(){return n.connectedComponentAsync}}),t.default=void 0,Object.defineProperty(t,"detectAllCyclesAsync",{enumerable:!0,get:function(){return n.detectAllCyclesAsync}}),Object.defineProperty(t,"detectAllDirectedCycleAsync",{enumerable:!0,get:function(){return n.detectAllDirectedCycleAsync}}),Object.defineProperty(t,"detectAllUndirectedCycleAsync",{enumerable:!0,get:function(){return n.detectAllUndirectedCycleAsync}}),Object.defineProperty(t,"detectCycleAsync",{enumerable:!0,get:function(){return n.detectCycleAsync}}),t.detectDirectedCycleAsync=void 0,Object.defineProperty(t,"dijkstraAsync",{enumerable:!0,get:function(){return n.dijkstraAsync}}),Object.defineProperty(t,"findAllPathAsync",{enumerable:!0,get:function(){return n.findAllPathAsync}}),Object.defineProperty(t,"findShortestPathAsync",{enumerable:!0,get:function(){return n.findShortestPathAsync}}),Object.defineProperty(t,"floydWarshallAsync",{enumerable:!0,get:function(){return n.floydWarshallAsync}}),Object.defineProperty(t,"getAdjMatrixAsync",{enumerable:!0,get:function(){return n.getAdjMatrixAsync}}),Object.defineProperty(t,"getDegreeAsync",{enumerable:!0,get:function(){return n.getDegreeAsync}}),Object.defineProperty(t,"getInDegreeAsync",{enumerable:!0,get:function(){return n.getInDegreeAsync}}),Object.defineProperty(t,"getNeighborsAsync",{enumerable:!0,get:function(){return n.getNeighborsAsync}}),Object.defineProperty(t,"getOutDegreeAsync",{enumerable:!0,get:function(){return n.getOutDegreeAsync}}),Object.defineProperty(t,"labelPropagationAsync",{enumerable:!0,get:function(){return n.labelPropagationAsync}}),Object.defineProperty(t,"louvainAsync",{enumerable:!0,get:function(){return n.louvainAsync}}),Object.defineProperty(t,"minimumSpanningTreeAsync",{enumerable:!0,get:function(){return n.minimumSpanningTreeAsync}}),Object.defineProperty(t,"pageRankAsync",{enumerable:!0,get:function(){return n.pageRankAsync}});var n=Je,e=n.detectCycleAsync;t.detectDirectedCycleAsync=e;var r={getAdjMatrixAsync:n.getAdjMatrixAsync,connectedComponentAsync:n.connectedComponentAsync,getDegreeAsync:n.getDegreeAsync,getInDegreeAsync:n.getInDegreeAsync,getOutDegreeAsync:n.getOutDegreeAsync,detectCycleAsync:n.detectCycleAsync,detectDirectedCycleAsync:e,detectAllCyclesAsync:n.detectAllCyclesAsync,detectAllDirectedCycleAsync:n.detectAllDirectedCycleAsync,detectAllUndirectedCycleAsync:n.detectAllUndirectedCycleAsync,dijkstraAsync:n.dijkstraAsync,findAllPathAsync:n.findAllPathAsync,findShortestPathAsync:n.findShortestPathAsync,floydWarshallAsync:n.floydWarshallAsync,labelPropagationAsync:n.labelPropagationAsync,louvainAsync:n.louvainAsync,minimumSpanningTreeAsync:n.minimumSpanningTreeAsync,pageRankAsync:n.pageRankAsync,getNeighborsAsync:n.getNeighborsAsync,GADDIAsync:n.GADDIAsync};t.default=r})(Wy);const KU=bo(Wy),QU=WP({__proto__:null,default:KU},[Wy]);function JU(){return window?window.devicePixelRatio:1}function r3(t,n,e,r){var i=t-e,o=n-r;return Math.sqrt(i*i+o*o)}function gs(t,n,e,r,i,o){return i>=t&&i<=t+e&&o>=n&&o<=n+r}function Sl(t,n){return!(n.minX>t.maxX||n.maxX<t.minX||n.minY>t.maxY||n.maxY<t.minY)}function $U(t,n){return!t||!n?t||n:{minX:Math.min(t.minX,n.minX),minY:Math.min(t.minY,n.minY),maxX:Math.max(t.maxX,n.maxX),maxY:Math.max(t.maxY,n.maxY)}}function cE(t,n){return t[0]===n[0]&&t[1]===n[1]}var tY=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,eY=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,nY=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,i3=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function o3(t,n){var e=t.match(i3);mt(e,function(r){var i=r.split(":");n.addColorStop(i[0],i[1])})}function rY(t,n,e){var r=tY.exec(e),i=parseFloat(r[1])%360*(Math.PI/180),o=r[2],a=n.getBBox(),s,u;i>=0&&i<1/2*Math.PI?(s={x:a.minX,y:a.minY},u={x:a.maxX,y:a.maxY}):1/2*Math.PI<=i&&i<Math.PI?(s={x:a.maxX,y:a.minY},u={x:a.minX,y:a.maxY}):Math.PI<=i&&i<3/2*Math.PI?(s={x:a.maxX,y:a.maxY},u={x:a.minX,y:a.minY}):(s={x:a.minX,y:a.maxY},u={x:a.maxX,y:a.minY});var c=Math.tan(i),l=c*c,h=(u.x-s.x+c*(u.y-s.y))/(l+1)+s.x,f=c*(u.x-s.x+c*(u.y-s.y))/(l+1)+s.y,d=t.createLinearGradient(s.x,s.y,h,f);return o3(o,d),d}function iY(t,n,e){var r=eY.exec(e),i=parseFloat(r[1]),o=parseFloat(r[2]),a=parseFloat(r[3]),s=r[4];if(a===0){var u=s.match(i3);return u[u.length-1].split(":")[1]}var c=n.getBBox(),l=c.maxX-c.minX,h=c.maxY-c.minY,f=Math.sqrt(l*l+h*h)/2,d=t.createRadialGradient(c.minX+l*i,c.minY+h*o,0,c.minX+l/2,c.minY+h/2,a*f);return o3(s,d),d}function oY(t,n,e){if(n.get("patternSource")&&n.get("patternSource")===e)return n.get("pattern");var r,i,o=nY.exec(e),a=o[1],s=o[2];function u(){r=t.createPattern(i,a),n.set("pattern",r),n.set("patternSource",e)}switch(a){case"a":a="repeat";break;case"x":a="repeat-x";break;case"y":a="repeat-y";break;case"n":a="no-repeat";break;default:a="no-repeat"}return i=new Image,s.match(/^data:/i)||(i.crossOrigin="Anonymous"),i.src=s,i.complete?u():(i.onload=u,i.src=i.src),r}function aY(t,n,e){var r=n.getBBox();if(isNaN(r.x)||isNaN(r.y)||isNaN(r.width)||isNaN(r.height))return e;if(Dt(e)){if(e[1]==="("||e[2]==="("){if(e[0]==="l")return rY(t,n,e);if(e[0]==="r")return iY(t,n,e);if(e[0]==="p")return oY(t,n,e)}return e}if(e instanceof CanvasPattern)return e}function sY(t){var n=0,e=0,r=0,i=0;return ve(t)?t.length===1?n=e=r=i=t[0]:t.length===2?(n=r=t[0],e=i=t[1]):t.length===3?(n=t[0],e=i=t[1],r=t[2]):(n=t[0],e=t[1],r=t[2],i=t[3]):n=e=r=i=t,[n,e,r,i]}function ff(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function sm(t,n){return ff(t)*ff(n)?(t[0]*n[0]+t[1]*n[1])/(ff(t)*ff(n)):1}function lE(t,n){return(t[0]*n[1]<t[1]*n[0]?-1:1)*Math.acos(sm(t,n))}function hE(t,n){var e=n[1],r=n[2],i=up(cp(n[3]),Math.PI*2),o=n[4],a=n[5],s=t[0],u=t[1],c=n[6],l=n[7],h=Math.cos(i)*(s-c)/2+Math.sin(i)*(u-l)/2,f=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(u-l)/2,d=h*h/(e*e)+f*f/(r*r);d>1&&(e*=Math.sqrt(d),r*=Math.sqrt(d));var p=e*e*(f*f)+r*r*(h*h),g=p?Math.sqrt((e*e*(r*r)-p)/p):1;o===a&&(g*=-1),isNaN(g)&&(g=0);var v=r?g*e*f/r:0,m=e?g*-r*h/e:0,y=(s+c)/2+Math.cos(i)*v-Math.sin(i)*m,b=(u+l)/2+Math.sin(i)*v+Math.cos(i)*m,x=[(h-v)/e,(f-m)/r],w=[(-1*h-v)/e,(-1*f-m)/r],E=lE([1,0],x),M=lE(x,w);return sm(x,w)<=-1&&(M=Math.PI),sm(x,w)>=1&&(M=0),a===0&&M>0&&(M=M-2*Math.PI),a===1&&M<0&&(M=M+2*Math.PI),{cx:y,cy:b,rx:cE(t,[c,l])?0:e,ry:cE(t,[c,l])?0:r,startAngle:E,endAngle:E+M,xRotation:i,arcFlag:o,sweepFlag:a}}var Td=Math.sin,Od=Math.cos,Zy=Math.atan2,df=Math.PI;function a3(t,n,e,r,i,o,a){var s=n.stroke,u=n.lineWidth,c=e-i,l=r-o,h=Zy(l,c),f=new $y({type:"path",canvas:t.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*Od(df/6)+","+10*Td(df/6)+" L0,0 L"+10*Od(df/6)+",-"+10*Td(df/6),stroke:s,lineWidth:u}});f.translate(i,o),f.rotateAtPoint(i,o,h),t.set(a?"startArrowShape":"endArrowShape",f)}function s3(t,n,e,r,i,o,a){var s=n.startArrow,u=n.endArrow,c=n.stroke,l=n.lineWidth,h=a?s:u,f=h.d,d=h.fill,p=h.stroke,g=h.lineWidth,v=or(h,["d","fill","stroke","lineWidth"]),m=e-i,y=r-o,b=Zy(y,m);f&&(i=i-Od(b)*f,o=o-Td(b)*f);var x=new $y({type:"path",canvas:t.get("canvas"),isArrowShape:!0,attrs:B(B({},v),{stroke:p||c,lineWidth:g||l,fill:d})});x.translate(i,o),x.rotateAtPoint(i,o,b),t.set(a?"startArrowShape":"endArrowShape",x)}function ys(t,n,e,r,i){var o=Zy(r-n,e-t);return{dx:Od(o)*i,dy:Td(o)*i}}function Ky(t,n,e,r,i,o){typeof n.startArrow=="object"?s3(t,n,e,r,i,o,!0):n.startArrow?a3(t,n,e,r,i,o,!0):t.set("startArrowShape",null)}function Qy(t,n,e,r,i,o){typeof n.endArrow=="object"?s3(t,n,e,r,i,o,!1):n.endArrow?a3(t,n,e,r,i,o,!1):t.set("startArrowShape",null)}var fE={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function Bu(t,n){var e=n.attr();for(var r in e){var i=e[r],o=fE[r]?fE[r]:r;o==="matrix"&&i?t.transform(i[0],i[1],i[3],i[4],i[6],i[7]):o==="lineDash"&&t.setLineDash?ve(i)&&t.setLineDash(i):(o==="strokeStyle"||o==="fillStyle"?i=aY(t,n,i):o==="globalAlpha"&&(i=i*t.globalAlpha),t[o]=i)}}function um(t,n,e){for(var r=0;r<n.length;r++){var i=n[r];i.cfg.visible?i.draw(t,e):i.skipDraw()}}function uY(t,n,e){var r=t.get("refreshElements");mt(r,function(i){if(i!==t)for(var o=i.cfg.parent;o&&o!==t&&!o.cfg.refresh;)o.cfg.refresh=!0,o=o.cfg.parent}),r[0]===t?Jy(n):cm(n,e)}function cm(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.cfg.visible)if(r.cfg.hasChanged)r.cfg.refresh=!0,r.isGroup()&&Jy(r.cfg.children);else if(r.cfg.refresh)r.isGroup()&&cm(r.cfg.children,n);else{var i=cY(r,n);r.cfg.refresh=i,i&&r.isGroup()&&cm(r.cfg.children,n)}}}function u3(t){for(var n=0;n<t.length;n++){var e=t[n];e.cfg.hasChanged=!1,e.isGroup()&&!e.destroyed&&u3(e.cfg.children)}}function Jy(t,n){for(var e=0;e<t.length;e++){var r=t[e];r.cfg.visible&&(r.cfg.refresh=!0,r.isGroup()&&Jy(r.get("children")))}}function cY(t,n){var e=t.cfg.cacheCanvasBBox,r=t.cfg.isInView&&e&&Sl(e,n);return r}function c3(t,n,e,r){var i=e.path,o=e.startArrow,a=e.endArrow;if(i){var s=[0,0],u=[0,0],c={dx:0,dy:0};n.beginPath();for(var l=0;l<i.length;l++){var h=i[l],f=h[0];if(l===0&&o&&o.d){var d=t.getStartTangent();c=ys(d[0][0],d[0][1],d[1][0],d[1][1],o.d)}else if(l===i.length-2&&i[l+1][0]==="Z"&&a&&a.d){var p=i[l+1];if(p[0]==="Z"){var d=t.getEndTangent();c=ys(d[0][0],d[0][1],d[1][0],d[1][1],a.d)}}else if(l===i.length-1&&a&&a.d&&i[0]!=="Z"){var d=t.getEndTangent();c=ys(d[0][0],d[0][1],d[1][0],d[1][1],a.d)}var g=c.dx,v=c.dy;switch(f){case"M":n.moveTo(h[1]-g,h[2]-v),u=[h[1],h[2]];break;case"L":n.lineTo(h[1]-g,h[2]-v);break;case"Q":n.quadraticCurveTo(h[1],h[2],h[3]-g,h[4]-v);break;case"C":n.bezierCurveTo(h[1],h[2],h[3],h[4],h[5]-g,h[6]-v);break;case"A":{var m=void 0;r?(m=r[l],m||(m=hE(s,h),r[l]=m)):m=hE(s,h);var y=m.cx,b=m.cy,x=m.rx,w=m.ry,E=m.startAngle,M=m.endAngle,_=m.xRotation,k=m.sweepFlag;if(n.ellipse)n.ellipse(y,b,x,w,_,E,M,1-k);else{var S=x>w?x:w,A=x>w?1:x/w,C=x>w?w/x:1;n.translate(y,b),n.rotate(_),n.scale(A,C),n.arc(0,0,S,E,M,1-k),n.scale(1/A,1/C),n.rotate(-_),n.translate(-y,-b)}break}case"Z":n.closePath();break}if(f==="Z")s=u;else{var I=h.length;s=[h[I-2],h[I-1]]}}}}function l3(t,n){var e=t.get("canvas");e&&(n==="remove"&&(t._cacheCanvasBBox=t.get("cacheCanvasBBox")),t.get("hasChanged")||(t.set("hasChanged",!0),t.cfg.parent&&t.cfg.parent.get("hasChanged")||(e.refreshElement(t,n,e),e.get("autoDraw")&&e.draw())))}function lY(t){var n;if(t.destroyed)n=t._cacheCanvasBBox;else{var e=t.get("cacheCanvasBBox"),r=e&&!!(e.width&&e.height),i=t.getCanvasBBox(),o=i&&!!(i.width&&i.height);r&&o?n=$U(e,i):r?n=e:o&&(n=i)}return n}function hY(t){if(!t.length)return null;var n=[],e=[],r=[],i=[];return mt(t,function(o){var a=lY(o);a&&(n.push(a.minX),e.push(a.minY),r.push(a.maxX),i.push(a.maxY))}),{minX:go(n),minY:go(e),maxX:po(r),maxY:po(i)}}function fY(t,n){return!t||!n||!Sl(t,n)?null:{minX:Math.max(t.minX,n.minX),minY:Math.max(t.minY,n.minY),maxX:Math.min(t.maxX,n.maxX),maxY:Math.min(t.maxY,n.maxY)}}var h3=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.onCanvasChange=function(e){l3(this,e)},n.prototype.getShapeBase=function(){return ry},n.prototype.getGroupBase=function(){return n},n.prototype._applyClip=function(e,r){r&&(e.save(),Bu(e,r),r.createPath(e),e.restore(),e.clip(),r._afterDraw())},n.prototype.cacheCanvasBBox=function(){var e=this.cfg.children,r=[],i=[];mt(e,function(f){var d=f.cfg.cacheCanvasBBox;d&&f.cfg.isInView&&(r.push(d.minX,d.maxX),i.push(d.minY,d.maxY))});var o=null;if(r.length){var a=go(r),s=po(r),u=go(i),c=po(i);o={minX:a,minY:u,x:a,y:u,maxX:s,maxY:c,width:s-a,height:c-u};var l=this.cfg.canvas;if(l){var h=l.getViewRange();this.set("isInView",Sl(o,h))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",o)},n.prototype.draw=function(e,r){var i=this.cfg.children,o=r?this.cfg.refresh:!0;i.length&&o&&(e.save(),Bu(e,this),this._applyClip(e,this.getClip()),um(e,i,r),e.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},n.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},n}(eI),Ri=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},n.prototype.getShapeBase=function(){return ry},n.prototype.getGroupBase=function(){return h3},n.prototype.onCanvasChange=function(e){l3(this,e)},n.prototype.calculateBBox=function(){var e=this.get("type"),r=this.getHitLineWidth(),i=iI(e),o=i(this),a=r/2,s=o.x-a,u=o.y-a,c=o.x+o.width+a,l=o.y+o.height+a;return{x:s,minX:s,y:u,minY:u,width:o.width+r,height:o.height+r,maxX:c,maxY:l}},n.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},n.prototype.isStroke=function(){return!!this.attrs.stroke},n.prototype._applyClip=function(e,r){r&&(e.save(),Bu(e,r),r.createPath(e),e.restore(),e.clip(),r._afterDraw())},n.prototype.draw=function(e,r){var i=this.cfg.clipShape;if(r){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var o=this.getCanvasBBox();if(!Sl(r,o)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}e.save(),Bu(e,this),this._applyClip(e,i),this.drawPath(e),e.restore(),this._afterDraw()},n.prototype.getCanvasViewBox=function(){var e=this.cfg.canvas;return e?e.getViewRange():null},n.prototype.cacheCanvasBBox=function(){var e=this.getCanvasViewBox();if(e){var r=this.getCanvasBBox(),i=Sl(r,e);this.set("isInView",i),i?this.set("cacheCanvasBBox",r):this.set("cacheCanvasBBox",null)}},n.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},n.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},n.prototype.drawPath=function(e){this.createPath(e),this.strokeAndFill(e),this.afterDrawPath(e)},n.prototype.fill=function(e){e.fill()},n.prototype.stroke=function(e){e.stroke()},n.prototype.strokeAndFill=function(e){var r=this.attrs,i=r.lineWidth,o=r.opacity,a=r.strokeOpacity,s=r.fillOpacity;this.isFill()&&(!fe(s)&&s!==1?(e.globalAlpha=s,this.fill(e),e.globalAlpha=o):this.fill(e)),this.isStroke()&&i>0&&(!fe(a)&&a!==1&&(e.globalAlpha=a),this.stroke(e)),this.afterDrawPath(e)},n.prototype.createPath=function(e){},n.prototype.afterDrawPath=function(e){},n.prototype.isInShape=function(e,r){var i=this.isStroke(),o=this.isFill(),a=this.getHitLineWidth();return this.isInStrokeOrPath(e,r,i,o,a)},n.prototype.isInStrokeOrPath=function(e,r,i,o,a){return!1},n.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var e=this.attrs;return e.lineWidth+e.lineAppendWidth},n}(nI),dY=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,r:0})},n.prototype.isInStrokeOrPath=function(e,r,i,o,a){var s=this.attr(),u=s.x,c=s.y,l=s.r,h=a/2,f=r3(u,c,e,r);return o&&i?f<=l+h:o?f<=l:i?f>=l-h&&f<=l+h:!1},n.prototype.createPath=function(e){var r=this.attr(),i=r.x,o=r.y,a=r.r;e.beginPath(),e.arc(i,o,a,0,Math.PI*2,!1),e.closePath()},n}(Ri);function pf(t,n,e,r){return t/(e*e)+n/(r*r)}var pY=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,rx:0,ry:0})},n.prototype.isInStrokeOrPath=function(e,r,i,o,a){var s=this.attr(),u=a/2,c=s.x,l=s.y,h=s.rx,f=s.ry,d=(e-c)*(e-c),p=(r-l)*(r-l);return o&&i?pf(d,p,h+u,f+u)<=1:o?pf(d,p,h,f)<=1:i?pf(d,p,h-u,f-u)>=1&&pf(d,p,h+u,f+u)<=1:!1},n.prototype.createPath=function(e){var r=this.attr(),i=r.x,o=r.y,a=r.rx,s=r.ry;if(e.beginPath(),e.ellipse)e.ellipse(i,o,a,s,0,0,Math.PI*2,!1);else{var u=a>s?a:s,c=a>s?1:a/s,l=a>s?s/a:1;e.save(),e.translate(i,o),e.scale(c,l),e.arc(0,0,u,0,Math.PI*2),e.restore(),e.closePath()}},n}(Ri);function dE(t){return t instanceof HTMLElement&&Dt(t.nodeName)&&t.nodeName.toUpperCase()==="CANVAS"}var gY=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,width:0,height:0})},n.prototype.initAttrs=function(e){this._setImage(e.img)},n.prototype.isStroke=function(){return!1},n.prototype.isOnlyHitBox=function(){return!0},n.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var e=this.get("canvas");e?e.draw():this.createPath(this.get("context"))}},n.prototype._setImage=function(e){var r=this,i=this.attrs;if(Dt(e)){var o=new Image;o.onload=function(){if(r.destroyed)return!1;r.attr("img",o),r.set("loading",!1),r._afterLoading();var a=r.get("callback");a&&a.call(r)},o.crossOrigin="Anonymous",o.src=e,this.set("loading",!0)}else e instanceof Image?(i.width||(i.width=e.width),i.height||(i.height=e.height)):dE(e)&&(i.width||(i.width=Number(e.getAttribute("width"))),i.height||(i.height,Number(e.getAttribute("height"))))},n.prototype.onAttrChange=function(e,r,i){t.prototype.onAttrChange.call(this,e,r,i),e==="img"&&this._setImage(r)},n.prototype.createPath=function(e){if(this.get("loading")){this.set("toDraw",!0),this.set("context",e);return}var r=this.attr(),i=r.x,o=r.y,a=r.width,s=r.height,u=r.sx,c=r.sy,l=r.swidth,h=r.sheight,f=r.img;(f instanceof Image||dE(f))&&(!fe(u)&&!fe(c)&&!fe(l)&&!fe(h)?e.drawImage(f,u,c,l,h,i,o,a,s):e.drawImage(f,i,o,a,s))},n}(Ri);function xa(t,n,e,r,i,o,a){var s=Math.min(t,e),u=Math.max(t,e),c=Math.min(n,r),l=Math.max(n,r),h=i/2;return o>=s-h&&o<=u+h&&a>=c-h&&a<=l+h?mr.pointToLine(t,n,e,r,o,a)<=i/2:!1}var vY=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},n.prototype.initAttrs=function(e){this.setArrow()},n.prototype.onAttrChange=function(e,r,i){t.prototype.onAttrChange.call(this,e,r,i),this.setArrow()},n.prototype.setArrow=function(){var e=this.attr(),r=e.x1,i=e.y1,o=e.x2,a=e.y2,s=e.startArrow,u=e.endArrow;s&&Ky(this,e,o,a,r,i),u&&Qy(this,e,r,i,o,a)},n.prototype.isInStrokeOrPath=function(e,r,i,o,a){if(!i||!a)return!1;var s=this.attr(),u=s.x1,c=s.y1,l=s.x2,h=s.y2;return xa(u,c,l,h,a,e,r)},n.prototype.createPath=function(e){var r=this.attr(),i=r.x1,o=r.y1,a=r.x2,s=r.y2,u=r.startArrow,c=r.endArrow,l={dx:0,dy:0},h={dx:0,dy:0};u&&u.d&&(l=ys(i,o,a,s,r.startArrow.d)),c&&c.d&&(h=ys(i,o,a,s,r.endArrow.d)),e.beginPath(),e.moveTo(i+l.dx,o+l.dy),e.lineTo(a-h.dx,s-h.dy)},n.prototype.afterDrawPath=function(e){var r=this.get("startArrowShape"),i=this.get("endArrowShape");r&&r.draw(e),i&&i.draw(e)},n.prototype.getTotalLength=function(){var e=this.attr(),r=e.x1,i=e.y1,o=e.x2,a=e.y2;return mr.length(r,i,o,a)},n.prototype.getPoint=function(e){var r=this.attr(),i=r.x1,o=r.y1,a=r.x2,s=r.y2;return mr.pointAt(i,o,a,s,e)},n}(Ri),mY={circle:function(t,n,e){return[["M",t-e,n],["A",e,e,0,1,0,t+e,n],["A",e,e,0,1,0,t-e,n]]},square:function(t,n,e){return[["M",t-e,n-e],["L",t+e,n-e],["L",t+e,n+e],["L",t-e,n+e],["Z"]]},diamond:function(t,n,e){return[["M",t-e,n],["L",t,n-e],["L",t+e,n],["L",t,n+e],["Z"]]},triangle:function(t,n,e){var r=e*Math.sin(.3333333333333333*Math.PI);return[["M",t-e,n+r],["L",t,n-r],["L",t+e,n+r],["Z"]]},"triangle-down":function(t,n,e){var r=e*Math.sin(.3333333333333333*Math.PI);return[["M",t-e,n-r],["L",t+e,n-r],["L",t,n+r],["Z"]]}},yY=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.initAttrs=function(e){this._resetParamsCache()},n.prototype._resetParamsCache=function(){this.set("paramsCache",{})},n.prototype.onAttrChange=function(e,r,i){t.prototype.onAttrChange.call(this,e,r,i),["symbol","x","y","r","radius"].indexOf(e)!==-1&&this._resetParamsCache()},n.prototype.isOnlyHitBox=function(){return!0},n.prototype._getR=function(e){return fe(e.r)?e.radius:e.r},n.prototype._getPath=function(){var e=this.attr(),r=e.x,i=e.y,o=e.symbol||"circle",a=this._getR(e),s,u;if(An(o))s=o,u=s(r,i,a),u=mI(u);else{if(s=n.Symbols[o],!s)return console.warn(o+" marker is not supported."),null;u=s(r,i,a)}return u},n.prototype.createPath=function(e){var r=this._getPath(),i=this.get("paramsCache");c3(this,e,{path:r},i)},n.Symbols=mY,n}(Ri);function f3(t,n,e){var r=dI();return t.createPath(r),r.isPointInPath(n,e)}var bY=1e-6;function D0(t){return Math.abs(t)<bY?0:t<0?-1:1}function xY(t,n,e){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])&&Math.min(t[0],n[0])<=e[0]&&e[0]<=Math.max(t[0],n[0])&&Math.min(t[1],n[1])<=e[1]&&e[1]<=Math.max(t[1],n[1])}function d3(t,n,e){var r=!1,i=t.length;if(i<=2)return!1;for(var o=0;o<i;o++){var a=t[o],s=t[(o+1)%i];if(xY(a,s,[n,e]))return!0;D0(a[1]-e)>0!=D0(s[1]-e)>0&&D0(n-(e-a[1])*(a[0]-s[0])/(a[1]-s[1])-a[0])<0&&(r=!r)}return r}function Yc(t,n,e,r,i,o,a,s){var u=(Math.atan2(s-n,a-t)+Math.PI*2)%(Math.PI*2);if(u<r||u>i)return!1;var c={x:t+e*Math.cos(u),y:n+e*Math.sin(u)};return r3(c.x,c.y,a,s)<=o/2}var wY=yi;function EY(t){for(var n=!1,e=t.length,r=0;r<e;r++){var i=t[r],o=i[0];if(o==="C"||o==="A"||o==="Q"){n=!0;break}}return n}function MY(t,n,e,r,i){for(var o=!1,a=n/2,s=0;s<t.length;s++){var u=t[s],c=u.currentPoint,l=u.params,h=u.prePoint,f=u.box;if(!(f&&!gs(f.x-a,f.y-a,f.width+n,f.height+n,e,r))){switch(u.command){case"L":case"Z":o=xa(h[0],h[1],c[0],c[1],n,e,r);break;case"Q":var d=cI.pointDistance(h[0],h[1],l[1],l[2],l[3],l[4],e,r);o=d<=n/2;break;case"C":var p=Qc.pointDistance(h[0],h[1],l[1],l[2],l[3],l[4],l[5],l[6],e,r,i);o=p<=n/2;break;case"A":var g=u.arcParams,v=g.cx,m=g.cy,y=g.rx,b=g.ry,x=g.startAngle,w=g.endAngle,E=g.xRotation,M=[e,r,1],_=y>b?y:b,k=y>b?1:y/b,S=y>b?b/y:1,A=wY(null,[["t",-v,-m],["r",-E],["s",1/k,1/S]]);hp(M,M,A),o=Yc(0,0,_,x,w,n,M[0],M[1]);break}if(o)break}}return o}function SY(t){for(var n=t.length,e=[],r=[],i=[],o=0;o<n;o++){var a=t[o],s=a[0];s==="M"?(i.length&&(r.push(i),i=[]),i.push([a[1],a[2]])):s==="Z"?i.length&&(e.push(i),i=[]):i.push([a[1],a[2]])}return i.length>0&&r.push(i),{polygons:e,polylines:r}}const gf=B({hasArc:EY,extractPolygons:SY,isPointInStroke:MY},Sz);function pE(t,n,e){for(var r=!1,i=0;i<t.length;i++){var o=t[i];if(r=d3(o,n,e),r)break}return r}var $y=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{startArrow:!1,endArrow:!1})},n.prototype.initAttrs=function(e){this._setPathArr(e.path),this.setArrow()},n.prototype.onAttrChange=function(e,r,i){t.prototype.onAttrChange.call(this,e,r,i),e==="path"&&this._setPathArr(r),this.setArrow()},n.prototype._setPathArr=function(e){this.attrs.path=mI(e);var r=gf.hasArc(e);this.set("hasArc",r),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},n.prototype.getSegments=function(){var e=this.get("segements");return e||(e=yI(this.attr("path")),this.set("segments",e)),e},n.prototype.setArrow=function(){var e=this.attr(),r=e.startArrow,i=e.endArrow;if(r){var o=this.getStartTangent();Ky(this,e,o[0][0],o[0][1],o[1][0],o[1][1])}if(i){var o=this.getEndTangent();Qy(this,e,o[0][0],o[0][1],o[1][0],o[1][1])}},n.prototype.isInStrokeOrPath=function(e,r,i,o,a){var s=this.getSegments(),u=this.get("hasArc"),c=!1;if(i){var l=this.getTotalLength();c=gf.isPointInStroke(s,a,e,r,l)}if(!c&&o)if(u)c=f3(this,e,r);else{var h=this.attr("path"),f=gf.extractPolygons(h);c=pE(f.polygons,e,r)||pE(f.polylines,e,r)}return c},n.prototype.createPath=function(e){var r=this.attr(),i=this.get("paramsCache");c3(this,e,r,i)},n.prototype.afterDrawPath=function(e){var r=this.get("startArrowShape"),i=this.get("endArrowShape");r&&r.draw(e),i&&i.draw(e)},n.prototype.getTotalLength=function(){var e=this.get("totalLength");return fe(e)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):e},n.prototype.getPoint=function(e){var r=this.get("tCache");r||(this._calculateCurve(),this._setTcache(),r=this.get("tCache"));var i,o,a=this.get("curve");if(!r||r.length===0)return a?{x:a[0][1],y:a[0][2]}:null;mt(r,function(l,h){e>=l[0]&&e<=l[1]&&(i=(e-l[0])/(l[1]-l[0]),o=h)});var s=a[o];if(fe(s)||fe(o))return null;var u=s.length,c=a[o+1];return Qc.pointAt(s[u-2],s[u-1],c[1],c[2],c[3],c[4],c[5],c[6],i)},n.prototype._calculateCurve=function(){var e=this.attr().path;this.set("curve",gf.pathToCurve(e))},n.prototype._setTcache=function(){var e=0,r=0,i=[],o,a,s,u,c=this.get("curve");if(c){if(mt(c,function(l,h){s=c[h+1],u=l.length,s&&(e+=Qc.length(l[u-2],l[u-1],s[1],s[2],s[3],s[4],s[5],s[6])||0)}),this.set("totalLength",e),e===0){this.set("tCache",[]);return}mt(c,function(l,h){s=c[h+1],u=l.length,s&&(o=[],o[0]=r/e,a=Qc.length(l[u-2],l[u-1],s[1],s[2],s[3],s[4],s[5],s[6]),r+=a||0,o[1]=r/e,i.push(o))}),this.set("tCache",i)}},n.prototype.getStartTangent=function(){var e=this.getSegments(),r;if(e.length>1){var i=e[0].currentPoint,o=e[1].currentPoint,a=e[1].startTangent;r=[],a?(r.push([i[0]-a[0],i[1]-a[1]]),r.push([i[0],i[1]])):(r.push([o[0],o[1]]),r.push([i[0],i[1]]))}return r},n.prototype.getEndTangent=function(){var e=this.getSegments(),r=e.length,i;if(r>1){var o=e[r-2].currentPoint,a=e[r-1].currentPoint,s=e[r-1].endTangent;i=[],s?(i.push([a[0]-s[0],a[1]-s[1]]),i.push([a[0],a[1]])):(i.push([o[0],o[1]]),i.push([a[0],a[1]]))}return i},n}(Ri);function p3(t,n,e,r,i){var o=t.length;if(o<2)return!1;for(var a=0;a<o-1;a++){var s=t[a][0],u=t[a][1],c=t[a+1][0],l=t[a+1][1];if(xa(s,u,c,l,n,e,r))return!0}if(i){var h=t[0],f=t[o-1];if(xa(h[0],h[1],f[0],f[1],n,e,r))return!0}return!1}var _Y=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.isInStrokeOrPath=function(e,r,i,o,a){var s=this.attr().points,u=!1;return i&&(u=p3(s,a,e,r,!0)),!u&&o&&(u=d3(s,e,r)),u},n.prototype.createPath=function(e){var r=this.attr(),i=r.points;if(!(i.length<2)){e.beginPath();for(var o=0;o<i.length;o++){var a=i[o];o===0?e.moveTo(a[0],a[1]):e.lineTo(a[0],a[1])}e.closePath()}},n}(Ri),kY=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{startArrow:!1,endArrow:!1})},n.prototype.initAttrs=function(e){this.setArrow()},n.prototype.onAttrChange=function(e,r,i){t.prototype.onAttrChange.call(this,e,r,i),this.setArrow(),["points"].indexOf(e)!==-1&&this._resetCache()},n.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},n.prototype.setArrow=function(){var e=this.attr(),r=this.attrs,i=r.points,o=r.startArrow,a=r.endArrow,s=i.length,u=i[0][0],c=i[0][1],l=i[s-1][0],h=i[s-1][1];o&&Ky(this,e,i[1][0],i[1][1],u,c),a&&Qy(this,e,i[s-2][0],i[s-2][1],l,h)},n.prototype.isFill=function(){return!1},n.prototype.isInStrokeOrPath=function(e,r,i,o,a){if(!i||!a)return!1;var s=this.attr().points;return p3(s,a,e,r,!1)},n.prototype.isStroke=function(){return!0},n.prototype.createPath=function(e){var r=this.attr(),i=r.points,o=r.startArrow,a=r.endArrow,s=i.length;if(!(i.length<2)){var u=i[0][0],c=i[0][1],l=i[s-1][0],h=i[s-1][1];if(o&&o.d){var f=ys(u,c,i[1][0],i[1][1],o.d);u+=f.dx,c+=f.dy}if(a&&a.d){var f=ys(i[s-2][0],i[s-2][1],l,h,a.d);l-=f.dx,h-=f.dy}e.beginPath(),e.moveTo(u,c);for(var d=0;d<s-1;d++){var p=i[d];e.lineTo(p[0],p[1])}e.lineTo(l,h)}},n.prototype.afterDrawPath=function(e){var r=this.get("startArrowShape"),i=this.get("endArrowShape");r&&r.draw(e),i&&i.draw(e)},n.prototype.getTotalLength=function(){var e=this.attr().points,r=this.get("totalLength");return fe(r)?(this.set("totalLength",fI.length(e)),this.get("totalLength")):r},n.prototype.getPoint=function(e){var r=this.attr().points,i=this.get("tCache");i||(this._setTcache(),i=this.get("tCache"));var o,a;return mt(i,function(s,u){e>=s[0]&&e<=s[1]&&(o=(e-s[0])/(s[1]-s[0]),a=u)}),mr.pointAt(r[a][0],r[a][1],r[a+1][0],r[a+1][1],o)},n.prototype._setTcache=function(){var e=this.attr().points;if(!(!e||e.length===0)){var r=this.getTotalLength();if(!(r<=0)){var i=0,o=[],a,s;mt(e,function(u,c){e[c+1]&&(a=[],a[0]=i/r,s=mr.length(u[0],u[1],e[c+1][0],e[c+1][1]),i+=s,a[1]=i/r,o.push(a))}),this.set("tCache",o)}}},n.prototype.getStartTangent=function(){var e=this.attr().points,r=[];return r.push([e[1][0],e[1][1]]),r.push([e[0][0],e[0][1]]),r},n.prototype.getEndTangent=function(){var e=this.attr().points,r=e.length-1,i=[];return i.push([e[r-1][0],e[r-1][1]]),i.push([e[r][0],e[r][1]]),i},n}(Ri);function AY(t,n,e,r,i,o,a){var s=i/2;return gs(t-s,n-s,e,i,o,a)||gs(t+e-s,n-s,i,r,o,a)||gs(t+s,n+r-s,e,i,o,a)||gs(t-s,n+s,i,r,o,a)}function CY(t,n,e,r,i,o,a,s){return xa(t+i,n,t+e-i,n,o,a,s)||xa(t+e,n+i,t+e,n+r-i,o,a,s)||xa(t+e-i,n+r,t+i,n+r,o,a,s)||xa(t,n+r-i,t,n+i,o,a,s)||Yc(t+e-i,n+i,i,1.5*Math.PI,2*Math.PI,o,a,s)||Yc(t+e-i,n+r-i,i,0,.5*Math.PI,o,a,s)||Yc(t+i,n+r-i,i,.5*Math.PI,Math.PI,o,a,s)||Yc(t+i,n+i,i,Math.PI,1.5*Math.PI,o,a,s)}var IY=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,width:0,height:0,radius:0})},n.prototype.isInStrokeOrPath=function(e,r,i,o,a){var s=this.attr(),u=s.x,c=s.y,l=s.width,h=s.height,f=s.radius;if(f){var d=!1;return i&&(d=CY(u,c,l,h,f,a,e,r)),!d&&o&&(d=f3(this,e,r)),d}else{var p=a/2;if(o&&i)return gs(u-p,c-p,l+p,h+p,e,r);if(o)return gs(u,c,l,h,e,r);if(i)return AY(u,c,l,h,a,e,r)}},n.prototype.createPath=function(e){var r=this.attr(),i=r.x,o=r.y,a=r.width,s=r.height,u=r.radius;if(e.beginPath(),u===0)e.rect(i,o,a,s);else{var c=sY(u),l=c[0],h=c[1],f=c[2],d=c[3];e.moveTo(i+l,o),e.lineTo(i+a-h,o),h!==0&&e.arc(i+a-h,o+h,h,-Math.PI/2,0),e.lineTo(i+a,o+s-f),f!==0&&e.arc(i+a-f,o+s-f,f,0,Math.PI/2),e.lineTo(i+d,o+s),d!==0&&e.arc(i+d,o+s-d,d,Math.PI/2,Math.PI),e.lineTo(i,o+l),l!==0&&e.arc(i+l,o+l,l,Math.PI,Math.PI*1.5),e.closePath()}},n}(Ri),TY=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},n.prototype.isOnlyHitBox=function(){return!0},n.prototype.initAttrs=function(e){this._assembleFont(),e.text&&this._setText(e.text)},n.prototype._assembleFont=function(){var e=this.attrs;e.font=gI(e)},n.prototype._setText=function(e){var r=null;Dt(e)&&e.indexOf(`
`)!==-1&&(r=e.split(`
`)),this.set("textArr",r)},n.prototype.onAttrChange=function(e,r,i){t.prototype.onAttrChange.call(this,e,r,i),e.startsWith("font")&&this._assembleFont(),e==="text"&&this._setText(r)},n.prototype._getSpaceingY=function(){var e=this.attrs,r=e.lineHeight,i=e.fontSize*1;return r?r-i:i*.14},n.prototype._drawTextArr=function(e,r,i){var o=this.attrs,a=o.textBaseline,s=o.x,u=o.y,c=o.fontSize*1,l=this._getSpaceingY(),h=pI(o.text,o.fontSize,o.lineHeight),f;mt(r,function(d,p){f=u+p*(l+c)-h+c,a==="middle"&&(f+=h-c-(h-c)/2),a==="top"&&(f+=h-c),fe(d)||(i?e.fillText(d,s,f):e.strokeText(d,s,f))})},n.prototype._drawText=function(e,r){var i=this.attr(),o=i.x,a=i.y,s=this.get("textArr");if(s)this._drawTextArr(e,s,r);else{var u=i.text;fe(u)||(r?e.fillText(u,o,a):e.strokeText(u,o,a))}},n.prototype.strokeAndFill=function(e){var r=this.attrs,i=r.lineWidth,o=r.opacity,a=r.strokeOpacity,s=r.fillOpacity;this.isStroke()&&i>0&&(!fe(a)&&a!==1&&(e.globalAlpha=o),this.stroke(e)),this.isFill()&&(!fe(s)&&s!==1?(e.globalAlpha=s,this.fill(e),e.globalAlpha=o):this.fill(e)),this.afterDrawPath(e)},n.prototype.fill=function(e){this._drawText(e,!0)},n.prototype.stroke=function(e){this._drawText(e,!1)},n}(Ri);function OY(t,n){if(n){var e=RC(n);return ds(e,t)}return t}function g3(t,n,e){var r=t.getTotalMatrix();if(r){var i=OY([n,e,1],r),o=i[0],a=i[1];return[o,a]}return[n,e]}function gE(t,n,e){if(t.isCanvas&&t.isCanvas())return!0;if(!jv(t)||t.cfg.isInView===!1)return!1;if(t.cfg.clipShape){var r=g3(t,n,e),i=r[0],o=r[1];if(t.isClipped(i,o))return!1}var a=t.cfg.cacheCanvasBBox||t.getCanvasBBox();return n>=a.minX&&n<=a.maxX&&e>=a.minY&&e<=a.maxY}function v3(t,n,e){if(!gE(t,n,e))return null;for(var r=null,i=t.getChildren(),o=i.length,a=o-1;a>=0;a--){var s=i[a];if(s.isGroup())r=v3(s,n,e);else if(gE(s,n,e)){var u=s,c=g3(s,n,e),l=c[0],h=c[1];u.isInShape(l,h)&&(r=s)}if(r)break}return r}var Uo=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.getDefaultCfg=function(){var e=t.prototype.getDefaultCfg.call(this);return e.renderer="canvas",e.autoDraw=!0,e.localRefresh=!0,e.refreshElements=[],e.clipView=!0,e.quickHit=!1,e},n.prototype.onCanvasChange=function(e){(e==="attr"||e==="sort"||e==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},n.prototype.getShapeBase=function(){return ry},n.prototype.getGroupBase=function(){return h3},n.prototype.getPixelRatio=function(){var e=this.get("pixelRatio")||JU();return e>=1?Math.ceil(e):1},n.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},n.prototype.createDom=function(){var e=document.createElement("canvas"),r=e.getContext("2d");return this.set("context",r),e},n.prototype.setDOMSize=function(e,r){t.prototype.setDOMSize.call(this,e,r);var i=this.get("context"),o=this.get("el"),a=this.getPixelRatio();o.width=a*e,o.height=a*r,a>1&&i.scale(a,a)},n.prototype.clear=function(){t.prototype.clear.call(this),this._clearFrame();var e=this.get("context"),r=this.get("el");e.clearRect(0,0,r.width,r.height)},n.prototype.getShape=function(e,r){var i;return this.get("quickHit")?i=v3(this,e,r):i=t.prototype.getShape.call(this,e,r,null),i},n.prototype._getRefreshRegion=function(){var e=this.get("refreshElements"),r=this.getViewRange(),i;if(e.length&&e[0]===this)i=r;else if(i=hY(e),i){i.minX=Math.floor(i.minX),i.minY=Math.floor(i.minY),i.maxX=Math.ceil(i.maxX),i.maxY=Math.ceil(i.maxY),i.maxY+=1;var o=this.get("clipView");o&&(i=fY(i,r))}return i},n.prototype.refreshElement=function(e){var r=this.get("refreshElements");r.push(e)},n.prototype._clearFrame=function(){var e=this.get("drawFrame");e&&(Sk(e),this.set("drawFrame",null),this.set("refreshElements",[]))},n.prototype.draw=function(){var e=this.get("drawFrame");this.get("autoDraw")&&e||this._startDraw()},n.prototype._drawAll=function(){var e=this.get("context"),r=this.get("el"),i=this.getChildren();e.clearRect(0,0,r.width,r.height),Bu(e,this),um(e,i),this.set("refreshElements",[])},n.prototype._drawRegion=function(){var e=this.get("context"),r=this.get("refreshElements"),i=this.getChildren(),o=this._getRefreshRegion();o?(e.clearRect(o.minX,o.minY,o.maxX-o.minX,o.maxY-o.minY),e.save(),e.beginPath(),e.rect(o.minX,o.minY,o.maxX-o.minX,o.maxY-o.minY),e.clip(),Bu(e,this),uY(this,i,o),um(e,i,o),e.restore()):r.length&&u3(r),mt(r,function(a){a.get("hasChanged")&&a.set("hasChanged",!1)}),this.set("refreshElements",[])},n.prototype._startDraw=function(){var e=this,r=this.get("drawFrame");r||(r=Mk(function(){e.get("localRefresh")?e._drawRegion():e._drawAll(),e.set("drawFrame",null)}),this.set("drawFrame",r))},n.prototype.skipDraw=function(){},n.prototype.removeDom=function(){var e=this.get("el");e.width=0,e.height=0,e.parentNode.removeChild(e)},n}(tI),lm={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},cn={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"};function vi(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function m3(t){var n=lm[t.type],e=t.getParent();if(!n)throw new Error("the type "+t.type+" is not supported by svg");var r=vi(n);if(t.get("id")&&(r.id=t.get("id")),t.set("el",r),t.set("attrs",{}),e){var i=e.get("el");i||(i=e.createDom(),e.set("el",i)),i.appendChild(r)}return r}function y3(t,n){var e=t.get("el"),r=Ck(e.children).sort(n),i=document.createDocumentFragment();r.forEach(function(o){i.appendChild(o)}),e.appendChild(i)}function NY(t,n){var e=t.parentNode,r=Array.from(e.childNodes).filter(function(s){return s.nodeType===1&&s.nodeName.toLowerCase()!=="defs"}),i=r[n],o=r.indexOf(t);if(i){if(o>n)e.insertBefore(t,i);else if(o<n){var a=r[n+1];a?e.insertBefore(t,a):e.appendChild(t)}}else e.appendChild(t)}function DY(t,n){var e=t.cfg.el,r=t.attr(),i={dx:r.shadowOffsetX,dy:r.shadowOffsetY,blur:r.shadowBlur,color:r.shadowColor};if(!i.dx&&!i.dy&&!i.blur&&!i.color)e.removeAttribute("filter");else{var o=n.find("filter",i);o||(o=n.addShadow(i)),e.setAttribute("filter","url(#"+o+")")}}function Vl(t){var n=t.attr().matrix;if(n){for(var e=t.cfg.el,r=[],i=0;i<9;i+=3)r.push(n[i]+","+n[i+1]);r=r.join(","),r.indexOf("NaN")===-1?e.setAttribute("transform","matrix("+r+")"):console.warn("invalid matrix:",n)}}function _l(t,n){var e=t.getClip(),r=t.get("el");if(!e)r.removeAttribute("clip-path");else if(e&&!r.hasAttribute("clip-path")){m3(e),e.createPath(n);var i=n.addClip(e);r.setAttribute("clip-path","url(#"+i+")")}}function b3(t,n){n.forEach(function(e){e.draw(t)})}function x3(t,n){var e=t.get("canvas");if(e&&e.get("autoDraw")){var r=e.get("context"),i=t.getParent(),o=i?i.getChildren():[e],a=t.get("el");if(n==="remove"){var s=t.get("isClipShape");if(s){var u=a&&a.parentNode,c=u&&u.parentNode;u&&c&&c.removeChild(u)}else a&&a.parentNode&&a.parentNode.removeChild(a)}else if(n==="show")a.setAttribute("visibility","visible");else if(n==="hide")a.setAttribute("visibility","hidden");else if(n==="zIndex")NY(a,o.indexOf(t));else if(n==="sort"){var l=t.get("children");l&&l.length&&y3(t,function(h,f){return l.indexOf(h)-l.indexOf(f)?1:0})}else n==="clear"?a&&(a.innerHTML=""):n==="matrix"?Vl(t):n==="clip"?_l(t,r):n==="attr"||n==="add"&&t.draw(r)}}var w3=function(t){Te(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n.prototype.isEntityGroup=function(){return!0},n.prototype.createDom=function(){var e=vi("g");this.set("el",e);var r=this.getParent();if(r){var i=r.get("el");i||(i=r.createDom(),r.set("el",i)),i.appendChild(e)}return e},n.prototype.afterAttrsChange=function(e){t.prototype.afterAttrsChange.call(this,e);var r=this.get("canvas");if(r&&r.get("autoDraw")){var i=r.get("context");this.createPath(i,e)}},n.prototype.onCanvasChange=function(e){x3(this,e)},n.prototype.getShapeBase=function(){return iy},n.prototype.getGroupBase=function(){return n},n.prototype.draw=function(e){var r=this.getChildren(),i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||this.createDom(),_l(this,e),this.createPath(e),r.length&&b3(e,r))},n.prototype.createPath=function(e,r){var i=this.attr(),o=this.get("el");mt(r||i,function(a,s){cn[s]&&o.setAttribute(cn[s],a)}),Vl(this)},n}(eI),bi=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="svg",e.canFill=!1,e.canStroke=!1,e}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},n.prototype.afterAttrsChange=function(e){t.prototype.afterAttrsChange.call(this,e);var r=this.get("canvas");if(r&&r.get("autoDraw")){var i=r.get("context");this.draw(i,e)}},n.prototype.getShapeBase=function(){return iy},n.prototype.getGroupBase=function(){return w3},n.prototype.onCanvasChange=function(e){x3(this,e)},n.prototype.calculateBBox=function(){var e=this.get("el"),r=null;if(e)r=e.getBBox();else{var i=iI(this.get("type"));i&&(r=i(this))}if(r){var o=r.x,a=r.y,s=r.width,u=r.height,c=this.getHitLineWidth(),l=c/2,h=o-l,f=a-l,d=o+s+l,p=a+u+l;return{x:h,y:f,minX:h,minY:f,maxX:d,maxY:p,width:s+c,height:u+c}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},n.prototype.isFill=function(){var e=this.attr(),r=e.fill,i=e.fillStyle;return(r||i||this.isClipShape())&&this.canFill},n.prototype.isStroke=function(){var e=this.attr(),r=e.stroke,i=e.strokeStyle;return(r||i)&&this.canStroke},n.prototype.draw=function(e,r){var i=this.get("el");this.get("destroyed")?i&&i.parentNode.removeChild(i):(i||m3(this),_l(this,e),this.createPath(e,r),this.shadow(e,r),this.strokeAndFill(e,r),this.transform(r))},n.prototype.createPath=function(e,r){},n.prototype.strokeAndFill=function(e,r){var i=r||this.attr(),o=i.fill,a=i.fillStyle,s=i.stroke,u=i.strokeStyle,c=i.fillOpacity,l=i.strokeOpacity,h=i.lineWidth,f=this.get("el");this.canFill&&(r?"fill"in i?this._setColor(e,"fill",o):"fillStyle"in i&&this._setColor(e,"fill",a):this._setColor(e,"fill",o||a),c&&f.setAttribute(cn.fillOpacity,c)),this.canStroke&&h>0&&(r?"stroke"in i?this._setColor(e,"stroke",s):"strokeStyle"in i&&this._setColor(e,"stroke",u):this._setColor(e,"stroke",s||u),l&&f.setAttribute(cn.strokeOpacity,l),h&&f.setAttribute(cn.lineWidth,h))},n.prototype._setColor=function(e,r,i){var o=this.get("el");if(!i){o.setAttribute(cn[r],"none");return}if(i=i.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(i)){var a=e.find("gradient",i);a||(a=e.addGradient(i)),o.setAttribute(cn[r],"url(#"+a+")")}else if(/^[p,P]{1}[\s]*\(/.test(i)){var a=e.find("pattern",i);a||(a=e.addPattern(i)),o.setAttribute(cn[r],"url(#"+a+")")}else o.setAttribute(cn[r],i)},n.prototype.shadow=function(e,r){var i=this.attr(),o=r||i,a=o.shadowOffsetX,s=o.shadowOffsetY,u=o.shadowBlur,c=o.shadowColor;(a||s||u||c)&&DY(this,e)},n.prototype.transform=function(e){var r=this.attr(),i=(e||r).matrix;i&&Vl(this)},n.prototype.isInShape=function(e,r){return this.isPointInPath(e,r)},n.prototype.isPointInPath=function(e,r){var i=this.get("el"),o=this.get("canvas"),a=o.get("el").getBoundingClientRect(),s=e+a.left,u=r+a.top,c=document.elementFromPoint(s,u);return!!(c&&c.isEqualNode(i))},n.prototype.getHitLineWidth=function(){var e=this.attrs,r=e.lineWidth,i=e.lineAppendWidth;return this.isStroke()?r+i:0},n}(nI),PY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="circle",e.canFill=!0,e.canStroke=!0,e}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,r:0})},n.prototype.createPath=function(e,r){var i=this.attr(),o=this.get("el");mt(r||i,function(a,s){s==="x"||s==="y"?o.setAttribute("c"+s,a):cn[s]&&o.setAttribute(cn[s],a)})},n}(bi),LY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="dom",e.canFill=!1,e.canStroke=!1,e}return n.prototype.createPath=function(e,r){var i=this.attr(),o=this.get("el");if(mt(r||i,function(c,l){cn[l]&&o.setAttribute(cn[l],c)}),typeof i.html=="function"){var a=i.html.call(this,i);if(a instanceof Element||a instanceof HTMLDocument){for(var s=o.childNodes,u=s.length-1;u>=0;u--)o.removeChild(s[u]);o.appendChild(a)}else o.innerHTML=a}else o.innerHTML=i.html},n}(bi),jY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="ellipse",e.canFill=!0,e.canStroke=!0,e}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,rx:0,ry:0})},n.prototype.createPath=function(e,r){var i=this.attr(),o=this.get("el");mt(r||i,function(a,s){s==="x"||s==="y"?o.setAttribute("c"+s,a):cn[s]&&o.setAttribute(cn[s],a)})},n}(bi),RY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="image",e.canFill=!1,e.canStroke=!1,e}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,width:0,height:0})},n.prototype.createPath=function(e,r){var i=this,o=this.attr(),a=this.get("el");mt(r||o,function(s,u){u==="img"?i._setImage(o.img):cn[u]&&a.setAttribute(cn[u],s)})},n.prototype.setAttr=function(e,r){this.attrs[e]=r,e==="img"&&this._setImage(r)},n.prototype._setImage=function(e){var r=this.attr(),i=this.get("el");if(Dt(e))i.setAttribute("href",e);else if(e instanceof window.Image)r.width||(i.setAttribute("width",e.width),this.attr("width",e.width)),r.height||(i.setAttribute("height",e.height),this.attr("height",e.height)),i.setAttribute("href",e.src);else if(e instanceof HTMLElement&&Dt(e.nodeName)&&e.nodeName.toUpperCase()==="CANVAS")i.setAttribute("href",e.toDataURL());else if(e instanceof ImageData){var o=document.createElement("canvas");o.setAttribute("width",""+e.width),o.setAttribute("height",""+e.height),o.getContext("2d").putImageData(e,0,0),r.width||(i.setAttribute("width",""+e.width),this.attr("width",e.width)),r.height||(i.setAttribute("height",""+e.height),this.attr("height",e.height)),i.setAttribute("href",o.toDataURL())}},n}(bi),FY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="line",e.canFill=!1,e.canStroke=!0,e}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},n.prototype.createPath=function(e,r){var i=this.attr(),o=this.get("el");mt(r||i,function(a,s){if(s==="startArrow"||s==="endArrow")if(a){var u=yr(a)?e.addArrow(i,cn[s]):e.getDefaultArrow(i,cn[s]);o.setAttribute(cn[s],"url(#"+u+")")}else o.removeAttribute(cn[s]);else cn[s]&&o.setAttribute(cn[s],a)})},n.prototype.getTotalLength=function(){var e=this.attr(),r=e.x1,i=e.y1,o=e.x2,a=e.y2;return mr.length(r,i,o,a)},n.prototype.getPoint=function(e){var r=this.attr(),i=r.x1,o=r.y1,a=r.x2,s=r.y2;return mr.pointAt(i,o,a,s,e)},n}(bi),vf={circle:function(t,n,e){return[["M",t,n],["m",-e,0],["a",e,e,0,1,0,e*2,0],["a",e,e,0,1,0,-e*2,0]]},square:function(t,n,e){return[["M",t-e,n-e],["L",t+e,n-e],["L",t+e,n+e],["L",t-e,n+e],["Z"]]},diamond:function(t,n,e){return[["M",t-e,n],["L",t,n-e],["L",t+e,n],["L",t,n+e],["Z"]]},triangle:function(t,n,e){var r=e*Math.sin(.3333333333333333*Math.PI);return[["M",t-e,n+r],["L",t,n-r],["L",t+e,n+r],["z"]]},triangleDown:function(t,n,e){var r=e*Math.sin(.3333333333333333*Math.PI);return[["M",t-e,n-r],["L",t+e,n-r],["L",t,n+r],["Z"]]}};const vE={get:function(t){return vf[t]},register:function(t,n){vf[t]=n},remove:function(t){delete vf[t]},getAll:function(){return vf}};var BY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="marker",e.canFill=!0,e.canStroke=!0,e}return n.prototype.createPath=function(e){var r=this.get("el");r.setAttribute("d",this._assembleMarker())},n.prototype._assembleMarker=function(){var e=this._getPath();return ve(e)?e.map(function(r){return r.join(" ")}).join(""):e},n.prototype._getPath=function(){var e=this.attr(),r=e.x,i=e.y,o=e.r||e.radius,a=e.symbol||"circle",s;return An(a)?s=a:s=vE.get(a),s?s(r,i,o):(console.warn(s+" symbol is not exist."),null)},n.symbolsFactory=vE,n}(bi),zY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="path",e.canFill=!0,e.canStroke=!0,e}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{startArrow:!1,endArrow:!1})},n.prototype.createPath=function(e,r){var i=this,o=this.attr(),a=this.get("el");mt(r||o,function(s,u){if(u==="path"&&ve(s))a.setAttribute("d",i._formatPath(s));else if(u==="startArrow"||u==="endArrow")if(s){var c=yr(s)?e.addArrow(o,cn[u]):e.getDefaultArrow(o,cn[u]);a.setAttribute(cn[u],"url(#"+c+")")}else a.removeAttribute(cn[u]);else cn[u]&&a.setAttribute(cn[u],s)})},n.prototype._formatPath=function(e){var r=e.map(function(i){return i.join(" ")}).join("");return~r.indexOf("NaN")?"":r},n.prototype.getTotalLength=function(){var e=this.get("el");return e?e.getTotalLength():null},n.prototype.getPoint=function(e){var r=this.get("el"),i=this.getTotalLength();if(i===0)return null;var o=r?r.getPointAtLength(e*i):null;return o?{x:o.x,y:o.y}:null},n}(bi),GY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="polygon",e.canFill=!0,e.canStroke=!0,e}return n.prototype.createPath=function(e,r){var i=this.attr(),o=this.get("el");mt(r||i,function(a,s){s==="points"&&ve(a)&&a.length>=2?o.setAttribute("points",a.map(function(u){return u[0]+","+u[1]}).join(" ")):cn[s]&&o.setAttribute(cn[s],a)})},n}(bi),UY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="polyline",e.canFill=!0,e.canStroke=!0,e}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{startArrow:!1,endArrow:!1})},n.prototype.onAttrChange=function(e,r,i){t.prototype.onAttrChange.call(this,e,r,i),["points"].indexOf(e)!==-1&&this._resetCache()},n.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},n.prototype.createPath=function(e,r){var i=this.attr(),o=this.get("el");mt(r||i,function(a,s){s==="points"&&ve(a)&&a.length>=2?o.setAttribute("points",a.map(function(u){return u[0]+","+u[1]}).join(" ")):cn[s]&&o.setAttribute(cn[s],a)})},n.prototype.getTotalLength=function(){var e=this.attr().points,r=this.get("totalLength");return fe(r)?(this.set("totalLength",fI.length(e)),this.get("totalLength")):r},n.prototype.getPoint=function(e){var r=this.attr().points,i=this.get("tCache");i||(this._setTcache(),i=this.get("tCache"));var o,a;return mt(i,function(s,u){e>=s[0]&&e<=s[1]&&(o=(e-s[0])/(s[1]-s[0]),a=u)}),mr.pointAt(r[a][0],r[a][1],r[a+1][0],r[a+1][1],o)},n.prototype._setTcache=function(){var e=this.attr().points;if(!(!e||e.length===0)){var r=this.getTotalLength();if(!(r<=0)){var i=0,o=[],a,s;mt(e,function(u,c){e[c+1]&&(a=[],a[0]=i/r,s=mr.length(u[0],u[1],e[c+1][0],e[c+1][1]),i+=s,a[1]=i/r,o.push(a))}),this.set("tCache",o)}}},n.prototype.getStartTangent=function(){var e=this.attr().points,r=[];return r.push([e[1][0],e[1][1]]),r.push([e[0][0],e[0][1]]),r},n.prototype.getEndTangent=function(){var e=this.attr().points,r=e.length-1,i=[];return i.push([e[r-1][0],e[r-1][1]]),i.push([e[r][0],e[r][1]]),i},n}(bi);function YY(t){var n=0,e=0,r=0,i=0;return ve(t)?t.length===1?n=e=r=i=t[0]:t.length===2?(n=r=t[0],e=i=t[1]):t.length===3?(n=t[0],e=i=t[1],r=t[2]):(n=t[0],e=t[1],r=t[2],i=t[3]):n=e=r=i=t,{r1:n,r2:e,r3:r,r4:i}}var VY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="rect",e.canFill=!0,e.canStroke=!0,e}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,width:0,height:0,radius:0})},n.prototype.createPath=function(e,r){var i=this,o=this.attr(),a=this.get("el"),s=!1,u=["x","y","width","height","radius"];mt(r||o,function(c,l){u.indexOf(l)!==-1&&!s?(a.setAttribute("d",i._assembleRect(o)),s=!0):u.indexOf(l)===-1&&cn[l]&&a.setAttribute(cn[l],c)})},n.prototype._assembleRect=function(e){var r=e.x,i=e.y,o=e.width,a=e.height,s=e.radius;if(!s)return"M "+r+","+i+" l "+o+",0 l 0,"+a+" l"+-o+" 0 z";var u=YY(s);ve(s)?s.length===1?u.r1=u.r2=u.r3=u.r4=s[0]:s.length===2?(u.r1=u.r3=s[0],u.r2=u.r4=s[1]):s.length===3?(u.r1=s[0],u.r2=u.r4=s[1],u.r3=s[2]):(u.r1=s[0],u.r2=s[1],u.r3=s[2],u.r4=s[3]):u.r1=u.r2=u.r3=u.r4=s;var c=[["M "+(r+u.r1)+","+i],["l "+(o-u.r1-u.r2)+",0"],["a "+u.r2+","+u.r2+",0,0,1,"+u.r2+","+u.r2],["l 0,"+(a-u.r2-u.r3)],["a "+u.r3+","+u.r3+",0,0,1,"+-u.r3+","+u.r3],["l "+(u.r3+u.r4-o)+",0"],["a "+u.r4+","+u.r4+",0,0,1,"+-u.r4+","+-u.r4],["l 0,"+(u.r4+u.r1-a)],["a "+u.r1+","+u.r1+",0,0,1,"+u.r1+","+-u.r1],["z"]];return c.join(" ")},n}(bi),mE=.3,WY={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},XY={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},HY={left:"left",start:"left",center:"middle",right:"end",end:"end"},qY=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="text",e.canFill=!0,e.canStroke=!0,e}return n.prototype.getDefaultAttrs=function(){var e=t.prototype.getDefaultAttrs.call(this);return B(B({},e),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},n.prototype.createPath=function(e,r){var i=this,o=this.attr(),a=this.get("el");this._setFont(),mt(r||o,function(s,u){u==="text"?i._setText(""+s):u==="matrix"&&s?Vl(i):cn[u]&&a.setAttribute(cn[u],s)}),a.setAttribute("paint-order","stroke"),a.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},n.prototype._setFont=function(){var e=this.get("el"),r=this.attr(),i=r.textBaseline,o=r.textAlign,a=jC();a&&a.name==="firefox"?e.setAttribute("dominant-baseline",XY[i]||"alphabetic"):e.setAttribute("alignment-baseline",WY[i]||"baseline"),e.setAttribute("text-anchor",HY[o]||"left")},n.prototype._setText=function(e){var r=this.get("el"),i=this.attr(),o=i.x,a=i.textBaseline,s=a===void 0?"bottom":a;if(!e)r.innerHTML="";else if(~e.indexOf(`
`)){var u=e.split(`
`),c=u.length-1,l="";mt(u,function(h,f){f===0?s==="alphabetic"?l+='<tspan x="'+o+'" dy="'+-c+'em">'+h+"</tspan>":s==="top"?l+='<tspan x="'+o+'" dy="0.9em">'+h+"</tspan>":s==="middle"?l+='<tspan x="'+o+'" dy="'+-(c-1)/2+'em">'+h+"</tspan>":s==="bottom"?l+='<tspan x="'+o+'" dy="-'+(c+mE)+'em">'+h+"</tspan>":s==="hanging"&&(l+='<tspan x="'+o+'" dy="'+(-(c-1)-mE)+'em">'+h+"</tspan>"):l+='<tspan x="'+o+'" dy="1em">'+h+"</tspan>"}),r.innerHTML=l}else r.innerHTML=e},n}(bi),ZY=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,KY=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,QY=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function E3(t){var n=t.match(QY);if(!n)return"";var e="";return n.sort(function(r,i){return r=r.split(":"),i=i.split(":"),Number(r[0])-Number(i[0])}),mt(n,function(r){r=r.split(":"),e+='<stop offset="'+r[0]+'" stop-color="'+r[1]+'"></stop>'}),e}function JY(t,n){var e=ZY.exec(t),r=up(cp(parseFloat(e[1])),Math.PI*2),i=e[2],o,a;r>=0&&r<.5*Math.PI?(o={x:0,y:0},a={x:1,y:1}):.5*Math.PI<=r&&r<Math.PI?(o={x:1,y:0},a={x:0,y:1}):Math.PI<=r&&r<1.5*Math.PI?(o={x:1,y:1},a={x:0,y:0}):(o={x:0,y:1},a={x:1,y:0});var s=Math.tan(r),u=s*s,c=(a.x-o.x+s*(a.y-o.y))/(u+1)+o.x,l=s*(a.x-o.x+s*(a.y-o.y))/(u+1)+o.y;n.setAttribute("x1",o.x),n.setAttribute("y1",o.y),n.setAttribute("x2",c),n.setAttribute("y2",l),n.innerHTML=E3(i)}function $Y(t,n){var e=KY.exec(t),r=parseFloat(e[1]),i=parseFloat(e[2]),o=parseFloat(e[3]),a=e[4];n.setAttribute("cx",r),n.setAttribute("cy",i),n.setAttribute("r",o),n.innerHTML=E3(a)}var tV=function(){function t(n){this.cfg={};var e=null,r=vo("gradient_");return n.toLowerCase()[0]==="l"?(e=vi("linearGradient"),JY(n,e)):(e=vi("radialGradient"),$Y(n,e)),e.setAttribute("id",r),this.el=e,this.id=r,this.cfg=n,this}return t.prototype.match=function(n,e){return this.cfg===e},t}(),eV={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},nV={x:"-40%",y:"-40%",width:"200%",height:"200%"},rV=function(){function t(n){this.type="filter",this.cfg={},this.type="filter";var e=vi("filter");return mt(nV,function(r,i){e.setAttribute(i,r)}),this.el=e,this.id=vo("filter_"),this.el.id=this.id,this.cfg=n,this._parseShadow(n,e),this}return t.prototype.match=function(n,e){if(this.type!==n)return!1;var r=!0,i=this.cfg;return mt(Object.keys(i),function(o){if(i[o]!==e[o])return r=!1,!1}),r},t.prototype.update=function(n,e){var r=this.cfg;return r[eV[n]]=e,this._parseShadow(r,this.el),this},t.prototype._parseShadow=function(n,e){var r=`<feDropShadow
      dx="`+(n.dx||0)+`"
      dy="`+(n.dy||0)+`"
      stdDeviation="`+(n.blur?n.blur/10:0)+`"
      flood-color="`+(n.color?n.color:"#000")+`"
      flood-opacity="`+(n.opacity?n.opacity:1)+`"
      />`;e.innerHTML=r},t}(),yE=function(){function t(n,e){this.cfg={};var r=vi("marker"),i=vo("marker_");r.setAttribute("id",i);var o=vi("path");o.setAttribute("stroke",n.stroke||"none"),o.setAttribute("fill",n.fill||"none"),r.appendChild(o),r.setAttribute("overflow","visible"),r.setAttribute("orient","auto-start-reverse"),this.el=r,this.child=o,this.id=i;var a=n[e==="marker-start"?"startArrow":"endArrow"];return this.stroke=n.stroke||"#000",a===!0?this._setDefaultPath(e,o):(this.cfg=a,this._setMarker(n.lineWidth,o)),this}return t.prototype.match=function(){return!1},t.prototype._setDefaultPath=function(n,e){var r=this.el;e.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),r.setAttribute("refX",""+10*Math.cos(Math.PI/6)),r.setAttribute("refY","5")},t.prototype._setMarker=function(n,e){var r=this.el,i=this.cfg.path,o=this.cfg.d;ve(i)&&(i=i.map(function(a){return a.join(" ")}).join("")),e.setAttribute("d",i),r.appendChild(e),o&&r.setAttribute("refX",""+o/n)},t.prototype.update=function(n){var e=this.child;e.attr?e.attr("fill",n):e.setAttribute("fill",n)},t}(),iV=function(){function t(n){this.type="clip",this.cfg={};var e=vi("clipPath");this.el=e,this.id=vo("clip_"),e.id=this.id;var r=n.cfg.el;return e.appendChild(r),this.cfg=n,this}return t.prototype.match=function(){return!1},t.prototype.remove=function(){var n=this.el;n.parentNode.removeChild(n)},t}(),oV=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,aV=function(){function t(n){this.cfg={};var e=vi("pattern");e.setAttribute("patternUnits","userSpaceOnUse");var r=vi("image");e.appendChild(r);var i=vo("pattern_");e.id=i,this.el=e,this.id=i,this.cfg=n;var o=oV.exec(n),a=o[2];r.setAttribute("href",a);var s=new Image;a.match(/^data:/i)||(s.crossOrigin="Anonymous"),s.src=a;function u(){e.setAttribute("width",""+s.width),e.setAttribute("height",""+s.height)}return s.complete?u():(s.onload=u,s.src=s.src),this}return t.prototype.match=function(n,e){return this.cfg===e},t}(),sV=function(){function t(n){var e=vi("defs"),r=vo("defs_");e.id=r,n.appendChild(e),this.children=[],this.defaultArrow={},this.el=e,this.canvas=n}return t.prototype.find=function(n,e){for(var r=this.children,i=null,o=0;o<r.length;o++)if(r[o].match(n,e)){i=r[o].id;break}return i},t.prototype.findById=function(n){for(var e=this.children,r=null,i=0;i<e.length;i++)if(e[i].id===n){r=e[i];break}return r},t.prototype.add=function(n){this.children.push(n),n.canvas=this.canvas,n.parent=this},t.prototype.getDefaultArrow=function(n,e){var r=n.stroke||n.strokeStyle;if(this.defaultArrow[r])return this.defaultArrow[r].id;var i=new yE(n,e);return this.defaultArrow[r]=i,this.el.appendChild(i.el),this.add(i),i.id},t.prototype.addGradient=function(n){var e=new tV(n);return this.el.appendChild(e.el),this.add(e),e.id},t.prototype.addArrow=function(n,e){var r=new yE(n,e);return this.el.appendChild(r.el),this.add(r),r.id},t.prototype.addShadow=function(n){var e=new rV(n);return this.el.appendChild(e.el),this.add(e),e.id},t.prototype.addPattern=function(n){var e=new aV(n);return this.el.appendChild(e.el),this.add(e),e.id},t.prototype.addClip=function(n){var e=new iV(n);return this.el.appendChild(e.el),this.add(e),e.id},t}(),$c=function(t){Te(n,t);function n(e){return t.call(this,B(B({},e),{autoDraw:!0,renderer:"svg"}))||this}return n.prototype.getShapeBase=function(){return iy},n.prototype.getGroupBase=function(){return w3},n.prototype.getShape=function(e,r,i){var o=i.target||i.srcElement;if(!lm[o.tagName]){for(var a=o.parentNode;a&&!lm[a.tagName];)a=a.parentNode;o=a}return this.find(function(s){return s.get("el")===o})},n.prototype.createDom=function(){var e=vi("svg"),r=new sV(e);return e.setAttribute("width",""+this.get("width")),e.setAttribute("height",""+this.get("height")),this.set("context",r),e},n.prototype.onCanvasChange=function(e){var r=this.get("context"),i=this.get("el");if(e==="sort"){var o=this.get("children");o&&o.length&&y3(this,function(s,u){return o.indexOf(s)-o.indexOf(u)?1:0})}else if(e==="clear"){if(i){i.innerHTML="";var a=r.el;a.innerHTML="",i.appendChild(a)}}else e==="matrix"?Vl(this):e==="clip"?_l(this,r):e==="changeSize"&&(i.setAttribute("width",""+this.get("width")),i.setAttribute("height",""+this.get("height")))},n.prototype.draw=function(){var e=this.get("context"),r=this.getChildren();_l(this,e),r.length&&b3(e,r)},n}(tI),M3={exports:{}},uV={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},S3={exports:{}},cV=function(t){return!t||typeof t=="string"?!1:t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&t.constructor.name!=="String")},lV=cV,hV=Array.prototype.concat,fV=Array.prototype.slice,bE=S3.exports=function(t){for(var n=[],e=0,r=t.length;e<r;e++){var i=t[e];lV(i)?n=hV.call(n,fV.call(i)):n.push(i)}return n};bE.wrap=function(t){return function(){return t(bE(arguments))}};var dV=S3.exports,tl=uV,Wl=dV,_3=Object.hasOwnProperty,k3=Object.create(null);for(var P0 in tl)_3.call(tl,P0)&&(k3[tl[P0]]=P0);var Jr=M3.exports={to:{},get:{}};Jr.get=function(t){var n=t.substring(0,3).toLowerCase(),e,r;switch(n){case"hsl":e=Jr.get.hsl(t),r="hsl";break;case"hwb":e=Jr.get.hwb(t),r="hwb";break;default:e=Jr.get.rgb(t),r="rgb";break}return e?{model:r,value:e}:null};Jr.get.rgb=function(t){if(!t)return null;var n=/^#([a-f0-9]{3,4})$/i,e=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,r=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,i=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,o=/^(\w+)$/,a=[0,0,0,1],s,u,c;if(s=t.match(e)){for(c=s[2],s=s[1],u=0;u<3;u++){var l=u*2;a[u]=parseInt(s.slice(l,l+2),16)}c&&(a[3]=parseInt(c,16)/255)}else if(s=t.match(n)){for(s=s[1],c=s[3],u=0;u<3;u++)a[u]=parseInt(s[u]+s[u],16);c&&(a[3]=parseInt(c+c,16)/255)}else if(s=t.match(r)){for(u=0;u<3;u++)a[u]=parseInt(s[u+1],0);s[4]&&(s[5]?a[3]=parseFloat(s[4])*.01:a[3]=parseFloat(s[4]))}else if(s=t.match(i)){for(u=0;u<3;u++)a[u]=Math.round(parseFloat(s[u+1])*2.55);s[4]&&(s[5]?a[3]=parseFloat(s[4])*.01:a[3]=parseFloat(s[4]))}else return(s=t.match(o))?s[1]==="transparent"?[0,0,0,0]:_3.call(tl,s[1])?(a=tl[s[1]],a[3]=1,a):null:null;for(u=0;u<3;u++)a[u]=ka(a[u],0,255);return a[3]=ka(a[3],0,1),a};Jr.get.hsl=function(t){if(!t)return null;var n=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,e=t.match(n);if(e){var r=parseFloat(e[4]),i=(parseFloat(e[1])%360+360)%360,o=ka(parseFloat(e[2]),0,100),a=ka(parseFloat(e[3]),0,100),s=ka(isNaN(r)?1:r,0,1);return[i,o,a,s]}return null};Jr.get.hwb=function(t){if(!t)return null;var n=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,e=t.match(n);if(e){var r=parseFloat(e[4]),i=(parseFloat(e[1])%360+360)%360,o=ka(parseFloat(e[2]),0,100),a=ka(parseFloat(e[3]),0,100),s=ka(isNaN(r)?1:r,0,1);return[i,o,a,s]}return null};Jr.to.hex=function(){var t=Wl(arguments);return"#"+mf(t[0])+mf(t[1])+mf(t[2])+(t[3]<1?mf(Math.round(t[3]*255)):"")};Jr.to.rgb=function(){var t=Wl(arguments);return t.length<4||t[3]===1?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"};Jr.to.rgb.percent=function(){var t=Wl(arguments),n=Math.round(t[0]/255*100),e=Math.round(t[1]/255*100),r=Math.round(t[2]/255*100);return t.length<4||t[3]===1?"rgb("+n+"%, "+e+"%, "+r+"%)":"rgba("+n+"%, "+e+"%, "+r+"%, "+t[3]+")"};Jr.to.hsl=function(){var t=Wl(arguments);return t.length<4||t[3]===1?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"};Jr.to.hwb=function(){var t=Wl(arguments),n="";return t.length>=4&&t[3]!==1&&(n=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+n+")"};Jr.to.keyword=function(t){return k3[t.slice(0,3)]};function ka(t,n,e){return Math.min(Math.max(n,t),e)}function mf(t){var n=Math.round(t).toString(16).toUpperCase();return n.length<2?"0"+n:n}var pV=M3.exports,A3={exports:{}},gV={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},bs=gV,C3={};for(var L0 in bs)bs.hasOwnProperty(L0)&&(C3[bs[L0]]=L0);var Ee=A3.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var Pr in Ee)if(Ee.hasOwnProperty(Pr)){if(!("channels"in Ee[Pr]))throw new Error("missing channels property: "+Pr);if(!("labels"in Ee[Pr]))throw new Error("missing channel labels property: "+Pr);if(Ee[Pr].labels.length!==Ee[Pr].channels)throw new Error("channel and label counts mismatch: "+Pr);var vV=Ee[Pr].channels,mV=Ee[Pr].labels;delete Ee[Pr].channels,delete Ee[Pr].labels,Object.defineProperty(Ee[Pr],"channels",{value:vV}),Object.defineProperty(Ee[Pr],"labels",{value:mV})}Ee.rgb.hsl=function(t){var n=t[0]/255,e=t[1]/255,r=t[2]/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=o-i,s,u,c;return o===i?s=0:n===o?s=(e-r)/a:e===o?s=2+(r-n)/a:r===o&&(s=4+(n-e)/a),s=Math.min(s*60,360),s<0&&(s+=360),c=(i+o)/2,o===i?u=0:c<=.5?u=a/(o+i):u=a/(2-o-i),[s,u*100,c*100]};Ee.rgb.hsv=function(t){var n,e,r,i,o,a=t[0]/255,s=t[1]/255,u=t[2]/255,c=Math.max(a,s,u),l=c-Math.min(a,s,u),h=function(f){return(c-f)/6/l+1/2};return l===0?i=o=0:(o=l/c,n=h(a),e=h(s),r=h(u),a===c?i=r-e:s===c?i=1/3+n-r:u===c&&(i=2/3+e-n),i<0?i+=1:i>1&&(i-=1)),[i*360,o*100,c*100]};Ee.rgb.hwb=function(t){var n=t[0],e=t[1],r=t[2],i=Ee.rgb.hsl(t)[0],o=1/255*Math.min(n,Math.min(e,r));return r=1-1/255*Math.max(n,Math.max(e,r)),[i,o*100,r*100]};Ee.rgb.cmyk=function(t){var n=t[0]/255,e=t[1]/255,r=t[2]/255,i,o,a,s;return s=Math.min(1-n,1-e,1-r),i=(1-n-s)/(1-s)||0,o=(1-e-s)/(1-s)||0,a=(1-r-s)/(1-s)||0,[i*100,o*100,a*100,s*100]};function yV(t,n){return Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2)+Math.pow(t[2]-n[2],2)}Ee.rgb.keyword=function(t){var n=C3[t];if(n)return n;var e=1/0,r;for(var i in bs)if(bs.hasOwnProperty(i)){var o=bs[i],a=yV(t,o);a<e&&(e=a,r=i)}return r};Ee.keyword.rgb=function(t){return bs[t]};Ee.rgb.xyz=function(t){var n=t[0]/255,e=t[1]/255,r=t[2]/255;n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var i=n*.4124+e*.3576+r*.1805,o=n*.2126+e*.7152+r*.0722,a=n*.0193+e*.1192+r*.9505;return[i*100,o*100,a*100]};Ee.rgb.lab=function(t){var n=Ee.rgb.xyz(t),e=n[0],r=n[1],i=n[2],o,a,s;return e/=95.047,r/=100,i/=108.883,e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,o=116*r-16,a=500*(e-r),s=200*(r-i),[o,a,s]};Ee.hsl.rgb=function(t){var n=t[0]/360,e=t[1]/100,r=t[2]/100,i,o,a,s,u;if(e===0)return u=r*255,[u,u,u];r<.5?o=r*(1+e):o=r+e-r*e,i=2*r-o,s=[0,0,0];for(var c=0;c<3;c++)a=n+1/3*-(c-1),a<0&&a++,a>1&&a--,6*a<1?u=i+(o-i)*6*a:2*a<1?u=o:3*a<2?u=i+(o-i)*(2/3-a)*6:u=i,s[c]=u*255;return s};Ee.hsl.hsv=function(t){var n=t[0],e=t[1]/100,r=t[2]/100,i=e,o=Math.max(r,.01),a,s;return r*=2,e*=r<=1?r:2-r,i*=o<=1?o:2-o,s=(r+e)/2,a=r===0?2*i/(o+i):2*e/(r+e),[n,a*100,s*100]};Ee.hsv.rgb=function(t){var n=t[0]/60,e=t[1]/100,r=t[2]/100,i=Math.floor(n)%6,o=n-Math.floor(n),a=255*r*(1-e),s=255*r*(1-e*o),u=255*r*(1-e*(1-o));switch(r*=255,i){case 0:return[r,u,a];case 1:return[s,r,a];case 2:return[a,r,u];case 3:return[a,s,r];case 4:return[u,a,r];case 5:return[r,a,s]}};Ee.hsv.hsl=function(t){var n=t[0],e=t[1]/100,r=t[2]/100,i=Math.max(r,.01),o,a,s;return s=(2-e)*r,o=(2-e)*i,a=e*i,a/=o<=1?o:2-o,a=a||0,s/=2,[n,a*100,s*100]};Ee.hwb.rgb=function(t){var n=t[0]/360,e=t[1]/100,r=t[2]/100,i=e+r,o,a,s,u;i>1&&(e/=i,r/=i),o=Math.floor(6*n),a=1-r,s=6*n-o,o&1&&(s=1-s),u=e+s*(a-e);var c,l,h;switch(o){default:case 6:case 0:c=a,l=u,h=e;break;case 1:c=u,l=a,h=e;break;case 2:c=e,l=a,h=u;break;case 3:c=e,l=u,h=a;break;case 4:c=u,l=e,h=a;break;case 5:c=a,l=e,h=u;break}return[c*255,l*255,h*255]};Ee.cmyk.rgb=function(t){var n=t[0]/100,e=t[1]/100,r=t[2]/100,i=t[3]/100,o,a,s;return o=1-Math.min(1,n*(1-i)+i),a=1-Math.min(1,e*(1-i)+i),s=1-Math.min(1,r*(1-i)+i),[o*255,a*255,s*255]};Ee.xyz.rgb=function(t){var n=t[0]/100,e=t[1]/100,r=t[2]/100,i,o,a;return i=n*3.2406+e*-1.5372+r*-.4986,o=n*-.9689+e*1.8758+r*.0415,a=n*.0557+e*-.204+r*1.057,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a*12.92,i=Math.min(Math.max(0,i),1),o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),[i*255,o*255,a*255]};Ee.xyz.lab=function(t){var n=t[0],e=t[1],r=t[2],i,o,a;return n/=95.047,e/=100,r/=108.883,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,i=116*e-16,o=500*(n-e),a=200*(e-r),[i,o,a]};Ee.lab.xyz=function(t){var n=t[0],e=t[1],r=t[2],i,o,a;o=(n+16)/116,i=e/500+o,a=o-r/200;var s=Math.pow(o,3),u=Math.pow(i,3),c=Math.pow(a,3);return o=s>.008856?s:(o-16/116)/7.787,i=u>.008856?u:(i-16/116)/7.787,a=c>.008856?c:(a-16/116)/7.787,i*=95.047,o*=100,a*=108.883,[i,o,a]};Ee.lab.lch=function(t){var n=t[0],e=t[1],r=t[2],i,o,a;return i=Math.atan2(r,e),o=i*360/2/Math.PI,o<0&&(o+=360),a=Math.sqrt(e*e+r*r),[n,a,o]};Ee.lch.lab=function(t){var n=t[0],e=t[1],r=t[2],i,o,a;return a=r/360*2*Math.PI,i=e*Math.cos(a),o=e*Math.sin(a),[n,i,o]};Ee.rgb.ansi16=function(t){var n=t[0],e=t[1],r=t[2],i=1 in arguments?arguments[1]:Ee.rgb.hsv(t)[2];if(i=Math.round(i/50),i===0)return 30;var o=30+(Math.round(r/255)<<2|Math.round(e/255)<<1|Math.round(n/255));return i===2&&(o+=60),o};Ee.hsv.ansi16=function(t){return Ee.rgb.ansi16(Ee.hsv.rgb(t),t[2])};Ee.rgb.ansi256=function(t){var n=t[0],e=t[1],r=t[2];if(n===e&&e===r)return n<8?16:n>248?231:Math.round((n-8)/247*24)+232;var i=16+36*Math.round(n/255*5)+6*Math.round(e/255*5)+Math.round(r/255*5);return i};Ee.ansi16.rgb=function(t){var n=t%10;if(n===0||n===7)return t>50&&(n+=3.5),n=n/10.5*255,[n,n,n];var e=(~~(t>50)+1)*.5,r=(n&1)*e*255,i=(n>>1&1)*e*255,o=(n>>2&1)*e*255;return[r,i,o]};Ee.ansi256.rgb=function(t){if(t>=232){var n=(t-232)*10+8;return[n,n,n]}t-=16;var e,r=Math.floor(t/36)/5*255,i=Math.floor((e=t%36)/6)/5*255,o=e%6/5*255;return[r,i,o]};Ee.rgb.hex=function(t){var n=((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255),e=n.toString(16).toUpperCase();return"000000".substring(e.length)+e};Ee.hex.rgb=function(t){var n=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!n)return[0,0,0];var e=n[0];n[0].length===3&&(e=e.split("").map(function(s){return s+s}).join(""));var r=parseInt(e,16),i=r>>16&255,o=r>>8&255,a=r&255;return[i,o,a]};Ee.rgb.hcg=function(t){var n=t[0]/255,e=t[1]/255,r=t[2]/255,i=Math.max(Math.max(n,e),r),o=Math.min(Math.min(n,e),r),a=i-o,s,u;return a<1?s=o/(1-a):s=0,a<=0?u=0:i===n?u=(e-r)/a%6:i===e?u=2+(r-n)/a:u=4+(n-e)/a+4,u/=6,u%=1,[u*360,a*100,s*100]};Ee.hsl.hcg=function(t){var n=t[1]/100,e=t[2]/100,r=1,i=0;return e<.5?r=2*n*e:r=2*n*(1-e),r<1&&(i=(e-.5*r)/(1-r)),[t[0],r*100,i*100]};Ee.hsv.hcg=function(t){var n=t[1]/100,e=t[2]/100,r=n*e,i=0;return r<1&&(i=(e-r)/(1-r)),[t[0],r*100,i*100]};Ee.hcg.rgb=function(t){var n=t[0]/360,e=t[1]/100,r=t[2]/100;if(e===0)return[r*255,r*255,r*255];var i=[0,0,0],o=n%1*6,a=o%1,s=1-a,u=0;switch(Math.floor(o)){case 0:i[0]=1,i[1]=a,i[2]=0;break;case 1:i[0]=s,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=a;break;case 3:i[0]=0,i[1]=s,i[2]=1;break;case 4:i[0]=a,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=s}return u=(1-e)*r,[(e*i[0]+u)*255,(e*i[1]+u)*255,(e*i[2]+u)*255]};Ee.hcg.hsv=function(t){var n=t[1]/100,e=t[2]/100,r=n+e*(1-n),i=0;return r>0&&(i=n/r),[t[0],i*100,r*100]};Ee.hcg.hsl=function(t){var n=t[1]/100,e=t[2]/100,r=e*(1-n)+.5*n,i=0;return r>0&&r<.5?i=n/(2*r):r>=.5&&r<1&&(i=n/(2*(1-r))),[t[0],i*100,r*100]};Ee.hcg.hwb=function(t){var n=t[1]/100,e=t[2]/100,r=n+e*(1-n);return[t[0],(r-n)*100,(1-r)*100]};Ee.hwb.hcg=function(t){var n=t[1]/100,e=t[2]/100,r=1-e,i=r-n,o=0;return i<1&&(o=(r-i)/(1-i)),[t[0],i*100,o*100]};Ee.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]};Ee.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]};Ee.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]};Ee.gray.hsl=Ee.gray.hsv=function(t){return[0,0,t[0]]};Ee.gray.hwb=function(t){return[0,100,t[0]]};Ee.gray.cmyk=function(t){return[0,0,0,t[0]]};Ee.gray.lab=function(t){return[t[0],0,0]};Ee.gray.hex=function(t){var n=Math.round(t[0]/100*255)&255,e=(n<<16)+(n<<8)+n,r=e.toString(16).toUpperCase();return"000000".substring(r.length)+r};Ee.rgb.gray=function(t){var n=(t[0]+t[1]+t[2])/3;return[n/255*100]};var I3=A3.exports,Nd=I3;function bV(){for(var t={},n=Object.keys(Nd),e=n.length,r=0;r<e;r++)t[n[r]]={distance:-1,parent:null};return t}function xV(t){var n=bV(),e=[t];for(n[t].distance=0;e.length;)for(var r=e.pop(),i=Object.keys(Nd[r]),o=i.length,a=0;a<o;a++){var s=i[a],u=n[s];u.distance===-1&&(u.distance=n[r].distance+1,u.parent=r,e.unshift(s))}return n}function wV(t,n){return function(e){return n(t(e))}}function EV(t,n){for(var e=[n[t].parent,t],r=Nd[n[t].parent][t],i=n[t].parent;n[i].parent;)e.unshift(n[i].parent),r=wV(Nd[n[i].parent][i],r),i=n[i].parent;return r.conversion=e,r}var MV=function(t){for(var n=xV(t),e={},r=Object.keys(n),i=r.length,o=0;o<i;o++){var a=r[o],s=n[a];s.parent!==null&&(e[a]=EV(a,n))}return e},hm=I3,SV=MV,pu={},_V=Object.keys(hm);function kV(t){var n=function(e){return e==null?e:(arguments.length>1&&(e=Array.prototype.slice.call(arguments)),t(e))};return"conversion"in t&&(n.conversion=t.conversion),n}function AV(t){var n=function(e){if(e==null)return e;arguments.length>1&&(e=Array.prototype.slice.call(arguments));var r=t(e);if(typeof r=="object")for(var i=r.length,o=0;o<i;o++)r[o]=Math.round(r[o]);return r};return"conversion"in t&&(n.conversion=t.conversion),n}_V.forEach(function(t){pu[t]={},Object.defineProperty(pu[t],"channels",{value:hm[t].channels}),Object.defineProperty(pu[t],"labels",{value:hm[t].labels});var n=SV(t),e=Object.keys(n);e.forEach(function(r){var i=n[r];pu[t][r]=AV(i),pu[t][r].raw=kV(i)})});var CV=pu,Vc=pV,Zr=CV,t1=[].slice,T3=["keyword","gray","hex"],fm={};Object.keys(Zr).forEach(function(t){fm[t1.call(Zr[t].labels).sort().join("")]=t});var Dd={};function Er(t,n){if(!(this instanceof Er))return new Er(t,n);if(n&&n in T3&&(n=null),n&&!(n in Zr))throw new Error("Unknown model: "+n);var e,r;if(t==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof Er)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if(typeof t=="string"){var i=Vc.get(t);if(i===null)throw new Error("Unable to parse color from string: "+t);this.model=i.model,r=Zr[this.model].channels,this.color=i.value.slice(0,r),this.valpha=typeof i.value[r]=="number"?i.value[r]:1}else if(t.length){this.model=n||"rgb",r=Zr[this.model].channels;var o=t1.call(t,0,r);this.color=dm(o,r),this.valpha=typeof t[r]=="number"?t[r]:1}else if(typeof t=="number")t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,t&255],this.valpha=1;else{this.valpha=1;var a=Object.keys(t);"alpha"in t&&(a.splice(a.indexOf("alpha"),1),this.valpha=typeof t.alpha=="number"?t.alpha:0);var s=a.sort().join("");if(!(s in fm))throw new Error("Unable to parse color from object: "+JSON.stringify(t));this.model=fm[s];var u=Zr[this.model].labels,c=[];for(e=0;e<u.length;e++)c.push(t[u[e]]);this.color=dm(c)}if(Dd[this.model])for(r=Zr[this.model].channels,e=0;e<r;e++){var l=Dd[this.model][e];l&&(this.color[e]=l(this.color[e]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}Er.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var n=this.model in Vc.to?this:this.rgb();n=n.round(typeof t=="number"?t:1);var e=n.valpha===1?n.color:n.color.concat(this.valpha);return Vc.to[n.model](e)},percentString:function(t){var n=this.rgb().round(typeof t=="number"?t:1),e=n.valpha===1?n.color:n.color.concat(this.valpha);return Vc.to.rgb.percent(e)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},n=Zr[this.model].channels,e=Zr[this.model].labels,r=0;r<n;r++)t[e[r]]=this.color[r];return this.valpha!==1&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,this.valpha!==1&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,this.valpha!==1&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new Er(this.color.map(TV(t)).concat(this.valpha),this.model)},alpha:function(t){return arguments.length?new Er(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:zn("rgb",0,nr(255)),green:zn("rgb",1,nr(255)),blue:zn("rgb",2,nr(255)),hue:zn(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:zn("hsl",1,nr(100)),lightness:zn("hsl",2,nr(100)),saturationv:zn("hsv",1,nr(100)),value:zn("hsv",2,nr(100)),chroma:zn("hcg",1,nr(100)),gray:zn("hcg",2,nr(100)),white:zn("hwb",1,nr(100)),wblack:zn("hwb",2,nr(100)),cyan:zn("cmyk",0,nr(100)),magenta:zn("cmyk",1,nr(100)),yellow:zn("cmyk",2,nr(100)),black:zn("cmyk",3,nr(100)),x:zn("xyz",0,nr(100)),y:zn("xyz",1,nr(100)),z:zn("xyz",2,nr(100)),l:zn("lab",0,nr(100)),a:zn("lab",1),b:zn("lab",2),keyword:function(t){return arguments.length?new Er(t):Zr[this.model].keyword(this.color)},hex:function(t){return arguments.length?new Er(t):Vc.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255},luminosity:function(){for(var t=this.rgb().color,n=[],e=0;e<t.length;e++){var r=t[e]/255;n[e]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return .2126*n[0]+.7152*n[1]+.0722*n[2]},contrast:function(t){var n=this.luminosity(),e=t.luminosity();return n>e?(n+.05)/(e+.05):(e+.05)/(n+.05)},level:function(t){var n=this.contrast(t);return n>=7.1?"AAA":n>=4.5?"AA":""},isDark:function(){var t=this.rgb().color,n=(t[0]*299+t[1]*587+t[2]*114)/1e3;return n<128},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),n=0;n<3;n++)t.color[n]=255-t.color[n];return t},lighten:function(t){var n=this.hsl();return n.color[2]+=n.color[2]*t,n},darken:function(t){var n=this.hsl();return n.color[2]-=n.color[2]*t,n},saturate:function(t){var n=this.hsl();return n.color[1]+=n.color[1]*t,n},desaturate:function(t){var n=this.hsl();return n.color[1]-=n.color[1]*t,n},whiten:function(t){var n=this.hwb();return n.color[1]+=n.color[1]*t,n},blacken:function(t){var n=this.hwb();return n.color[2]+=n.color[2]*t,n},grayscale:function(){var t=this.rgb().color,n=t[0]*.3+t[1]*.59+t[2]*.11;return Er.rgb(n,n,n)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var n=this.hsl(),e=n.color[0];return e=(e+t)%360,e=e<0?360+e:e,n.color[0]=e,n},mix:function(t,n){if(!t||!t.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof t);var e=t.rgb(),r=this.rgb(),i=n===void 0?.5:n,o=2*i-1,a=e.alpha()-r.alpha(),s=((o*a===-1?o:(o+a)/(1+o*a))+1)/2,u=1-s;return Er.rgb(s*e.red()+u*r.red(),s*e.green()+u*r.green(),s*e.blue()+u*r.blue(),e.alpha()*i+r.alpha()*(1-i))}};Object.keys(Zr).forEach(function(t){if(T3.indexOf(t)===-1){var n=Zr[t].channels;Er.prototype[t]=function(){if(this.model===t)return new Er(this);if(arguments.length)return new Er(arguments,t);var e=typeof arguments[n]=="number"?n:this.valpha;return new Er(OV(Zr[this.model][t].raw(this.color)).concat(e),t)},Er[t]=function(e){return typeof e=="number"&&(e=dm(t1.call(arguments),n)),new Er(e,t)}}});function IV(t,n){return Number(t.toFixed(n))}function TV(t){return function(n){return IV(n,t)}}function zn(t,n,e){return t=Array.isArray(t)?t:[t],t.forEach(function(r){(Dd[r]||(Dd[r]=[]))[n]=e}),t=t[0],function(r){var i;return arguments.length?(e&&(r=e(r)),i=this[t](),i.color[n]=r,i):(i=this[t]().color[n],e&&(i=e(i)),i)}}function nr(t){return function(n){return Math.max(0,Math.min(t,n))}}function OV(t){return Array.isArray(t)?t:[t]}function dm(t,n){for(var e=0;e<n;e++)typeof t[e]!="number"&&(t[e]=0);return t}var NV=Er;const el=bo(NV);function Pd(t){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Pd(t)}var DV=/^\s+/,PV=/\s+$/;function Me(t,n){if(t=t||"",n=n||{},t instanceof Me)return t;if(!(this instanceof Me))return new Me(t,n);var e=LV(t);this._originalInput=t,this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a,this._roundA=Math.round(100*this._a)/100,this._format=n.format||e.format,this._gradientType=n.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=e.ok}Me.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},getLuminance:function(){var t=this.toRgb(),n,e,r,i,o,a;return n=t.r/255,e=t.g/255,r=t.b/255,n<=.03928?i=n/12.92:i=Math.pow((n+.055)/1.055,2.4),e<=.03928?o=e/12.92:o=Math.pow((e+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),.2126*i+.7152*o+.0722*a},setAlpha:function(t){return this._a=O3(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=wE(this._r,this._g,this._b);return{h:t.h*360,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=wE(this._r,this._g,this._b),n=Math.round(t.h*360),e=Math.round(t.s*100),r=Math.round(t.v*100);return this._a==1?"hsv("+n+", "+e+"%, "+r+"%)":"hsva("+n+", "+e+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var t=xE(this._r,this._g,this._b);return{h:t.h*360,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=xE(this._r,this._g,this._b),n=Math.round(t.h*360),e=Math.round(t.s*100),r=Math.round(t.l*100);return this._a==1?"hsl("+n+", "+e+"%, "+r+"%)":"hsla("+n+", "+e+"%, "+r+"%, "+this._roundA+")"},toHex:function(t){return EE(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return BV(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Tn(this._r,255)*100)+"%",g:Math.round(Tn(this._g,255)*100)+"%",b:Math.round(Tn(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Tn(this._r,255)*100)+"%, "+Math.round(Tn(this._g,255)*100)+"%, "+Math.round(Tn(this._b,255)*100)+"%)":"rgba("+Math.round(Tn(this._r,255)*100)+"%, "+Math.round(Tn(this._g,255)*100)+"%, "+Math.round(Tn(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:QV[EE(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var n="#"+ME(this._r,this._g,this._b,this._a),e=n,r=this._gradientType?"GradientType = 1, ":"";if(t){var i=Me(t);e="#"+ME(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+n+",endColorstr="+e+")"},toString:function(t){var n=!!t;t=t||this._format;var e=!1,r=this._a<1&&this._a>=0,i=!n&&r&&(t==="hex"||t==="hex6"||t==="hex3"||t==="hex4"||t==="hex8"||t==="name");return i?t==="name"&&this._a===0?this.toName():this.toRgbString():(t==="rgb"&&(e=this.toRgbString()),t==="prgb"&&(e=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(e=this.toHexString()),t==="hex3"&&(e=this.toHexString(!0)),t==="hex4"&&(e=this.toHex8String(!0)),t==="hex8"&&(e=this.toHex8String()),t==="name"&&(e=this.toName()),t==="hsl"&&(e=this.toHslString()),t==="hsv"&&(e=this.toHsvString()),e||this.toHexString())},clone:function(){return Me(this.toString())},_applyModification:function(t,n){var e=t.apply(null,[this].concat([].slice.call(n)));return this._r=e._r,this._g=e._g,this._b=e._b,this.setAlpha(e._a),this},lighten:function(){return this._applyModification(YV,arguments)},brighten:function(){return this._applyModification(VV,arguments)},darken:function(){return this._applyModification(WV,arguments)},desaturate:function(){return this._applyModification(zV,arguments)},saturate:function(){return this._applyModification(GV,arguments)},greyscale:function(){return this._applyModification(UV,arguments)},spin:function(){return this._applyModification(XV,arguments)},_applyCombination:function(t,n){return t.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(ZV,arguments)},complement:function(){return this._applyCombination(HV,arguments)},monochromatic:function(){return this._applyCombination(KV,arguments)},splitcomplement:function(){return this._applyCombination(qV,arguments)},triad:function(){return this._applyCombination(SE,[3])},tetrad:function(){return this._applyCombination(SE,[4])}};Me.fromRatio=function(t,n){if(Pd(t)=="object"){var e={};for(var r in t)t.hasOwnProperty(r)&&(r==="a"?e[r]=t[r]:e[r]=Wc(t[r]));t=e}return Me(t,n)};function LV(t){var n={r:0,g:0,b:0},e=1,r=null,i=null,o=null,a=!1,s=!1;return typeof t=="string"&&(t=eW(t)),Pd(t)=="object"&&(Do(t.r)&&Do(t.g)&&Do(t.b)?(n=jV(t.r,t.g,t.b),a=!0,s=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Do(t.h)&&Do(t.s)&&Do(t.v)?(r=Wc(t.s),i=Wc(t.v),n=FV(t.h,r,i),a=!0,s="hsv"):Do(t.h)&&Do(t.s)&&Do(t.l)&&(r=Wc(t.s),o=Wc(t.l),n=RV(t.h,r,o),a=!0,s="hsl"),t.hasOwnProperty("a")&&(e=t.a)),e=O3(e),{ok:a,format:t.format||s,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:e}}function jV(t,n,e){return{r:Tn(t,255)*255,g:Tn(n,255)*255,b:Tn(e,255)*255}}function xE(t,n,e){t=Tn(t,255),n=Tn(n,255),e=Tn(e,255);var r=Math.max(t,n,e),i=Math.min(t,n,e),o,a,s=(r+i)/2;if(r==i)o=a=0;else{var u=r-i;switch(a=s>.5?u/(2-r-i):u/(r+i),r){case t:o=(n-e)/u+(n<e?6:0);break;case n:o=(e-t)/u+2;break;case e:o=(t-n)/u+4;break}o/=6}return{h:o,s:a,l:s}}function RV(t,n,e){var r,i,o;t=Tn(t,360),n=Tn(n,100),e=Tn(e,100);function a(c,l,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?c+(l-c)*6*h:h<1/2?l:h<2/3?c+(l-c)*(2/3-h)*6:c}if(n===0)r=i=o=e;else{var s=e<.5?e*(1+n):e+n-e*n,u=2*e-s;r=a(u,s,t+1/3),i=a(u,s,t),o=a(u,s,t-1/3)}return{r:r*255,g:i*255,b:o*255}}function wE(t,n,e){t=Tn(t,255),n=Tn(n,255),e=Tn(e,255);var r=Math.max(t,n,e),i=Math.min(t,n,e),o,a,s=r,u=r-i;if(a=r===0?0:u/r,r==i)o=0;else{switch(r){case t:o=(n-e)/u+(n<e?6:0);break;case n:o=(e-t)/u+2;break;case e:o=(t-n)/u+4;break}o/=6}return{h:o,s:a,v:s}}function FV(t,n,e){t=Tn(t,360)*6,n=Tn(n,100),e=Tn(e,100);var r=Math.floor(t),i=t-r,o=e*(1-n),a=e*(1-i*n),s=e*(1-(1-i)*n),u=r%6,c=[e,a,o,o,s,e][u],l=[s,e,e,a,o,o][u],h=[o,o,s,e,e,a][u];return{r:c*255,g:l*255,b:h*255}}function EE(t,n,e,r){var i=[Ni(Math.round(t).toString(16)),Ni(Math.round(n).toString(16)),Ni(Math.round(e).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function BV(t,n,e,r,i){var o=[Ni(Math.round(t).toString(16)),Ni(Math.round(n).toString(16)),Ni(Math.round(e).toString(16)),Ni(N3(r))];return i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function ME(t,n,e,r){var i=[Ni(N3(r)),Ni(Math.round(t).toString(16)),Ni(Math.round(n).toString(16)),Ni(Math.round(e).toString(16))];return i.join("")}Me.equals=function(t,n){return!t||!n?!1:Me(t).toRgbString()==Me(n).toRgbString()};Me.random=function(){return Me.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function zV(t,n){n=n===0?0:n||10;var e=Me(t).toHsl();return e.s-=n/100,e.s=Ip(e.s),Me(e)}function GV(t,n){n=n===0?0:n||10;var e=Me(t).toHsl();return e.s+=n/100,e.s=Ip(e.s),Me(e)}function UV(t){return Me(t).desaturate(100)}function YV(t,n){n=n===0?0:n||10;var e=Me(t).toHsl();return e.l+=n/100,e.l=Ip(e.l),Me(e)}function VV(t,n){n=n===0?0:n||10;var e=Me(t).toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(255*-(n/100)))),e.g=Math.max(0,Math.min(255,e.g-Math.round(255*-(n/100)))),e.b=Math.max(0,Math.min(255,e.b-Math.round(255*-(n/100)))),Me(e)}function WV(t,n){n=n===0?0:n||10;var e=Me(t).toHsl();return e.l-=n/100,e.l=Ip(e.l),Me(e)}function XV(t,n){var e=Me(t).toHsl(),r=(e.h+n)%360;return e.h=r<0?360+r:r,Me(e)}function HV(t){var n=Me(t).toHsl();return n.h=(n.h+180)%360,Me(n)}function SE(t,n){if(isNaN(n)||n<=0)throw new Error("Argument to polyad must be a positive number");for(var e=Me(t).toHsl(),r=[Me(t)],i=360/n,o=1;o<n;o++)r.push(Me({h:(e.h+o*i)%360,s:e.s,l:e.l}));return r}function qV(t){var n=Me(t).toHsl(),e=n.h;return[Me(t),Me({h:(e+72)%360,s:n.s,l:n.l}),Me({h:(e+216)%360,s:n.s,l:n.l})]}function ZV(t,n,e){n=n||6,e=e||30;var r=Me(t).toHsl(),i=360/e,o=[Me(t)];for(r.h=(r.h-(i*n>>1)+720)%360;--n;)r.h=(r.h+i)%360,o.push(Me(r));return o}function KV(t,n){n=n||6;for(var e=Me(t).toHsv(),r=e.h,i=e.s,o=e.v,a=[],s=1/n;n--;)a.push(Me({h:r,s:i,v:o})),o=(o+s)%1;return a}Me.mix=function(t,n,e){e=e===0?0:e||50;var r=Me(t).toRgb(),i=Me(n).toRgb(),o=e/100,a={r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a};return Me(a)};Me.readability=function(t,n){var e=Me(t),r=Me(n);return(Math.max(e.getLuminance(),r.getLuminance())+.05)/(Math.min(e.getLuminance(),r.getLuminance())+.05)};Me.isReadable=function(t,n,e){var r=Me.readability(t,n),i,o;switch(o=!1,i=nW(e),i.level+i.size){case"AAsmall":case"AAAlarge":o=r>=4.5;break;case"AAlarge":o=r>=3;break;case"AAAsmall":o=r>=7;break}return o};Me.mostReadable=function(t,n,e){var r=null,i=0,o,a,s,u;e=e||{},a=e.includeFallbackColors,s=e.level,u=e.size;for(var c=0;c<n.length;c++)o=Me.readability(t,n[c]),o>i&&(i=o,r=Me(n[c]));return Me.isReadable(t,r,{level:s,size:u})||!a?r:(e.includeFallbackColors=!1,Me.mostReadable(t,["#fff","#000"],e))};var pm=Me.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},QV=Me.hexNames=JV(pm);function JV(t){var n={};for(var e in t)t.hasOwnProperty(e)&&(n[t[e]]=e);return n}function O3(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Tn(t,n){$V(t)&&(t="100%");var e=tW(t);return t=Math.min(n,Math.max(0,parseFloat(t))),e&&(t=parseInt(t*n,10)/100),Math.abs(t-n)<1e-6?1:t%n/parseFloat(n)}function Ip(t){return Math.min(1,Math.max(0,t))}function Xr(t){return parseInt(t,16)}function $V(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function tW(t){return typeof t=="string"&&t.indexOf("%")!=-1}function Ni(t){return t.length==1?"0"+t:""+t}function Wc(t){return t<=1&&(t=t*100+"%"),t}function N3(t){return Math.round(parseFloat(t)*255).toString(16)}function _E(t){return Xr(t)/255}var _i=function(){var t="[-\\+]?\\d+%?",n="[-\\+]?\\d*\\.\\d+%?",e="(?:"+n+")|(?:"+t+")",r="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",i="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Do(t){return!!_i.CSS_UNIT.exec(t)}function eW(t){t=t.replace(DV,"").replace(PV,"").toLowerCase();var n=!1;if(pm[t])t=pm[t],n=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var e;return(e=_i.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=_i.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=_i.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=_i.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=_i.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=_i.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=_i.hex8.exec(t))?{r:Xr(e[1]),g:Xr(e[2]),b:Xr(e[3]),a:_E(e[4]),format:n?"name":"hex8"}:(e=_i.hex6.exec(t))?{r:Xr(e[1]),g:Xr(e[2]),b:Xr(e[3]),format:n?"name":"hex"}:(e=_i.hex4.exec(t))?{r:Xr(e[1]+""+e[1]),g:Xr(e[2]+""+e[2]),b:Xr(e[3]+""+e[3]),a:_E(e[4]+""+e[4]),format:n?"name":"hex8"}:(e=_i.hex3.exec(t))?{r:Xr(e[1]+""+e[1]),g:Xr(e[2]+""+e[2]),b:Xr(e[3]+""+e[3]),format:n?"name":"hex"}:!1}function nW(t){var n,e;return t=t||{level:"AA",size:"small"},n=(t.level||"AA").toUpperCase(),e=(t.size||"small").toLowerCase(),n!=="AA"&&n!=="AAA"&&(n="AA"),e!=="small"&&e!=="large"&&(e="small"),{level:n,size:e}}var yf=2,kE=.16,rW=.05,iW=.05,oW=.15,D3=5,P3=4,aW=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function AE(t,n,e){var r;return Math.round(t.h)>=60&&Math.round(t.h)<=240?r=e?Math.round(t.h)-yf*n:Math.round(t.h)+yf*n:r=e?Math.round(t.h)+yf*n:Math.round(t.h)-yf*n,r<0?r+=360:r>=360&&(r-=360),r}function CE(t,n,e){if(t.h===0&&t.s===0)return t.s;var r;return e?r=t.s-kE*n:n===P3?r=t.s+kE:r=t.s+rW*n,r>1&&(r=1),e&&n===D3&&r>.1&&(r=.1),r<.06&&(r=.06),Number(r.toFixed(2))}function IE(t,n,e){var r;return e?r=t.v+iW*n:r=t.v-oW*n,r>1&&(r=1),Number(r.toFixed(2))}function Ld(t){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=[],r=Me(t),i=D3;i>0;i-=1){var o=r.toHsv(),a=Me({h:AE(o,i,!0),s:CE(o,i,!0),v:IE(o,i,!0)}).toHexString();e.push(a)}e.push(r.toHexString());for(var s=1;s<=P3;s+=1){var u=r.toHsv(),c=Me({h:AE(u,s),s:CE(u,s),v:IE(u,s)}).toHexString();e.push(c)}return n.theme==="dark"?aW.map(function(l){var h=l.index,f=l.opacity,d=Me.mix(n.backgroundColor||"#141414",e[h],f*100).toHexString();return d}):e}var j0={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},R0={},F0={};Object.keys(j0).forEach(function(t){R0[t]=Ld(j0[t]),R0[t].primary=R0[t][5],F0[t]=Ld(j0[t],{theme:"dark",backgroundColor:"#141414"}),F0[t].primary=F0[t][5]});var ir=function(t,n,e){var r=el(t),i=el(n);return el([(1-e)*r.red()+e*i.red(),(1-e)*r.green()+e*i.green(),(1-e)*r.blue()+e*i.blue()]).rgb()},sW=function(t,n,e){n===void 0&&(n="#fff"),e===void 0&&(e="rgb(150, 150, 150)");var r=ir(n,t,.05).rgb().toString(),i=ir(n,t,.1).rgb().toString(),o=ir(n,t,.2).rgb().toString(),a=ir(n,t,.4).rgb().toString(),s=ir(n,e,.02).rgb().toString(),u=ir(n,e,.05).rgb().toString(),c=ir(n,e,.1).rgb().toString(),l=ir(n,e,.2).rgb().toString(),h=ir(n,e,.3).rgb().toString(),f=Ld(t,{theme:"default",backgroundColor:n}),d=el(t).hex().toLowerCase(),p=f.indexOf(d),g=t;return p!==-1&&(g=f[p+1]),{mainStroke:t,mainFill:i,activeStroke:t,activeFill:r,inactiveStroke:a,inactiveFill:r,selectedStroke:t,selectedFill:n,highlightStroke:g,highlightFill:o,disableStroke:h,disableFill:u,edgeMainStroke:h,edgeActiveStroke:t,edgeInactiveStroke:l,edgeSelectedStroke:t,edgeHighlightStroke:t,edgeDisableStroke:c,comboMainStroke:h,comboMainFill:s,comboActiveStroke:t,comboActiveFill:r,comboInactiveStroke:h,comboInactiveFill:s,comboSelectedStroke:t,comboSelectedFill:s,comboHighlightStroke:g,comboHighlightFill:s,comboDisableStroke:l,comboDisableFill:u}},uW=function(t,n,e){n===void 0&&(n="#fff"),e===void 0&&(e="#777");var r=ir(n,t,.2).rgb().toString(),i=ir(n,t,.3).rgb().toString(),o=ir(n,t,.6).rgb().toString(),a=ir(n,t,.8).rgb().toString(),s=ir(n,e,.2).rgb().toString(),u=ir(n,e,.25).rgb().toString(),c=ir(n,e,.3).rgb().toString(),l=ir(n,e,.4).rgb().toString(),h=ir(n,e,.5).rgb().toString(),f=Ld(t,{theme:"dark",backgroundColor:n}),d=el(t).hex().toLowerCase(),p=f.indexOf(d),g=t;return p!==-1&&(g=f[p+1]),{mainStroke:a,mainFill:r,activeStroke:t,activeFill:i,inactiveStroke:a,inactiveFill:r,selectedStroke:t,selectedFill:r,highlightStroke:t,highlightFill:o,disableStroke:h,disableFill:u,edgeMainStroke:e,edgeActiveStroke:t,edgeInactiveStroke:e,edgeSelectedStroke:t,edgeHighlightStroke:t,edgeDisableStroke:c,comboMainStroke:l,comboMainFill:u,comboActiveStroke:t,comboActiveFill:s,comboInactiveStroke:l,comboInactiveFill:u,comboSelectedStroke:t,comboSelectedFill:s,comboHighlightStroke:g,comboHighlightFill:u,comboDisableStroke:l,comboDisableFill:s}},e1=function(t,n,e,r){return n===void 0&&(n="#fff"),e===void 0&&(e="default"),e==="default"?sW(t,n,"rgb(150, 150, 150)"):uW(t,n,"#777")},cW=function(t,n,e,r){n===void 0&&(n="#fff"),e===void 0&&(e="default");var i=[];return t.forEach(function(o){i.push(e1(o,n,e))}),i};const lW=Object.freeze(Object.defineProperty({__proto__:null,getColorSetsBySubjectColors:cW,getColorsWithSubjectColor:e1,mixColor:ir},Symbol.toStringTag,{value:"Module"}));var hW="rgb(95, 149, 255)",fW="rgb(255, 255, 255)",TE="rgb(0, 0, 0)",nn=e1(hW,fW);const nl={version:"0.8.20",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",comboContainerClassName:"combo-container",delegateContainerClassName:"delegate-container",defaultLoopPosition:"top",nodeLabel:{style:{fill:"#000",fontSize:12,textAlign:"center",textBaseline:"middle"},offset:4},defaultNode:{type:"circle",style:{lineWidth:1,stroke:nn.mainStroke,fill:nn.mainFill},size:20,color:nn.mainStroke,linkPoints:{size:8,lineWidth:1,fill:nn.activeFill,stroke:nn.activeStroke}},nodeStateStyles:{active:{fill:nn.activeFill,stroke:nn.activeStroke,lineWidth:2,shadowColor:nn.mainStroke,shadowBlur:10},selected:{fill:nn.selectedFill,stroke:nn.selectedStroke,lineWidth:4,shadowColor:nn.selectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{fill:nn.highlightFill,stroke:nn.highlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{fill:nn.inactiveFill,stroke:nn.inactiveStroke,lineWidth:1},disable:{fill:nn.disableFill,stroke:nn.disableStroke,lineWidth:1}},edgeLabel:{style:{fill:TE,textAlign:"center",textBaseline:"middle",fontSize:12}},defaultEdge:{type:"line",size:1,style:{stroke:nn.edgeMainStroke,lineAppendWidth:2},color:nn.edgeMainStroke},edgeStateStyles:{active:{stroke:nn.edgeActiveStroke,lineWidth:1},selected:{stroke:nn.edgeSelectedStroke,lineWidth:2,shadowColor:nn.edgeSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:nn.edgeHighlightStroke,lineWidth:2,"text-shape":{fontWeight:500}},inactive:{stroke:nn.edgeInactiveStroke,lineWidth:1},disable:{stroke:nn.edgeDisableStroke,lineWidth:1}},comboLabel:{style:{fill:TE,textBaseline:"middle",fontSize:12},refY:10,refX:10},defaultCombo:{type:"circle",style:{fill:nn.comboMainFill,lineWidth:1,stroke:nn.comboMainStroke,r:5,width:20,height:10},size:[20,5],color:nn.comboMainStroke,padding:[25,20,15,20]},comboStateStyles:{active:{stroke:nn.comboActiveStroke,lineWidth:1,fill:nn.comboActiveFill},selected:{stroke:nn.comboSelectedStroke,lineWidth:2,fill:nn.comboSelectedFill,shadowColor:nn.comboSelectedStroke,shadowBlur:10,"text-shape":{fontWeight:500}},highlight:{stroke:nn.comboHighlightStroke,lineWidth:2,fill:nn.comboHighlightFill,"text-shape":{fontWeight:500}},inactive:{stroke:nn.comboInactiveStroke,fill:nn.comboInactiveFill,lineWidth:1},disable:{stroke:nn.comboDisableStroke,fill:nn.comboDisableFill,lineWidth:1}},delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},textWaterMarkerConfig:{width:150,height:100,compatible:!1,text:{x:0,y:60,lineHeight:20,rotate:20,fontSize:14,fontFamily:"Microsoft YaHei",fill:"rgba(0, 0, 0, 0.1)",baseline:"Middle"}},imageWaterMarkerConfig:{width:150,height:130,compatible:!1,image:{x:0,y:0,width:30,height:20,rotate:0}},waterMarkerImage:"https://gw.alipayobjects.com/os/s/prod/antv/assets/image/logo-with-text-73b8a.svg"};function bf(t,n,e){if(t){if(typeof t.addEventListener=="function")return t.addEventListener(n,e,!1),{remove:function(){t.removeEventListener(n,e,!1)}};if(typeof t.attachEvent=="function")return t.attachEvent("on"+n,e),{remove:function(){t.detachEvent("on"+n,e)}}}}var Xc,B0,L3,gm;function dW(){Xc=document.createElement("table"),B0=document.createElement("tr"),L3=/^\s*<(\w+|!)[^>]*>/,gm={tr:document.createElement("tbody"),tbody:Xc,thead:Xc,tfoot:Xc,td:B0,th:B0,"*":document.createElement("div")}}function Mn(t){Xc||dW();var n=L3.test(t)&&RegExp.$1;(!n||!(n in gm))&&(n="*");var e=gm[n];t=typeof t=="string"?t.replace(/(^\s*)|(\s*$)/g,""):t,e.innerHTML=""+t;var r=e.childNodes[0];return r&&e.contains(r)&&e.removeChild(r),r}function Ve(t,n){if(t)for(var e in n)n.hasOwnProperty(e)&&(t.style[e]=n[e]);return t}var pW=Cr.cloneEvent,gW=Cr.isViewportChanged,vW=function(t){Te(n,t);function n(e){var r=t.call(this,e)||this;return r.extendEvents=[],r.dragging=!1,r.mousedown=!1,r.preItem=null,r.destroy(),r.graph=e,r.destroyed=!1,r.initEvents(),r}return n.prototype.initEvents=function(){var e=this,r=e.graph,i=e.extendEvents,o=i===void 0?[]:i,a=r.get("canvas"),s=a.get("el"),u=fs(this,"onCanvasEvents"),c=fs(this,"onExtendEvents"),l=fs(this,"onWheelEvent");a.off("*").on("*",u),this.canvasHandler=u,o.push(bf(s,"wheel",l)),typeof window<"u"&&(o.push(bf(window,"keydown",c)),o.push(bf(window,"keyup",c)),o.push(bf(window,"focus",c))),this.resetHandler&&r.off("afterchangedata",this.resetHandler),this.resetHandler=fs(this,"resetStatus"),r.on("afterchangedata",this.resetHandler)},n.getItemRoot=function(e){for(;e&&!e.get("item");)e=e.get("parent");return e},n.prototype.onCanvasEvents=function(e){var r=this,i=this.graph,o=i.get("canvas"),a=e.target,s=e.type;switch(s){case"drag":this.onCanvasEvents(Object.assign({},e,{type:"mousemove"}));break;case"dragend":this.onCanvasEvents(Object.assign({},e,{type:"mouseup"}));break;case"mousedown":this.mousedown=!0;break;case"dragend":case"mouseup":setTimeout(function(){return r.mousedown=!1});break;case"click":if(!this.mousedown)return;break}e.canvasX=e.x,e.canvasY=e.y;var u={x:e.canvasX,y:e.canvasY},c=i.get("group"),l=c.getMatrix();if(l||(l=[1,0,0,0,1,0,0,0,1]),gW(l)&&(u=i.getPointByClient(e.clientX,e.clientY)),e.x=u.x,e.y=u.y,e.currentTarget=i,a===o){(s==="mousemove"||s==="mouseleave")&&this.handleMouseMove(e,"canvas"),e.target=o,e.item=null,i.emit(s,e),i.emit("canvas:".concat(s),e);return}var h=n.getItemRoot(a);if(!h){i.emit(s,e);return}var f=h.get("item");if(!f.destroyed){var d=f.getType();if(e.target=a,e.item=f,e.canvasX===e.x&&e.canvasY===e.y){var p=i.getCanvasByPoint(e.x,e.y);e.canvasX=p.x,e.canvasY=p.y}e.name&&!e.name.includes(":")?(i.emit("".concat(d,":").concat(s),e),i.emit(s,e)):e.name&&i.emit(e.name,e),s==="dragstart"&&(this.dragging=!0),s==="dragend"&&(this.dragging=!1),s==="mousemove"&&this.handleMouseMove(e,d)}},n.prototype.onExtendEvents=function(e){this.graph.emit(e.type,e)},n.prototype.onWheelEvent=function(e){fe(e.wheelDelta)&&(e.wheelDelta=-e.detail),this.graph.emit("wheel",e)},n.prototype.handleMouseMove=function(e,r){var i=this,o=i.graph,a=i.preItem,s=o.get("canvas"),u=e.target===s?null:e.item;e=pW(e),a&&a!==u&&!a.destroyed&&(e.item=a,this.emitCustomEvent(a.getType(),"mouseleave",e),this.dragging&&this.emitCustomEvent(a.getType(),"dragleave",e)),u&&a!==u&&(e.item=u,this.emitCustomEvent(r,"mouseenter",e),this.dragging&&this.emitCustomEvent(r,"dragenter",e)),this.preItem=u},n.prototype.emitCustomEvent=function(e,r,i){i.type=r,this.graph.emit("".concat(e,":").concat(r),i)},n.prototype.resetStatus=function(){this.mousedown=!1,this.dragging=!1,this.preItem=null},n.prototype.destroy=function(){var e=this,r=e.graph,i=e.canvasHandler,o=e.extendEvents,a=r.get("canvas");a.off("*",i),mt(o,function(s){s.remove()}),this.resetStatus(),this.extendEvents.length=0,this.canvasHandler=null,this.resetHandler=null,this.destroyed=!0},n}(OG),$e={},Ho={},Yn={};Object.defineProperty(Yn,"__esModule",{value:!0});Yn.Base=void 0;var mW=function(){function t(){this.nodes=[],this.edges=[],this.combos=[],this.comboEdges=[],this.hiddenNodes=[],this.hiddenEdges=[],this.hiddenCombos=[],this.vedges=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=function(){}}return t.prototype.layout=function(n){return this.init(n),this.execute(!0)},t.prototype.init=function(n){this.nodes=n.nodes||[],this.edges=n.edges||[],this.combos=n.combos||[],this.comboEdges=n.comboEdges||[],this.hiddenNodes=n.hiddenNodes||[],this.hiddenEdges=n.hiddenEdges||[],this.hiddenCombos=n.hiddenCombos||[],this.vedges=n.vedges||[]},t.prototype.execute=function(n){},t.prototype.executeWithWorker=function(){},t.prototype.getDefaultCfg=function(){return{}},t.prototype.updateCfg=function(n){n&&Object.assign(this,n)},t.prototype.getType=function(){return"base"},t.prototype.destroy=function(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0},t}();Yn.Base=mW;var OE={},zu={};Object.defineProperty(zu,"__esModule",{value:!0});zu.camelize=zu.isString=void 0;var yW=function(t){return typeof t=="string"};zu.isString=yW;var bW=function(t){var n=Object.create(null);return function(e){var r=n[e];return r||(n[e]=t(e))}},xW=/-(\w)/g;zu.camelize=bW(function(t){return t.replace(xW,function(n,e){return e?e.toUpperCase():""})});var Xl={};Object.defineProperty(Xl,"__esModule",{value:!0});Xl.isArray=void 0;Xl.isArray=Array.isArray;var Tp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.toNumber=t.isNaN=t.isNumber=void 0;var n=function(i){return typeof i=="number"};t.isNumber=n;var e=function(i){return Number.isNaN(Number(i))};t.isNaN=e;var r=function(i){var o=parseFloat(i);return(0,t.isNaN)(o)?i:o};t.toNumber=r})(Tp);var Op={},n1={};(function(t){var n=bt&&bt.__assign||function(){return n=Object.assign||function(i){for(var o,a=1,s=arguments.length;a<s;a++){o=arguments[a];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(i[u]=o[u])}return i},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.clone=t.isObject=void 0;var e=function(i){return i!==null&&typeof i=="object"};t.isObject=e;var r=function(i){if(i===null)return i;if(i instanceof Date)return new Date(i.getTime());if(i instanceof Array){var o=[];return i.forEach(function(s){o.push(s)}),o.map(function(s){return(0,t.clone)(s)})}if(typeof i=="object"&&Object.keys(i).length){var a=n({},i);return Object.keys(a).forEach(function(s){a[s]=(0,t.clone)(a[s])}),a}return i};t.clone=r})(n1);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getCoreNodeAndRelativeLeafNodes=t.getAvgNodePosition=t.getLayoutBBox=t.traverseTreeUp=t.scaleMatrix=t.getAdjMatrix=t.floydWarshall=t.getDegreeMap=t.getDegree=t.getEdgeTerminal=void 0;var n=Xl,e=Tp,r=n1,i=function(y,b){var x=y[b];return(0,r.isObject)(x)?x.cell:x};t.getEdgeTerminal=i;var o=function(y,b,x){for(var w=[],E=0;E<y;E++)w[E]={in:0,out:0,all:0};return x&&x.forEach(function(M){var _=(0,t.getEdgeTerminal)(M,"source"),k=(0,t.getEdgeTerminal)(M,"target");_&&w[b[_]]&&(w[b[_]].out+=1,w[b[_]].all+=1),k&&w[b[k]]&&(w[b[k]].in+=1,w[b[k]].all+=1)}),w};t.getDegree=o;var a=function(y,b){var x={};return y.forEach(function(w){x[w.id]={in:0,out:0,all:0}}),b&&b.forEach(function(w){var E=(0,t.getEdgeTerminal)(w,"source"),M=(0,t.getEdgeTerminal)(w,"target");E&&(x[E].out+=1,x[E].all+=1),M&&(x[M].in+=1,x[M].all+=1)}),x};t.getDegreeMap=a;var s=function(y){for(var b=[],x=y.length,w=0;w<x;w+=1){b[w]=[];for(var E=0;E<x;E+=1)w===E?b[w][E]=0:y[w][E]===0||!y[w][E]?b[w][E]=1/0:b[w][E]=y[w][E]}for(var M=0;M<x;M+=1)for(var w=0;w<x;w+=1)for(var E=0;E<x;E+=1)b[w][E]>b[w][M]+b[M][E]&&(b[w][E]=b[w][M]+b[M][E]);return b};t.floydWarshall=s;var u=function(y,b){var x=y.nodes,w=y.edges,E=[],M={};if(!x)throw new Error("invalid nodes data!");return x&&x.forEach(function(_,k){M[_.id]=k;var S=[];E.push(S)}),w==null||w.forEach(function(_){var k=(0,t.getEdgeTerminal)(_,"source"),S=(0,t.getEdgeTerminal)(_,"target"),A=M[k],C=M[S];A===void 0||C===void 0||(E[A][C]=1,b||(E[C][A]=1))}),E};t.getAdjMatrix=u;var c=function(y,b){var x=[];return y.forEach(function(w){var E=[];w.forEach(function(M){E.push(M*b)}),x.push(E)}),x};t.scaleMatrix=c;var l=function(y,b){if(y&&y.children){for(var x=y.children.length-1;x>=0;x--)if(!l(y.children[x],b))return}return!!b(y)},h=function(y,b){typeof b=="function"&&l(y,b)};t.traverseTreeUp=h;var f=function(y){var b=1/0,x=1/0,w=-1/0,E=-1/0;return y.forEach(function(M){var _=M.size;(0,n.isArray)(_)?_.length===1&&(_=[_[0],_[0]]):(0,e.isNumber)(_)?_=[_,_]:(_===void 0||isNaN(_))&&(_=[30,30]);var k=[_[0]/2,_[1]/2],S=M.x-k[0],A=M.x+k[0],C=M.y-k[1],I=M.y+k[1];b>S&&(b=S),x>C&&(x=C),w<A&&(w=A),E<I&&(E=I)}),{minX:b,minY:x,maxX:w,maxY:E}};t.getLayoutBBox=f;var d=function(y){var b={x:0,y:0};y.forEach(function(w){b.x+=w.x||0,b.y+=w.y||0});var x=y.length||1;return{x:b.x/x,y:b.y/x}};t.getAvgNodePosition=d;var p=function(y,b,x){var w,E;return y==="source"?((w=x==null?void 0:x.find(function(M){return M.target===b.id}))===null||w===void 0?void 0:w.source)||{}:((E=x==null?void 0:x.find(function(M){return M.source===b.id}))===null||E===void 0?void 0:E.target)||{}},g=function(y,b,x){var w=[];switch(y){case"source":w=x==null?void 0:x.filter(function(M){return M.source===b.id}).map(function(M){return M.target});break;case"target":w=x==null?void 0:x.filter(function(M){return M.target===b.id}).map(function(M){return M.source});break;case"both":w=x==null?void 0:x.filter(function(M){return M.source===b.id}).map(function(M){return M.target}).concat(x==null?void 0:x.filter(function(M){return M.target===b.id}).map(function(M){return M.source}));break}var E=new Set(w);return Array.from(E)},v=function(y,b,x,w,E){var M=x[b]||"",_=(w==null?void 0:w.filter(function(k){return k[b]===M}))||[];return y==="leaf"&&(_=_.filter(function(k){var S,A;return((S=E[k.id])===null||S===void 0?void 0:S.in)===0||((A=E[k.id])===null||A===void 0?void 0:A.out)===0})),_},m=function(y,b,x,w,E,M){var _=E[b.id],k=_.in,S=_.out,A=b,C=[];k===0?(A=p("source",b,x),C=g("both",A,x).map(function(N){return M[N]})):S===0&&(A=p("target",b,x),C=g("both",A,x).map(function(N){return M[N]})),C=C.filter(function(N){return E[N.id]&&(E[N.id].in===0||E[N.id].out===0)});var I=v(y,w,b,C,E);return{coreNode:A,relativeLeafNodes:C,sameTypeLeafNodes:I}};t.getCoreNodeAndRelativeLeafNodes=m})(Op);var NE={},DE;function wW(){return DE||(DE=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getFuncByUnknownType=t.getFunc=t.isFunction=void 0;var n=Ln(),e=Tp,r=function(a){return typeof a=="function"};t.isFunction=r;var i=function(a,s,u){var c;return u?c=u:(0,e.isNumber)(a)?c=function(){return a}:c=function(){return s},c};t.getFunc=i;var o=function(a,s,u){return u===void 0&&(u=!0),!s&&s!==0?function(c){return c.size?(0,n.isArray)(c.size)?c.size[0]>c.size[1]?c.size[0]:c.size[1]:(0,n.isObject)(c.size)?c.size.width>c.size.height?c.size.width:c.size.height:c.size:a}:(0,t.isFunction)(s)?s:(0,e.isNumber)(s)?function(){return s}:(0,n.isArray)(s)?function(){if(u){var c=Math.max.apply(Math,s);return isNaN(c)?a:c}return s}:(0,n.isObject)(s)?function(){if(u){var c=Math.max(s.width,s.height);return isNaN(c)?a:c}return[s.width,s.height]}:function(){return a}};t.getFuncByUnknownType=o}(NE)),NE}var PE;function Ln(){return PE||(PE=1,function(t){var n=bt&&bt.__createBinding||(Object.create?function(r,i,o,a){a===void 0&&(a=o);var s=Object.getOwnPropertyDescriptor(i,o);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(r,a,s)}:function(r,i,o,a){a===void 0&&(a=o),r[a]=i[o]}),e=bt&&bt.__exportStar||function(r,i){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&n(i,r,o)};Object.defineProperty(t,"__esModule",{value:!0}),e(zu,t),e(Xl,t),e(Tp,t),e(Op,t),e(n1,t),e(wW(),t)}(OE)),OE}var EW=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Ho,"__esModule",{value:!0});Ho.getLayoutByName=Ho.unRegisterLayout=Ho.registerLayout=void 0;var MW=Yn,SW=Ln(),wa=new Map,_W=function(t,n){if(wa.get(t)&&console.warn("The layout with the name ".concat(t," exists already, it will be overridden")),(0,SW.isObject)(n)){var e=function(r){EW(i,r);function i(o){var a=this,s;a=r.call(this)||this;var u=a,c={},l=Object.assign({},u.getDefaultCfg(),((s=n.getDefaultCfg)===null||s===void 0?void 0:s.call(n))||{});return Object.assign(c,l,n,o),Object.keys(c).forEach(function(h){var f=c[h];u[h]=f}),a}return i}(MW.Base);wa.set(t,e)}else wa.set(t,n);return wa.get(t)};Ho.registerLayout=_W;var kW=function(t){wa.has(t)&&wa.delete(t)};Ho.unRegisterLayout=kW;var AW=function(t){return wa.has(t)?wa.get(t):null};Ho.getLayoutByName=AW;var LE={},Hl={},CW=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Hl,"__esModule",{value:!0});Hl.GridLayout=void 0;var ru=Ln(),IW=Yn,TW=function(t){CW(n,t);function n(e){var r=t.call(this)||this;return r.begin=[0,0],r.preventOverlap=!0,r.preventOverlapPadding=10,r.condense=!1,r.sortBy="degree",r.nodes=[],r.edges=[],r.width=300,r.height=300,r.row=0,r.col=0,r.cellWidth=0,r.cellHeight=0,r.cellUsed={},r.id2manPos={},r.onLayoutEnd=function(){},r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}},n.prototype.execute=function(){var e=this,r=e.nodes,i=e.edges,o=e.begin,a=r.length;if(a===0)return e.onLayoutEnd&&e.onLayoutEnd(),{nodes:r,edges:i};if(a===1)return r[0].x=o[0],r[0].y=o[1],e.onLayoutEnd&&e.onLayoutEnd(),{nodes:r,edges:i};var s=e.sortBy,u=e.width,c=e.height,l=e.condense,h=e.preventOverlapPadding,f=e.preventOverlap,d=e.nodeSpacing,p=e.nodeSize,g=[];r.forEach(function(C){g.push(C)});var v={};if(g.forEach(function(C,I){v[C.id]=I}),(s==="degree"||!(0,ru.isString)(s)||g[0][s]===void 0)&&(s="degree",(0,ru.isNaN)(r[0].degree))){var m=(0,ru.getDegree)(g.length,v,i);g.forEach(function(C,I){C.degree=m[I].all})}g.sort(function(C,I){return I[s]-C[s]}),!u&&typeof window<"u"&&(u=window.innerWidth),!c&&typeof window<"u"&&(c=window.innerHeight);var y=e.rows,b=e.cols!=null?e.cols:e.columns;if(e.cells=a,y!=null&&b!=null?(e.rows=y,e.cols=b):y!=null&&b==null?(e.rows=y,e.cols=Math.ceil(e.cells/e.rows)):y==null&&b!=null?(e.cols=b,e.rows=Math.ceil(e.cells/e.cols)):(e.splits=Math.sqrt(e.cells*e.height/e.width),e.rows=Math.round(e.splits),e.cols=Math.round(e.width/e.height*e.splits)),e.rows=Math.max(e.rows,1),e.cols=Math.max(e.cols,1),e.cols*e.rows>e.cells){var x=e.small(),w=e.large();(x-1)*w>=e.cells?e.small(x-1):(w-1)*x>=e.cells&&e.large(w-1)}else for(;e.cols*e.rows<e.cells;){var x=e.small(),w=e.large();(w+1)*x>=e.cells?e.large(w+1):e.small(x+1)}if(e.cellWidth=u/e.cols,e.cellHeight=c/e.rows,l&&(e.cellWidth=0,e.cellHeight=0),f||d){var E=(0,ru.getFuncByUnknownType)(10,d),M=(0,ru.getFuncByUnknownType)(30,p,!1);g.forEach(function(C){(!C.x||!C.y)&&(C.x=0,C.y=0);var I=M(C)||30,N,D;(0,ru.isArray)(I)?(N=I[0],D=I[1]):(N=I,D=I);var P=E!==void 0?E(C):h,j=N+P,L=D+P;e.cellWidth=Math.max(e.cellWidth,j),e.cellHeight=Math.max(e.cellHeight,L)})}e.cellUsed={},e.row=0,e.col=0,e.id2manPos={};for(var _=0;_<g.length;_++){var k=g[_],S=void 0;if(e.position&&(S=e.position(k)),S&&(S.row!==void 0||S.col!==void 0)){var A={row:S.row,col:S.col};if(A.col===void 0)for(A.col=0;e.used(A.row,A.col);)A.col++;else if(A.row===void 0)for(A.row=0;e.used(A.row,A.col);)A.row++;e.id2manPos[k.id]=A,e.use(A.row,A.col)}e.getPos(k)}return e.onLayoutEnd&&e.onLayoutEnd(),{edges:i,nodes:g}},n.prototype.small=function(e){var r=this,i,o=r.rows||5,a=r.cols||5;if(e==null)i=Math.min(o,a);else{var s=Math.min(o,a);s===r.rows?r.rows=e:r.cols=e}return i},n.prototype.large=function(e){var r=this,i,o=r.rows||5,a=r.cols||5;if(e==null)i=Math.max(o,a);else{var s=Math.max(o,a);s===r.rows?r.rows=e:r.cols=e}return i},n.prototype.used=function(e,r){var i=this;return i.cellUsed["c-".concat(e,"-").concat(r)]||!1},n.prototype.use=function(e,r){var i=this;i.cellUsed["c-".concat(e,"-").concat(r)]=!0},n.prototype.moveToNextCell=function(){var e=this,r=e.cols||5;e.col++,e.col>=r&&(e.col=0,e.row++)},n.prototype.getPos=function(e){var r=this,i=r.begin,o=r.cellWidth,a=r.cellHeight,s,u,c=r.id2manPos[e.id];if(c)s=c.col*o+o/2+i[0],u=c.row*a+a/2+i[1];else{for(;r.used(r.row,r.col);)r.moveToNextCell();s=r.col*o+o/2+i[0],u=r.row*a+a/2+i[1],r.use(r.row,r.col),r.moveToNextCell()}e.x=s,e.y=u},n.prototype.getType=function(){return"grid"},n}(IW.Base);Hl.GridLayout=TW;var ql={},OW=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(ql,"__esModule",{value:!0});ql.RandomLayout=void 0;var NW=Yn,DW=function(t){OW(n,t);function n(e){var r=t.call(this)||this;return r.center=[0,0],r.width=300,r.height=300,r.nodes=[],r.edges=[],r.onLayoutEnd=function(){},r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{center:[0,0],width:300,height:300}},n.prototype.execute=function(){var e=this,r=e.nodes,i=.9,o=e.center;return!e.width&&typeof window<"u"&&(e.width=window.innerWidth),!e.height&&typeof window<"u"&&(e.height=window.innerHeight),r&&r.forEach(function(a){a.x=(Math.random()-.5)*i*e.width+o[0],a.y=(Math.random()-.5)*i*e.height+o[1]}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:r,edges:this.edges}},n.prototype.getType=function(){return"random"},n}(NW.Base);ql.RandomLayout=DW;var Zl={},PW=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Zl,"__esModule",{value:!0});Zl.GForceLayout=void 0;var LW=Yn,Mr=Ln(),z0=function(t,n){var e;return t?(0,Mr.isNumber)(t)?e=function(r){return t}:e=t:e=function(r){return n||1},e},jW=function(t){PW(n,t);function n(e){var r=t.call(this)||this;return r.maxIteration=500,r.workerEnabled=!1,r.edgeStrength=200,r.nodeStrength=1e3,r.coulombDisScale=.005,r.damping=.9,r.maxSpeed=1e3,r.minMovement=.5,r.interval=.02,r.factor=1,r.linkDistance=1,r.gravity=10,r.preventOverlap=!0,r.collideStrength=1,r.tick=function(){},r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.animate=!0,r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}},n.prototype.execute=function(){var e,r,i=this,o=i.nodes;if(i.timeInterval!==void 0&&typeof window<"u"&&window.clearInterval(i.timeInterval),!o||o.length===0){(e=i.onLayoutEnd)===null||e===void 0||e.call(i);return}!i.width&&typeof window<"u"&&(i.width=window.innerWidth),!i.height&&typeof window<"u"&&(i.height=window.innerHeight),i.center||(i.center=[i.width/2,i.height/2]);var a=i.center;if(o.length===1){o[0].x=a[0],o[0].y=a[1],(r=i.onLayoutEnd)===null||r===void 0||r.call(i);return}var s={},u={};o.forEach(function(p,g){(0,Mr.isNumber)(p.x)||(p.x=Math.random()*i.width),(0,Mr.isNumber)(p.y)||(p.y=Math.random()*i.height),s[p.id]=p,u[p.id]=g}),i.nodeMap=s,i.nodeIdxMap=u,i.linkDistance=z0(i.linkDistance,1),i.nodeStrength=z0(i.nodeStrength,1),i.edgeStrength=z0(i.edgeStrength,1);var c=i.nodeSize,l;if(i.preventOverlap){var h=i.nodeSpacing,f;(0,Mr.isNumber)(h)?f=function(){return h}:(0,Mr.isFunction)(h)?f=h:f=function(){return 0},c?(0,Mr.isArray)(c)?l=function(p){return Math.max(c[0],c[1])+f(p)}:l=function(p){return c+f(p)}:l=function(p){return p.size?(0,Mr.isArray)(p.size)?Math.max(p.size[0],p.size[1])+f(p):(0,Mr.isObject)(p.size)?Math.max(p.size.width,p.size.height)+f(p):p.size+f(p):10+f(p)}}i.nodeSize=l;var d=i.edges;i.degrees=(0,Mr.getDegree)(o.length,i.nodeIdxMap,d),i.getMass||(i.getMass=function(p){var g=p.mass||i.degrees[i.nodeIdxMap[p.id]].all||1;return g}),i.run()},n.prototype.run=function(){var e,r=this,i=r.maxIteration,o=r.nodes,a=r.workerEnabled,s=r.minMovement,u=r.animate;if(o)if(a||!u){for(var c=0;c<i;c++){var l=r.runOneStep(c);if(r.reachMoveThreshold(o,l,s))break}(e=r.onLayoutEnd)===null||e===void 0||e.call(r)}else{if(typeof window>"u")return;var h=0;this.timeInterval=window.setInterval(function(){var f,d;if(o){var p=r.runOneStep(h)||[];r.reachMoveThreshold(o,p,s)&&((f=r.onLayoutEnd)===null||f===void 0||f.call(r),window.clearInterval(r.timeInterval)),h++,h>=i&&((d=r.onLayoutEnd)===null||d===void 0||d.call(r),window.clearInterval(r.timeInterval))}},0)}},n.prototype.reachMoveThreshold=function(e,r,i){var o=0;return e.forEach(function(a,s){var u=a.x-r[s].x,c=a.y-r[s].y;o+=Math.sqrt(u*u+c*c)}),o/=e.length,o<i},n.prototype.runOneStep=function(e){var r,i=this,o=i.nodes,a=i.edges,s=[],u=[];if(o){o.forEach(function(h,f){s[2*f]=0,s[2*f+1]=0,u[2*f]=0,u[2*f+1]=0}),i.calRepulsive(s,o),a&&i.calAttractive(s,a),i.calGravity(s,o);var c=Math.max(.02,i.interval-e*.002);i.updateVelocity(s,u,c,o);var l=[];return o.forEach(function(h){l.push({x:h.x,y:h.y})}),i.updatePosition(u,c,o),(r=i.tick)===null||r===void 0||r.call(i),l}},n.prototype.calRepulsive=function(e,r){var i=this,o=i.getMass,a=i.factor,s=i.coulombDisScale,u=i.preventOverlap,c=i.collideStrength,l=c===void 0?1:c,h=i.nodeStrength,f=i.nodeSize;r.forEach(function(d,p){var g=o?o(d):1;r.forEach(function(v,m){if(!(p>=m)){var y=d.x-v.x,b=d.y-v.y;y===0&&b===0&&(y=Math.random()*.01,b=Math.random()*.01);var x=y*y+b*b,w=Math.sqrt(x),E=(w+.1)*s,M=y/w,_=b/w,k=(h(d)+h(v))*.5*a/(E*E),S=o?o(v):1;if(e[2*p]+=M*k,e[2*p+1]+=_*k,e[2*m]-=M*k,e[2*m+1]-=_*k,u&&(f(d)+f(v))/2>w){var A=l*(h(d)+h(v))*.5/x;e[2*p]+=M*A/g,e[2*p+1]+=_*A/g,e[2*m]-=M*A/S,e[2*m+1]-=_*A/S}}})})},n.prototype.calAttractive=function(e,r){var i=this,o=i.nodeMap,a=i.nodeIdxMap,s=i.linkDistance,u=i.edgeStrength,c=i.nodeSize,l=i.getMass;r.forEach(function(h,f){var d=(0,Mr.getEdgeTerminal)(h,"source"),p=(0,Mr.getEdgeTerminal)(h,"target"),g=o[d],v=o[p],m=v.x-g.x,y=v.y-g.y;m===0&&y===0&&(m=Math.random()*.01,y=Math.random()*.01);var b=Math.sqrt(m*m+y*y),x=m/b,w=y/b,E=s(h,g,v)||1+(c(g)+c(v)||0)/2,M=E-b,_=M*u(h),k=a[d],S=a[p],A=l?l(g):1,C=l?l(v):1;e[2*k]-=x*_/A,e[2*k+1]-=w*_/A,e[2*S]+=x*_/C,e[2*S+1]+=w*_/C})},n.prototype.calGravity=function(e,r){for(var i=this,o=i.center,a=i.gravity,s=i.degrees,u=r.length,c=0;c<u;c++){var l=r[c],h=l.x-o[0],f=l.y-o[1],d=a;if(i.getCenter){var p=i.getCenter(l,s[c].all);p&&(0,Mr.isNumber)(p[0])&&(0,Mr.isNumber)(p[1])&&(0,Mr.isNumber)(p[2])&&(h=l.x-p[0],f=l.y-p[1],d=p[2])}d&&(e[2*c]-=d*h,e[2*c+1]-=d*f)}},n.prototype.updateVelocity=function(e,r,i,o){var a=this,s=i*a.damping;o.forEach(function(u,c){var l=e[2*c]*s||.01,h=e[2*c+1]*s||.01,f=Math.sqrt(l*l+h*h);if(f>a.maxSpeed){var d=a.maxSpeed/f;l=d*l,h=d*h}r[2*c]=l,r[2*c+1]=h})},n.prototype.updatePosition=function(e,r,i){i.forEach(function(o,a){if((0,Mr.isNumber)(o.fx)&&(0,Mr.isNumber)(o.fy)){o.x=o.fx,o.y=o.fy;return}var s=e[2*a]*r,u=e[2*a+1]*r;o.x+=s,o.y+=u})},n.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)},n.prototype.destroy=function(){var e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0},n.prototype.getType=function(){return"gForce"},n}(LW.Base);Zl.GForceLayout=jW;var Kl={},Np={};function RW(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return j3(this.cover(n,e),n,e,t)}function j3(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o=t._root,a={data:r},s=t._x0,u=t._y0,c=t._x1,l=t._y1,h,f,d,p,g,v,m,y;if(!o)return t._root=a,t;for(;o.length;)if((g=n>=(h=(s+c)/2))?s=h:c=h,(v=e>=(f=(u+l)/2))?u=f:l=f,i=o,!(o=o[m=v<<1|g]))return i[m]=a,t;if(d=+t._x.call(null,o.data),p=+t._y.call(null,o.data),n===d&&e===p)return a.next=o,i?i[m]=a:t._root=a,t;do i=i?i[m]=new Array(4):t._root=new Array(4),(g=n>=(h=(s+c)/2))?s=h:c=h,(v=e>=(f=(u+l)/2))?u=f:l=f;while((m=v<<1|g)===(y=(p>=f)<<1|d>=h));return i[y]=o,i[m]=a,t}function FW(t){var n,e,r=t.length,i,o,a=new Array(r),s=new Array(r),u=1/0,c=1/0,l=-1/0,h=-1/0;for(e=0;e<r;++e)isNaN(i=+this._x.call(null,n=t[e]))||isNaN(o=+this._y.call(null,n))||(a[e]=i,s[e]=o,i<u&&(u=i),i>l&&(l=i),o<c&&(c=o),o>h&&(h=o));if(u>l||c>h)return this;for(this.cover(u,c).cover(l,h),e=0;e<r;++e)j3(this,a[e],s[e],t[e]);return this}function BW(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{for(var a=i-e||1,s=this._root,u,c;e>t||t>=i||r>n||n>=o;)switch(c=(n<r)<<1|t<e,u=new Array(4),u[c]=s,s=u,a*=2,c){case 0:i=e+a,o=r+a;break;case 1:e=i-a,o=r+a;break;case 2:i=e+a,r=o-a;break;case 3:e=i-a,r=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this}function zW(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function GW(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Or(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function UW(t,n,e){var r,i=this._x0,o=this._y0,a,s,u,c,l=this._x1,h=this._y1,f=[],d=this._root,p,g;for(d&&f.push(new Or(d,i,o,l,h)),e==null?e=1/0:(i=t-e,o=n-e,l=t+e,h=n+e,e*=e);p=f.pop();)if(!(!(d=p.node)||(a=p.x0)>l||(s=p.y0)>h||(u=p.x1)<i||(c=p.y1)<o))if(d.length){var v=(a+u)/2,m=(s+c)/2;f.push(new Or(d[3],v,m,u,c),new Or(d[2],a,m,v,c),new Or(d[1],v,s,u,m),new Or(d[0],a,s,v,m)),(g=(n>=m)<<1|t>=v)&&(p=f[f.length-1],f[f.length-1]=f[f.length-1-g],f[f.length-1-g]=p)}else{var y=t-+this._x.call(null,d.data),b=n-+this._y.call(null,d.data),x=y*y+b*b;if(x<e){var w=Math.sqrt(e=x);i=t-w,o=n-w,l=t+w,h=n+w,r=d.data}}return r}function YW(t){if(isNaN(l=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var n,e=this._root,r,i,o,a=this._x0,s=this._y0,u=this._x1,c=this._y1,l,h,f,d,p,g,v,m;if(!e)return this;if(e.length)for(;;){if((p=l>=(f=(a+u)/2))?a=f:u=f,(g=h>=(d=(s+c)/2))?s=d:c=d,n=e,!(e=e[v=g<<1|p]))return this;if(!e.length)break;(n[v+1&3]||n[v+2&3]||n[v+3&3])&&(r=n,m=v)}for(;e.data!==t;)if(i=e,!(e=e.next))return this;return(o=e.next)&&delete e.next,i?(o?i.next=o:delete i.next,this):n?(o?n[v]=o:delete n[v],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(r?r[m]=e:this._root=e),this):(this._root=o,this)}function VW(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function WW(){return this._root}function XW(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function HW(t){var n=[],e,r=this._root,i,o,a,s,u;for(r&&n.push(new Or(r,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(r=e.node,o=e.x0,a=e.y0,s=e.x1,u=e.y1)&&r.length){var c=(o+s)/2,l=(a+u)/2;(i=r[3])&&n.push(new Or(i,c,l,s,u)),(i=r[2])&&n.push(new Or(i,o,l,c,u)),(i=r[1])&&n.push(new Or(i,c,a,s,l)),(i=r[0])&&n.push(new Or(i,o,a,c,l))}return this}function qW(t){var n=[],e=[],r;for(this._root&&n.push(new Or(this._root,this._x0,this._y0,this._x1,this._y1));r=n.pop();){var i=r.node;if(i.length){var o,a=r.x0,s=r.y0,u=r.x1,c=r.y1,l=(a+u)/2,h=(s+c)/2;(o=i[0])&&n.push(new Or(o,a,s,l,h)),(o=i[1])&&n.push(new Or(o,l,s,u,h)),(o=i[2])&&n.push(new Or(o,a,h,l,c)),(o=i[3])&&n.push(new Or(o,l,h,u,c))}e.push(r)}for(;r=e.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function ZW(t){return t[0]}function KW(t){return arguments.length?(this._x=t,this):this._x}function QW(t){return t[1]}function JW(t){return arguments.length?(this._y=t,this):this._y}function Dp(t,n,e){var r=new r1(n??ZW,e??QW,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function r1(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function jE(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var Nr=Dp.prototype=r1.prototype;Nr.copy=function(){var t=new r1(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,r;if(!n)return t;if(!n.length)return t._root=jE(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var i=0;i<4;++i)(r=n.source[i])&&(r.length?e.push({source:r,target:n.target[i]=new Array(4)}):n.target[i]=jE(r));return t};Nr.add=RW;Nr.addAll=FW;Nr.cover=BW;Nr.data=zW;Nr.extent=GW;Nr.find=UW;Nr.remove=YW;Nr.removeAll=VW;Nr.root=WW;Nr.size=XW;Nr.visit=HW;Nr.visitAfter=qW;Nr.x=KW;Nr.y=JW;const $W=Object.freeze(Object.defineProperty({__proto__:null,quadtree:Dp},Symbol.toStringTag,{value:"Module"})),tX=xo($W);Object.defineProperty(Np,"__esModule",{value:!0});Np.forceNBody=void 0;var eX=tX,nX=.81,RE=.1;function rX(t,n,e,r,i){var o=e/r,a=t.map(function(u,c){var l=n[u.id],h=l.data,f=l.x,d=l.y,p=l.size,g=h.layout.force.nodeStrength;return{x:f,y:d,size:p,index:c,vx:0,vy:0,weight:o*g}}),s=(0,eX.quadtree)(a,function(u){return u.x},function(u){return u.y}).visitAfter(iX);return a.forEach(function(u){aX(u,s)}),a.map(function(u,c){var l=n[t[c].id],h=l.data.layout.force.mass,f=h===void 0?1:h;i[2*c]=u.vx/f,i[2*c+1]=u.vy/f}),i}Np.forceNBody=rX;function iX(t){var n=0,e=0,r=0;if(t.length){for(var i=0;i<4;i++){var o=t[i];o&&o.weight&&(n+=o.weight,e+=o.x*o.weight,r+=o.y*o.weight)}t.x=e/n,t.y=r/n,t.weight=n}else{var o=t;t.x=o.data.x,t.y=o.data.y,t.weight=o.data.weight}}var oX=function(t,n,e,r,i,o){var a=o.x-t.x||RE,s=o.y-t.y||RE,u=r-n,c=a*a+s*s,l=Math.sqrt(c)*c;if(u*u*nX<c){var h=t.weight/l;return o.vx+=a*h,o.vy+=s*h,!0}if(t.length)return!1;if(t.data!==o){var h=t.data.weight/l;o.vx+=a*h,o.vy+=s*h}};function aX(t,n){n.visit(function(e,r,i,o,a){return oX(e,r,i,o,a,t)})}var sX=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ki=bt&&bt.__assign||function(){return ki=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ki.apply(this,arguments)};Object.defineProperty(Kl,"__esModule",{value:!0});Kl.Force2Layout=void 0;var uX=Yn,rr=Ln(),cX=Np,G0=function(t,n){var e;return t?(0,rr.isNumber)(t)?e=function(r){return t}:e=t:e=function(r){return n||1},e},lX=function(t){sX(n,t);function n(e){var r=t.call(this)||this;r.maxIteration=1e3,r.workerEnabled=!1,r.edgeStrength=200,r.nodeStrength=1e3,r.coulombDisScale=.005,r.damping=.9,r.maxSpeed=500,r.minMovement=.4,r.interval=.02,r.factor=1,r.linkDistance=200,r.gravity=0,r.clusterNodeStrength=20,r.preventOverlap=!0,r.distanceThresholdMode="mean",r.tick=function(){},r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.judgingDistance=0,r.centripetalOptions={leaf:2,single:2,others:1,center:function(o){return{x:r.width/2,y:r.height/2}}};var i=e.getMass;return r.propsGetMass=i,r.updateCfg(e),r}return n.prototype.getCentripetalOptions=function(){var e=this,r=e.leafCluster,i=e.clustering,o=e.nodeClusterBy,a=e.nodes,s=e.nodeMap,u=e.clusterNodeStrength,c=function(b){return typeof u=="function"?u(b):u},l={},h;if(r){h=this.getSameTypeLeafMap()||{};var f=Array.from(new Set(a==null?void 0:a.map(function(b){return b[o]})))||[];l={single:100,leaf:function(b,x,w){var E=h[b.id]||{},M=E.relativeLeafNodes,_=E.sameTypeLeafNodes;return(_==null?void 0:_.length)===(M==null?void 0:M.length)||(f==null?void 0:f.length)===1?1:c(b)},others:1,center:function(b,x,w){var E,M=(((E=b.data)===null||E===void 0?void 0:E.layout)||{}).degree;if(!M)return{x:100,y:100};var _;if(M===1){var k=(h[b.id]||{}).sameTypeLeafNodes,S=k===void 0?[]:k;S.length===1?_=void 0:S.length>1&&(_=(0,rr.getAvgNodePosition)(S))}else _=void 0;return{x:_==null?void 0:_.x,y:_==null?void 0:_.y}}}}if(i){h||(h=this.getSameTypeLeafMap());var d=Array.from(new Set(a.map(function(b,x){return b[o]}))).filter(function(b){return b!==void 0}),p={};d.forEach(function(b){var x=a.filter(function(w){return w[o]===b}).map(function(w){return s[w.id]});p[b]=(0,rr.getAvgNodePosition)(x)}),l={single:function(b){return c(b)},leaf:function(b){return c(b)},others:function(b){return c(b)},center:function(b,x,w){var E=p[b[o]];return{x:E==null?void 0:E.x,y:E==null?void 0:E.y}}}}this.centripetalOptions=ki(ki({},this.centripetalOptions),l);var g=this.centripetalOptions,v=g.leaf,m=g.single,y=g.others;v&&typeof v!="function"&&(this.centripetalOptions.leaf=function(){return v}),m&&typeof m!="function"&&(this.centripetalOptions.single=function(){return m}),y&&typeof y!="function"&&(this.centripetalOptions.others=function(){return y})},n.prototype.updateCfg=function(e){e&&Object.assign(this,e)},n.prototype.getDefaultCfg=function(){return{maxIteration:500,gravity:10,enableTick:!0,animate:!0}},n.prototype.execute=function(){var e=this;e.stop();var r=e.nodes,i=e.edges,o=e.defSpringLen;if(e.judgingDistance=0,!r||r.length===0){e.onLayoutEnd([]);return}!e.width&&typeof window<"u"&&(e.width=window.innerWidth),!e.height&&typeof window<"u"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);var a=e.center;if(r.length===1){r[0].x=a[0],r[0].y=a[1],e.onLayoutEnd([ki({},r[0])]);return}e.degreesMap=(0,rr.getDegreeMap)(r,i),e.propsGetMass?e.getMass=e.propsGetMass:e.getMass=function(d){var p=1;(0,rr.isNumber)(d.mass)&&(p=d.mass);var g=e.degreesMap[d.id].all;return!g||g<5?p:g*5*p};var s=e.nodeSize,u;if(e.preventOverlap){var c=e.nodeSpacing,l;(0,rr.isNumber)(c)?l=function(){return c}:(0,rr.isFunction)(c)?l=c:l=function(){return 0},s?(0,rr.isArray)(s)?u=function(d){return Math.max(s[0],s[1])+l(d)}:u=function(d){return s+l(d)}:u=function(d){return d.size?(0,rr.isArray)(d.size)?Math.max(d.size[0],d.size[1])+l(d):(0,rr.isObject)(d.size)?Math.max(d.size.width,d.size.height)+l(d):d.size+l(d):10+l(d)}}e.nodeSize=u,e.linkDistance=G0(e.linkDistance,1),e.nodeStrength=G0(e.nodeStrength,1),e.edgeStrength=G0(e.edgeStrength,1);var h={},f={};r.forEach(function(d,p){(0,rr.isNumber)(d.x)||(d.x=Math.random()*e.width),(0,rr.isNumber)(d.y)||(d.y=Math.random()*e.height);var g=e.degreesMap[d.id];h[d.id]=ki(ki({},d),{data:ki(ki({},d.data),{size:e.nodeSize(d)||30,layout:{inDegree:g.in,outDegree:g.out,degree:g.all,tDegree:g.in,sDegree:g.out,force:{mass:e.getMass(d),nodeStrength:e.nodeStrength(d,i)}}})}),f[d.id]=p}),e.nodeMap=h,e.nodeIdxMap=f,e.edgeInfos=[],i==null||i.forEach(function(d){var p=h[d.source],g=h[d.target];!p||!g?elf.edgeInfos.push({}):e.edgeInfos.push({edgeStrength:e.edgeStrength(d),linkDistance:o?o(ki(ki({},d),{source:p,target:g}),p,g):e.linkDistance(d,p,g)||1+(s(p)+s(p)||0)/2})}),this.getCentripetalOptions(),e.onLayoutEnd=e.onLayoutEnd||function(){},e.run()},n.prototype.run=function(){var e=this,r=e.maxIteration,i=e.nodes,o=e.edges,a=e.workerEnabled,s=e.minMovement,u=e.animate,c=e.nodeMap,l=e.height;if(e.currentMinY=0,e.currentMaxY=l,!!i){var h=[];if(i.forEach(function(m,y){h[2*y]=0,h[2*y+1]=0}),this.defSideCoe&&typeof this.defSideCoe=="function"){var f={};o.forEach(function(m){var y=m.source,b=m.target;f[y]=f[y]||[],f[y].push(m),f[b]=f[b]||[],f[b].push(m)}),this.relatedEdges=f}var d=r,p=!u;if(a||p){for(var g=0;(e.judgingDistance>s||g<1)&&g<d;g++)e.runOneStep(g,h);e.onLayoutEnd(Object.values(c))}else{if(typeof window>"u")return;var v=0;this.timeInterval=window.setInterval(function(){i&&(e.runOneStep(v,h),v++,(v>=d||e.judgingDistance<s)&&(e.onLayoutEnd(Object.values(c)),window.clearInterval(e.timeInterval)))},0)}}},n.prototype.runOneStep=function(e,r){var i,o=this,a=o.nodes,s=o.edges;o.nodeMap;var u=o.monitor,c=[];if(a!=null&&a.length){o.calRepulsive(c),s&&o.calAttractive(c),o.calGravity(c),o.attractToSide(c);var l=o.interval;if(o.updateVelocity(c,r,l),o.updatePosition(r,l),(i=o.tick)===null||i===void 0||i.call(o),u){var h=this.calTotalEnergy(c);u({energy:h,nodes:a,edges:s,iterations:e})}}},n.prototype.calTotalEnergy=function(e){var r=this,i=r.nodes,o=r.nodeMap;if(!(i!=null&&i.length))return 0;var a=0;return i.forEach(function(s,u){var c=e[2*u],l=e[2*u+1],h=c*c+l*l,f=o[s.id].data.layout.force.mass,d=f===void 0?1:f;a+=d*h*.5}),a},n.prototype.calRepulsive=function(e){var r=this,i=r.nodes,o=r.nodeMap,a=r.factor,s=r.coulombDisScale;r.nodeSize,(0,cX.forceNBody)(i,o,a,s*s,e)},n.prototype.calAttractive=function(e){var r=this,i=r.edges,o=r.nodeMap,a=r.nodeIdxMap,s=r.edgeInfos;r.nodeSize,i.forEach(function(u,c){var l=(0,rr.getEdgeTerminal)(u,"source"),h=(0,rr.getEdgeTerminal)(u,"target"),f=o[l],d=o[h];if(!(!f||!d)){var p=d.x-f.x,g=d.y-f.y;!p&&!g&&(p=Math.random()*.01,g=Math.random()*.01);var v=Math.sqrt(p*p+g*g),m=p/v,y=g/v,b=s[c]||{},x=b.linkDistance,w=x===void 0?200:x,E=b.edgeStrength,M=E===void 0?200:E,_=w-v,k=_*M,S=f.data.layout.force.mass||1,A=d.data.layout.force.mass||1,C=1/S,I=1/A,N=m*k,D=y*k,P=2*a[l],j=2*a[h];e[P]-=N*C,e[P+1]-=D*C,e[j]+=N*I,e[j+1]+=D*I}})},n.prototype.calGravity=function(e){var r,i=this,o=i.nodes,a=i.edges,s=a===void 0?[]:a,u=i.nodeMap,c=i.width,l=i.height,h=i.center,f=i.gravity,d=i.degreesMap,p=i.centripetalOptions;if(o)for(var g=o.length,v=0;v<g;v++){var m=2*v,y=u[o[v].id],b=y.data.layout.force.mass,x=b===void 0?1:b,w=0,E=0,M=f,_=d[y.id],k=_.in,S=_.out,A=_.all,C=(r=i.getCenter)===null||r===void 0?void 0:r.call(i,y,A);if(C){var I=C[0],N=C[1],D=C[2];w=y.x-I,E=y.y-N,M=D}else w=y.x-h[0],E=y.y-h[1];if(M&&(e[m]-=M*w/x,e[m+1]-=M*E/x),p){var P=p.leaf,j=p.single,L=p.others,R=p.center,V=(R==null?void 0:R(y,o,s,c,l))||{x:0,y:0,centerStrength:0},tt=V.x,ut=V.y,dt=V.centerStrength;if(!(0,rr.isNumber)(tt)||!(0,rr.isNumber)(ut))continue;var J=(y.x-tt)/x,Et=(y.y-ut)/x;if(dt&&(e[m]-=dt*J,e[m+1]-=dt*Et),A===0){var Bt=j(y);if(!Bt)continue;e[m]-=Bt*J,e[m+1]-=Bt*Et;continue}if(k===0||S===0){var Vt=P(y,o,s);if(!Vt)continue;e[m]-=Vt*J,e[m+1]-=Vt*Et;continue}var se=L(y);if(!se)continue;e[m]-=se*J,e[m+1]-=se*Et}}},n.prototype.attractToSide=function(e){var r=this,i=r.defSideCoe;r.height;var o=r.nodes,a=r.relatedEdges,s=r.currentMinY,u=s===void 0?0:s,c=r.currentMaxY,l=c===void 0?this.height:c;!i||typeof i!="function"||!(o!=null&&o.length)||o.forEach(function(h,f){var d=i(h,a[h.id]||[]);if(d!==0){var p=d<0?u:l,g=Math.abs(d);e[2*f+1]-=g*(h.y-p)}})},n.prototype.updateVelocity=function(e,r,i){var o=this,a=o.nodes,s=o.damping,u=o.maxSpeed;a!=null&&a.length&&a.forEach(function(c,l){var h=(r[2*l]+e[2*l]*i)*s||.01,f=(r[2*l+1]+e[2*l+1]*i)*s||.01,d=Math.sqrt(h*h+f*f);if(d>u){var p=u/d;h=p*h,f=p*f}r[2*l]=h,r[2*l+1]=f})},n.prototype.updatePosition=function(e,r){var i=this,o=i.nodes,a=i.distanceThresholdMode,s=i.nodeMap;if(!(o!=null&&o.length)){this.judgingDistance=0;return}var u=0;a==="max"?i.judgingDistance=-1/0:a==="min"&&(i.judgingDistance=1/0);var c=1/0,l=-1/0;o.forEach(function(h,f){var d=s[h.id];if((0,rr.isNumber)(h.fx)&&(0,rr.isNumber)(h.fy)){h.x=h.fx,h.y=h.fy,d.x=h.x,d.y=h.y;return}var p=e[2*f]*r,g=e[2*f+1]*r;h.x+=p,h.y+=g,d.x=h.x,d.y=h.y,h.y<c&&(c=h.y),h.y>l&&(l=h.y);var v=Math.sqrt(p*p+g*g);switch(a){case"max":i.judgingDistance<v&&(i.judgingDistance=v);break;case"min":i.judgingDistance>v&&(i.judgingDistance=v);break;default:u=u+v;break}}),this.currentMinY=c,this.currentMaxY=l,(!a||a==="mean")&&(i.judgingDistance=u/o.length)},n.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)},n.prototype.destroy=function(){var e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0},n.prototype.getType=function(){return"force2"},n.prototype.getSameTypeLeafMap=function(){var e=this,r=e.nodeClusterBy,i=e.nodes,o=e.edges,a=e.nodeMap,s=e.degreesMap;if(i!=null&&i.length){var u={};return i.forEach(function(c,l){var h=s[c.id].all;h===1&&(u[c.id]=(0,rr.getCoreNodeAndRelativeLeafNodes)("leaf",c,o,r,s,a))}),u}},n}(uX.Base);Kl.Force2Layout=lX;var i1={},Pp={};function hX(t,n){var e,r=1;t==null&&(t=0),n==null&&(n=0);function i(){var o,a=e.length,s,u=0,c=0;for(o=0;o<a;++o)s=e[o],u+=s.x,c+=s.y;for(u=(u/a-t)*r,c=(c/a-n)*r,o=0;o<a;++o)s=e[o],s.x-=u,s.y-=c}return i.initialize=function(o){e=o},i.x=function(o){return arguments.length?(t=+o,i):t},i.y=function(o){return arguments.length?(n=+o,i):n},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function ar(t){return function(){return t}}function Ea(t){return(t()-.5)*1e-6}function fX(t){return t.x+t.vx}function dX(t){return t.y+t.vy}function pX(t){var n,e,r,i=1,o=1;typeof t!="function"&&(t=ar(t==null?1:+t));function a(){for(var c,l=n.length,h,f,d,p,g,v,m=0;m<o;++m)for(h=Dp(n,fX,dX).visitAfter(s),c=0;c<l;++c)f=n[c],g=e[f.index],v=g*g,d=f.x+f.vx,p=f.y+f.vy,h.visit(y);function y(b,x,w,E,M){var _=b.data,k=b.r,S=g+k;if(_){if(_.index>f.index){var A=d-_.x-_.vx,C=p-_.y-_.vy,I=A*A+C*C;I<S*S&&(A===0&&(A=Ea(r),I+=A*A),C===0&&(C=Ea(r),I+=C*C),I=(S-(I=Math.sqrt(I)))/I*i,f.vx+=(A*=I)*(S=(k*=k)/(v+k)),f.vy+=(C*=I)*S,_.vx-=A*(S=1-S),_.vy-=C*S)}return}return x>d+S||E<d-S||w>p+S||M<p-S}}function s(c){if(c.data)return c.r=e[c.data.index];for(var l=c.r=0;l<4;++l)c[l]&&c[l].r>c.r&&(c.r=c[l].r)}function u(){if(n){var c,l=n.length,h;for(e=new Array(l),c=0;c<l;++c)h=n[c],e[h.index]=+t(h,c,n)}}return a.initialize=function(c,l){n=c,r=l,u()},a.iterations=function(c){return arguments.length?(o=+c,a):o},a.strength=function(c){return arguments.length?(i=+c,a):i},a.radius=function(c){return arguments.length?(t=typeof c=="function"?c:ar(+c),u(),a):t},a}function gX(t){return t.index}function FE(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function vX(t){var n=gX,e=h,r,i=ar(30),o,a,s,u,c,l=1;t==null&&(t=[]);function h(v){return 1/Math.min(s[v.source.index],s[v.target.index])}function f(v){for(var m=0,y=t.length;m<l;++m)for(var b=0,x,w,E,M,_,k,S;b<y;++b)x=t[b],w=x.source,E=x.target,M=E.x+E.vx-w.x-w.vx||Ea(c),_=E.y+E.vy-w.y-w.vy||Ea(c),k=Math.sqrt(M*M+_*_),k=(k-o[b])/k*v*r[b],M*=k,_*=k,E.vx-=M*(S=u[b]),E.vy-=_*S,w.vx+=M*(S=1-S),w.vy+=_*S}function d(){if(a){var v,m=a.length,y=t.length,b=new Map(a.map((w,E)=>[n(w,E,a),w])),x;for(v=0,s=new Array(m);v<y;++v)x=t[v],x.index=v,typeof x.source!="object"&&(x.source=FE(b,x.source)),typeof x.target!="object"&&(x.target=FE(b,x.target)),s[x.source.index]=(s[x.source.index]||0)+1,s[x.target.index]=(s[x.target.index]||0)+1;for(v=0,u=new Array(y);v<y;++v)x=t[v],u[v]=s[x.source.index]/(s[x.source.index]+s[x.target.index]);r=new Array(y),p(),o=new Array(y),g()}}function p(){if(a)for(var v=0,m=t.length;v<m;++v)r[v]=+e(t[v],v,t)}function g(){if(a)for(var v=0,m=t.length;v<m;++v)o[v]=+i(t[v],v,t)}return f.initialize=function(v,m){a=v,c=m,d()},f.links=function(v){return arguments.length?(t=v,d(),f):t},f.id=function(v){return arguments.length?(n=v,f):n},f.iterations=function(v){return arguments.length?(l=+v,f):l},f.strength=function(v){return arguments.length?(e=typeof v=="function"?v:ar(+v),p(),f):e},f.distance=function(v){return arguments.length?(i=typeof v=="function"?v:ar(+v),g(),f):i},f}var mX={value:()=>{}};function R3(){for(var t=0,n=arguments.length,e={},r;t<n;++t){if(!(r=arguments[t]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new td(e)}function td(t){this._=t}function yX(t,n){return t.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}td.prototype=R3.prototype={constructor:td,on:function(t,n){var e=this._,r=yX(t+"",e),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=bX(e[i],t.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<a;)if(i=(t=r[o]).type)e[i]=BE(e[i],t.name,n);else if(n==null)for(i in e)e[i]=BE(e[i],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new td(t)},call:function(t,n){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,o;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};function bX(t,n){for(var e=0,r=t.length,i;e<r;++e)if((i=t[e]).name===n)return i.value}function BE(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=mX,t=t.slice(0,r).concat(t.slice(r+1));break}return e!=null&&t.push({name:n,value:e}),t}var Gu=0,Hc=0,kc=0,F3=1e3,jd,qc,Rd=0,As=0,Lp=0,kl=typeof performance=="object"&&performance.now?performance:Date,B3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function z3(){return As||(B3(xX),As=kl.now()+Lp)}function xX(){As=0}function vm(){this._call=this._time=this._next=null}vm.prototype=G3.prototype={constructor:vm,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?z3():+e)+(n==null?0:+n),!this._next&&qc!==this&&(qc?qc._next=this:jd=this,qc=this),this._call=t,this._time=e,mm()},stop:function(){this._call&&(this._call=null,this._time=1/0,mm())}};function G3(t,n,e){var r=new vm;return r.restart(t,n,e),r}function wX(){z3(),++Gu;for(var t=jd,n;t;)(n=As-t._time)>=0&&t._call.call(null,n),t=t._next;--Gu}function zE(){As=(Rd=kl.now())+Lp,Gu=Hc=0;try{wX()}finally{Gu=0,MX(),As=0}}function EX(){var t=kl.now(),n=t-Rd;n>F3&&(Lp-=n,Rd=t)}function MX(){for(var t,n=jd,e,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:jd=e);qc=t,mm(r)}function mm(t){if(!Gu){Hc&&(Hc=clearTimeout(Hc));var n=t-As;n>24?(t<1/0&&(Hc=setTimeout(zE,t-kl.now()-Lp)),kc&&(kc=clearInterval(kc))):(kc||(Rd=kl.now(),kc=setInterval(EX,F3)),Gu=1,B3(zE))}}const SX=1664525,_X=1013904223,GE=4294967296;function kX(){let t=1;return()=>(t=(SX*t+_X)%GE)/GE}function AX(t){return t.x}function CX(t){return t.y}var IX=10,TX=Math.PI*(3-Math.sqrt(5));function OX(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=G3(h),c=R3("tick","end"),l=kX();t==null&&(t=[]);function h(){f(),c.call("tick",n),e<r&&(u.stop(),c.call("end",n))}function f(g){var v,m=t.length,y;g===void 0&&(g=1);for(var b=0;b<g;++b)for(e+=(o-e)*i,s.forEach(function(x){x(e)}),v=0;v<m;++v)y=t[v],y.fx==null?y.x+=y.vx*=a:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=a:(y.y=y.fy,y.vy=0);return n}function d(){for(var g=0,v=t.length,m;g<v;++g){if(m=t[g],m.index=g,m.fx!=null&&(m.x=m.fx),m.fy!=null&&(m.y=m.fy),isNaN(m.x)||isNaN(m.y)){var y=IX*Math.sqrt(.5+g),b=g*TX;m.x=y*Math.cos(b),m.y=y*Math.sin(b)}(isNaN(m.vx)||isNaN(m.vy))&&(m.vx=m.vy=0)}}function p(g){return g.initialize&&g.initialize(t,l),g}return d(),n={tick:f,restart:function(){return u.restart(h),n},stop:function(){return u.stop(),n},nodes:function(g){return arguments.length?(t=g,d(),s.forEach(p),n):t},alpha:function(g){return arguments.length?(e=+g,n):e},alphaMin:function(g){return arguments.length?(r=+g,n):r},alphaDecay:function(g){return arguments.length?(i=+g,n):+i},alphaTarget:function(g){return arguments.length?(o=+g,n):o},velocityDecay:function(g){return arguments.length?(a=1-g,n):1-a},randomSource:function(g){return arguments.length?(l=g,s.forEach(p),n):l},force:function(g,v){return arguments.length>1?(v==null?s.delete(g):s.set(g,p(v)),n):s.get(g)},find:function(g,v,m){var y=0,b=t.length,x,w,E,M,_;for(m==null?m=1/0:m*=m,y=0;y<b;++y)M=t[y],x=g-M.x,w=v-M.y,E=x*x+w*w,E<m&&(_=M,m=E);return _},on:function(g,v){return arguments.length>1?(c.on(g,v),n):c.on(g)}}}function NX(){var t,n,e,r,i=ar(-30),o,a=1,s=1/0,u=.81;function c(d){var p,g=t.length,v=Dp(t,AX,CX).visitAfter(h);for(r=d,p=0;p<g;++p)n=t[p],v.visit(f)}function l(){if(t){var d,p=t.length,g;for(o=new Array(p),d=0;d<p;++d)g=t[d],o[g.index]=+i(g,d,t)}}function h(d){var p=0,g,v,m=0,y,b,x;if(d.length){for(y=b=x=0;x<4;++x)(g=d[x])&&(v=Math.abs(g.value))&&(p+=g.value,m+=v,y+=v*g.x,b+=v*g.y);d.x=y/m,d.y=b/m}else{g=d,g.x=g.data.x,g.y=g.data.y;do p+=o[g.data.index];while(g=g.next)}d.value=p}function f(d,p,g,v){if(!d.value)return!0;var m=d.x-n.x,y=d.y-n.y,b=v-p,x=m*m+y*y;if(b*b/u<x)return x<s&&(m===0&&(m=Ea(e),x+=m*m),y===0&&(y=Ea(e),x+=y*y),x<a&&(x=Math.sqrt(a*x)),n.vx+=m*d.value*r/x,n.vy+=y*d.value*r/x),!0;if(!(d.length||x>=s)){(d.data!==n||d.next)&&(m===0&&(m=Ea(e),x+=m*m),y===0&&(y=Ea(e),x+=y*y),x<a&&(x=Math.sqrt(a*x)));do d.data!==n&&(b=o[d.data.index]*r/x,n.vx+=m*b,n.vy+=y*b);while(d=d.next)}}return c.initialize=function(d,p){t=d,e=p,l()},c.strength=function(d){return arguments.length?(i=typeof d=="function"?d:ar(+d),l(),c):i},c.distanceMin=function(d){return arguments.length?(a=d*d,c):Math.sqrt(a)},c.distanceMax=function(d){return arguments.length?(s=d*d,c):Math.sqrt(s)},c.theta=function(d){return arguments.length?(u=d*d,c):Math.sqrt(u)},c}function DX(t,n,e){var r,i=ar(.1),o,a;typeof t!="function"&&(t=ar(+t)),n==null&&(n=0),e==null&&(e=0);function s(c){for(var l=0,h=r.length;l<h;++l){var f=r[l],d=f.x-n||1e-6,p=f.y-e||1e-6,g=Math.sqrt(d*d+p*p),v=(a[l]-g)*o[l]*c/g;f.vx+=d*v,f.vy+=p*v}}function u(){if(r){var c,l=r.length;for(o=new Array(l),a=new Array(l),c=0;c<l;++c)a[c]=+t(r[c],c,r),o[c]=isNaN(a[c])?0:+i(r[c],c,r)}}return s.initialize=function(c){r=c,u()},s.strength=function(c){return arguments.length?(i=typeof c=="function"?c:ar(+c),u(),s):i},s.radius=function(c){return arguments.length?(t=typeof c=="function"?c:ar(+c),u(),s):t},s.x=function(c){return arguments.length?(n=+c,s):n},s.y=function(c){return arguments.length?(e=+c,s):e},s}function PX(t){var n=ar(.1),e,r,i;typeof t!="function"&&(t=ar(t==null?0:+t));function o(s){for(var u=0,c=e.length,l;u<c;++u)l=e[u],l.vx+=(i[u]-l.x)*r[u]*s}function a(){if(e){var s,u=e.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+t(e[s],s,e))?0:+n(e[s],s,e)}}return o.initialize=function(s){e=s,a()},o.strength=function(s){return arguments.length?(n=typeof s=="function"?s:ar(+s),a(),o):n},o.x=function(s){return arguments.length?(t=typeof s=="function"?s:ar(+s),a(),o):t},o}function LX(t){var n=ar(.1),e,r,i;typeof t!="function"&&(t=ar(t==null?0:+t));function o(s){for(var u=0,c=e.length,l;u<c;++u)l=e[u],l.vy+=(i[u]-l.y)*r[u]*s}function a(){if(e){var s,u=e.length;for(r=new Array(u),i=new Array(u),s=0;s<u;++s)r[s]=isNaN(i[s]=+t(e[s],s,e))?0:+n(e[s],s,e)}}return o.initialize=function(s){e=s,a()},o.strength=function(s){return arguments.length?(n=typeof s=="function"?s:ar(+s),a(),o):n},o.y=function(s){return arguments.length?(t=typeof s=="function"?s:ar(+s),a(),o):t},o}const jX=Object.freeze(Object.defineProperty({__proto__:null,forceCenter:hX,forceCollide:pX,forceLink:vX,forceManyBody:NX,forceRadial:DX,forceSimulation:OX,forceX:PX,forceY:LX},Symbol.toStringTag,{value:"Module"})),o1=xo(jX);var a1={},RX=bt&&bt.__createBinding||(Object.create?function(t,n,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,r,i)}:function(t,n,e,r){r===void 0&&(r=e),t[r]=n[e]}),FX=bt&&bt.__setModuleDefault||(Object.create?function(t,n){Object.defineProperty(t,"default",{enumerable:!0,value:n})}:function(t,n){t.default=n}),BX=bt&&bt.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var e in t)e!=="default"&&Object.prototype.hasOwnProperty.call(t,e)&&RX(n,t,e);return FX(n,t),n};Object.defineProperty(a1,"__esModule",{value:!0});var iu=BX(o1),xf=Ln();function zX(){function t(J){return function(){return J}}var n=function(J){return J.cluster},e=t(1),r=t(-1),i=t(100),o=t(.1),a=[0,0],s=[],u={},c=[],l=100,h=100,f={none:{x:0,y:0}},d=[],p,g="force",v=!0,m=.1;function y(J){if(!v)return y;p.tick(),_();for(var Et=0,Bt=s.length,Vt=void 0,se=J*m;Et<Bt;++Et)Vt=s[Et],Vt.vx+=(f[n(Vt)].x-Vt.x)*se,Vt.vy+=(f[n(Vt)].y-Vt.y)*se}function b(){s&&x()}function x(){if(!(!s||!s.length)){if(n(s[0])===void 0)throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");var J=w();p=iu.forceSimulation(J.nodes).force("x",iu.forceX(l).strength(.1)).force("y",iu.forceY(h).strength(.1)).force("collide",iu.forceCollide(function(Et){return Et.r}).iterations(4)).force("charge",iu.forceManyBody().strength(r)).force("links",iu.forceLink(J.nodes.length?J.links:[]).distance(i).strength(o)),d=p.nodes(),_()}}function w(){var J=[],Et=[],Bt={},Vt=[],se={},re=[];return se=E(s),re=M(c),Vt=Object.keys(se),Vt.forEach(function(ue,de){var Ze=se[ue];J.push({id:ue,size:Ze.count,r:Math.sqrt(Ze.sumforceNodeSize/Math.PI)}),Bt[ue]=de}),re.forEach(function(ue){var de=(0,xf.getEdgeTerminal)(ue,"source"),Ze=(0,xf.getEdgeTerminal)(ue,"target"),Ne=Bt[de],Re=Bt[Ze];Ne!==void 0&&Re!==void 0&&Et.push({source:Ne,target:Re,count:ue.count})}),{nodes:J,links:Et}}function E(J){var Et={};return J.forEach(function(Bt){var Vt=n(Bt);Et[Vt]||(Et[Vt]={count:0,sumforceNodeSize:0})}),J.forEach(function(Bt){var Vt=n(Bt),se=e(Bt),re=Et[Vt];re.count=re.count+1,re.sumforceNodeSize=re.sumforceNodeSize+Math.PI*(se*se)*1.3,Et[Vt]=re}),Et}function M(J){var Et={},Bt=[];J.forEach(function(se){var re=k(se),ue=0;Et[re]!==void 0&&(ue=Et[re]),ue+=1,Et[re]=ue});var Vt=Object.entries(Et);return Vt.forEach(function(se){var re=se[0],ue=se[1],de=re.split("~")[0],Ze=re.split("~")[1];de!==void 0&&Ze!==void 0&&Bt.push({source:de,target:Ze,count:ue})}),Bt}function _(){return f={none:{x:0,y:0}},d.forEach(function(J){f[J.id]={x:J.x-a[0],y:J.y-a[1]}}),f}function k(J){var Et=(0,xf.getEdgeTerminal)(J,"source"),Bt=(0,xf.getEdgeTerminal)(J,"target"),Vt=n(u[Et]),se=n(u[Bt]);return Vt<=se?"".concat(Vt,"~").concat(se):"".concat(se,"~").concat(Vt)}function S(J){u={},J.forEach(function(Et){u[Et.id]=Et})}function A(J){return arguments.length?(g=J,b(),y):g}function C(J){return arguments.length?typeof J=="string"?(n=function(Et){return Et[J]},y):(n=J,y):n}function I(J){return arguments.length?(v=J,y):v}function N(J){return arguments.length?(m=J,y):m}function D(J){return arguments.length?(l=J,y):l}function P(J){return arguments.length?(h=J,y):h}function j(J){return arguments.length?(S(J||[]),s=J||[],y):s}function L(J){return arguments.length?(c=J||[],b(),y):c}function R(J){return arguments.length?(typeof J=="function"?e=J:e=t(+J),b(),y):e}function V(J){return arguments.length?(typeof J=="function"?r=J:r=t(+J),b(),y):r}function tt(J){return arguments.length?(typeof J=="function"?i=J:i=t(+J),b(),y):i}function ut(J){return arguments.length?(typeof J=="function"?o=J:o=t(+J),b(),y):o}function dt(J){return arguments.length?(a=J,y):a}return y.initialize=function(J){s=J,b()},y.template=A,y.groupBy=C,y.enableGrouping=I,y.strength=N,y.centerX=D,y.centerY=P,y.nodes=j,y.links=L,y.forceNodeSize=R,y.nodeSize=y.forceNodeSize,y.forceCharge=V,y.forceLinkDistance=tt,y.forceLinkStrength=ut,y.offset=dt,y.getFocis=_,y}a1.default=zX;var Zo={};Object.defineProperty(Zo,"__esModule",{value:!0});Zo.FORCE_LAYOUT_TYPE_MAP=Zo.LAYOUT_MESSAGE=void 0;Zo.LAYOUT_MESSAGE={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};Zo.FORCE_LAYOUT_TYPE_MAP={gForce:!0,force2:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0};var GX=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),UX=bt&&bt.__createBinding||(Object.create?function(t,n,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,r,i)}:function(t,n,e,r){r===void 0&&(r=e),t[r]=n[e]}),YX=bt&&bt.__setModuleDefault||(Object.create?function(t,n){Object.defineProperty(t,"default",{enumerable:!0,value:n})}:function(t,n){t.default=n}),VX=bt&&bt.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var e in t)e!=="default"&&Object.prototype.hasOwnProperty.call(t,e)&&UX(n,t,e);return YX(n,t),n},WX=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Pp,"__esModule",{value:!0});Pp.ForceLayout=void 0;var ou=VX(o1),XX=WX(a1),ns=Ln(),HX=Yn,qX=Zo,ZX=function(t){GX(n,t);function n(e){var r=t.call(this)||this;return r.center=[0,0],r.nodeStrength=null,r.edgeStrength=null,r.preventOverlap=!1,r.clusterNodeStrength=null,r.clusterEdgeStrength=null,r.clusterEdgeDistance=null,r.clusterNodeSize=null,r.clusterFociStrength=null,r.linkDistance=50,r.alphaDecay=.028,r.alphaMin=.001,r.alpha=.3,r.collideStrength=1,r.workerEnabled=!1,r.tick=function(){},r.onLayoutEnd=function(){},r.ticking=void 0,e&&r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{center:[0,0],nodeStrength:null,edgeStrength:null,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10,tick:function(){},onLayoutEnd:function(){},workerEnabled:!1}},n.prototype.init=function(e){var r=this;r.nodes=e.nodes||[];var i=e.edges||[];r.edges=i.map(function(o){var a={},s=["targetNode","sourceNode","startPoint","endPoint"];return Object.keys(o).forEach(function(u){s.indexOf(u)>-1||(a[u]=o[u])}),a}),r.ticking=!1},n.prototype.execute=function(e){var r=this,i=r.nodes,o=r.edges;if(!r.ticking){var a=r.forceSimulation,s=r.alphaMin,u=r.alphaDecay,c=r.alpha;if(a){if(e){if(r.clustering&&r.clusterForce&&(r.clusterForce.nodes(i),r.clusterForce.links(o)),a.nodes(i),o&&r.edgeForce)r.edgeForce.links(o);else if(o&&!r.edgeForce){var l=ou.forceLink().id(function(g){return g.id}).links(o);r.edgeStrength&&l.strength(r.edgeStrength),r.linkDistance&&l.distance(r.linkDistance),r.edgeForce=l,a.force("link",l)}}r.preventOverlap&&r.overlapProcess(a),a.alpha(c).restart(),this.ticking=!0}else try{var h=ou.forceManyBody();if(r.nodeStrength&&h.strength(r.nodeStrength),a=ou.forceSimulation().nodes(i),r.clustering){var f=(0,XX.default)();f.centerX(r.center[0]).centerY(r.center[1]).template("force").strength(r.clusterFociStrength),o&&f.links(o),i&&f.nodes(i),f.forceLinkDistance(r.clusterEdgeDistance).forceLinkStrength(r.clusterEdgeStrength).forceCharge(r.clusterNodeStrength).forceNodeSize(r.clusterNodeSize),r.clusterForce=f,a.force("group",f)}if(a.force("center",ou.forceCenter(r.center[0],r.center[1])).force("charge",h).alpha(c).alphaDecay(u).alphaMin(s),r.preventOverlap&&r.overlapProcess(a),o){var l=ou.forceLink().id(function(v){return v.id}).links(o);r.edgeStrength&&l.strength(r.edgeStrength),r.linkDistance&&l.distance(r.linkDistance),r.edgeForce=l,a.force("link",l)}if(r.workerEnabled&&!QX()&&(r.workerEnabled=!1,console.warn("workerEnabled option is only supported when running in web worker.")),!r.workerEnabled)a.on("tick",function(){r.tick()}).on("end",function(){r.ticking=!1,r.onLayoutEnd&&r.onLayoutEnd()}),r.ticking=!0;else{a.stop();for(var d=KX(a),p=1;p<=d;p++)a.tick(),postMessage({nodes:i,currentTick:p,totalTicks:d,type:qX.LAYOUT_MESSAGE.TICK},void 0);r.ticking=!1}r.forceSimulation=a,r.ticking=!0}catch(g){r.ticking=!1,console.warn(g)}}},n.prototype.overlapProcess=function(e){var r=this,i=r.nodeSize,o=r.nodeSpacing,a,s,u=r.collideStrength;if((0,ns.isNumber)(o)?s=function(){return o}:(0,ns.isFunction)(o)?s=o:s=function(){return 0},!i)a=function(f){if(f.size){if((0,ns.isArray)(f.size)){var d=f.size[0]>f.size[1]?f.size[0]:f.size[1];return d/2+s(f)}if((0,ns.isObject)(f.size)){var d=f.size.width>f.size.height?f.size.width:f.size.height;return d/2+s(f)}return f.size/2+s(f)}return 10+s(f)};else if((0,ns.isFunction)(i))a=function(f){var d=i(f);return d+s(f)};else if((0,ns.isArray)(i)){var c=i[0]>i[1]?i[0]:i[1],l=c/2;a=function(f){return l+s(f)}}else if((0,ns.isNumber)(i)){var h=i/2;a=function(f){return h+s(f)}}else a=function(){return 10};e.force("collisionForce",ou.forceCollide(a).strength(u))},n.prototype.updateCfg=function(e){var r=this;r.ticking&&(r.forceSimulation.stop(),r.ticking=!1),r.forceSimulation=null,Object.assign(r,e)},n.prototype.destroy=function(){var e=this;e.ticking&&(e.forceSimulation.stop(),e.ticking=!1),e.nodes=null,e.edges=null,e.destroyed=!0},n}(HX.Base);Pp.ForceLayout=ZX;function KX(t){var n=t.alphaMin(),e=t.alphaTarget(),r=t.alpha(),i=Math.log((n-e)/(r-e))/Math.log(1-t.alphaDecay()),o=Math.ceil(i);return o}function QX(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}(function(t){var n=bt&&bt.__createBinding||(Object.create?function(r,i,o,a){a===void 0&&(a=o);var s=Object.getOwnPropertyDescriptor(i,o);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(r,a,s)}:function(r,i,o,a){a===void 0&&(a=o),r[a]=i[o]}),e=bt&&bt.__exportStar||function(r,i){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&n(i,r,o)};Object.defineProperty(t,"__esModule",{value:!0}),e(Pp,t)})(i1);var Ql={},JX=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Ql,"__esModule",{value:!0});Ql.CircularLayout=void 0;var $X=Yn,so=Ln();function tH(t,n,e,r){t.forEach(function(i,o){t[o].children=[],t[o].parent=[]}),r?n.forEach(function(i){var o=(0,so.getEdgeTerminal)(i,"source"),a=(0,so.getEdgeTerminal)(i,"target"),s=0;o&&(s=e[o]);var u=0;a&&(u=e[a]);var c=t[s].children,l=t[u].parent;c.push(t[u].id),l.push(t[s].id)}):n.forEach(function(i){var o=(0,so.getEdgeTerminal)(i,"source"),a=(0,so.getEdgeTerminal)(i,"target"),s=0;o&&(s=e[o]);var u=0;a&&(u=e[a]);var c=t[s].children,l=t[u].children;c.push(t[u].id),l.push(t[s].id)})}function eH(t,n,e){for(var r=e.length,i=0;i<r;i++){var o=(0,so.getEdgeTerminal)(e[i],"source"),a=(0,so.getEdgeTerminal)(e[i],"target");if(t.id===o&&n.id===a||n.id===o&&t.id===a)return!0}return!1}function nH(t,n){var e=t.degree,r=n.degree;return e<r?-1:e>r?1:0}var rH=function(t){JX(n,t);function n(e){var r=t.call(this)||this;return r.radius=null,r.nodeSize=void 0,r.startRadius=null,r.endRadius=null,r.startAngle=0,r.endAngle=2*Math.PI,r.clockwise=!0,r.divisions=1,r.ordering=null,r.angleRatio=1,r.nodes=[],r.edges=[],r.nodeMap={},r.degrees=[],r.width=300,r.height=300,r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1}},n.prototype.execute=function(){var e,r=this,i=r.nodes,o=r.edges,a=i.length;if(a===0){r.onLayoutEnd&&r.onLayoutEnd();return}!r.width&&typeof window<"u"&&(r.width=window.innerWidth),!r.height&&typeof window<"u"&&(r.height=window.innerHeight),r.center||(r.center=[r.width/2,r.height/2]);var s=r.center;if(a===1){i[0].x=s[0],i[0].y=s[1],r.onLayoutEnd&&r.onLayoutEnd();return}var u=r.radius,c=r.startRadius,l=r.endRadius,h=r.divisions,f=r.startAngle,d=r.endAngle,p=r.angleRatio,g=r.ordering,v=r.clockwise,m=r.nodeSpacing,y=r.nodeSize,b=(d-f)/a,x={};i.forEach(function(P,j){x[P.id]=j}),r.nodeMap=x;var w=(0,so.getDegree)(i.length,x,o);if(r.degrees=w,m){var E=(0,so.getFuncByUnknownType)(10,m),M=(0,so.getFuncByUnknownType)(10,y),_=-1/0;i.forEach(function(P){var j=M(P);_<j&&(_=j)});var k=0;i.forEach(function(P,j){j===0?k+=_||10:k+=(E(P)||0)+(_||10)}),u=k/(2*Math.PI)}else!u&&!c&&!l?u=r.height>r.width?r.width/2:r.height/2:!c&&l?c=l:c&&!l&&(l=c);var S=b*p,A=[];g==="topology"?A=r.topologyOrdering():g==="topology-directed"?A=r.topologyOrdering(!0):g==="degree"?A=r.degreeOrdering():A=i;for(var C=Math.ceil(a/h),I=0;I<a;++I){var N=u;!N&&c!==null&&l!==null&&(N=c+I*(l-c)/(a-1)),N||(N=10+I*100/(a-1));var D=f+I%C*S+2*Math.PI/h*Math.floor(I/C);v||(D=d-I%C*S-2*Math.PI/h*Math.floor(I/C)),A[I].x=s[0]+Math.cos(D)*N,A[I].y=s[1]+Math.sin(D)*N,A[I].weight=w[I].all}return(e=r.onLayoutEnd)===null||e===void 0||e.call(r),{nodes:A,edges:this.edges}},n.prototype.topologyOrdering=function(e){e===void 0&&(e=!1);var r=this,i=r.degrees,o=r.edges,a=r.nodes,s=(0,so.clone)(a),u=r.nodeMap,c=[s[0]],l=[a[0]],h=[],f=a.length;h[0]=!0,tH(s,o,u,e);var d=0;return s.forEach(function(p,g){if(g!==0)if((g===f-1||i[g].all!==i[g+1].all||eH(c[d],p,o))&&!h[g])c.push(p),l.push(a[u[p.id]]),h[g]=!0,d++;else{for(var v=c[d].children,m=!1,y=0;y<v.length;y++){var b=u[v[y]];if(i[b].all===i[g].all&&!h[b]){c.push(s[b]),l.push(a[u[s[b].id]]),h[b]=!0,m=!0;break}}for(var x=0;!m&&(h[x]||(c.push(s[x]),l.push(a[u[s[x].id]]),h[x]=!0,m=!0),x++,x!==f););}}),l},n.prototype.degreeOrdering=function(){var e=this,r=e.nodes,i=[],o=e.degrees;return r.forEach(function(a,s){a.degree=o[s].all,i.push(a)}),i.sort(nH),i},n.prototype.getType=function(){return"circular"},n}($X.Base);Ql.CircularLayout=rH;var tc={},s1={},u1={},c1={},l1={},h1={};Object.defineProperty(h1,"__esModule",{value:!0});var iH=function(t,n){if(t!=="next"&&t!=="prev")return n},UE=function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev},oH=function(){function t(){var n={};n.prev=n,n.next=n.prev,this.shortcut=n}return t.prototype.dequeue=function(){var n=this.shortcut,e=n.prev;if(e&&e!==n)return UE(e),e},t.prototype.enqueue=function(n){var e=this.shortcut;n.prev&&n.next&&UE(n),n.next=e.next,e.next.prev=n,e.next=n,n.prev=e},t.prototype.toString=function(){for(var n=[],e=this.shortcut,r=e.prev;r!==e;)n.push(JSON.stringify(r,iH)),r=r==null?void 0:r.prev;return"[".concat(n.join(", "),"]")},t}();h1.default=oH;var Au;(function(t){t.DEFAULT_EDGE_NAME="\0",t.GRAPH_NODE="\0",t.EDGE_KEY_DELIM=""})(Au||(Au={}));function YE(t,n){var e=t.get(n)||0;t.set(n,e+1)}function VE(t,n){var e=t.get(n);e!==void 0&&(e=e-1,e>0?t.set(n,e):t.delete(n))}function U3(t,n,e,r){var i=String(n),o=String(e);if(!t&&i>o){var a=i;i=o,o=a}return i+Au.EDGE_KEY_DELIM+o+Au.EDGE_KEY_DELIM+(r===void 0?Au.DEFAULT_EDGE_NAME:r)}function WE(t,n,e,r){var i=String(n),o=String(e),a={v:n,w:e};if(!t&&i>o){var s=a.v;a.v=a.w,a.w=s}return r!==void 0&&(a.name=r),a}function U0(t,n){return U3(t,n.v,n.w,n.name)}function XE(t){return typeof t=="function"}var aH=function(t){return t.nodes().map(function(n){var e=t.node(n),r=t.parent(n),i={id:n,value:e,parent:r};return i.value===void 0&&delete i.value,i.parent===void 0&&delete i.parent,i})},sH=function(t){return t.edges().map(function(n){var e=t.edge(n),r={v:n.v,w:n.w,value:e,name:n.name};return r.name===void 0&&delete r.name,r.value===void 0&&delete r.value,r})},uH=function(t){var n={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:aH(t),edges:sH(t),value:t.graph()};return n.value===void 0&&delete n.value,n},cH=function(t){var n=new Ps(t.options);return t.value!==void 0&&n.setGraph(t.value),t.nodes.forEach(function(e){n.setNode(e.id,e.value),e.parent&&n.setParent(e.id,e.parent)}),t.edges.forEach(function(e){n.setEdge(e.v,e.w,e.value,e.name)}),n};function HE(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,r)}return e}function qE(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?HE(Object(e),!0).forEach(function(r){lH(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):HE(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}function lH(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function hH(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function ZE(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fH(t,n,e){return n&&ZE(t.prototype,n),e&&ZE(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}var dH={compound:!1,multigraph:!1,directed:!0},Ps=function(){function t(){var n=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hH(this,t),this.directed=!0,this.multigraph=!1,this.compound=!1,this.GRAPH_NODE=Au.GRAPH_NODE,this.label=void 0,this.nodeCountNum=0,this.edgeCountNum=0,this.defaultNodeLabelFn=function(){},this.defaultEdgeLabelFn=function(){},this.parentMap=void 0,this.childrenMap=void 0,this.nodesLabelMap=new Map,this.inEdgesMap=new Map,this.outEdgesMap=new Map,this.predecessorsMap=new Map,this.successorsMap=new Map,this.edgesMap=new Map,this.edgesLabelsMap=new Map,this.isDirected=function(){return n.directed},this.isMultigraph=function(){return n.multigraph},this.isCompound=function(){return n.compound},this.setGraph=function(i){return n.label=i,n},this.graph=function(){return n.label},this.setDefaultNodeLabel=function(i){return XE(i)?n.defaultNodeLabelFn=i:n.defaultNodeLabelFn=function(){return i},n},this.nodeCount=function(){return n.nodeCountNum},this.node=function(i){return n.nodesLabelMap.get(i)},this.nodes=function(){return Array.from(n.nodesLabelMap.keys())},this.sources=function(){return n.nodes().filter(function(i){var o;return!(!((o=n.inEdgesMap.get(i))===null||o===void 0)&&o.size)})},this.sinks=function(){return n.nodes().filter(function(i){var o;return!(!((o=n.outEdgesMap.get(i))===null||o===void 0)&&o.size)})},this.setNodes=function(i,o){return i.map(function(a){return n.setNode(a,o)}),n},this.hasNode=function(i){return n.nodesLabelMap.has(i)},this.checkCompound=function(){if(!n.isCompound())throw new Error("Cannot construct parent-children relations in a non-compound graph")},this.parent=function(i){if(n.isCompound()){var o,a=(o=n.parentMap)===null||o===void 0?void 0:o.get(i);if(a!==n.GRAPH_NODE)return a}},this.removeFromParentsChildList=function(i){var o=n.parentMap.get(i);n.childrenMap.get(o).delete(i)},this.setParent=function(i,o){var a,s;n.checkCompound();for(var u=o===void 0?n.GRAPH_NODE:o,c=n.parent(u);c;){if(i===c)throw new Error("Setting "+o+" as parent of "+i+" would create a cycle");c=n.parent(c)}o&&n.setNode(o),n.setNode(i),n.removeFromParentsChildList(i),(a=n.parentMap)===null||a===void 0||a.set(i,u);var l=n.childrenMap.get(u);return l.set(i,!0),(s=n.childrenMap)===null||s===void 0||s.set(u,l),n},this.children=function(i){var o=i===void 0?n.GRAPH_NODE:i;if(n.isCompound()){var a,s=(a=n.childrenMap)===null||a===void 0?void 0:a.get(o);return s?Array.from(s.keys()):void 0}if(o===n.GRAPH_NODE)return n.nodes();if(i&&n.hasNode(i))return[]},this.predecessors=function(i){var o=n.predecessorsMap.get(i);return o?Array.from(o.keys()):void 0},this.successors=function(i){var o=n.successorsMap.get(i);return o?Array.from(o.keys()):void 0},this.neighbors=function(i){var o;if(n.hasNode(i))return Array.from(new Set((o=n.predecessors(i))===null||o===void 0?void 0:o.concat(n.successors(i))))},this.isLeaf=function(i){var o;if(n.isDirected()){var a;return!(!((a=n.successors(i))===null||a===void 0)&&a.length)}return!(!((o=n.neighbors(i))===null||o===void 0)&&o.length)},this.filterNodes=function(i){var o=n.directed,a=n.multigraph,s=n.compound,u=new t({directed:o,multigraph:a,compound:s});if(u.setGraph(n.graph()),n.nodes().forEach(function(l){i(l)&&u.setNode(l,n.node(l))}),n.edges().forEach(function(l){u.hasNode(l.v)&&u.hasNode(l.w)&&u.setEdgeObj(l,n.edge(l))}),s){var c=function(l){for(var h=n.parent(l);h!==void 0&&!u.hasNode(h);)h=n.parent(h);return h};u.nodes().forEach(function(l){u.setParent(l,c(l))})}return u},this.setDefaultEdgeLabel=function(i){return XE(i)?n.defaultEdgeLabelFn=i:n.defaultEdgeLabelFn=function(){return i},n},this.edgeCount=function(){return n.edgeCountNum},this.setEdgeObj=function(i,o){return n.setEdge(i.v,i.w,o,i.name)},this.setPath=function(i,o){return i.reduce(function(a,s){return n.setEdge(a,s,o),s}),n},this.edgeFromArgs=function(i,o,a){return n.edge({v:i,w:o,name:a})},this.edge=function(i){return n.edgesLabelsMap.get(U0(n.isDirected(),i))},this.hasEdge=function(i,o,a){return n.edgesLabelsMap.has(U0(n.isDirected(),{v:i,w:o,name:a}))},this.removeEdgeObj=function(i){var o=i.v,a=i.w,s=i.name;return n.removeEdge(o,a,s)},this.edges=function(){return Array.from(n.edgesMap.values())},this.inEdges=function(i,o){var a=n.inEdgesMap.get(i);if(a)return Array.from(a.values()).filter(function(s){return!o||s.v===o})},this.outEdges=function(i,o){var a=n.outEdgesMap.get(i);if(a)return Array.from(a.values()).filter(function(s){return!o||s.w===o})},this.nodeEdges=function(i,o){var a;if(n.hasNode(i))return(a=n.inEdges(i,o))===null||a===void 0?void 0:a.concat(n.outEdges(i,o))},this.toJSON=function(){return uH(n)},this.nodeInDegree=function(i){var o=n.inEdgesMap.get(i);return o?o.size:0},this.nodeOutDegree=function(i){var o=n.outEdgesMap.get(i);return o?o.size:0},this.nodeDegree=function(i){return n.nodeInDegree(i)+n.nodeOutDegree(i)},this.source=function(i){return i.v},this.target=function(i){return i.w};var r=qE(qE({},dH),e);this.compound=r.compound,this.directed=r.directed,this.multigraph=r.multigraph,this.compound&&(this.parentMap=new Map,this.childrenMap=new Map)}return fH(t,[{key:"setNode",value:function(n,e){var r=this.nodesLabelMap,i=this.defaultNodeLabelFn,o=this.isCompound,a=this.parentMap,s=this.childrenMap,u=this.inEdgesMap,c=this.outEdgesMap,l=this.predecessorsMap,h=this.successorsMap;if(r.has(n))return e!==void 0&&r.set(n,e),this;if(r.set(n,e||i(n)),o()){var f;a==null||a.set(n,this.GRAPH_NODE),s==null||s.set(n,new Map),s!=null&&s.has(this.GRAPH_NODE)||s==null||s.set(this.GRAPH_NODE,new Map),s==null||(f=s.get(this.GRAPH_NODE))===null||f===void 0||f.set(n,!0)}return[u,c,l,h].forEach(function(d){return d.set(n,new Map)}),this.nodeCountNum+=1,this}},{key:"removeNode",value:function(n){var e=this;if(this.hasNode(n)){var r=function(p){e.removeEdge(p.v,p.w,p.name)},i=this.inEdgesMap,o=this.outEdgesMap,a=this.predecessorsMap,s=this.successorsMap,u=this.nodesLabelMap;if(this.isCompound()){var c,l,h;this.removeFromParentsChildList(n),(c=this.parentMap)===null||c===void 0||c.delete(n),(l=this.children(n))===null||l===void 0||l.forEach(function(p){return e.setParent(p)}),(h=this.childrenMap)===null||h===void 0||h.delete(n)}var f=i.get(n),d=o.get(n);Array.from(f.values()).forEach(function(p){return r(p)}),Array.from(d.values()).forEach(function(p){return r(p)}),u.delete(n),i.delete(n),o.delete(n),a.delete(n),s.delete(n),this.nodeCountNum-=1}return this}},{key:"setEdge",value:function(n,e,r,i){var o,a,s=WE(this.isDirected(),n,e,i),u=U0(this.isDirected(),s),c=s.v,l=s.w;if(this.edgesLabelsMap.has(u))return this.edgesLabelsMap.set(u,r),this;if(i!==void 0&&!this.isMultigraph())throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(c),this.setNode(l),this.edgesLabelsMap.set(u,r||this.defaultEdgeLabelFn(c,l,i)),Object.freeze(s),this.edgesMap.set(u,s);var h=this.predecessorsMap.get(l),f=this.successorsMap.get(c);return YE(h,c),YE(f,l),(o=this.inEdgesMap.get(l))===null||o===void 0||o.set(u,s),(a=this.outEdgesMap.get(c))===null||a===void 0||a.set(u,s),this.edgeCountNum+=1,this}},{key:"removeEdge",value:function(n,e,r){var i=U3(this.isDirected(),n,e,r),o=this.edgesMap.get(i);if(o){var a=WE(this.isDirected(),n,e,r),s=a.v,u=a.w;this.edgesLabelsMap.delete(i),this.edgesMap.delete(i);var c=this.predecessorsMap.get(u),l=this.successorsMap.get(s);VE(c,s),VE(l,u),this.inEdgesMap.get(u).delete(i),this.outEdgesMap.get(s).delete(i),this.edgeCountNum-=1}return this}}]),t}();Ps.fromJSON=cH;function ym(t){"@babel/helpers - typeof";return ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ym(t)}function pH(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function KE(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gH(t,n,e){return n&&KE(t.prototype,n),e&&KE(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function vs(){return typeof Reflect<"u"&&Reflect.get?vs=Reflect.get:vs=function(t,n,e){var r=vH(t,n);if(r){var i=Object.getOwnPropertyDescriptor(r,n);return i.get?i.get.call(arguments.length<3?t:e):i.value}},vs.apply(this,arguments)}function vH(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&(t=Yo(t),t!==null););return t}function mH(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&bm(t,n)}function bm(t,n){return bm=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},bm(t,n)}function yH(t){var n=wH();return function(){var e=Yo(t),r;if(n){var i=Yo(this).constructor;r=Reflect.construct(e,arguments,i)}else r=e.apply(this,arguments);return bH(this,r)}}function bH(t,n){if(n&&(ym(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xH(t)}function xH(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yo(t){return Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Yo(t)}var EH=function(t){mH(e,t);var n=yH(e);function e(){var r;pH(this,e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=n.call.apply(n,[this].concat(o)),r.eventPool={},r}return gH(e,[{key:"appendEvent",value:function(r,i){this.eventPool[r]||(this.eventPool[r]=[]),this.eventPool[r].push(i)}},{key:"removeEvent",value:function(r,i){if(this.eventPool[r]){var o=this.eventPool[r].indexOf(i);o>-1&&this.eventPool[r].splice(o,1)}}},{key:"emitEvent",value:function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];this.eventPool[r]&&this.eventPool[r].forEach(function(s){s.apply(void 0,o)})}},{key:"setNode",value:function(r,i){return vs(Yo(e.prototype),"setNode",this).call(this,r,i),this.emitEvent("nodeAdd",r,i),this}},{key:"removeNode",value:function(r){return vs(Yo(e.prototype),"removeNode",this).call(this,r),this.emitEvent("nodeRemove",r),this}},{key:"setEdge",value:function(r,i,o,a){return vs(Yo(e.prototype),"setEdge",this).call(this,r,i,o,a),this.emitEvent("edgeAdd",r,i,o,a),this}},{key:"removeEdge",value:function(r,i,o){return vs(Yo(e.prototype),"removeEdge",this).call(this,r,i,o),this.emitEvent("edgeRemove",r,i,o),this}}]),e}(Ps);function QE(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function MH(t,n,e){return n&&QE(t.prototype,n),e&&QE(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function SH(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var Y3=MH(function t(){var n=this;SH(this,t),this.arr=[],this.keyIndice=new Map,this.size=function(){return n.arr.length},this.keys=function(){return n.arr.map(function(e){return e.key})},this.has=function(e){return n.keyIndice.has(e)},this.priority=function(e){var r=n.keyIndice.get(e);if(r!==void 0)return n.arr[r].priority},this.swap=function(e,r){var i=n.arr,o=n.keyIndice,a=[i[e],i[r]],s=a[0],u=a[1];i[e]=u,i[r]=s,o.set(s.key,r),o.set(u.key,e)},this.innerDecrease=function(e){for(var r=n.arr,i=r[e].priority,o,a=e;a!==0;){var s;if(o=a>>1,((s=r[o])===null||s===void 0?void 0:s.priority)<i)break;n.swap(a,o),a=o}},this.heapify=function(e){var r=n.arr,i=e<<1,o=i+1,a=e;i<r.length&&(a=r[i].priority<r[a].priority?i:a,o<r.length&&(a=r[o].priority<r[a].priority?o:a),a!==e&&(n.swap(e,a),n.heapify(a)))},this.min=function(){if(n.size()===0)throw new Error("Queue underflow");return n.arr[0].key},this.add=function(e,r){var i=n.keyIndice,o=n.arr;if(!i.has(e)){var a=o.length;return i.set(e,a),o.push({key:e,priority:r}),n.innerDecrease(a),!0}return!1},this.removeMin=function(){n.swap(0,n.arr.length-1);var e=n.arr.pop();return n.keyIndice.delete(e.key),n.heapify(0),e.key},this.decrease=function(e,r){if(!n.has(e))throw new Error("There's no key named ".concat(e));var i=n.keyIndice.get(e);if(r>n.arr[i].priority)throw new Error("New priority is greater than current priority.Key: ".concat(e," Old: + ").concat(n.arr[i].priority," New: ").concat(r));n.arr[i].priority=r,n.innerDecrease(i)}}),_H=function(t,n){var e=new Ps,r=new Map,i=new Y3,o;function a(c){var l=c.v===o?c.w:c.v,h=i.priority(l);if(h!==void 0){var f=n(c);f<h&&(r.set(l,o),i.decrease(l,f))}}if(t.nodeCount()===0)return e;t.nodes().forEach(function(c){i.add(c,Number.POSITIVE_INFINITY),e.setNode(c)}),i.decrease(t.nodes()[0],0);for(var s=!1;i.size()>0;){var u;if(o=i.removeMin(),r.has(o))e.setEdge(o,r.get(o));else{if(s)throw new Error("Input graph is not connected: "+t.graph());s=!0}(u=t.nodeEdges(o))===null||u===void 0||u.forEach(a)}return e},kH=function(t){var n=new Set,e=[],r=t.nodes();return r.forEach(function(i){for(var o=[],a=[i];a.length>0;){var s=a.pop();if(!n.has(s)){var u,c;n.add(s),o.push(s),(u=t.successors(s))===null||u===void 0||u.forEach(function(l){return a.push(l)}),(c=t.predecessors(s))===null||c===void 0||c.forEach(function(l){return a.push(l)})}}o.length&&e.push(o)}),e},AH=function t(n,e,r,i,o,a){i.includes(e)||(i.push(e),r||a.push(e),o(e).forEach(function(s){return t(n,s,r,i,o,a)}),r&&a.push(e))},f1=function(t,n,e){var r=Array.isArray(n)?n:[n],i=function(s){return t.isDirected()?t.successors(s):t.neighbors(s)},o=[],a=[];return r.forEach(function(s){if(t.hasNode(s))AH(t,s,e==="post",a,i,o);else throw new Error("Graph does not have node: "+s)}),o};function CH(t,n){return NH(t)||OH(t,n)||TH(t,n)||IH()}function IH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TH(t,n){if(t){if(typeof t=="string")return JE(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return JE(t,n)}}function JE(t,n){(n==null||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function OH(t,n){var e=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var r=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(r.push(a.value),!(n&&r.length===n));i=!0);}catch(u){o=!0,s=u}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return r}}function NH(t){if(Array.isArray(t))return t}var DH=function(){return 1},V3=function(t,n,e,r){return PH(t,n,e||DH,r||function(i){return t.outEdges(i)})},PH=function(t,n,e,r){var i=new Map,o=new Y3,a,s,u=function(l){var h=l.v!==a?l.v:l.w,f=i.get(h),d=e(l),p=s.distance+d;if(d<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+l+" Weight: "+d);p<f.distance&&(f.distance=p,f.predecessor=a,o.decrease(h,p))};for(t.nodes().forEach(function(l){var h=l===n?0:Number.POSITIVE_INFINITY;i.set(l,{distance:h}),o.add(l,h)});o.size()>0&&(a=o.removeMin(),s=i.get(a),!(s&&s.distance===Number.POSITIVE_INFINITY));)r(a).forEach(u);var c={};return Array.from(i.entries()).forEach(function(l){var h=CH(l,2),f=h[0],d=h[1];return c[String(f)]=d,c}),c},LH=function(t,n,e){var r={};return t.nodes().forEach(function(i){return r[String(i)]=V3(t,i,n,e),r}),r},W3=function(t){var n=0,e=[],r=new Map,i=[];function o(a){var s,u={onStack:!0,lowlink:n,index:n};if(r.set(a,u),n+=1,e.push(a),(s=t.successors(a))===null||s===void 0||s.forEach(function(f){var d;if(r.has(f)){if(!((d=r.get(f))===null||d===void 0)&&d.onStack){var p=r.get(f);u.lowlink=Math.min(u.lowlink,p.index)}}else{o(f);var g=r.get(f);u.lowlink=Math.min(u.lowlink,g.lowlink)}}),u.lowlink===u.index){var c=[],l;do{l=e.pop();var h=r.get(l);h.onStack=!1,c.push(l)}while(a!==l);i.push(c)}}return t.nodes().forEach(function(a){r.has(a)||o(a)}),i},jH=function(t){return W3(t).filter(function(n){return n.length>1||n.length===1&&t.hasEdge(n[0],n[0])})};function xm(t){"@babel/helpers - typeof";return xm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},xm(t)}function $E(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function RH(t,n,e){return n&&$E(t.prototype,n),e&&$E(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function FH(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function BH(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&Al(t,n)}function zH(t){var n=X3();return function(){var e=Cl(t),r;if(n){var i=Cl(this).constructor;r=Reflect.construct(e,arguments,i)}else r=e.apply(this,arguments);return GH(this,r)}}function GH(t,n){if(n&&(xm(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UH(t)}function UH(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wm(t){var n=typeof Map=="function"?new Map:void 0;return wm=function(e){if(e===null||!YH(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(e))return n.get(e);n.set(e,r)}function r(){return ed(e,arguments,Cl(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Al(r,e)},wm(t)}function ed(t,n,e){return X3()?ed=Reflect.construct:ed=function(r,i,o){var a=[null];a.push.apply(a,i);var s=Function.bind.apply(r,a),u=new s;return o&&Al(u,o.prototype),u},ed.apply(null,arguments)}function X3(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function YH(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function Al(t,n){return Al=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},Al(t,n)}function Cl(t){return Cl=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Cl(t)}var Em=function(t){BH(e,t);var n=zH(e);function e(){return FH(this,e),n.apply(this,arguments)}return RH(e)}(wm(Error));function H3(t){var n=new Set,e=new Set,r=[];function i(o){if(e.has(o))throw new Em;if(!n.has(o)){var a;e.add(o),n.add(o),(a=t.predecessors(o))===null||a===void 0||a.forEach(i),e.delete(o),r.push(o)}}if(t.sinks().forEach(i),n.size!==t.nodeCount())throw new Em;return r}var VH=function(t){try{H3(t)}catch(n){if(n instanceof Em)return!1;throw n}return!0},WH=function(t,n){return f1(t,n,"post")},XH=function(t,n){return f1(t,n,"pre")},HH=function(){return 1};function qH(t,n,e){return ZH(t,n||HH,e||function(r){return t.outEdges(r)})}function ZH(t,n,e){var r={},i=t.nodes();return i.forEach(function(o){var a=String(o);r[a]={},r[a][a]={distance:0},i.forEach(function(s){o!==s&&(r[a][String(s)]={distance:Number.POSITIVE_INFINITY})}),e(o).forEach(function(s){var u=s.v===o?s.w:s.v,c=n(s);r[a][String(u)]={distance:c,predecessor:o}})}),i.forEach(function(o){var a=String(o),s=r[a];i.forEach(function(u){var c=String(u),l=r[c];i.forEach(function(h){var f=String(h),d=l[a],p=s[f],g=l[f],v=d.distance+p.distance;v<g.distance&&(g.distance=v,g.predecessor=p.predecessor)})})}),r}const KH=Object.freeze(Object.defineProperty({__proto__:null,components:kH,dfs:f1,dijkstra:V3,dijkstraAll:LH,findCycles:jH,floydWarshall:qH,isAcyclic:VH,postorder:WH,preorder:XH,prim:_H,tarjan:W3,topsort:H3},Symbol.toStringTag,{value:"Module"}));var QH=function(t,n){for(var e=t.nodes(),r=0;r<e.length;r++){var i=e[r];if(n.hasNode(i))return!0}return!1},q3=function(t,n){for(var e=t.edges(),r=0;r<e.length;r++){var i=e[r];if(n.hasEdge(i.v,i.w,i.name))return!0}return!1},Z3=function(t,n){var e=t.nodes(),r=e.filter(function(i){return n.hasNode(i)});return r},K3=function(t,n){var e=t.edges(),r=e.filter(function(i){return n.hasEdge(i.v,i.w,i.name)});return r},Q3=function(t,n){return t.isCompound()===n.isCompound()&&t.isDirected()===n.isDirected()&&t.isMultigraph()===n.isMultigraph()},jp=function(t,n){var e=Z3(t,n);return e.length===t.nodes().length},d1=function(t,n){var e=K3(t,n);return e.length===t.edges().length},JH=function(t,n){return Q3(t,n)&&t.nodeCount()===n.nodeCount()&&jp(t,n)&&t.edgeCount()===n.edgeCount()&&d1(t,n)},$H=function(t,n){return jp(t,n)&&d1(t,n)};function tq(t,n){return iq(t)||rq(t,n)||nq(t,n)||eq()}function eq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nq(t,n){if(t){if(typeof t=="string")return tM(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return tM(t,n)}}function tM(t,n){(n==null||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function rq(t,n){var e=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(e!=null){var r=[],i=!0,o=!1,a,s;try{for(e=e.call(t);!(i=(a=e.next()).done)&&(r.push(a.value),!(n&&r.length===n));i=!0);}catch(u){o=!0,s=u}finally{try{!i&&e.return!=null&&e.return()}finally{if(o)throw s}}return r}}function iq(t){if(Array.isArray(t))return t}function oq(t){return t instanceof Ps}function Fd(t){if(t.isMultigraph())return!1;for(var n=t.edges(),e=new Map,r=0;r<n.length;r++){var i=n[r];if(i.v===i.w)return!1;var o=[i.v,i.w].sort(),a=tq(o,2),s=a[0],u=a[1],c="".concat(s,"-").concat(u);if(e.has(c))return!1;e.set(c,!0)}return!0}function aq(t){return t.nodes().length===0}function sq(t){for(var n=t.edges(),e=0;e<n.length;e++){var r=n[e];if(r.v===r.w)return!0}return!1}const uq=Object.freeze(Object.defineProperty({__proto__:null,hasSelfLoop:sq,isGraph:oq,isNullGraph:aq,isSimpleGraph:Fd},Symbol.toStringTag,{value:"Module"}));var cq=function(t,n){if(!Fd(t)||!Fd(n)||!jp(t,n)||q3(t,n))return!1;var e=t.nodeCount();return t.edgeCount()+n.edgeCount()===e*(e-1)/2};const lq=Object.freeze(Object.defineProperty({__proto__:null,containAllSameEdges:d1,containAllSameNodes:jp,containSameEdges:q3,containSameNodes:QH,getSameEdges:K3,getSameNodes:Z3,isGraphComplement:cq,isGraphContainsAnother:$H,isGraphOptionSame:Q3,isGraphSame:JH},Symbol.toStringTag,{value:"Module"}));var hq=function(t){if(!Fd(t))return null;for(var n=t.nodeCount(),e=new Ps({compound:t.isCompound(),directed:t.isDirected(),multigraph:t.isMultigraph()}),r=t.nodes(),i=0;i<n;i++){var o=r[i];e.setNode(o,t.node(o));for(var a=i+1;a<n;a++){var s=r[a];t.hasEdge(o,s)||e.setEdge(o,s)}}return e};const fq=Object.freeze(Object.defineProperty({__proto__:null,getGraphComplement:hq},Symbol.toStringTag,{value:"Module"})),dq=Object.freeze(Object.defineProperty({__proto__:null,Graph:Ps,GraphWithEvent:EH,algorithm:KH,comparision:lq,essence:uq,generate:fq},Symbol.toStringTag,{value:"Module"})),Rp=xo(dq);var J3=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),pq=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(l1,"__esModule",{value:!0});var gq=pq(h1),vq=Rp,mq=function(t){J3(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n}(gq.default),yq=function(t){J3(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n}(vq.Graph),bq=function(){return 1},xq=function(t,n){var e;if(t.nodeCount()<=1)return[];var r=Eq(t,n||bq),i=wq(r.graph,r.buckets,r.zeroIdx);return(e=i.map(function(o){return t.outEdges(o.v,o.w)}))===null||e===void 0?void 0:e.flat()},wq=function(t,n,e){for(var r=[],i=n[n.length-1],o=n[0],a;t.nodeCount();){for(;a=o.dequeue();)Y0(t,n,e,a);for(;a=i.dequeue();)Y0(t,n,e,a);if(t.nodeCount()){for(var s=n.length-2;s>0;--s)if(a=n[s].dequeue(),a){r=r.concat(Y0(t,n,e,a,!0));break}}}return r},Y0=function(t,n,e,r,i){var o,a,s=[];return(o=t.inEdges(r.v))===null||o===void 0||o.forEach(function(u){var c=t.edge(u),l=t.node(u.v);i&&s.push({v:u.v,w:u.w,in:0,out:0}),l.out===void 0&&(l.out=0),l.out-=c,Mm(n,e,l)}),(a=t.outEdges(r.v))===null||a===void 0||a.forEach(function(u){var c=t.edge(u),l=u.w,h=t.node(l);h.in===void 0&&(h.in=0),h.in-=c,Mm(n,e,h)}),t.removeNode(r.v),i?s:void 0},Eq=function(t,n){var e=new yq,r=0,i=0;t.nodes().forEach(function(c){e.setNode(c,{v:c,in:0,out:0})}),t.edges().forEach(function(c){var l=e.edge(c)||0,h=(n==null?void 0:n(c))||1,f=l+h;e.setEdge(c.v,c.w,f),i=Math.max(i,e.node(c.v).out+=h),r=Math.max(r,e.node(c.w).in+=h)});for(var o=[],a=i+r+3,s=0;s<a;s++)o.push(new mq);var u=r+1;return e.nodes().forEach(function(c){Mm(o,u,e.node(c))}),{buckets:o,zeroIdx:u,graph:e}},Mm=function(t,n,e){e.out?e.in?t[e.out-e.in+n].enqueue(e):t[t.length-1].enqueue(e):t[0].enqueue(e)};l1.default=xq;var Mq=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(c1,"__esModule",{value:!0});var Sq=Mq(l1),_q=function(t){var n=function(r){return function(i){var o;return((o=r.edge(i))===null||o===void 0?void 0:o.weight)||1}},e=t.graph().acyclicer==="greedy"?(0,Sq.default)(t,n(t)):kq(t);e==null||e.forEach(function(r){var i=t.edge(r);t.removeEdgeObj(r),i.forwardName=r.name,i.reversed=!0,t.setEdge(r.w,r.v,i,"rev-".concat(Math.random()))})},kq=function(t){var n=[],e={},r={},i=function(o){var a;r[o]||(r[o]=!0,e[o]=!0,(a=t.outEdges(o))===null||a===void 0||a.forEach(function(s){e[s.w]?n.push(s):i(s.w)}),delete e[o])};return t.nodes().forEach(i),n},Aq=function(t){t.edges().forEach(function(n){var e=t.edge(n);if(e.reversed){t.removeEdgeObj(n);var r=e.forwardName;delete e.reversed,delete e.forwardName,t.setEdge(n.w,n.v,e,r)}})};c1.default={run:_q,undo:Aq};var p1={},ti={},Ko={},Cq=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Ko,"__esModule",{value:!0});Ko.Graph=void 0;var Iq=Rp,Tq=function(t){Cq(n,t);function n(){return t!==null&&t.apply(this,arguments)||this}return n}(Iq.Graph);Ko.Graph=Tq;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.minBy=t.notime=t.time=t.partition=t.maxRank=t.addBorderNode=t.removeEmptyRanks=t.normalizeRanks=t.buildLayerMatrix=t.intersectRect=t.predecessorWeights=t.successorWeights=t.zipObject=t.asNonCompoundGraph=t.simplify=t.addDummyNode=void 0;var n=Ln(),e=Ko,r=function(x,w){return Number(x)-Number(w)},i=function(x,w,E,M){var _;do _="".concat(M).concat(Math.random());while(x.hasNode(_));return E.dummy=w,x.setNode(_,E),_};t.addDummyNode=i;var o=function(x){var w=new e.Graph().setGraph(x.graph());return x.nodes().forEach(function(E){w.setNode(E,x.node(E))}),x.edges().forEach(function(E){var M=w.edgeFromArgs(E.v,E.w)||{weight:0,minlen:1},_=x.edge(E);w.setEdge(E.v,E.w,{weight:M.weight+_.weight,minlen:Math.max(M.minlen,_.minlen)})}),w};t.simplify=o;var a=function(x){var w=new e.Graph({multigraph:x.isMultigraph()}).setGraph(x.graph());return x.nodes().forEach(function(E){var M;!((M=x.children(E))===null||M===void 0)&&M.length||w.setNode(E,x.node(E))}),x.edges().forEach(function(E){w.setEdgeObj(E,x.edge(E))}),w};t.asNonCompoundGraph=a;var s=function(x,w){return x==null?void 0:x.reduce(function(E,M,_){return E[M]=w[_],E},{})};t.zipObject=s;var u=function(x){var w={};return x.nodes().forEach(function(E){var M,_={};(M=x.outEdges(E))===null||M===void 0||M.forEach(function(k){var S;_[k.w]=(_[k.w]||0)+(((S=x.edge(k))===null||S===void 0?void 0:S.weight)||0)}),w[E]=_}),w};t.successorWeights=u;var c=function(x){var w=x.nodes(),E=w.map(function(M){var _,k={};return(_=x.inEdges(M))===null||_===void 0||_.forEach(function(S){k[S.v]=(k[S.v]||0)+x.edge(S).weight}),k});return(0,t.zipObject)(w,E)};t.predecessorWeights=c;var l=function(x,w){var E=Number(x.x),M=Number(x.y),_=Number(w.x)-E,k=Number(w.y)-M,S=Number(x.width)/2,A=Number(x.height)/2;if(!_&&!k)return{x:0,y:0};var C,I;return Math.abs(k)*S>Math.abs(_)*A?(k<0&&(A=-A),C=A*_/k,I=A):(_<0&&(S=-S),C=S,I=S*k/_),{x:E+C,y:M+I}};t.intersectRect=l;var h=function(x){for(var w=[],E=(0,t.maxRank)(x)+1,M=0;M<E;M++)w.push([]);x.nodes().forEach(function(_){var k=x.node(_);if(k){var S=k.rank;S!==void 0&&w[S]&&w[S].push(_)}});for(var M=0;M<E;M++)w[M]=w[M].sort(function(k,S){var A,C;return r((A=x.node(k))===null||A===void 0?void 0:A.order,(C=x.node(S))===null||C===void 0?void 0:C.order)});return w};t.buildLayerMatrix=h;var f=function(x){var w=x.nodes().filter(function(M){var _;return((_=x.node(M))===null||_===void 0?void 0:_.rank)!==void 0}).map(function(M){return x.node(M).rank}),E=Math.min.apply(Math,w);x.nodes().forEach(function(M){var _=x.node(M);_.hasOwnProperty("rank")&&E!==1/0&&(_.rank-=E)})};t.normalizeRanks=f;var d=function(x){var w=x.nodes(),E=w.filter(function(I){var N;return((N=x.node(I))===null||N===void 0?void 0:N.rank)!==void 0}).map(function(I){return x.node(I).rank}),M=Math.min.apply(Math,E),_=[];w.forEach(function(I){var N,D=(((N=x.node(I))===null||N===void 0?void 0:N.rank)||0)-M;_[D]||(_[D]=[]),_[D].push(I)});for(var k=0,S=x.graph().nodeRankFactor||0,A=0;A<_.length;A++){var C=_[A];C===void 0?A%S!==0&&(k-=1):k&&(C==null||C.forEach(function(I){var N=x.node(I);N&&(N.rank=N.rank||0,N.rank+=k)}))}};t.removeEmptyRanks=d;var p=function(x,w,E,M){var _={width:0,height:0};return(0,n.isNumber)(E)&&(0,n.isNumber)(M)&&(_.rank=E,_.order=M),(0,t.addDummyNode)(x,"border",_,w)};t.addBorderNode=p;var g=function(x){var w;return x.nodes().forEach(function(E){var M,_=(M=x.node(E))===null||M===void 0?void 0:M.rank;_!==void 0&&(w===void 0||_>w)&&(w=_)}),w||(w=0),w};t.maxRank=g;var v=function(x,w){var E={lhs:[],rhs:[]};return x==null||x.forEach(function(M){w(M)?E.lhs.push(M):E.rhs.push(M)}),E};t.partition=v;var m=function(x,w){var E=Date.now();try{return w()}finally{console.log("".concat(x," time: ").concat(Date.now()-E,"ms"))}};t.time=m;var y=function(x,w){return w()};t.notime=y;var b=function(x,w){return x.reduce(function(E,M){var _=w(E),k=w(M);return _>k?M:E})};t.minBy=b})(ti);Object.defineProperty(p1,"__esModule",{value:!0});var Oq=ti,Nq=function(t){t.graph().dummyChains=[],t.edges().forEach(function(n){return Dq(t,n)})},Dq=function(t,n){var e=n.v,r=t.node(e).rank,i=n.w,o=t.node(i).rank,a=n.name,s=t.edge(n),u=s.labelRank;if(o!==r+1){t.removeEdgeObj(n);var c=t.graph(),l,h,f;for(f=0,++r;r<o;++f,++r)s.points=[],h={edgeLabel:s,width:0,height:0,edgeObj:n,rank:r},l=(0,Oq.addDummyNode)(t,"edge",h,"_d"),r===u&&(h.width=s.width,h.height=s.height,h.dummy="edge-label",h.labelpos=s.labelpos),t.setEdge(e,l,{weight:s.weight},a),f===0&&(c.dummyChains||(c.dummyChains=[]),c.dummyChains.push(l)),e=l;t.setEdge(e,i,{weight:s.weight},a)}},Pq=function(t){var n;(n=t.graph().dummyChains)===null||n===void 0||n.forEach(function(e){var r=t.node(e),i=r.edgeLabel,o;r.edgeObj&&t.setEdgeObj(r.edgeObj,i);for(var a=e;r.dummy;)o=t.successors(a)[0],t.removeNode(a),i.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),a=o,r=t.node(a)})};p1.default={run:Nq,undo:Pq};var g1={},Pi={};Object.defineProperty(Pi,"__esModule",{value:!0});Pi.slack=Pi.longestPathWithLayer=Pi.longestPath=void 0;var $3=function(t){var n,e={},r=function(i){var o,a=t.node(i);if(!a)return 0;if(e[i])return a.rank;e[i]=!0;var s;return(o=t.outEdges(i))===null||o===void 0||o.forEach(function(u){var c=r(u.w),l=t.edge(u).minlen,h=c-l;h&&(s===void 0||h<s)&&(s=h)}),s||(s=0),a.rank=s,s};(n=t.sources())===null||n===void 0||n.forEach(function(i){return r(i)})};Pi.longestPath=$3;var tT=function(t){var n,e={},r,i=function(s){var u,c=t.node(s);if(!c)return 0;if(e[s])return c.rank;e[s]=!0;var l;return(u=t.outEdges(s))===null||u===void 0||u.forEach(function(h){var f=i(h.w),d=t.edge(h).minlen,p=f-d;p&&(l===void 0||p<l)&&(l=p)}),l||(l=0),(r===void 0||l<r)&&(r=l),c.rank=l,l};(n=t.sources())===null||n===void 0||n.forEach(function(s){t.node(s)&&i(s)}),r===void 0&&(r=0);var o={},a=function(s,u){var c,l=t.node(s),h=isNaN(l.layer)?u:l.layer;(l.rank===void 0||l.rank<h)&&(l.rank=h),!o[s]&&(o[s]=!0,(c=t.outEdges(s))===null||c===void 0||c.map(function(f){a(f.w,h+t.edge(f).minlen)}))};t.nodes().forEach(function(s){var u=t.node(s);u&&(isNaN(u.layer)?u.rank-=r:a(s,u.layer))})};Pi.longestPathWithLayer=tT;var eT=function(t,n){return t.node(n.w).rank-t.node(n.v).rank-t.edge(n).minlen};Pi.slack=eT;Pi.default={longestPath:$3,longestPathWithLayer:tT,slack:eT};var Na={};Object.defineProperty(Na,"__esModule",{value:!0});Na.feasibleTreeWithLayer=Na.feasibleTree=void 0;var Cs=Pi,Lq=ti,nT=Ko,rT=function(t){var n=new nT.Graph({directed:!1}),e=t.nodes()[0],r=t.nodeCount();n.setNode(e,{});for(var i,o;jq(n,t)<r;)i=oT(n,t),o=n.hasNode(i.v)?(0,Cs.slack)(t,i):-(0,Cs.slack)(t,i),aT(n,t,o);return n};Na.feasibleTree=rT;var jq=function(t,n){var e=function(r){n.nodeEdges(r).forEach(function(i){var o=i.v,a=r===o?i.w:o;!t.hasNode(a)&&!(0,Cs.slack)(n,i)&&(t.setNode(a,{}),t.setEdge(r,a,{}),e(a))})};return t.nodes().forEach(e),t.nodeCount()},iT=function(t){var n=new nT.Graph({directed:!1}),e=t.nodes()[0],r=t.nodes().filter(function(a){return!!t.node(a)}).length;n.setNode(e,{});for(var i,o;Rq(n,t)<r;)i=oT(n,t),o=n.hasNode(i.v)?(0,Cs.slack)(t,i):-(0,Cs.slack)(t,i),aT(n,t,o);return n};Na.feasibleTreeWithLayer=iT;var Rq=function(t,n){var e=function(r){var i;(i=n.nodeEdges(r))===null||i===void 0||i.forEach(function(o){var a=o.v,s=r===a?o.w:a;!t.hasNode(s)&&(n.node(s).layer!==void 0||!(0,Cs.slack)(n,o))&&(t.setNode(s,{}),t.setEdge(r,s,{}),e(s))})};return t.nodes().forEach(e),t.nodeCount()},oT=function(t,n){return(0,Lq.minBy)(n.edges(),function(e){return t.hasNode(e.v)!==t.hasNode(e.w)?(0,Cs.slack)(n,e):1/0})},aT=function(t,n,e){t.nodes().forEach(function(r){n.node(r).rank||(n.node(r).rank=0),n.node(r).rank+=e})};Na.default={feasibleTree:rT,feasibleTreeWithLayer:iT};var sT={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.exchangeEdges=t.enterEdge=t.leaveEdge=t.initLowLimValues=t.calcCutValue=t.initCutValues=void 0;var n=Na,e=Pi,r=ti,i=Rp,o=i.algorithm.preorder,a=i.algorithm.postorder,s=function(b){var x=(0,r.simplify)(b);(0,e.longestPath)(x);var w=(0,n.feasibleTree)(x);(0,t.initLowLimValues)(w),(0,t.initCutValues)(w,x);for(var E,M;E=(0,t.leaveEdge)(w);)M=(0,t.enterEdge)(w,x,E),(0,t.exchangeEdges)(w,x,E,M)},u=function(b,x){var w=a(b,b.nodes());w=w==null?void 0:w.slice(0,(w==null?void 0:w.length)-1),w==null||w.forEach(function(E){c(b,x,E)})};t.initCutValues=u;var c=function(b,x,w){var E=b.node(w),M=E.parent;b.edgeFromArgs(w,M).cutvalue=(0,t.calcCutValue)(b,x,w)},l=function(b,x,w){var E,M=b.node(w),_=M.parent,k=!0,S=x.edgeFromArgs(w,_),A=0;return S||(k=!1,S=x.edgeFromArgs(_,w)),A=S.weight,(E=x.nodeEdges(w))===null||E===void 0||E.forEach(function(C){var I=C.v===w,N=I?C.w:C.v;if(N!==_){var D=I===k,P=x.edge(C).weight;if(A+=D?P:-P,m(b,w,N)){var j=b.edgeFromArgs(w,N).cutvalue;A+=D?-j:j}}}),A};t.calcCutValue=l;var h=function(b,x){x===void 0&&(x=b.nodes()[0]),f(b,{},1,x)};t.initLowLimValues=h;var f=function(b,x,w,E,M){var _,k=w,S=w,A=b.node(E);return x[E]=!0,(_=b.neighbors(E))===null||_===void 0||_.forEach(function(C){x[C]||(S=f(b,x,S,C,E))}),A.low=k,A.lim=S++,M?A.parent=M:delete A.parent,S},d=function(b){return b.edges().find(function(x){return b.edge(x).cutvalue<0})};t.leaveEdge=d;var p=function(b,x,w){var E=w.v,M=w.w;x.hasEdge(E,M)||(E=w.w,M=w.v);var _=b.node(E),k=b.node(M),S=_,A=!1;_.lim>k.lim&&(S=k,A=!0);var C=x.edges().filter(function(I){return A===y(b,b.node(I.v),S)&&A!==y(b,b.node(I.w),S)});return(0,r.minBy)(C,function(I){return(0,e.slack)(x,I)})};t.enterEdge=p;var g=function(b,x,w,E){var M=w.v,_=w.w;b.removeEdge(M,_),b.setEdge(E.v,E.w,{}),(0,t.initLowLimValues)(b),(0,t.initCutValues)(b,x),v(b,x)};t.exchangeEdges=g;var v=function(b,x){var w=b.nodes().find(function(M){var _;return!(!((_=x.node(M))===null||_===void 0)&&_.parent)}),E=o(b,w);E=E==null?void 0:E.slice(1),E==null||E.forEach(function(M){var _=b.node(M).parent,k=x.edgeFromArgs(M,_),S=!1;k||(k=x.edgeFromArgs(_,M),S=!0),x.node(M).rank=x.node(_).rank+(S?k.minlen:-k.minlen)})},m=function(b,x,w){return b.hasEdge(x,w)},y=function(b,x,w){return w.low<=x.lim&&x.lim<=w.lim};t.default=s})(sT);var Fq=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(g1,"__esModule",{value:!0});var uT=Pi,Bq=Na,zq=Fq(sT),Gq=function(t){switch(t.graph().ranker){case"network-simplex":Yq(t);break;case"tight-tree":eM(t);break;case"longest-path":Uq(t);break;default:eM(t)}},Uq=uT.longestPath,eM=function(t){(0,uT.longestPathWithLayer)(t),(0,Bq.feasibleTreeWithLayer)(t)},Yq=function(t){(0,zq.default)(t)};g1.default=Gq;var v1={};Object.defineProperty(v1,"__esModule",{value:!0});var Vq=function(t){var n,e={},r=0,i=function(o){var a,s=r;(a=t.children(o))===null||a===void 0||a.forEach(i),e[o]={low:s,lim:r++}};return(n=t.children())===null||n===void 0||n.forEach(i),e},Wq=function(t,n,e,r){var i=[],o=[],a=Math.min(n[e].low,n[r].low),s=Math.max(n[e].lim,n[r].lim),u,c;u=e;do u=t.parent(u),i.push(u);while(u&&(n[u].low>a||s>n[u].lim));for(c=u,u=r;u&&u!==c;)o.push(u),u=t.parent(u);return{lca:c,path:i.concat(o.reverse())}},Xq=function(t){var n,e=Vq(t);(n=t.graph().dummyChains)===null||n===void 0||n.forEach(function(r){var i,o,a=r,s=t.node(a),u=s.edgeObj;if(u)for(var c=Wq(t,e,u.v,u.w),l=c.path,h=c.lca,f=0,d=l[f],p=!0;a!==u.w;){if(s=t.node(a),p){for(;d!==h&&((i=t.node(d))===null||i===void 0?void 0:i.maxRank)<s.rank;)f++,d=l[f];d===h&&(p=!1)}if(!p){for(;f<l.length-1&&((o=t.node(l[f+1]))===null||o===void 0?void 0:o.minRank)<=s.rank;)f++;d=l[f]}t.setParent(a,d),a=t.successors(a)[0]}})};v1.default=Xq;var m1={};Object.defineProperty(m1,"__esModule",{value:!0});var Sm=ti,Hq=function(t){var n,e=(0,Sm.addDummyNode)(t,"root",{},"_root"),r=qq(t),i=Math.max.apply(Math,Object.values(r));Math.abs(i)===1/0&&(i=1);var o=i-1,a=2*o+1;t.graph().nestingRoot=e,t.edges().forEach(function(u){t.edge(u).minlen*=a});var s=Zq(t)+1;(n=t.children())===null||n===void 0||n.forEach(function(u){cT(t,e,a,s,o,r,u)}),t.graph().nodeRankFactor=a},cT=function(t,n,e,r,i,o,a){var s=t.children(a);if(!(s!=null&&s.length)){a!==n&&t.setEdge(n,a,{weight:0,minlen:e});return}var u=(0,Sm.addBorderNode)(t,"_bt"),c=(0,Sm.addBorderNode)(t,"_bb"),l=t.node(a);t.setParent(u,a),l.borderTop=u,t.setParent(c,a),l.borderBottom=c,s==null||s.forEach(function(h){cT(t,n,e,r,i,o,h);var f=t.node(h),d=f.borderTop?f.borderTop:h,p=f.borderBottom?f.borderBottom:h,g=f.borderTop?r:2*r,v=d!==p?1:i-o[a]+1;t.setEdge(u,d,{minlen:v,weight:g,nestingEdge:!0}),t.setEdge(p,c,{minlen:v,weight:g,nestingEdge:!0})}),t.parent(a)||t.setEdge(n,u,{weight:0,minlen:i+o[a]})},qq=function(t){var n,e={},r=function(i,o){var a=t.children(i);a==null||a.forEach(function(s){return r(s,o+1)}),e[i]=o};return(n=t.children())===null||n===void 0||n.forEach(function(i){return r(i,1)}),e},Zq=function(t){var n=0;return t.edges().forEach(function(e){n+=t.edge(e).weight}),n},Kq=function(t){var n=t.graph();n.nestingRoot&&t.removeNode(n.nestingRoot),delete n.nestingRoot,t.edges().forEach(function(e){var r=t.edge(e);r.nestingEdge&&t.removeEdgeObj(e)})};m1.default={run:Hq,cleanup:Kq};var y1={};Object.defineProperty(y1,"__esModule",{value:!0});var Qq=ti,Jq=function(t){var n,e=function(r){var i=t.children(r),o=t.node(r);if(i!=null&&i.length&&i.forEach(function(u){return e(u)}),o.hasOwnProperty("minRank")){o.borderLeft=[],o.borderRight=[];for(var a=o.minRank,s=o.maxRank+1;a<s;a+=1)nM(t,"borderLeft","_bl",r,o,a),nM(t,"borderRight","_br",r,o,a)}};(n=t.children())===null||n===void 0||n.forEach(function(r){return e(r)})},nM=function(t,n,e,r,i,o){var a={rank:o,borderType:n,width:0,height:0},s=i[n][o-1],u=(0,Qq.addDummyNode)(t,"border",a,e);i[n][o]=u,t.setParent(u,r),s&&t.setEdge(s,u,{weight:1})};y1.default=Jq;var b1={};Object.defineProperty(b1,"__esModule",{value:!0});var $q=function(t){var n,e=(n=t.graph().rankdir)===null||n===void 0?void 0:n.toLowerCase();(e==="lr"||e==="rl")&&lT(t)},tZ=function(t){var n,e=(n=t.graph().rankdir)===null||n===void 0?void 0:n.toLowerCase();(e==="bt"||e==="rl")&&eZ(t),(e==="lr"||e==="rl")&&(nZ(t),lT(t))},lT=function(t){t.nodes().forEach(function(n){rM(t.node(n))}),t.edges().forEach(function(n){rM(t.edge(n))})},rM=function(t){var n=t.width;t.width=t.height,t.height=n},eZ=function(t){t.nodes().forEach(function(n){V0(t.node(n))}),t.edges().forEach(function(n){var e,r=t.edge(n);(e=r.points)===null||e===void 0||e.forEach(function(i){return V0(i)}),r.hasOwnProperty("y")&&V0(r)})},V0=function(t){t!=null&&t.y&&(t.y=-t.y)},nZ=function(t){t.nodes().forEach(function(n){W0(t.node(n))}),t.edges().forEach(function(n){var e,r=t.edge(n);(e=r.points)===null||e===void 0||e.forEach(function(i){return W0(i)}),r.hasOwnProperty("x")&&W0(r)})},W0=function(t){var n=t.x;t.x=t.y,t.y=n};b1.default={adjust:$q,undo:tZ};var x1={},w1={};function hT(t){return[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)]}function X0(t){var n=Math.round(t).toString(16);return n.length===1?"0"+n:n}function fT(t){return"#"+X0(t[0])+X0(t[1])+X0(t[2])}var rZ=/rgba?\(([\s.,0-9]+)\)/;function iZ(){var t=document.createElement("i");return t.title="Web Colour Picker",t.style.display="none",document.body.appendChild(t),t}var wf;function dT(t){if(t[0]==="#"&&t.length===7)return t;wf||(wf=iZ()),wf.style.color=t;var n=document.defaultView.getComputedStyle(wf,"").getPropertyValue("color"),e=rZ.exec(n),r=e[1].split(/\s*,\s*/).map(function(i){return Number(i)});return n=fT(r),n}function H0(t,n,e,r){return t[r]+(n[r]-t[r])*e}function oZ(t,n){var e=isNaN(Number(n))||n<0?0:n>1?1:Number(n),r=t.length-1,i=Math.floor(r*e),o=r*e-i,a=t[i],s=i===r?a:t[i+1];return fT([H0(a,s,o,0),H0(a,s,o,1),H0(a,s,o,2)])}function aZ(t){var n=typeof t=="string"?t.split("-"):t,e=n.map(function(r){return hT(r.indexOf("#")===-1?dT(r):r)});return function(r){return oZ(e,r)}}var sZ=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,uZ=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,cZ=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function lZ(t){return/^[r,R,L,l]{1}[\s]*\(/.test(t)}function hZ(t){if(lZ(t)){var n,e=void 0;if(t[0]==="l"){var r=sZ.exec(t),i=+r[1]+90;e=r[2],n="linear-gradient("+i+"deg, "}else if(t[0]==="r"){n="radial-gradient(";var r=uZ.exec(t);e=r[4]}var o=e.match(cZ);return o.forEach(function(a,s){var u=a.split(":");n+=u[1]+" "+Number(u[0])*100+"%",s!==o.length-1&&(n+=", ")}),n+=")",n}return t}function fZ(t,n,e){var r=[0,0,0,0,0,0,0,0,0];return ly(r,e),mo(t,r,n)}function dZ(t,n,e){var r=[0,0,0,0,0,0,0,0,0];return hy(r,e),mo(t,r,n)}function pZ(t,n,e){var r=[0,0,0,0,0,0,0,0,0];return fy(r,e),mo(t,r,n)}function gZ(t,n,e){return mo(t,e,n)}function vZ(t,n){for(var e=t?[].concat(t):[1,0,0,0,1,0,0,0,1],r=0,i=n.length;r<i;r++){var o=n[r];switch(o[0]){case"t":fZ(e,e,[o[1],o[2]]);break;case"s":pZ(e,e,[o[1],o[2]]);break;case"r":dZ(e,e,o[1]);break;case"m":gZ(e,e,o[1]);break}}return e}function pT(t,n){return t[0]*n[1]-n[0]*t[1]}function mZ(t,n,e){var r=zA(t,n),i=pT(t,n)>=0;return e?i?Math.PI*2-r:r:i?r:Math.PI*2-r}function yZ(t,n,e){return e?(t[0]=n[1],t[1]=-1*n[0]):(t[0]=-1*n[1],t[1]=n[0]),t}function ec(t){return t.map(function(n){return Array.isArray(n)?[].concat(n):n})}function bZ(t,n){if(n==="off")return ec(t);var e=typeof n=="number"&&n>=1?Math.pow(10,n):1;return t.map(function(r){var i=r.slice(1).map(Number).map(function(o){return n?Math.round(o*e)/e:Math.round(o)});return[r[0]].concat(i)})}function xZ(t,n){return n===void 0&&(n="off"),bZ(t,n).map(function(e){return e[0]+e.slice(1).join(" ")}).join("")}var gT={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function wZ(t,n,e){if(t[e].length>7){t[e].shift();for(var r=t[e],i=e;r.length;)n[e]="A",t.splice(i+=1,0,["C"].concat(r.splice(0,6)));t.splice(e,1)}}var rl={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function vT(t){return Array.isArray(t)&&t.every(function(n){var e=n[0].toLowerCase();return rl[e]===n.length-1&&"achlmqstvz".includes(e)})}function mT(t){return vT(t)&&t.every(function(n){var e=n[0];return e===e.toUpperCase()})}function yT(t){return mT(t)&&t.every(function(n){var e=n[0];return"ACLMQZ".includes(e)})}function iM(t){for(var n=t.pathValue[t.segmentStart],e=n.toLowerCase(),r=t.data;r.length>=rl[e]&&(e==="m"&&r.length>2?(t.segments.push([n].concat(r.splice(0,2))),e="l",n=n==="m"?"l":"L"):t.segments.push([n].concat(r.splice(0,rl[e]))),!!rl[e]););}function EZ(t){var n=t.index,e=t.pathValue,r=e.charCodeAt(n);if(r===48){t.param=0,t.index+=1;return}if(r===49){t.param=1,t.index+=1;return}t.err='[path-util]: invalid Arc flag "'+e[n]+'", expecting 0 or 1 at index '+n}function MZ(t){return t>=48&&t<=57||t===43||t===45||t===46}function au(t){return t>=48&&t<=57}function SZ(t){var n=t.max,e=t.pathValue,r=t.index,i=r,o=!1,a=!1,s=!1,u=!1,c;if(i>=n){t.err="[path-util]: Invalid path value at index "+i+', "pathValue" is missing param';return}if(c=e.charCodeAt(i),(c===43||c===45)&&(i+=1,c=e.charCodeAt(i)),!au(c)&&c!==46){t.err="[path-util]: Invalid path value at index "+i+', "'+e[i]+'" is not a number';return}if(c!==46){if(o=c===48,i+=1,c=e.charCodeAt(i),o&&i<n&&c&&au(c)){t.err="[path-util]: Invalid path value at index "+r+', "'+e[r]+'" illegal number';return}for(;i<n&&au(e.charCodeAt(i));)i+=1,a=!0;c=e.charCodeAt(i)}if(c===46){for(u=!0,i+=1;au(e.charCodeAt(i));)i+=1,s=!0;c=e.charCodeAt(i)}if(c===101||c===69){if(u&&!a&&!s){t.err="[path-util]: Invalid path value at index "+i+', "'+e[i]+'" invalid float exponent';return}if(i+=1,c=e.charCodeAt(i),(c===43||c===45)&&(i+=1),i<n&&au(e.charCodeAt(i)))for(;i<n&&au(e.charCodeAt(i));)i+=1;else{t.err="[path-util]: Invalid path value at index "+i+', "'+e[i]+'" invalid integer exponent';return}}t.index=i,t.param=+t.pathValue.slice(r,i)}function _Z(t){var n=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return t===10||t===13||t===8232||t===8233||t===32||t===9||t===11||t===12||t===160||t>=5760&&n.includes(t)}function nd(t){for(var n=t.pathValue,e=t.max;t.index<e&&_Z(n.charCodeAt(t.index));)t.index+=1}function kZ(t){switch(t|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function AZ(t){return(t|32)===97}function CZ(t){var n=t.max,e=t.pathValue,r=t.index,i=e.charCodeAt(r),o=rl[e[r].toLowerCase()];if(t.segmentStart=r,!kZ(i)){t.err='[path-util]: Invalid path value "'+e[r]+'" is not a path command';return}if(t.index+=1,nd(t),t.data=[],!o){iM(t);return}for(;;){for(var a=o;a>0;a-=1){if(AZ(i)&&(a===3||a===4)?EZ(t):SZ(t),t.err.length)return;t.data.push(t.param),nd(t),t.index<n&&e.charCodeAt(t.index)===44&&(t.index+=1,nd(t))}if(t.index>=t.max||!MZ(e.charCodeAt(t.index)))break}iM(t)}var IZ=function(){function t(n){this.pathValue=n,this.segments=[],this.max=n.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return t}();function E1(t){if(vT(t))return ec(t);var n=new IZ(t);for(nd(n);n.index<n.max&&!n.err.length;)CZ(n);return n.err?n.err:n.segments}function bT(t){if(mT(t))return ec(t);var n=E1(t),e=0,r=0,i=0,o=0;return n.map(function(a){var s=a.slice(1).map(Number),u=a[0],c=u.toUpperCase();if(u==="M")return e=s[0],r=s[1],i=e,o=r,["M",e,r];var l;if(u!==c)switch(c){case"A":l=[c,s[0],s[1],s[2],s[3],s[4],s[5]+e,s[6]+r];break;case"V":l=[c,s[0]+r];break;case"H":l=[c,s[0]+e];break;default:{var h=s.map(function(d,p){return d+(p%2?r:e)});l=[c].concat(h)}}else l=[c].concat(s);var f=l.length;switch(c){case"Z":e=i,r=o;break;case"H":e=l[1];break;case"V":r=l[1];break;default:e=l[f-2],r=l[f-1],c==="M"&&(i=e,o=r)}return l})}function TZ(t,n){var e=t[0],r=n.x1,i=n.y1,o=n.x2,a=n.y2,s=t.slice(1).map(Number),u=t;if("TQ".includes(e)||(n.qx=null,n.qy=null),e==="H")u=["L",t[1],i];else if(e==="V")u=["L",r,t[1]];else if(e==="S"){var c=r*2-o,l=i*2-a;n.x1=c,n.y1=l,u=["C",c,l].concat(s)}else if(e==="T"){var h=r*2-n.qx,f=i*2-n.qy;n.qx=h,n.qy=f,u=["Q",h,f].concat(s)}else if(e==="Q"){var d=s[0],p=s[1];n.qx=d,n.qy=p}return u}function Fp(t){if(yT(t))return ec(t);for(var n=bT(t),e=B({},gT),r=0;r<n.length;r+=1){n[r]=TZ(n[r],e);var i=n[r],o=i.length;e.x1=+i[o-2],e.y1=+i[o-1],e.x2=+i[o-4]||e.x1,e.y2=+i[o-3]||e.y1}return n}function OZ(t){return yT(t)&&t.every(function(n){var e=n[0];return"MC".includes(e)})}function Ef(t,n,e){var r=t*Math.cos(e)-n*Math.sin(e),i=t*Math.sin(e)+n*Math.cos(e);return{x:r,y:i}}function M1(t,n,e,r,i,o,a,s,u,c){var l=t,h=n,f=e,d=r,p=s,g=u,v=Math.PI*120/180,m=Math.PI/180*(+i||0),y=[],b,x,w,E,M;if(c)x=c[0],w=c[1],E=c[2],M=c[3];else{b=Ef(l,h,-m),l=b.x,h=b.y,b=Ef(p,g,-m),p=b.x,g=b.y;var _=(l-p)/2,k=(h-g)/2,S=_*_/(f*f)+k*k/(d*d);S>1&&(S=Math.sqrt(S),f*=S,d*=S);var A=f*f,C=d*d,I=(o===a?-1:1)*Math.sqrt(Math.abs((A*C-A*k*k-C*_*_)/(A*k*k+C*_*_)));E=I*f*k/d+(l+p)/2,M=I*-d*_/f+(h+g)/2,x=Math.asin(((h-M)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),w=Math.asin(((g-M)/d*Math.pow(10,9)>>0)/Math.pow(10,9)),x=l<E?Math.PI-x:x,w=p<E?Math.PI-w:w,x<0&&(x=Math.PI*2+x),w<0&&(w=Math.PI*2+w),a&&x>w&&(x-=Math.PI*2),!a&&w>x&&(w-=Math.PI*2)}var N=w-x;if(Math.abs(N)>v){var D=w,P=p,j=g;w=x+v*(a&&w>x?1:-1),p=E+f*Math.cos(w),g=M+d*Math.sin(w),y=M1(p,g,f,d,i,0,a,P,j,[w,D,E,M])}N=w-x;var L=Math.cos(x),R=Math.sin(x),V=Math.cos(w),tt=Math.sin(w),ut=Math.tan(N/4),dt=4/3*f*ut,J=4/3*d*ut,Et=[l,h],Bt=[l+dt*R,h-J*L],Vt=[p+dt*tt,g-J*V],se=[p,g];if(Bt[0]=2*Et[0]-Bt[0],Bt[1]=2*Et[1]-Bt[1],c)return Bt.concat(Vt,se,y);y=Bt.concat(Vt,se,y);for(var re=[],ue=0,de=y.length;ue<de;ue+=1)re[ue]=ue%2?Ef(y[ue-1],y[ue],m).y:Ef(y[ue],y[ue+1],m).x;return re}function NZ(t,n,e,r,i,o){var a=.3333333333333333,s=2/3;return[a*t+s*e,a*n+s*r,a*i+s*e,a*o+s*r,i,o]}function di(t,n,e){var r=t[0],i=t[1],o=n[0],a=n[1];return[r+(o-r)*e,i+(a-i)*e]}function nc(t,n){return Math.sqrt((t[0]-n[0])*(t[0]-n[0])+(t[1]-n[1])*(t[1]-n[1]))}function Il(t,n,e,r,i){var o=nc([t,n],[e,r]),a={x:0,y:0};if(typeof i=="number")if(i<=0)a={x:t,y:n};else if(i>=o)a={x:e,y:r};else{var s=di([t,n],[e,r],i/o),u=s[0],c=s[1];a={x:u,y:c}}return{length:o,point:a,min:{x:Math.min(t,e),y:Math.min(n,r)},max:{x:Math.max(t,e),y:Math.max(n,r)}}}function oM(t,n,e,r){var i=.5,o=[t,n],a=[e,r],s=di(o,a,i),u=di(a,s,i),c=di(s,u,i),l=di(u,c,i),h=di(c,l,i),f=Il(o[0],o[1],s[0],s[1],c[0]).point,d=Il(h[0],h[1],l[0],l[1],u[0]).point;return[f.x,f.y,d.x,d.y,e,r]}function DZ(t,n){var e=t[0],r=t.slice(1).map(Number),i=r[0],o=r[1],a,s=n.x1,u=n.y1,c=n.x,l=n.y;switch("TQ".includes(e)||(n.qx=null,n.qy=null),e){case"M":return n.x=i,n.y=o,t;case"A":return a=[s,u].concat(r),["C"].concat(M1(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9]));case"Q":return n.qx=i,n.qy=o,a=[s,u].concat(r),["C"].concat(NZ(a[0],a[1],a[2],a[3],a[4],a[5]));case"L":return["C"].concat(oM(s,u,i,o));case"Z":return s===c&&u===l?["C",s,u,c,l,c,l]:["C"].concat(oM(s,u,c,l))}return t}function xT(t,n){if(n===void 0&&(n=!1),OZ(t)){var e=ec(t);return n?[e,[]]:e}for(var r=Fp(t),i=B({},gT),o=[],a="",s=r.length,u,c,l=[],h=0;h<s;h+=1){r[h]&&(a=r[h][0]),o[h]=a;var f=DZ(r[h],i);r[h]=f,wZ(r,o,h),s=r.length,a==="Z"&&l.push(h),u=r[h],c=u.length,i.x1=+u[c-2],i.y1=+u[c-1],i.x2=+u[c-4]||i.x1,i.y2=+u[c-3]||i.y1}return n?[r,l]:r}function PZ(t){var n=t.slice(1).map(function(e,r,i){return r?i[r-1].slice(-2).concat(e.slice(1)):t[0].slice(1).concat(e.slice(1))}).map(function(e){return e.map(function(r,i){return e[e.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(n[0].slice(0,2))].concat(n.map(function(e){return["C"].concat(e.slice(2))}))}function aM(t,n){var e=t.x,r=t.y,i=n.x,o=n.y,a=e*i+r*o,s=Math.sqrt((Math.pow(e,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(o,2))),u=e*o-r*i<0?-1:1,c=u*Math.acos(a/s);return c}function LZ(t,n,e,r,i,o,a,s,u,c){var l=Math.abs,h=Math.sin,f=Math.cos,d=Math.sqrt,p=Math.PI,g=l(e),v=l(r),m=(i%360+360)%360,y=m*(p/180);if(t===s&&n===u)return{x:t,y:n};if(g===0||v===0)return Il(t,n,s,u,c).point;var b=(t-s)/2,x=(n-u)/2,w={x:f(y)*b+h(y)*x,y:-h(y)*b+f(y)*x},E=Math.pow(w.x,2)/Math.pow(g,2)+Math.pow(w.y,2)/Math.pow(v,2);E>1&&(g*=d(E),v*=d(E));var M=Math.pow(g,2)*Math.pow(v,2)-Math.pow(g,2)*Math.pow(w.y,2)-Math.pow(v,2)*Math.pow(w.x,2),_=Math.pow(g,2)*Math.pow(w.y,2)+Math.pow(v,2)*Math.pow(w.x,2),k=M/_;k=k<0?0:k;var S=(o!==a?1:-1)*d(k),A={x:S*(g*w.y/v),y:S*(-(v*w.x)/g)},C={x:f(y)*A.x-h(y)*A.y+(t+s)/2,y:h(y)*A.x+f(y)*A.y+(n+u)/2},I={x:(w.x-A.x)/g,y:(w.y-A.y)/v},N=aM({x:1,y:0},I),D={x:(-w.x-A.x)/g,y:(-w.y-A.y)/v},P=aM(I,D);!a&&P>0?P-=2*p:a&&P<0&&(P+=2*p),P%=2*p;var j=N+P*c,L=g*f(j),R=v*h(j),V={x:f(y)*L-h(y)*R+C.x,y:h(y)*L+f(y)*R+C.y};return V}function jZ(t,n,e,r,i,o,a,s,u,c,l){var h,f=l.bbox,d=f===void 0?!0:f,p=l.length,g=p===void 0?!0:p,v=l.sampleSize,m=v===void 0?30:v,y=typeof c=="number",b=t,x=n,w=0,E=[b,x,w],M=[b,x],_=0,k={x:0,y:0},S=[{x:b,y:x}];y&&c<=0&&(k={x:b,y:x});for(var A=0;A<=m;A+=1){if(_=A/m,h=LZ(t,n,e,r,i,o,a,s,u,_),b=h.x,x=h.y,d&&S.push({x:b,y:x}),g&&(w+=nc(M,[b,x])),M=[b,x],y&&w>=c&&c>E[2]){var C=(w-c)/(w-E[2]);k={x:M[0]*(1-C)+E[0]*C,y:M[1]*(1-C)+E[1]*C}}E=[b,x,w]}return y&&c>=w&&(k={x:s,y:u}),{length:w,point:k,min:{x:Math.min.apply(null,S.map(function(I){return I.x})),y:Math.min.apply(null,S.map(function(I){return I.y}))},max:{x:Math.max.apply(null,S.map(function(I){return I.x})),y:Math.max.apply(null,S.map(function(I){return I.y}))}}}function RZ(t,n,e,r,i,o,a,s,u){var c=1-u;return{x:Math.pow(c,3)*t+3*Math.pow(c,2)*u*e+3*c*Math.pow(u,2)*i+Math.pow(u,3)*a,y:Math.pow(c,3)*n+3*Math.pow(c,2)*u*r+3*c*Math.pow(u,2)*o+Math.pow(u,3)*s}}function wT(t,n,e,r,i,o,a,s,u,c){var l,h=c.bbox,f=h===void 0?!0:h,d=c.length,p=d===void 0?!0:d,g=c.sampleSize,v=g===void 0?10:g,m=typeof u=="number",y=t,b=n,x=0,w=[y,b,x],E=[y,b],M=0,_={x:0,y:0},k=[{x:y,y:b}];m&&u<=0&&(_={x:y,y:b});for(var S=0;S<=v;S+=1){if(M=S/v,l=RZ(t,n,e,r,i,o,a,s,M),y=l.x,b=l.y,f&&k.push({x:y,y:b}),p&&(x+=nc(E,[y,b])),E=[y,b],m&&x>=u&&u>w[2]){var A=(x-u)/(x-w[2]);_={x:E[0]*(1-A)+w[0]*A,y:E[1]*(1-A)+w[1]*A}}w=[y,b,x]}return m&&u>=x&&(_={x:a,y:s}),{length:x,point:_,min:{x:Math.min.apply(null,k.map(function(C){return C.x})),y:Math.min.apply(null,k.map(function(C){return C.y}))},max:{x:Math.max.apply(null,k.map(function(C){return C.x})),y:Math.max.apply(null,k.map(function(C){return C.y}))}}}function FZ(t,n,e,r,i,o,a){var s=1-a;return{x:Math.pow(s,2)*t+2*s*a*e+Math.pow(a,2)*i,y:Math.pow(s,2)*n+2*s*a*r+Math.pow(a,2)*o}}function BZ(t,n,e,r,i,o,a,s){var u,c=s.bbox,l=c===void 0?!0:c,h=s.length,f=h===void 0?!0:h,d=s.sampleSize,p=d===void 0?10:d,g=typeof a=="number",v=t,m=n,y=0,b=[v,m,y],x=[v,m],w=0,E={x:0,y:0},M=[{x:v,y:m}];g&&a<=0&&(E={x:v,y:m});for(var _=0;_<=p;_+=1){if(w=_/p,u=FZ(t,n,e,r,i,o,w),v=u.x,m=u.y,l&&M.push({x:v,y:m}),f&&(y+=nc(x,[v,m])),x=[v,m],g&&y>=a&&a>b[2]){var k=(y-a)/(y-b[2]);E={x:x[0]*(1-k)+b[0]*k,y:x[1]*(1-k)+b[1]*k}}b=[v,m,y]}return g&&a>=y&&(E={x:i,y:o}),{length:y,point:E,min:{x:Math.min.apply(null,M.map(function(S){return S.x})),y:Math.min.apply(null,M.map(function(S){return S.y}))},max:{x:Math.max.apply(null,M.map(function(S){return S.x})),y:Math.max.apply(null,M.map(function(S){return S.y}))}}}function Bp(t,n,e){for(var r,i,o,a,s,u,c=Fp(t),l=typeof n=="number",h,f=[],d,p=0,g=0,v=0,m=0,y,b=[],x=[],w=0,E={x:0,y:0},M=E,_=E,k=E,S=0,A=0,C=c.length;A<C;A+=1)y=c[A],d=y[0],h=d==="M",f=h?f:[p,g].concat(y.slice(1)),h?(v=y[1],m=y[2],E={x:v,y:m},M=E,w=0,l&&n<.001&&(k=E)):d==="L"?(r=Il(f[0],f[1],f[2],f[3],(n||0)-S),w=r.length,E=r.min,M=r.max,_=r.point):d==="A"?(i=jZ(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],(n||0)-S,e||{}),w=i.length,E=i.min,M=i.max,_=i.point):d==="C"?(o=wT(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],(n||0)-S,e||{}),w=o.length,E=o.min,M=o.max,_=o.point):d==="Q"?(a=BZ(f[0],f[1],f[2],f[3],f[4],f[5],(n||0)-S,e||{}),w=a.length,E=a.min,M=a.max,_=a.point):d==="Z"&&(f=[p,g,v,m],s=Il(f[0],f[1],f[2],f[3],(n||0)-S),w=s.length,E=s.min,M=s.max,_=s.point),l&&S<n&&S+w>=n&&(k=_),x.push(M),b.push(E),S+=w,u=d!=="Z"?y.slice(-2):[v,m],p=u[0],g=u[1];return l&&n>=S&&(k={x:p,y:g}),{length:S,point:k,min:{x:Math.min.apply(null,b.map(function(I){return I.x})),y:Math.min.apply(null,b.map(function(I){return I.y}))},max:{x:Math.max.apply(null,x.map(function(I){return I.x})),y:Math.max.apply(null,x.map(function(I){return I.y}))}}}function zZ(t,n){if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var e=Bp(t,void 0,B(B({},n),{length:!1})),r=e.min,i=r.x,o=r.y,a=e.max,s=a.x,u=a.y,c=s-i,l=u-o;return{width:c,height:l,x:i,y:o,x2:s,y2:u,cx:i+c/2,cy:o+l/2,cz:Math.max(c,l)+Math.min(c,l)/2}}function il(t,n){return Bp(t,void 0,B(B({},n),{bbox:!1,length:!0})).length}function GZ(t,n){if(!t)return{length:0,x:0,y:0,width:0,height:0,x2:0,y2:0,cx:0,cy:0,cz:0};var e=Bp(t,void 0,B(B({},n),{bbox:!0,length:!0})),r=e.length,i=e.min,o=i.x,a=i.y,s=e.max,u=s.x,c=s.y,l=u-o,h=c-a;return{length:r,width:l,height:h,x:o,y:a,x2:u,y2:c,cx:o+l/2,cy:a+h/2,cz:Math.max(l,h)+Math.min(l,h)/2}}function UZ(t){var n=t.length,e=n-1;return t.map(function(r,i){return t.map(function(o,a){var s=i+a,u;return a===0||t[s]&&t[s][0]==="M"?(u=t[s],["M"].concat(u.slice(-2))):(s>=n&&(s-=e),t[s])})})}function YZ(t,n){var e=t.length-1,r=[],i=0,o=0,a=UZ(t);return a.forEach(function(s,u){t.slice(1).forEach(function(c,l){o+=nc(t[(u+l)%e].slice(-2),n[l%e].slice(-2))}),r[u]=o,o=0}),i=r.indexOf(Math.min.apply(null,r)),a[i]}function VZ(t,n,e,r,i,o,a,s){return 3*((s-n)*(e+i)-(a-t)*(r+o)+r*(t-i)-e*(n-o)+s*(i+t/3)-a*(o+n/3))/20}function ET(t){var n=0,e=0,r=0;return xT(t).map(function(i){var o;switch(i[0]){case"M":return n=i[1],e=i[2],0;default:var a=i.slice(1),s=a[0],u=a[1],c=a[2],l=a[3],h=a[4],f=a[5];return r=VZ(n,e,s,u,c,l,h,f),o=i.slice(-2),n=o[0],e=o[1],r}}).reduce(function(i,o){return i+o},0)}function WZ(t){return ET(t)>=0}function rd(t,n,e){return Bp(t,n,B(B({},e),{bbox:!1,length:!0})).point}function XZ(t,n){var e=E1(t);if(typeof e=="string")throw TypeError(e);var r=e.slice(),i=il(r),o=r.length-1,a=0,s=0,u=e[0],c=u.slice(-2),l=c[0],h=c[1],f={x:l,y:h};if(o<=0||!n||!Number.isFinite(n))return{segment:u,index:0,length:s,point:f,lengthAtSegment:a};if(n>=i)return r=e.slice(0,-1),a=il(r),s=i-a,{segment:e[o],index:o,length:s,lengthAtSegment:a};for(var d=[];o>0;)u=r[o],r=r.slice(0,-1),a=il(r),s=i-a,i=a,d.push({segment:u,index:o,length:s,lengthAtSegment:a}),o-=1;return d.find(function(p){var g=p.lengthAtSegment;return g<=n})}function HZ(t,n){for(var e=E1(t),r=Fp(e),i=il(e),o=function(w){var E=w.x-n.x,M=w.y-n.y;return E*E+M*M},a=8,s,u=0,c,l=0,h=1/0,f=0;f<=i;f+=a)s=rd(r,f),u=o(s),u<h&&(c=s,l=f,h=u);a/=2;for(var d,p,g=0,v=0,m=0,y=0;a>.5;)g=l-a,d=rd(r,g),m=o(d),v=l+a,p=rd(r,v),y=o(p),g>=0&&m<h?(c=d,l=g,h=m):v<=i&&y<h?(c=p,l=v,h=y):a/=2;var b=XZ(e,l),x=Math.sqrt(h);return{closest:c,distance:x,segment:b}}function qZ(t,n){var e=HZ(t,n).distance;return Math.abs(e)<.001}function ZZ(t,n){n===void 0&&(n=.5);var e=t.slice(0,2),r=t.slice(2,4),i=t.slice(4,6),o=t.slice(6,8),a=di(e,r,n),s=di(r,i,n),u=di(i,o,n),c=di(a,s,n),l=di(s,u,n),h=di(c,l,n);return[["C"].concat(a,c,h),["C"].concat(l,u,o)]}function sM(t){return t.map(function(n,e,r){var i=e&&r[e-1].slice(-2).concat(n.slice(1)),o=e?wT(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,a;return e?a=o?ZZ(i):[n,n]:a=[n],{s:n,ss:a,l:o}})}function MT(t,n,e){var r=sM(t),i=sM(n),o=r.length,a=i.length,s=r.filter(function(v){return v.l}).length,u=i.filter(function(v){return v.l}).length,c=r.filter(function(v){return v.l}).reduce(function(v,m){var y=m.l;return v+y},0)/s||0,l=i.filter(function(v){return v.l}).reduce(function(v,m){var y=m.l;return v+y},0)/u||0,h=e||Math.max(o,a),f=[c,l],d=[h-o,h-a],p=0,g=[r,i].map(function(v,m){return v.l===h?v.map(function(y){return y.s}):v.map(function(y,b){return p=b&&d[m]&&y.l>=f[m],d[m]-=p?1:0,p?y.ss:[y.s]}).flat()});return g[0].length===g[1].length?g:MT(g[0],g[1],h)}var KZ=function(t){return t!==null&&typeof t!="function"&&isFinite(t.length)};const zr=KZ;var QZ=function(t,n){return zr(t)?t.indexOf(n)>-1:!1};const Bd=QZ;var JZ=function(t,n){if(!zr(t))return t;for(var e=[],r=0;r<t.length;r++){var i=t[r];n(i,r)&&e.push(i)}return e};const ST=JZ;var $Z=function(t,n){return n===void 0&&(n=[]),ST(t,function(e){return!Bd(n,e)})};const tK=$Z,ei=function(t){return typeof t=="function"};var eK=function(t){return t==null};const Ra=eK;var nK={}.toString,rK=function(t,n){return nK.call(t)==="[object "+n+"]"};const wo=rK,Kn=function(t){return Array.isArray?Array.isArray(t):wo(t,"Array")},zp=function(t){var n=typeof t;return t!==null&&n==="object"||n==="function"};function Uu(t,n){if(t){var e;if(Kn(t))for(var r=0,i=t.length;r<i&&(e=n(t[r],r),e!==!1);r++);else if(zp(t)){for(var o in t)if(t.hasOwnProperty(o)&&(e=n(t[o],o),e===!1))break}}}var iK=Object.keys?function(t){return Object.keys(t)}:function(t){var n=[];return Uu(t,function(e,r){ei(t)&&r==="prototype"||n.push(r)}),n};const _T=iK;function kT(t,n){var e=_T(n),r=e.length;if(Ra(t))return!r;for(var i=0;i<r;i+=1){var o=e[i];if(n[o]!==t[o]||!(o in t))return!1}return!0}var oK=function(t){return typeof t=="object"&&t!==null};const zd=oK;var aK=function(t){if(!zd(t)||!wo(t,"Object"))return!1;if(Object.getPrototypeOf(t)===null)return!0;for(var n=t;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(t)===n};const Yu=aK;function sK(t,n){if(!Kn(t))return null;var e;if(ei(n)&&(e=n),Yu(n)&&(e=function(i){return kT(i,n)}),e){for(var r=0;r<t.length;r+=1)if(e(t[r]))return t[r]}return null}function uK(t,n,e){e===void 0&&(e=0);for(var r=e;r<t.length;r++)if(n(t[r],r))return r;return-1}var cK=function(t,n){for(var e=null,r=0;r<t.length;r++){var i=t[r],o=i[n];if(!Ra(o)){Kn(o)?e=o[0]:e=o;break}}return e};const lK=cK;var hK=function(t){if(!Kn(t))return[];for(var n=[],e=0;e<t.length;e++)n=n.concat(t[e]);return n};const fK=hK;var AT=function(t,n){if(n===void 0&&(n=[]),!Kn(t))n.push(t);else for(var e=0;e<t.length;e+=1)AT(t[e],n);return n};const dK=AT,CT=function(t){if(Kn(t))return t.reduce(function(n,e){return Math.max(n,e)},t[0])},IT=function(t){if(Kn(t))return t.reduce(function(n,e){return Math.min(n,e)},t[0])};var pK=function(t){var n=t.filter(function(a){return!isNaN(a)});if(!n.length)return{min:0,max:0};if(Kn(t[0])){for(var e=[],r=0;r<t.length;r++)e=e.concat(t[r]);n=e}var i=CT(n),o=IT(n);return{min:o,max:i}};const gK=pK;var TT=Array.prototype,vK=TT.splice,mK=TT.indexOf,yK=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(var r=0;r<n.length;r++)for(var i=n[r],o=-1;(o=mK.call(t,i))>-1;)vK.call(t,o,1);return t};const bK=yK;var xK=Array.prototype.splice,wK=function(t,n){if(!zr(t))return[];for(var e=t?n.length:0,r=e-1;e--;){var i=void 0,o=n[e];(e===r||o!==i)&&(i=o,xK.call(t,o,1))}return t};const OT=wK;var EK=function(t,n,e){if(!Kn(t)&&!Yu(t))return t;var r=e;return Uu(t,function(i,o){r=n(r,i,o)}),r};const NT=EK;var MK=function(t,n){var e=[];if(!zr(t))return e;for(var r=-1,i=[],o=t.length;++r<o;){var a=t[r];n(a,r,t)&&(e.push(a),i.push(r))}return OT(t,i),e};const SK=MK,Da=function(t){return wo(t,"String")};function _K(t,n){var e;if(ei(n))e=function(i,o){return n(i)-n(o)};else{var r=[];Da(n)?r.push(n):Kn(n)&&(r=n),e=function(i,o){for(var a=0;a<r.length;a+=1){var s=r[a];if(i[s]>o[s])return 1;if(i[s]<o[s])return-1}return 0}}return t.sort(e),t}function DT(t,n){n===void 0&&(n=new Map);var e=[];if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];n.has(o)||(e.push(o),n.set(o,!0))}return e}var kK=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return DT([].concat.apply([],t))};const AK=kK,CK=function(t,n){for(var e=[],r={},i=0;i<t.length;i++){var o=t[i],a=o[n];if(!Ra(a)){Kn(a)||(a=[a]);for(var s=0;s<a.length;s++){var u=a[s];r[u]||(e.push(u),r[u]=!0)}}}return e};function IK(t){if(zr(t))return t[0]}function TK(t){if(zr(t)){var n=t;return n[n.length-1]}}function OK(t,n){return Kn(t)||Da(t)?t[0]===n:!1}function NK(t,n){return Kn(t)||Da(t)?t[t.length-1]===n:!1}var DK=function(t,n){for(var e=0;e<t.length;e++)if(!n(t[e],e))return!1;return!0};const PK=DK;var LK=function(t,n){for(var e=0;e<t.length;e++)if(n(t[e],e))return!0;return!1};const jK=LK;var RK=Object.prototype.hasOwnProperty;function PT(t,n){if(!n||!Kn(t))return{};for(var e={},r=ei(n)?n:function(s){return s[n]},i,o=0;o<t.length;o++){var a=t[o];i=r(a),RK.call(e,i)?e[i].push(a):e[i]=[a]}return e}function LT(t,n){if(!n)return{0:t};if(!ei(n)){var e=Kn(n)?n:n.replace(/\s+/g,"").split("*");n=function(r){for(var i="_",o=0,a=e.length;o<a;o++)i+=r[e[o]]&&r[e[o]].toString();return i}}return PT(t,n)}const FK=function(t,n){if(!n)return[t];var e=LT(t,n),r=[];for(var i in e)r.push(e[i]);return r};function BK(t,n){return t["_wrap_"+n]}function zK(t,n){if(t["_wrap_"+n])return t["_wrap_"+n];var e=function(r){t[n](r)};return t["_wrap_"+n]=e,e}var uM={};function GK(t){var n=uM[t];if(!n){for(var e=t.toString(16),r=e.length;r<6;r++)e="0"+e;n="#"+e,uM[t]=n}return n}function UK(t){var n=0,e=0,r=0,i=0;return Kn(t)?t.length===1?n=e=r=i=t[0]:t.length===2?(n=r=t[0],e=i=t[1]):t.length===3?(n=t[0],e=i=t[1],r=t[2]):(n=t[0],e=t[1],r=t[2],i=t[3]):n=e=r=i=t,{r1:n,r2:e,r3:r,r4:i}}var YK=function(t,n,e){return t<n?n:t>e?e:t};const VK=YK;var WK=function(t,n){var e=n.toString(),r=e.indexOf(".");if(r===-1)return Math.round(t);var i=e.substr(r+1).length;return i>20&&(i=20),parseFloat(t.toFixed(i))};const XK=WK;var HK=function(t){return wo(t,"Number")};const Qo=HK;var qK=function(t){return Qo(t)&&t%1!==0};const ZK=qK;var KK=function(t){return Qo(t)&&t%2===0};const QK=KK;var JK=Number.isInteger?Number.isInteger:function(t){return Qo(t)&&t%1===0};const $K=JK;var tQ=function(t){return Qo(t)&&t<0};const eQ=tQ;var nQ=1e-5;function rQ(t,n,e){return e===void 0&&(e=nQ),Math.abs(t-n)<e}var iQ=function(t){return Qo(t)&&t%2!==0};const oQ=iQ;var aQ=function(t){return Qo(t)&&t>0};const sQ=aQ,uQ=function(t,n){if(Kn(t)){for(var e,r=-1/0,i=0;i<t.length;i++){var o=t[i],a=ei(n)?n(o):o[n];a>r&&(e=o,r=a)}return e}},cQ=function(t,n){if(Kn(t)){for(var e,r=1/0,i=0;i<t.length;i++){var o=t[i],a=ei(n)?n(o):o[n];a<r&&(e=o,r=a)}return e}};var lQ=function(t,n){return(t%n+n)%n};const hQ=lQ;var fQ=180/Math.PI,dQ=function(t){return fQ*t};const pQ=dQ,gQ=parseInt;var vQ=Math.PI/180,mQ=function(t){return vQ*t};const yQ=mQ,cM=function(t,n){return t.hasOwnProperty(n)};var bQ=Object.values?function(t){return Object.values(t)}:function(t){var n=[];return Uu(t,function(e,r){ei(t)&&r==="prototype"||n.push(e)}),n};const jT=bQ,xQ=function(t,n){return Bd(jT(t),n)},Jl=function(t){return Ra(t)?"":t.toString()};var wQ=function(t){return Jl(t).toLowerCase()};const EQ=wQ;var MQ=function(t){var n=Jl(t);return n.charAt(0).toLowerCase()+n.substring(1)};const SQ=MQ;function _Q(t,n){return!t||!n?t:t.replace(/\\?\{([^{}]+)\}/g,function(e,r){return e.charAt(0)==="\\"?e.slice(1):n[r]===void 0?"":n[r]})}var kQ=function(t){return Jl(t).toUpperCase()};const AQ=kQ;var CQ=function(t){var n=Jl(t);return n.charAt(0).toUpperCase()+n.substring(1)};const IQ=CQ;var TQ={}.toString,OQ=function(t){return TQ.call(t).replace(/^\[object /,"").replace(/]$/,"")};const RT=OQ;var NQ=function(t){return wo(t,"Arguments")};const DQ=NQ;var PQ=function(t){return wo(t,"Boolean")};const LQ=PQ;var jQ=function(t){return wo(t,"Date")};const RQ=jQ;var FQ=function(t){return wo(t,"Error")};const BQ=FQ;function zQ(t){return Qo(t)&&isFinite(t)}var GQ=function(t){return t===null};const UQ=GQ;var YQ=Object.prototype,VQ=function(t){var n=t&&t.constructor,e=typeof n=="function"&&n.prototype||YQ;return t===e};const FT=VQ;var WQ=function(t){return wo(t,"RegExp")};const XQ=WQ;var HQ=function(t){return t===void 0};const qQ=HQ;var ZQ=function(t){return t instanceof Element||t instanceof HTMLDocument};const KQ=ZQ;function QQ(t){var n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,16)};return n(t)}function JQ(t){var n=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;n(t)}function q0(t,n){for(var e in n)n.hasOwnProperty(e)&&e!=="constructor"&&n[e]!==void 0&&(t[e]=n[e])}function Cu(t,n,e,r){return n&&q0(t,n),e&&q0(t,e),r&&q0(t,r),t}var $Q=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=t[0],r=1;r<t.length;r++){var i=t[r];ei(i)&&(i=i.prototype),Cu(e.prototype,i)}};const tJ=$Q;var _m=function(t){if(typeof t!="object"||t===null)return t;var n;if(Kn(t)){n=[];for(var e=0,r=t.length;e<r;e++)typeof t[e]=="object"&&t[e]!=null?n[e]=_m(t[e]):n[e]=t[e]}else{n={};for(var i in t)typeof t[i]=="object"&&t[i]!=null?n[i]=_m(t[i]):n[i]=t[i]}return n};const eJ=_m;function nJ(t,n,e){var r;return function(){var i=this,o=arguments,a=function(){r=null,e||t.apply(i,o)},s=e&&!r;clearTimeout(r),r=setTimeout(a,n),s&&t.apply(i,o)}}const rJ=function(t,n){if(!ei(t))throw new TypeError("Expected a function");var e=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=n?n.apply(this,r):r[0],a=e.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};return e.cache=new Map,e};var iJ=5;function BT(t,n,e,r){e=e||0,r=r||iJ;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];o!==null&&Yu(o)?(Yu(t[i])||(t[i]={}),e<r?BT(t[i],o,e+1,r):t[i]=n[i]):Kn(o)?(t[i]=[],t[i]=t[i].concat(o)):o!==void 0&&(t[i]=o)}}var oJ=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(var r=0;r<n.length;r+=1)BT(t,n[r]);return t};const aJ=oJ;var sJ=function(t,n,e,r){ei(n)||(e=n,n=t,t=function(){});var i=Object.create?function(a,s){return Object.create(a,{constructor:{value:s}})}:function(a,s){function u(){}u.prototype=a;var c=new u;return c.constructor=s,c},o=i(n.prototype,t);return t.prototype=Cu(o,t.prototype),t.superclass=i(n.prototype,n),Cu(o,e),Cu(t,r),t};const uJ=sJ;var cJ=function(t,n){if(!zr(t))return-1;var e=Array.prototype.indexOf;if(e)return e.call(t,n);for(var r=-1,i=0;i<t.length;i++)if(t[i]===n){r=i;break}return r};const lJ=cJ;var hJ=Object.prototype.hasOwnProperty;function fJ(t){if(Ra(t))return!0;if(zr(t))return!t.length;var n=RT(t);if(n==="Map"||n==="Set")return!t.size;if(FT(t))return!Object.keys(t).length;for(var e in t)if(hJ.call(t,e))return!1;return!0}var km=function(t,n){if(t===n)return!0;if(!t||!n||Da(t)||Da(n))return!1;if(zr(t)||zr(n)){if(t.length!==n.length)return!1;for(var e=!0,r=0;r<t.length&&(e=km(t[r],n[r]),!!e);r++);return e}if(zd(t)||zd(n)){var i=Object.keys(t),o=Object.keys(n);if(i.length!==o.length)return!1;for(var e=!0,r=0;r<i.length&&(e=km(t[i[r]],n[i[r]]),!!e);r++);return e}return!1};const zT=km,dJ=function(t,n,e){return ei(e)?!!e(t,n):zT(t,n)};var pJ=function(t,n){if(!zr(t))return t;for(var e=[],r=0;r<t.length;r++){var i=t[r];e.push(n(i,r))}return e};const gJ=pJ;var vJ=function(t){return t};const mJ=function(t,n){n===void 0&&(n=vJ);var e={};return zp(t)&&!Ra(t)&&Object.keys(t).forEach(function(r){e[r]=n(t[r],r)}),e},yJ=function(t,n,e){for(var r=0,i=Da(n)?n.split("."):n;t&&r<i.length;)t=t[i[r++]];return t===void 0||r<i.length?e:t},bJ=function(t,n,e){var r=t,i=Da(n)?n.split("."):n;return i.forEach(function(o,a){a<i.length-1?(zp(r[o])||(r[o]=Qo(i[a+1])?[]:{}),r=r[o]):r[o]=e}),t};var xJ=Object.prototype.hasOwnProperty;const wJ=function(t,n){if(t===null||!Yu(t))return{};var e={};return Uu(n,function(r){xJ.call(t,r)&&(e[r]=t[r])}),e},EJ=function(t,n){return NT(t,function(e,r,i){return n.includes(i)||(e[i]=r),e},{})},MJ=function(t,n,e){var r,i,o,a,s=0;e||(e={});var u=function(){s=e.leading===!1?0:Date.now(),r=null,a=t.apply(i,o),r||(i=o=null)},c=function(){var l=Date.now();!s&&e.leading===!1&&(s=l);var h=n-(l-s);return i=this,o=arguments,h<=0||h>n?(r&&(clearTimeout(r),r=null),s=l,a=t.apply(i,o),r||(i=o=null)):!r&&e.trailing!==!1&&(r=setTimeout(u,h)),a};return c.cancel=function(){clearTimeout(r),s=0,r=i=o=null},c},SJ=function(t){return zr(t)?Array.prototype.slice.call(t):[]};var Mf={};const _J=function(t){return t=t||"g",Mf[t]?Mf[t]+=1:Mf[t]=1,t+Mf[t]},kJ=function(){},AJ=function(t){return t};function CJ(t){return Ra(t)?0:zr(t)?t.length:Object.keys(t).length}var IJ=function(){function t(){this.map={}}return t.prototype.has=function(n){return this.map[n]!==void 0},t.prototype.get=function(n,e){var r=this.map[n];return r===void 0?e:r},t.prototype.set=function(n,e){this.map[n]=e},t.prototype.clear=function(){this.map={}},t.prototype.delete=function(n){delete this.map[n]},t.prototype.size=function(){return Object.keys(this.map).length},t}();const TJ=IJ;var OJ=1e-6;function Z0(t){return Math.abs(t)<OJ?0:t<0?-1:1}function NJ(t,n,e){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])&&Math.min(t[0],n[0])<=e[0]&&e[0]<=Math.max(t[0],n[0])&&Math.min(t[1],n[1])<=e[1]&&e[1]<=Math.max(t[1],n[1])}function Am(t,n,e){var r=!1,i=t.length;if(i<=2)return!1;for(var o=0;o<i;o++){var a=t[o],s=t[(o+1)%i];if(NJ(a,s,[n,e]))return!0;Z0(a[1]-e)>0!=Z0(s[1]-e)>0&&Z0(n-(e-a[1])*(a[0]-s[0])/(a[1]-s[1])-a[0])<0&&(r=!r)}return r}var lM=function(t,n,e){return t>=n&&t<=e};function DJ(t,n,e,r){var i=.001,o={x:e.x-t.x,y:e.y-t.y},a={x:n.x-t.x,y:n.y-t.y},s={x:r.x-e.x,y:r.y-e.y},u=a.x*s.y-a.y*s.x,c=u*u,l=a.x*a.x+a.y*a.y,h=s.x*s.x+s.y*s.y,f=null;if(c>i*l*h){var d=(o.x*s.y-o.y*s.x)/u,p=(o.x*a.y-o.y*a.x)/u;lM(d,0,1)&&lM(p,0,1)&&(f={x:t.x+d*a.x,y:t.y+d*a.y})}return f}function hM(t){for(var n=[],e=t.length,r=0;r<e-1;r++){var i=t[r],o=t[r+1];n.push({from:{x:i[0],y:i[1]},to:{x:o[0],y:o[1]}})}if(n.length>1){var a=t[0],s=t[e-1];n.push({from:{x:s[0],y:s[1]},to:{x:a[0],y:a[1]}})}return n}function PJ(t,n){var e=!1;return t.forEach(function(r){if(DJ(r.from,r.to,n.from,n.to))return e=!0,!1}),e}function fM(t){var n=t.map(function(r){return r[0]}),e=t.map(function(r){return r[1]});return{minX:Math.min.apply(null,n),maxX:Math.max.apply(null,n),minY:Math.min.apply(null,e),maxY:Math.max.apply(null,e)}}function LJ(t,n){return!(n.minX>t.maxX||n.maxX<t.minX||n.minY>t.maxY||n.maxY<t.minY)}function jJ(t,n){if(t.length<2||n.length<2)return!1;var e=fM(t),r=fM(n);if(!LJ(e,r))return!1;var i=!1;if(n.forEach(function(u){if(Am(t,u[0],u[1]))return i=!0,!1}),i||(t.forEach(function(u){if(Am(n,u[0],u[1]))return i=!0,!1}),i))return!0;var o=hM(t),a=hM(n),s=!1;return a.forEach(function(u){if(PJ(o,u))return s=!0,!1}),s}const RJ=Object.freeze(Object.defineProperty({__proto__:null,Cache:TJ,angleTo:mZ,arcToCubic:M1,assign:Cu,augment:tJ,clamp:VK,clearAnimationFrame:JQ,clone:eJ,clonePath:ec,contains:Bd,debounce:nJ,deepMix:aJ,difference:tK,direction:pT,distanceSquareRoot:nc,each:Uu,endsWith:NK,equalizeSegments:MT,every:PK,extend:uJ,filter:ST,find:sK,findIndex:uK,firstValue:lK,fixedBase:XK,flatten:fK,flattenDeep:dK,forIn:Uu,get:yJ,getDrawDirection:WZ,getPathArea:ET,getPathBBox:zZ,getPathBBoxTotalLength:GZ,getPointAtLength:rd,getRange:gK,getRotatedCurve:YZ,getTotalLength:il,getType:RT,getWrapBehavior:BK,gradient:aZ,group:FK,groupBy:PT,groupToMap:LT,has:cM,hasKey:cM,hasValue:xQ,head:IK,identity:AJ,includes:Bd,indexOf:lJ,isArguments:DQ,isArray:Kn,isArrayLike:zr,isBoolean:LQ,isDate:RQ,isDecimal:ZK,isElement:KQ,isEmpty:fJ,isEqual:zT,isEqualWith:dJ,isError:BQ,isEven:QK,isFinite:zQ,isFunction:ei,isInteger:$K,isMatch:kT,isNegative:eQ,isNil:Ra,isNull:UQ,isNumber:Qo,isNumberEqual:rQ,isObject:zp,isObjectLike:zd,isOdd:oQ,isPlainObject:Yu,isPointInPolygon:Am,isPointInStroke:qZ,isPolygonsIntersect:jJ,isPositive:sQ,isPrototype:FT,isRegExp:XQ,isString:Da,isType:wo,isUndefined:qQ,keys:_T,last:TK,lowerCase:EQ,lowerFirst:SQ,map:gJ,mapValues:mJ,max:CT,maxBy:uQ,memoize:rJ,min:IT,minBy:cQ,mix:Cu,mod:hQ,noop:kJ,normalizePath:Fp,number2color:GK,omit:EJ,parseRadius:UK,path2Absolute:bT,path2Curve:xT,path2String:xZ,pick:wJ,pull:bK,pullAt:OT,reduce:NT,remove:SK,requestAnimationFrame:QQ,reverseCurve:PZ,rgb2arr:hT,set:bJ,size:CJ,some:jK,sortBy:_K,startsWith:OK,substitute:_Q,throttle:MJ,toArray:SJ,toCSSGradient:hZ,toDegree:pQ,toInteger:gQ,toRGB:dT,toRadian:yQ,toString:Jl,transform:vZ,union:AK,uniq:DT,uniqueId:_J,upperCase:AQ,upperFirst:IQ,values:jT,valuesOfKey:CK,vertical:yZ,wrapBehavior:zK},Symbol.toStringTag,{value:"Module"})),GT=xo(RJ);Object.defineProperty(w1,"__esModule",{value:!0});var FJ=GT,BJ=function(t){for(var n={},e=t.nodes().filter(function(h){var f;return!(!((f=t.children(h))===null||f===void 0)&&f.length)}),r=e.map(function(h){return t.node(h).rank}),i=(0,FJ.max)(r),o=[],a=0;a<i+1;a++)o.push([]);var s=function(h){var f;if(!n.hasOwnProperty(h)){n[h]=!0;var d=t.node(h);isNaN(d.rank)||o[d.rank].push(h),(f=t.successors(h))===null||f===void 0||f.forEach(function(p){return s(p)})}},u=e.sort(function(h,f){return t.node(h).rank-t.node(f).rank}),c=u.filter(function(h){return t.node(h).fixorder!==void 0}),l=c.sort(function(h,f){return t.node(h).fixorder-t.node(f).fixorder});return l==null||l.forEach(function(h){isNaN(t.node(h).rank)||o[t.node(h).rank].push(h),n[h]=!0}),u==null||u.forEach(s),o};w1.default=BJ;var S1={};Object.defineProperty(S1,"__esModule",{value:!0});var zJ=ti,GJ=function(t,n,e){for(var r=(0,zJ.zipObject)(e,e.map(function(l,h){return h})),i=n.map(function(l){var h,f=(h=t.outEdges(l))===null||h===void 0?void 0:h.map(function(d){return{pos:r[d.w]||0,weight:t.edge(d).weight}});return f==null?void 0:f.sort(function(d,p){return d.pos-p.pos})}),o=i.flat().filter(function(l){return l!==void 0}),a=1;a<e.length;)a<<=1;var s=2*a-1;a-=1;var u=Array(s).fill(0,0,s),c=0;return o==null||o.forEach(function(l){if(l){var h=l.pos+a;u[h]+=l.weight;for(var f=0;h>0;)h%2&&(f+=u[h+1]),h=h-1>>1,u[h]+=l.weight;c+=l.weight*f}}),c},UJ=function(t,n){for(var e=0,r=1;r<(n==null?void 0:n.length);r+=1)e+=GJ(t,n[r-1],n[r]);return e};S1.default=UJ;var _1={};Object.defineProperty(_1,"__esModule",{value:!0});var YJ=Ko,VJ=function(t,n,e){var r=WJ(t),i=new YJ.Graph({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(o){return t.node(o)});return t.nodes().forEach(function(o){var a,s=t.node(o),u=t.parent(o);(s.rank===n||s.minRank<=n&&n<=s.maxRank)&&(i.setNode(o),i.setParent(o,u||r),(a=t[e](o))===null||a===void 0||a.forEach(function(c){var l=c.v===o?c.w:c.v,h=i.edgeFromArgs(l,o),f=h!==void 0?h.weight:0;i.setEdge(l,o,{weight:t.edge(c).weight+f})}),s.hasOwnProperty("minRank")&&i.setNode(o,{borderLeft:s.borderLeft[n],borderRight:s.borderRight[n]}))}),i},WJ=function(t){for(var n;t.hasNode(n="_root".concat(Math.random())););return n};_1.default=VJ;var k1={};Object.defineProperty(k1,"__esModule",{value:!0});var XJ=function(t,n,e){var r={},i;e==null||e.forEach(function(o){for(var a=t.parent(o),s,u;a;){if(s=t.parent(a),s?(u=r[s],r[s]=a):(u=i,i=a),u&&u!==a){n.setEdge(u,a);return}a=s}})};k1.default=XJ;var A1={},C1={};Object.defineProperty(C1,"__esModule",{value:!0});var HJ=function(t,n){return n.map(function(e){var r=t.inEdges(e);if(!(r!=null&&r.length))return{v:e};{var i={sum:0,weight:0};return r==null||r.forEach(function(o){var a=t.edge(o),s=t.node(o.v);i.sum+=a.weight*s.order,i.weight+=a.weight}),{v:e,barycenter:i.sum/i.weight,weight:i.weight}}})};C1.default=HJ;var I1={};Object.defineProperty(I1,"__esModule",{value:!0});var qJ=function(t,n){var e,r,i,o={};t==null||t.forEach(function(s,u){o[s.v]={i:u,indegree:0,in:[],out:[],vs:[s.v]};var c=o[s.v];s.barycenter!==void 0&&(c.barycenter=s.barycenter,c.weight=s.weight)}),(e=n.edges())===null||e===void 0||e.forEach(function(s){var u=o[s.v],c=o[s.w];u!==void 0&&c!==void 0&&(c.indegree++,u.out.push(o[s.w]))});var a=(i=(r=Object.values(o)).filter)===null||i===void 0?void 0:i.call(r,function(s){return!s.indegree});return ZJ(a)},ZJ=function(t){for(var n,e,r=[],i=function(c){return function(l){l.merged||(l.barycenter===void 0||c.barycenter===void 0||l.barycenter>=c.barycenter)&&KJ(c,l)}},o=function(c){return function(l){l.in.push(c),--l.indegree===0&&t.push(l)}},a=function(){var c=t.pop();r.push(c),(n=c.in.reverse())===null||n===void 0||n.forEach(function(l){return i(c)(l)}),(e=c.out)===null||e===void 0||e.forEach(function(l){return o(c)(l)})};t!=null&&t.length;)a();var s=r.filter(function(c){return!c.merged}),u=["vs","i","barycenter","weight"];return s.map(function(c){var l={};return u==null||u.forEach(function(h){c[h]!==void 0&&(l[h]=c[h])}),l})},KJ=function(t,n){var e,r=0,i=0;t.weight&&(r+=t.barycenter*t.weight,i+=t.weight),n.weight&&(r+=n.barycenter*n.weight,i+=n.weight),t.vs=(e=n.vs)===null||e===void 0?void 0:e.concat(t.vs),t.barycenter=r/i,t.weight=i,t.i=Math.min(n.i,t.i),n.merged=!0};I1.default=qJ;var T1={};Object.defineProperty(T1,"__esModule",{value:!0});var QJ=ti,JJ=function(t,n,e,r){var i=(0,QJ.partition)(t,function(f){var d=f.hasOwnProperty("fixorder")&&!isNaN(f.fixorder);return r?!d&&f.hasOwnProperty("barycenter"):d||f.hasOwnProperty("barycenter")}),o=i.lhs,a=i.rhs.sort(function(f,d){return-f.i- -d.i}),s=[],u=0,c=0,l=0;o==null||o.sort($J(!!n,!!e)),l=dM(s,a,l),o==null||o.forEach(function(f){var d;l+=(d=f.vs)===null||d===void 0?void 0:d.length,s.push(f.vs),u+=f.barycenter*f.weight,c+=f.weight,l=dM(s,a,l)});var h={vs:s.flat()};return c&&(h.barycenter=u/c,h.weight=c),h},dM=function(t,n,e){for(var r=e,i;n.length&&(i=n[n.length-1]).i<=r;)n.pop(),t==null||t.push(i.vs),r++;return r},$J=function(t,n){return function(e,r){if(e.fixorder!==void 0&&r.fixorder!==void 0)return e.fixorder-r.fixorder;if(e.barycenter<r.barycenter)return-1;if(e.barycenter>r.barycenter)return 1;if(n&&e.order!==void 0&&r.order!==void 0){if(e.order<r.order)return-1;if(e.order>r.order)return 1}return t?r.i-e.i:e.i-r.i}};T1.default=JJ;var O1=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(A1,"__esModule",{value:!0});var t$=O1(C1),e$=O1(I1),n$=O1(T1),UT=function(t,n,e,r,i,o){var a,s,u,c,l=t.children(n),h=t.node(n),f=h?h.borderLeft:void 0,d=h?h.borderRight:void 0,p={};f&&(l=l==null?void 0:l.filter(function(x){return x!==f&&x!==d}));var g=(0,t$.default)(t,l||[]);g==null||g.forEach(function(x){var w;if(!((w=t.children(x.v))===null||w===void 0)&&w.length){var E=UT(t,x.v,e,r,o);p[x.v]=E,E.hasOwnProperty("barycenter")&&i$(x,E)}});var v=(0,e$.default)(g,e);r$(v,p),(a=v.filter(function(x){return x.vs.length>0}))===null||a===void 0||a.forEach(function(x){var w=t.node(x.vs[0]);w&&(x.fixorder=w.fixorder,x.order=w.order)});var m=(0,n$.default)(v,r,i,o);if(f&&(m.vs=[f,m.vs,d].flat(),!((s=t.predecessors(f))===null||s===void 0)&&s.length)){var y=t.node(((u=t.predecessors(f))===null||u===void 0?void 0:u[0])||""),b=t.node(((c=t.predecessors(d))===null||c===void 0?void 0:c[0])||"");m.hasOwnProperty("barycenter")||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+y.order+b.order)/(m.weight+2),m.weight+=2}return m},r$=function(t,n){t==null||t.forEach(function(e){var r,i=(r=e.vs)===null||r===void 0?void 0:r.map(function(o){return n[o]?n[o].vs:o});e.vs=i.flat()})},i$=function(t,n){t.barycenter!==void 0?(t.barycenter=(t.barycenter*t.weight+n.barycenter*n.weight)/(t.weight+n.weight),t.weight+=n.weight):(t.barycenter=n.barycenter,t.weight=n.weight)};A1.default=UT;var $l=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(x1,"__esModule",{value:!0});var pM=$l(w1),gM=$l(S1),o$=$l(_1),a$=$l(k1),s$=$l(A1),vM=Ln(),u$=Ko,K0=ti,c$=function(t,n){for(var e=(0,K0.maxRank)(t),r=[],i=[],o=1;o<e+1;o++)r.push(o);for(var o=e-1;o>-1;o--)i.push(o);var a=mM(t,r,"inEdges"),s=mM(t,i,"outEdges"),u=(0,pM.default)(t);Q0(t,u);for(var c=Number.POSITIVE_INFINITY,l,o=0,h=0;h<4;++o,++h){yM(o%2?a:s,o%4>=2,!1,n),u=(0,K0.buildLayerMatrix)(t);var f=(0,gM.default)(t,u);f<c&&(h=0,l=(0,vM.clone)(u),c=f)}u=(0,pM.default)(t),Q0(t,u);for(var o=0,h=0;h<4;++o,++h){yM(o%2?a:s,o%4>=2,!0,n),u=(0,K0.buildLayerMatrix)(t);var f=(0,gM.default)(t,u);f<c&&(h=0,l=(0,vM.clone)(u),c=f)}Q0(t,l)},mM=function(t,n,e){return n.map(function(r){return(0,o$.default)(t,r,e)})},yM=function(t,n,e,r){var i=new u$.Graph;t==null||t.forEach(function(o){for(var a,s=o.graph().root,u=(0,s$.default)(o,s,i,n,e,r),c=0;c<((a=u.vs)===null||a===void 0?void 0:a.length);c++){var l=o.node(u.vs[c]);l&&(l.order=c)}(0,a$.default)(o,i,u.vs)})},Q0=function(t,n){n==null||n.forEach(function(e){e==null||e.forEach(function(r,i){t.node(r).order=i})})};x1.default=c$;var N1={},YT={};(function(t){var n=bt&&bt.__extends||function(){var x=function(w,E){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,_){M.__proto__=_}||function(M,_){for(var k in _)Object.prototype.hasOwnProperty.call(_,k)&&(M[k]=_[k])},x(w,E)};return function(w,E){if(typeof E!="function"&&E!==null)throw new TypeError("Class extends value "+String(E)+" is not a constructor or null");x(w,E);function M(){this.constructor=w}w.prototype=E===null?Object.create(E):(M.prototype=E.prototype,new M)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.width=t.sep=t.positionX=t.balance=t.alignCoordinates=t.findSmallestWidthAlignment=t.buildBlockGraph=t.horizontalCompaction=t.verticalAlignment=t.hasConflict=t.addConflict=t.findOtherInnerSegmentNode=t.findType2Conflicts=t.findType1Conflicts=void 0;var e=Rp,r=GT,i=ti,o=function(x){n(w,x);function w(){return x!==null&&x.apply(this,arguments)||this}return w}(e.Graph),a=function(x,w){var E={},M=function(_,k){var S=0,A=0,C=_.length,I=k==null?void 0:k[(k==null?void 0:k.length)-1];return k==null||k.forEach(function(N,D){var P,j=(0,t.findOtherInnerSegmentNode)(x,N),L=j?x.node(j).order:C;(j||N===I)&&((P=k.slice(A,D+1))===null||P===void 0||P.forEach(function(R){var V;(V=x.predecessors(R))===null||V===void 0||V.forEach(function(tt){var ut,dt=x.node(tt),J=dt.order;(J<S||L<J)&&!(dt.dummy&&!((ut=x.node(R))===null||ut===void 0)&&ut.dummy)&&(0,t.addConflict)(E,tt,R)})}),A=D+1,S=L)}),k};return w!=null&&w.length&&w.reduce(M),E};t.findType1Conflicts=a;var s=function(x,w){var E={};function M(A,C,I,N,D){for(var P,j,L,R=C;R<I;R++)L=A[R],!((P=x.node(L))===null||P===void 0)&&P.dummy&&((j=x.predecessors(L))===null||j===void 0||j.forEach(function(V){var tt=x.node(V);tt.dummy&&(tt.order<N||tt.order>D)&&(0,t.addConflict)(E,V,L)}))}function _(A){return JSON.stringify(A.slice(1))}function k(A,C){var I=_(A);C.get(I)||(M.apply(void 0,A),C.set(I,!0))}var S=function(A,C){var I=-1,N,D=0,P=new Map;return C==null||C.forEach(function(j,L){var R;if(((R=x.node(j))===null||R===void 0?void 0:R.dummy)==="border"){var V=x.predecessors(j)||[];V.length&&(N=x.node(V[0]).order,k([C,D,L,I,N],P),D=L,I=N)}k([C,D,C.length,N,A.length],P)}),C};return w!=null&&w.length&&w.reduce(S),E};t.findType2Conflicts=s;var u=function(x,w){var E,M;if(!((E=x.node(w))===null||E===void 0)&&E.dummy)return(M=x.predecessors(w))===null||M===void 0?void 0:M.find(function(_){return x.node(_).dummy})};t.findOtherInnerSegmentNode=u;var c=function(x,w,E){var M=w,_=E;if(M>_){var k=M;M=_,_=k}var S=x[M];S||(x[M]=S={}),S[_]=!0};t.addConflict=c;var l=function(x,w,E){var M=w,_=E;if(M>_){var k=w;M=_,_=k}return!!x[M]};t.hasConflict=l;var h=function(x,w,E,M){var _={},k={},S={};return w==null||w.forEach(function(A){A==null||A.forEach(function(C,I){_[C]=C,k[C]=C,S[C]=I})}),w==null||w.forEach(function(A){var C=-1;A==null||A.forEach(function(I){var N=M(I);if(N.length){N=N.sort(function(R,V){return S[R]-S[V]});for(var D=(N.length-1)/2,P=Math.floor(D),j=Math.ceil(D);P<=j;++P){var L=N[P];k[I]===I&&C<S[L]&&!(0,t.hasConflict)(E,I,L)&&(k[L]=I,k[I]=_[I]=_[L],C=S[L])}}})}),{root:_,align:k}};t.verticalAlignment=h;var f=function(x,w,E,M,_){var k,S={},A=(0,t.buildBlockGraph)(x,w,E,_),C=_?"borderLeft":"borderRight",I=function(P,j){for(var L=A.nodes(),R=L.pop(),V={};R;)V[R]?P(R):(V[R]=!0,L.push(R),L=L.concat(j(R))),R=L.pop()},N=function(P){S[P]=(A.inEdges(P)||[]).reduce(function(j,L){return Math.max(j,(S[L.v]||0)+A.edge(L))},0)},D=function(P){var j=(A.outEdges(P)||[]).reduce(function(R,V){return Math.min(R,(S[V.w]||0)-A.edge(V))},Number.POSITIVE_INFINITY),L=x.node(P);j!==Number.POSITIVE_INFINITY&&L.borderType!==C&&(S[P]=Math.max(S[P],j))};return I(N,A.predecessors.bind(A)),I(D,A.successors.bind(A)),(k=Object.values(M))===null||k===void 0||k.forEach(function(P){S[P]=S[E[P]]}),S};t.horizontalCompaction=f;var d=function(x,w,E,M){var _=new o,k=x.graph(),S=(0,t.sep)(k.nodesep,k.edgesep,M);return w==null||w.forEach(function(A){var C;A==null||A.forEach(function(I){var N=E[I];if(_.setNode(N),C){var D=E[C],P=_.edgeFromArgs(D,N);_.setEdge(D,N,Math.max(S(x,I,C),P||0))}C=I})}),_};t.buildBlockGraph=d;var p=function(x,w){return(0,i.minBy)(Object.values(w),function(E){var M,_=Number.NEGATIVE_INFINITY,k=Number.POSITIVE_INFINITY;return(M=Object.keys(E))===null||M===void 0||M.forEach(function(S){var A=E[S],C=(0,t.width)(x,S)/2;_=Math.max(A+C,_),k=Math.min(A-C,k)}),_-k})};t.findSmallestWidthAlignment=p;function g(x,w){var E=Object.values(w),M=(0,r.min)(E),_=(0,r.max)(E);["u","d"].forEach(function(k){["l","r"].forEach(function(S){var A=k+S,C=x[A],I;if(C!==w){var N=Object.values(C);I=S==="l"?M-(0,r.min)(N):_-(0,r.max)(N),I&&(x[A]={},Object.keys(C).forEach(function(D){x[A][D]=C[D]+I}))}})})}t.alignCoordinates=g;var v=function(x,w){var E={};return Object.keys(x.ul).forEach(function(M){if(w)E[M]=x[w.toLowerCase()][M];else{var _=Object.values(x).map(function(k){return k[M]});E[M]=(_[0]+_[1])/2}}),E};t.balance=v;var m=function(x){var w=(0,i.buildLayerMatrix)(x),E=Object.assign((0,t.findType1Conflicts)(x,w),(0,t.findType2Conflicts)(x,w)),M={},_;["u","d"].forEach(function(S){_=S==="u"?w:Object.values(w).reverse(),["l","r"].forEach(function(A){A==="r"&&(_=_.map(function(D){return Object.values(D).reverse()}));var C=(S==="u"?x.predecessors:x.successors).bind(x),I=(0,t.verticalAlignment)(x,_,E,C),N=(0,t.horizontalCompaction)(x,_,I.root,I.align,A==="r");A==="r"&&Object.keys(N).forEach(function(D){N[D]=-N[D]}),M[S+A]=N})});var k=(0,t.findSmallestWidthAlignment)(x,M);return g(M,k),(0,t.balance)(M,x.graph().align)};t.positionX=m;var y=function(x,w,E){return function(M,_,k){var S=M.node(_),A=M.node(k),C=0,I;if(C+=S.width/2,S.hasOwnProperty("labelpos"))switch((S.labelpos||"").toLowerCase()){case"l":I=-S.width/2;break;case"r":I=S.width/2;break}if(I&&(C+=E?I:-I),I=0,C+=(S.dummy?w:x)/2,C+=(A.dummy?w:x)/2,C+=A.width/2,A.labelpos)switch((A.labelpos||"").toLowerCase()){case"l":I=A.width/2;break;case"r":I=-A.width/2;break}return I&&(C+=E?I:-I),I=0,C}};t.sep=y;var b=function(x,w){return x.node(w).width||0};t.width=b})(YT);var bM=bt&&bt.__spreadArray||function(t,n,e){if(e||arguments.length===2)for(var r=0,i=n.length,o;r<i;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};Object.defineProperty(N1,"__esModule",{value:!0});var D1=ti,rs=YT,l$=function(t){var n=(0,D1.buildLayerMatrix)(t),e=t.graph().ranksep,r=0;n==null||n.forEach(function(i){var o=i.map(function(s){return t.node(s).height}),a=Math.max.apply(Math,bM(bM([],o,!1),[0],!1));i==null||i.forEach(function(s){t.node(s).y=r+a/2}),r+=a+e})},h$=function(t){var n=(0,D1.buildLayerMatrix)(t),e=Object.assign((0,rs.findType1Conflicts)(t,n),(0,rs.findType2Conflicts)(t,n)),r={},i=[];["u","d"].forEach(function(a){i=a==="u"?n:Object.values(n).reverse(),["l","r"].forEach(function(s){s==="r"&&(i=i.map(function(h){return Object.values(h).reverse()}));var u=(a==="u"?t.predecessors:t.successors).bind(t),c=(0,rs.verticalAlignment)(t,i,e,u),l=(0,rs.horizontalCompaction)(t,i,c.root,c.align,s==="r");s==="r"&&Object.keys(l).forEach(function(h){return l[h]=-l[h]}),r[a+s]=l})});var o=(0,rs.findSmallestWidthAlignment)(t,r);return o&&(0,rs.alignCoordinates)(r,o),(0,rs.balance)(r,t.graph().align)},f$=function(t){var n,e=(0,D1.asNonCompoundGraph)(t);l$(e);var r=h$(e);(n=Object.keys(r))===null||n===void 0||n.forEach(function(i){e.node(i).x=r[i]})};N1.default=f$;var P1={};Object.defineProperty(P1,"__esModule",{value:!0});var d$=function(t,n){for(var e=t.nodes().filter(function(s){var u;return!(!((u=t.children(s))===null||u===void 0)&&u.length)}),r=e.map(function(s){return t.node(s).rank}),i=Math.max.apply(Math,r),o=[],a=0;a<i+1;a++)o[a]=[];n==null||n.forEach(function(s){var u=t.node(s);!u||u!=null&&u.dummy||isNaN(u.rank)||(u.fixorder=o[u.rank].length,o[u.rank].push(s))})};P1.default=d$;var Gd=bt&&bt.__assign||function(){return Gd=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Gd.apply(this,arguments)},Eo=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(u1,"__esModule",{value:!0});var xM=Eo(c1),wM=Eo(p1),p$=Eo(g1),fo=ti,g$=Eo(v1),EM=Eo(m1),v$=Eo(y1),MM=Eo(b1),m$=Eo(x1),y$=Eo(N1),b$=Eo(P1),x$=Ko,w$=function(t,n){var e=n&&n.debugTiming?fo.time:fo.notime;e("layout",function(){n&&!n.keepNodeOrder&&n.prevGraph&&e("  inheritOrder",function(){M$(t,n.prevGraph)});var r=e("  buildLayoutGraph",function(){return O$(t)});n&&n.edgeLabelSpace===!1||e("  makeSpaceForEdgeLabels",function(){N$(r)});try{e("  runLayout",function(){E$(r,e,n)})}catch(i){if(i.message==="Not possible to find intersection inside of the rectangle"){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,i);return}throw i}e("  updateInputGraph",function(){S$(t,r)})})},E$=function(t,n,e){n("    removeSelfEdges",function(){G$(t)}),n("    acyclic",function(){xM.default.run(t)}),n("    nestingGraph.run",function(){EM.default.run(t)}),n("    rank",function(){(0,p$.default)((0,fo.asNonCompoundGraph)(t))}),n("    injectEdgeLabelProxies",function(){D$(t)}),n("    removeEmptyRanks",function(){(0,fo.removeEmptyRanks)(t)}),n("    nestingGraph.cleanup",function(){EM.default.cleanup(t)}),n("    normalizeRanks",function(){(0,fo.normalizeRanks)(t)}),n("    assignRankMinMax",function(){P$(t)}),n("    removeEdgeLabelProxies",function(){L$(t)}),n("    normalize.run",function(){wM.default.run(t)}),n("    parentDummyChains",function(){(0,g$.default)(t)}),n("    addBorderSegments",function(){(0,v$.default)(t)}),e&&e.keepNodeOrder&&n("    initDataOrder",function(){(0,b$.default)(t,e.nodeOrder)}),n("    order",function(){(0,m$.default)(t,e==null?void 0:e.keepNodeOrder)}),n("    insertSelfEdges",function(){U$(t)}),n("    adjustCoordinateSystem",function(){MM.default.adjust(t)}),n("    position",function(){(0,y$.default)(t)}),n("    positionSelfEdges",function(){Y$(t)}),n("    removeBorderNodes",function(){z$(t)}),n("    normalize.undo",function(){wM.default.undo(t)}),n("    fixupEdgeLabelCoords",function(){F$(t)}),n("    undoCoordinateSystem",function(){MM.default.undo(t)}),n("    translateGraph",function(){j$(t)}),n("    assignNodeIntersects",function(){R$(t)}),n("    reversePoints",function(){B$(t)}),n("    acyclic.undo",function(){xM.default.undo(t)})},M$=function(t,n){t.nodes().forEach(function(e){var r=t.node(e),i=n.node(e);i!==void 0?(r.fixorder=i._order,delete i._order):delete r.fixorder})},S$=function(t,n){t.nodes().forEach(function(e){var r,i=t.node(e);if(i){var o=n.node(e);i.x=o.x,i.y=o.y,i._order=o.order,i._rank=o.rank,!((r=n.children(e))===null||r===void 0)&&r.length&&(i.width=o.width,i.height=o.height)}}),t.edges().forEach(function(e){var r=t.edge(e),i=n.edge(e);r.points=i?i.points:[],i&&i.hasOwnProperty("x")&&(r.x=i.x,r.y=i.y)}),t.graph().width=n.graph().width,t.graph().height=n.graph().height},_$=["nodesep","edgesep","ranksep","marginx","marginy"],k$={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},SM=["acyclicer","ranker","rankdir","align"],A$=["width","height","layer","fixorder"],C$={width:0,height:0},I$=["minlen","weight","width","height","labeloffset"],T$={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},_M=["labelpos"],O$=function(t){var n=new x$.Graph({multigraph:!0,compound:!0}),e=$0(t.graph()),r={};return SM==null||SM.forEach(function(i){e[i]!==void 0&&(r[i]=e[i])}),n.setGraph(Object.assign({},k$,J0(e,_$),r)),t.nodes().forEach(function(i){var o=$0(t.node(i)),a=Gd(Gd({},C$),o),s=J0(a,A$);n.setNode(i,s),n.setParent(i,t.parent(i))}),t.edges().forEach(function(i){var o=$0(t.edge(i)),a={};_M==null||_M.forEach(function(s){o[s]!==void 0&&(a[s]=o[s])}),n.setEdgeObj(i,Object.assign({},T$,J0(o,I$),a))}),n},N$=function(t){var n=t.graph();n.ranksep||(n.ranksep=0),n.ranksep/=2,t.nodes().forEach(function(e){var r=t.node(e);isNaN(r.layer)||r.layer||(r.layer=0)}),t.edges().forEach(function(e){var r,i=t.edge(e);i.minlen*=2,((r=i.labelpos)===null||r===void 0?void 0:r.toLowerCase())!=="c"&&(n.rankdir==="TB"||n.rankdir==="BT"?i.width+=i.labeloffset:i.height+=i.labeloffset)})},D$=function(t){t.edges().forEach(function(n){var e=t.edge(n);if(e.width&&e.height){var r=t.node(n.v),i=t.node(n.w),o={e:n,rank:(i.rank-r.rank)/2+r.rank};(0,fo.addDummyNode)(t,"edge-proxy",o,"_ep")}})},P$=function(t){var n=0;t.nodes().forEach(function(e){var r,i,o=t.node(e);o.borderTop&&(o.minRank=(r=t.node(o.borderTop))===null||r===void 0?void 0:r.rank,o.maxRank=(i=t.node(o.borderBottom))===null||i===void 0?void 0:i.rank,n=Math.max(n,o.maxRank||-1/0))}),t.graph().maxRank=n},L$=function(t){t.nodes().forEach(function(n){var e=t.node(n);e.dummy==="edge-proxy"&&(t.edge(e.e).labelRank=e.rank,t.removeNode(n))})},j$=function(t){var n,e=0,r,i=0,o=t.graph(),a=o.marginx||0,s=o.marginy||0,u=function(c){if(c){var l=c.x,h=c.y,f=c.width,d=c.height;!isNaN(l)&&!isNaN(f)&&(n===void 0&&(n=l-f/2),n=Math.min(n,l-f/2),e=Math.max(e,l+f/2)),!isNaN(h)&&!isNaN(d)&&(r===void 0&&(r=h-d/2),r=Math.min(r,h-d/2),i=Math.max(i,h+d/2))}};t.nodes().forEach(function(c){u(t.node(c))}),t.edges().forEach(function(c){var l=t.edge(c);l!=null&&l.hasOwnProperty("x")&&u(l)}),n-=a,r-=s,t.nodes().forEach(function(c){var l=t.node(c);l&&(l.x-=n,l.y-=r)}),t.edges().forEach(function(c){var l,h=t.edge(c);(l=h.points)===null||l===void 0||l.forEach(function(f){f.x-=n,f.y-=r}),h.hasOwnProperty("x")&&(h.x-=n),h.hasOwnProperty("y")&&(h.y-=r)}),o.width=e-n+a,o.height=i-r+s},R$=function(t){t.edges().forEach(function(n){var e=t.edge(n),r=t.node(n.v),i=t.node(n.w),o,a;e.points?(o=e.points[0],a=e.points[e.points.length-1]):(e.points=[],o=i,a=r),e.points.unshift((0,fo.intersectRect)(r,o)),e.points.push((0,fo.intersectRect)(i,a))})},F$=function(t){t.edges().forEach(function(n){var e=t.edge(n);if(e!=null&&e.hasOwnProperty("x"))switch((e.labelpos==="l"||e.labelpos==="r")&&(e.width-=e.labeloffset),e.labelpos){case"l":e.x-=e.width/2+e.labeloffset;break;case"r":e.x+=e.width/2+e.labeloffset;break}})},B$=function(t){t.edges().forEach(function(n){var e,r=t.edge(n);r.reversed&&((e=r.points)===null||e===void 0||e.reverse())})},z$=function(t){t.nodes().forEach(function(n){var e,r,i;if(!((e=t.children(n))===null||e===void 0)&&e.length){var o=t.node(n),a=t.node(o.borderTop),s=t.node(o.borderBottom),u=t.node(o.borderLeft[((r=o.borderLeft)===null||r===void 0?void 0:r.length)-1]),c=t.node(o.borderRight[((i=o.borderRight)===null||i===void 0?void 0:i.length)-1]);o.width=Math.abs((c==null?void 0:c.x)-(u==null?void 0:u.x))||10,o.height=Math.abs((s==null?void 0:s.y)-(a==null?void 0:a.y))||10,o.x=((u==null?void 0:u.x)||0)+o.width/2,o.y=((a==null?void 0:a.y)||0)+o.height/2}}),t.nodes().forEach(function(n){var e;((e=t.node(n))===null||e===void 0?void 0:e.dummy)==="border"&&t.removeNode(n)})},G$=function(t){t.edges().forEach(function(n){if(n.v===n.w){var e=t.node(n.v);e.selfEdges||(e.selfEdges=[]),e.selfEdges.push({e:n,label:t.edge(n)}),t.removeEdgeObj(n)}})},U$=function(t){var n=(0,fo.buildLayerMatrix)(t);n==null||n.forEach(function(e){var r=0;e==null||e.forEach(function(i,o){var a,s=t.node(i);s.order=o+r,(a=s.selfEdges)===null||a===void 0||a.forEach(function(u){(0,fo.addDummyNode)(t,"selfedge",{width:u.label.width,height:u.label.height,rank:s.rank,order:o+ ++r,e:u.e,label:u.label},"_se")}),delete s.selfEdges})})},Y$=function(t){t.nodes().forEach(function(n){var e=t.node(n);if(e.dummy==="selfedge"){var r=t.node(e.e.v),i=r.x+r.width/2,o=r.y,a=e.x-i,s=r.height/2;t.setEdgeObj(e.e,e.label),t.removeNode(n),e.label.points=[{x:i+2*a/3,y:o-s},{x:i+5*a/6,y:o-s},{y:o,x:i+a},{x:i+5*a/6,y:o+s},{x:i+2*a/3,y:o+s}],e.label.x=e.x,e.label.y=e.y}})},J0=function(t,n){var e={};return n==null||n.forEach(function(r){t[r]!==void 0&&(e[r]=+t[r])}),e},$0=function(t){t===void 0&&(t={});var n={};return Object.keys(t).forEach(function(e){n[e.toLowerCase()]=t[e]}),n};u1.default=w$;var V$=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(s1,"__esModule",{value:!0});var W$=V$(u1),kM=ti;s1.default={layout:W$.default,util:{time:kM.time,notime:kM.notime}};var X$=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),H$=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(tc,"__esModule",{value:!0});tc.DagreLayout=void 0;var q$=H$(s1),Wr=Ln(),Z$=Yn,AM=Ko,K$=function(t){X$(n,t);function n(e){var r=t.call(this)||this;return r.rankdir="TB",r.nodesep=50,r.ranksep=50,r.controlPoints=!1,r.sortByCombo=!1,r.edgeLabelSpace=!0,r.radial=!1,r.nodes=[],r.edges=[],r.onLayoutEnd=function(){},r.layoutNode=function(i){var o=r,a=o.nodes,s=a.find(function(c){return c.id===i});if(s){var u=s.layout!==!1;return u}return!0},r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1,radial:!1,focusNode:null}},n.prototype.execute=function(){var e=this,r,i,o,a,s=this,u=s.nodes,c=s.nodeSize,l=s.rankdir,h=s.combos,f=s.begin,d=s.radial,p=s.comboEdges,g=p===void 0?[]:p,v=s.vedges,m=v===void 0?[]:v;if(u){var y=s.edges||[],b=new AM.Graph({multigraph:!0,compound:!0});s.nodeMap={};var x={};u.forEach(function(ot){s.nodeMap[ot.id]=ot,ot.comboId&&(x[ot.comboId]=x[ot.comboId]||[],x[ot.comboId].push(ot.id))});var w=[],E={};!((r=s.nodeOrder)===null||r===void 0)&&r.length?(s.nodeOrder.forEach(function(ot){E[ot]=!0,w.push(s.nodeMap[ot])}),u.forEach(function(ot){E[ot.id]||w.push(ot)})):w=u;var M;c?(0,Wr.isArray)(c)?M=function(){return c}:M=function(){return[c,c]}:M=function(ot){return ot.size?(0,Wr.isArray)(ot.size)?ot.size:(0,Wr.isObject)(ot.size)?[ot.size.width||40,ot.size.height||40]:[ot.size,ot.size]:[40,40]};var _=(0,Wr.getFunc)(s.ranksep,50,s.ranksepFunc),k=(0,Wr.getFunc)(s.nodesep,50,s.nodesepFunc),S=k,A=_;(l==="LR"||l==="RL")&&(S=_,A=k),b.setDefaultEdgeLabel(function(){return{}}),b.setGraph(s);var C={};this.sortByCombo&&h&&h.forEach(function(ot){if(C[ot.id]=ot,ot.collapsed){var O=M(ot),ct=A(ot),Xt=S(ot),jt=O[0]+2*Xt,te=O[1]+2*ct;b.setNode(ot.id,{width:jt,height:te})}ot.parentId&&(C[ot.parentId]||b.setNode(ot.parentId,{}),b.setParent(ot.id,ot.parentId))}),w.filter(function(ot){return ot.layout!==!1}).forEach(function(ot){var O=M(ot),ct=A(ot),Xt=S(ot),jt=O[0]+2*Xt,te=O[1]+2*ct,_t=ot.layer;(0,Wr.isNumber)(_t)?b.setNode(ot.id,{width:jt,height:te,layer:_t}):b.setNode(ot.id,{width:jt,height:te}),e.sortByCombo&&ot.comboId&&(C[ot.comboId]||(C[ot.comboId]={id:ot.comboId},b.setNode(ot.comboId,{})),b.setParent(ot.id,ot.comboId))}),y.forEach(function(ot){var O=(0,Wr.getEdgeTerminal)(ot,"source"),ct=(0,Wr.getEdgeTerminal)(ot,"target");e.layoutNode(O)&&e.layoutNode(ct)&&b.setEdge(O,ct,{weight:ot.weight||1})}),(i=g==null?void 0:g.concat(m||[]))===null||i===void 0||i.forEach(function(ot){var O,ct,Xt=ot.source,jt=ot.target,te=!((O=C[Xt])===null||O===void 0)&&O.collapsed?[Xt]:x[Xt]||[Xt],_t=!((ct=C[jt])===null||ct===void 0)&&ct.collapsed?[jt]:x[jt]||[jt];te.forEach(function(Zt){_t.forEach(function(me){b.setEdge(Zt,me,{weight:ot.weight||1})})})});var I=void 0;!((o=s.preset)===null||o===void 0)&&o.nodes&&(I=new AM.Graph({multigraph:!0,compound:!0}),s.preset.nodes.forEach(function(ot){I==null||I.setNode(ot.id,ot)})),q$.default.layout(b,{prevGraph:I,edgeLabelSpace:s.edgeLabelSpace,keepNodeOrder:!!s.nodeOrder,nodeOrder:s.nodeOrder});var N=[0,0];if(f){var D=1/0,P=1/0;b.nodes().forEach(function(ot){var O=b.node(ot);D>O.x&&(D=O.x),P>O.y&&(P=O.y)}),b.edges().forEach(function(ot){var O,ct=b.edge(ot);(O=ct.points)===null||O===void 0||O.forEach(function(Xt){D>Xt.x&&(D=Xt.x),P>Xt.y&&(P=Xt.y)})}),N[0]=f[0]-D,N[1]=f[1]-P}var j=l==="LR"||l==="RL";if(d){var L=this,R=L.focusNode,V=L.ranksep,tt=L.getRadialPos,ut=(0,Wr.isString)(R)?R:R==null?void 0:R.id,dt=ut?(a=b.node(ut))===null||a===void 0?void 0:a._rank:0,J=[],Et=j?"y":"x",Bt=j?"height":"width",Vt=1/0,se=-1/0;b.nodes().forEach(function(ot){var O=b.node(ot);if(s.nodeMap[ot]){var ct=k(s.nodeMap[ot]);if(dt===0)J[O._rank]||(J[O._rank]={nodes:[],totalWidth:0,maxSize:-1/0}),J[O._rank].nodes.push(ot),J[O._rank].totalWidth+=ct*2+O[Bt],J[O._rank].maxSize<Math.max(O.width,O.height)&&(J[O._rank].maxSize=Math.max(O.width,O.height));else{var Xt=O._rank-dt;if(Xt===0)J[Xt]||(J[Xt]={nodes:[],totalWidth:0,maxSize:-1/0}),J[Xt].nodes.push(ot),J[Xt].totalWidth+=ct*2+O[Bt],J[Xt].maxSize<Math.max(O.width,O.height)&&(J[Xt].maxSize=Math.max(O.width,O.height));else{var jt=Math.abs(Xt);J[jt]||(J[jt]={left:[],right:[],totalWidth:0,maxSize:-1/0}),J[jt].totalWidth+=ct*2+O[Bt],J[jt].maxSize<Math.max(O.width,O.height)&&(J[jt].maxSize=Math.max(O.width,O.height)),Xt<0?J[jt].left.push(ot):J[jt].right.push(ot)}}var te=O[Et]-O[Bt]/2-ct,_t=O[Et]+O[Bt]/2+ct;te<Vt&&(Vt=te),_t>se&&(se=_t)}});var re=V||50,ue={},de=(se-Vt)/.9,Ze=[(Vt+se-de)*.5,(Vt+se+de)*.5],Ne=function(ot,O,ct,Xt){ct===void 0&&(ct=-1/0),Xt===void 0&&(Xt=[0,1]);var jt=ct;return ot.forEach(function(te){var _t=b.node(te);ue[te]=O;var Zt=tt(_t[Et],Ze,de,O,Xt),me=Zt.x,Ce=Zt.y;if(s.nodeMap[te]){s.nodeMap[te].x=me+N[0],s.nodeMap[te].y=Ce+N[1],s.nodeMap[te]._order=_t._order;var _e=_(s.nodeMap[te]);jt<_e&&(jt=_e)}}),jt},Re=!0,pn=0;J.forEach(function(ot){var O,ct,Xt,jt,te,_t,Zt;if(!(!(!((O=ot==null?void 0:ot.nodes)===null||O===void 0)&&O.length)&&!(!((ct=ot==null?void 0:ot.left)===null||ct===void 0)&&ct.length)&&!(!((Xt=ot==null?void 0:ot.right)===null||Xt===void 0)&&Xt.length))){if(Re&&ot.nodes.length===1){var me=ot.nodes[0];if(!s.nodeMap[me])return;s.nodeMap[me].x=N[0],s.nodeMap[me].y=N[1],ue[ot.nodes[0]]=0,re=_(s.nodeMap[me]),Re=!1;return}re=Math.max(re,ot.totalWidth/(2*Math.PI));var Ce=-1/0;if(dt===0||!((jt=ot.nodes)===null||jt===void 0)&&jt.length)Ce=Ne(ot.nodes,re,Ce,[0,1]);else{var _e=((te=ot.left)===null||te===void 0?void 0:te.length)/(((_t=ot.left)===null||_t===void 0?void 0:_t.length)+((Zt=ot.right)===null||Zt===void 0?void 0:Zt.length));Ce=Ne(ot.left,re,Ce,[0,_e]),Ce=Ne(ot.right,re,Ce,[_e+.05,1])}re+=Ce,Re=!1,pn-ot.maxSize}}),b.edges().forEach(function(ot){var O,ct,Xt,jt=b.edge(ot),te=y.findIndex(function(He){var un=(0,Wr.getEdgeTerminal)(He,"source"),yn=(0,Wr.getEdgeTerminal)(He,"target");return un===ot.v&&yn===ot.w});if(!(te<=-1)&&s.edgeLabelSpace&&s.controlPoints&&y[te].type!=="loop"){var _t=Et==="x"?"y":"x",Zt=(O=jt==null?void 0:jt.points)===null||O===void 0?void 0:O.slice(1,jt.points.length-1),me=[],Ce=(ct=b.node(ot.v))===null||ct===void 0?void 0:ct[_t],_e=Ce-((Xt=b.node(ot.w))===null||Xt===void 0?void 0:Xt[_t]),Qn=ue[ot.v],dn=Qn-ue[ot.w];Zt==null||Zt.forEach(function(He){var un=(He[_t]-Ce)/_e*dn+Qn,yn=tt(He[Et],Ze,de,un);me.push({x:yn.x+N[0],y:yn.y+N[1]})}),y[te].controlPoints=me}})}else{var en=new Set,fn=l==="BT"||l==="RL",De=fn?function(ot,O){return O-ot}:function(ot,O){return ot-O};b.nodes().forEach(function(ot){var O=b.node(ot);if(O){var ct=e.nodeMap[ot];ct||(ct=h==null?void 0:h.find(function(Xt){return Xt.id===ot})),ct&&(ct.x=O.x+N[0],ct.y=O.y+N[1],ct._order=O._order,en.add(j?ct.x:ct.y))}});var Vn=Array.from(en).sort(De),Wt=j?function(ot,O){return ot.x!==O.x}:function(ot,O){return ot.y!==O.y},ee=j?function(ot,O,ct){var Xt=Math.max(O.y,ct.y),jt=Math.min(O.y,ct.y);return ot.filter(function(te){return te.y<=Xt&&te.y>=jt})}:function(ot,O,ct){var Xt=Math.max(O.x,ct.x),jt=Math.min(O.x,ct.x);return ot.filter(function(te){return te.x<=Xt&&te.x>=jt})};b.edges().forEach(function(ot){var O,ct=b.edge(ot),Xt=y.findIndex(function(_t){var Zt=(0,Wr.getEdgeTerminal)(_t,"source"),me=(0,Wr.getEdgeTerminal)(_t,"target");return Zt===ot.v&&me===ot.w});if(!(Xt<=-1)&&s.edgeLabelSpace&&s.controlPoints&&y[Xt].type!=="loop"){(O=ct==null?void 0:ct.points)===null||O===void 0||O.forEach(function(_t){_t.x+=N[0],_t.y+=N[1]});var jt=s.nodeMap[ot.v],te=s.nodeMap[ot.w];y[Xt].controlPoints=Q$(ct==null?void 0:ct.points,jt,te,Vn,j,Wt,ee)}})}return s.onLayoutEnd&&s.onLayoutEnd(),{nodes:u,edges:y}}},n.prototype.getRadialPos=function(e,r,i,o,a){a===void 0&&(a=[0,1]);var s=(e-r[0])/i;s=s*(a[1]-a[0])+a[0];var u=s*2*Math.PI;return{x:Math.cos(u)*o,y:Math.sin(u)*o}},n.prototype.getType=function(){return"dagre"},n}(Z$.Base);tc.DagreLayout=K$;var Q$=function(t,n,e,r,i,o,a){var s=(t==null?void 0:t.slice(1,t.length-1))||[];if(n&&e){var u=n.x,c=n.y,l=e.x,h=e.y;if(i&&(u=n.y,c=n.x,l=e.y,h=e.x),h!==c&&u!==l){var f=r.indexOf(c),d=r[f+1];if(d){var p=s[0],g=i?{x:(c+d)/2,y:(p==null?void 0:p.y)||l}:{x:(p==null?void 0:p.x)||l,y:(c+d)/2};(!p||o(p,g))&&s.unshift(g)}var v=r.indexOf(h),m=Math.abs(v-f);if(m===1)s=a(s,n,e),s.length||s.push(i?{x:(c+h)/2,y:u}:{x:u,y:(c+h)/2});else if(m>1){var y=r[v-1];if(y){var b=s[s.length-1],x=i?{x:(h+y)/2,y:(b==null?void 0:b.y)||l}:{x:(b==null?void 0:b.x)||u,y:(h+y)/2};(!b||o(b,x))&&s.push(x)}}}}return s},th={};const Ud={graph:{meta:{rankDir:"TB",nodeSep:50,rankSep:50,edgeSep:5,align:void 0}},subScene:{meta:{paddingTop:20,paddingBottom:20,paddingLeft:20,paddingRight:20,labelHeight:20}},nodeSize:{meta:{width:100,maxLabelWidth:0,height:20},node:{width:80,height:20,labelOffset:10,maxLabelWidth:40},bridge:{width:5,height:5,radius:2,labelOffset:0}}};function Cm(t={},n=Ud){var e,r,i,o;const a=JSON.parse(JSON.stringify(n)),s=((e=t==null?void 0:t.graph)===null||e===void 0?void 0:e.meta)||{},u=((r=t==null?void 0:t.subScene)===null||r===void 0?void 0:r.meta)||{},c=((i=t==null?void 0:t.nodeSize)===null||i===void 0?void 0:i.meta)||{},l=((o=t==null?void 0:t.nodeSize)===null||o===void 0?void 0:o.node)||{},h=a.nodeSize.bridge;return{graph:{meta:Object.assign(a.graph.meta,s)},subScene:{meta:Object.assign(a.subScene.meta,u)},nodeSize:{meta:Object.assign(a.nodeSize.meta,c),node:Object.assign(a.nodeSize.node,l),bridge:h}}}function VT(t){return`◬${t}◬`}const Vu=VT("ROOT"),WT=VT("BRIDGE_GRAPH");var Rr,Is,Wu,Im;(function(t){t[t.META=0]="META",t[t.NODE=1]="NODE",t[t.BRIDGE=2]="BRIDGE"})(Rr||(Rr={})),function(t){t[t.INCLUDE=0]="INCLUDE",t[t.EXCLUDE=1]="EXCLUDE",t[t.UNSPECIFIED=2]="UNSPECIFIED"}(Is||(Is={})),function(t){t[t.META=0]="META",t[t.CORE=1]="CORE",t[t.BRIDGE=2]="BRIDGE"}(Wu||(Wu={})),function(t){t[t.META=0]="META",t[t.OP=1]="OP",t[t.SERIES=2]="SERIES"}(Im||(Im={}));var Sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function L1(t,n){return t(n={exports:{}},n.exports),n.exports}var J$=function(){this.__data__=[],this.size=0},rc=function(t,n){return t===n||t!=t&&n!=n},Gp=function(t,n){for(var e=t.length;e--;)if(rc(t[e][0],n))return e;return-1},$$=Array.prototype.splice,ttt=function(t){var n=this.__data__,e=Gp(n,t);return!(e<0)&&(e==n.length-1?n.pop():$$.call(n,e,1),--this.size,!0)},ett=function(t){var n=this.__data__,e=Gp(n,t);return e<0?void 0:n[e][1]},ntt=function(t){return Gp(this.__data__,t)>-1},rtt=function(t,n){var e=this.__data__,r=Gp(e,t);return r<0?(++this.size,e.push([t,n])):e[r][1]=n,this};function gu(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}gu.prototype.clear=J$,gu.prototype.delete=ttt,gu.prototype.get=ett,gu.prototype.has=ntt,gu.prototype.set=rtt;var Up=gu,itt=function(){this.__data__=new Up,this.size=0},ott=function(t){var n=this.__data__,e=n.delete(t);return this.size=n.size,e},att=function(t){return this.__data__.get(t)},stt=function(t){return this.__data__.has(t)},XT=typeof Sf=="object"&&Sf&&Sf.Object===Object&&Sf,utt=typeof self=="object"&&self&&self.Object===Object&&self,Fi=XT||utt||Function("return this")(),mi=Fi.Symbol,HT=Object.prototype,ctt=HT.hasOwnProperty,ltt=HT.toString,Ac=mi?mi.toStringTag:void 0,htt=function(t){var n=ctt.call(t,Ac),e=t[Ac];try{t[Ac]=void 0;var r=!0}catch{}var i=ltt.call(t);return r&&(n?t[Ac]=e:delete t[Ac]),i},ftt=Object.prototype.toString,dtt=function(t){return ftt.call(t)},CM=mi?mi.toStringTag:void 0,Fa=function(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":CM&&CM in Object(t)?htt(t):dtt(t)},Gr=function(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")},IM,eh=function(t){if(!Gr(t))return!1;var n=Fa(t);return n=="[object Function]"||n=="[object GeneratorFunction]"||n=="[object AsyncFunction]"||n=="[object Proxy]"},tv=Fi["__core-js_shared__"],TM=(IM=/[^.]+$/.exec(tv&&tv.keys&&tv.keys.IE_PROTO||""))?"Symbol(src)_1."+IM:"",ptt=function(t){return!!TM&&TM in t},gtt=Function.prototype.toString,Ls=function(t){if(t!=null){try{return gtt.call(t)}catch{}try{return t+""}catch{}}return""},vtt=/^\[object .+?Constructor\]$/,mtt=Function.prototype,ytt=Object.prototype,btt=mtt.toString,xtt=ytt.hasOwnProperty,wtt=RegExp("^"+btt.call(xtt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ett=function(t){return!(!Gr(t)||ptt(t))&&(eh(t)?wtt:vtt).test(Ls(t))},Mtt=function(t,n){return t==null?void 0:t[n]},js=function(t,n){var e=Mtt(t,n);return Ett(e)?e:void 0},Tl=js(Fi,"Map"),Ol=js(Object,"create"),Stt=function(){this.__data__=Ol?Ol(null):{},this.size=0},_tt=function(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n},ktt=Object.prototype.hasOwnProperty,Att=function(t){var n=this.__data__;if(Ol){var e=n[t];return e==="__lodash_hash_undefined__"?void 0:e}return ktt.call(n,t)?n[t]:void 0},Ctt=Object.prototype.hasOwnProperty,Itt=function(t){var n=this.__data__;return Ol?n[t]!==void 0:Ctt.call(n,t)},Ttt=function(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=Ol&&n===void 0?"__lodash_hash_undefined__":n,this};function vu(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}vu.prototype.clear=Stt,vu.prototype.delete=_tt,vu.prototype.get=Att,vu.prototype.has=Itt,vu.prototype.set=Ttt;var OM=vu,Ott=function(){this.size=0,this.__data__={hash:new OM,map:new(Tl||Up),string:new OM}},Ntt=function(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null},Yp=function(t,n){var e=t.__data__;return Ntt(n)?e[typeof n=="string"?"string":"hash"]:e.map},Dtt=function(t){var n=Yp(this,t).delete(t);return this.size-=n?1:0,n},Ptt=function(t){return Yp(this,t).get(t)},Ltt=function(t){return Yp(this,t).has(t)},jtt=function(t,n){var e=Yp(this,t),r=e.size;return e.set(t,n),this.size+=e.size==r?0:1,this};function mu(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}mu.prototype.clear=Ott,mu.prototype.delete=Dtt,mu.prototype.get=Ptt,mu.prototype.has=Ltt,mu.prototype.set=jtt;var Vp=mu,Rtt=function(t,n){var e=this.__data__;if(e instanceof Up){var r=e.__data__;if(!Tl||r.length<199)return r.push([t,n]),this.size=++e.size,this;e=this.__data__=new Vp(r)}return e.set(t,n),this.size=e.size,this};function yu(t){var n=this.__data__=new Up(t);this.size=n.size}yu.prototype.clear=itt,yu.prototype.delete=ott,yu.prototype.get=att,yu.prototype.has=stt,yu.prototype.set=Rtt;var Iu=yu,j1=function(t,n){for(var e=-1,r=t==null?0:t.length;++e<r&&n(t[e],e,t)!==!1;);return t},Yd=function(){try{var t=js(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Wp=function(t,n,e){n=="__proto__"&&Yd?Yd(t,n,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[n]=e},Ftt=Object.prototype.hasOwnProperty,Xp=function(t,n,e){var r=t[n];Ftt.call(t,n)&&rc(r,e)&&(e!==void 0||n in t)||Wp(t,n,e)},nh=function(t,n,e,r){var i=!e;e||(e={});for(var o=-1,a=n.length;++o<a;){var s=n[o],u=r?r(e[s],t[s],s,e,t):void 0;u===void 0&&(u=t[s]),i?Wp(e,s,u):Xp(e,s,u)}return e},Btt=function(t,n){for(var e=-1,r=Array(t);++e<t;)r[e]=n(e);return r},Li=function(t){return t!=null&&typeof t=="object"},NM=function(t){return Li(t)&&Fa(t)=="[object Arguments]"},qT=Object.prototype,ztt=qT.hasOwnProperty,Gtt=qT.propertyIsEnumerable,Xu=NM(function(){return arguments}())?NM:function(t){return Li(t)&&ztt.call(t,"callee")&&!Gtt.call(t,"callee")},Un=Array.isArray,Utt=function(){return!1},Ts=L1(function(t,n){var e=n&&!n.nodeType&&n,r=e&&t&&!t.nodeType&&t,i=r&&r.exports===e?Fi.Buffer:void 0,o=(i?i.isBuffer:void 0)||Utt;t.exports=o}),Ytt=/^(?:0|[1-9]\d*)$/,Hp=function(t,n){var e=typeof t;return!!(n=n??9007199254740991)&&(e=="number"||e!="symbol"&&Ytt.test(t))&&t>-1&&t%1==0&&t<n},R1=function(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=9007199254740991},_n={};_n["[object Float32Array]"]=_n["[object Float64Array]"]=_n["[object Int8Array]"]=_n["[object Int16Array]"]=_n["[object Int32Array]"]=_n["[object Uint8Array]"]=_n["[object Uint8ClampedArray]"]=_n["[object Uint16Array]"]=_n["[object Uint32Array]"]=!0,_n["[object Arguments]"]=_n["[object Array]"]=_n["[object ArrayBuffer]"]=_n["[object Boolean]"]=_n["[object DataView]"]=_n["[object Date]"]=_n["[object Error]"]=_n["[object Function]"]=_n["[object Map]"]=_n["[object Number]"]=_n["[object Object]"]=_n["[object RegExp]"]=_n["[object Set]"]=_n["[object String]"]=_n["[object WeakMap]"]=!1;var Vtt=function(t){return Li(t)&&R1(t.length)&&!!_n[Fa(t)]},qp=function(t){return function(n){return t(n)}},Hu=L1(function(t,n){var e=n&&!n.nodeType&&n,r=e&&t&&!t.nodeType&&t,i=r&&r.exports===e&&XT.process,o=function(){try{var a=r&&r.require&&r.require("util").types;return a||i&&i.binding&&i.binding("util")}catch{}}();t.exports=o}),DM=Hu&&Hu.isTypedArray,rh=DM?qp(DM):Vtt,Wtt=Object.prototype.hasOwnProperty,ZT=function(t,n){var e=Un(t),r=!e&&Xu(t),i=!e&&!r&&Ts(t),o=!e&&!r&&!i&&rh(t),a=e||r||i||o,s=a?Btt(t.length,String):[],u=s.length;for(var c in t)!n&&!Wtt.call(t,c)||a&&(c=="length"||i&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Hp(c,u))||s.push(c);return s},Xtt=Object.prototype,Zp=function(t){var n=t&&t.constructor;return t===(typeof n=="function"&&n.prototype||Xtt)},KT=function(t,n){return function(e){return t(n(e))}},Htt=KT(Object.keys,Object),qtt=Object.prototype.hasOwnProperty,F1=function(t){if(!Zp(t))return Htt(t);var n=[];for(var e in Object(t))qtt.call(t,e)&&e!="constructor"&&n.push(e);return n},Jo=function(t){return t!=null&&R1(t.length)&&!eh(t)},Ba=function(t){return Jo(t)?ZT(t):F1(t)},Ztt=function(t,n){return t&&nh(n,Ba(n),t)},Ktt=function(t){var n=[];if(t!=null)for(var e in Object(t))n.push(e);return n},Qtt=Object.prototype.hasOwnProperty,Jtt=function(t){if(!Gr(t))return Ktt(t);var n=Zp(t),e=[];for(var r in t)(r!="constructor"||!n&&Qtt.call(t,r))&&e.push(r);return e},Rs=function(t){return Jo(t)?ZT(t,!0):Jtt(t)},$tt=function(t,n){return t&&nh(n,Rs(n),t)},QT=L1(function(t,n){var e=n&&!n.nodeType&&n,r=e&&t&&!t.nodeType&&t,i=r&&r.exports===e?Fi.Buffer:void 0,o=i?i.allocUnsafe:void 0;t.exports=function(a,s){if(s)return a.slice();var u=a.length,c=o?o(u):new a.constructor(u);return a.copy(c),c}}),JT=function(t,n){var e=-1,r=t.length;for(n||(n=Array(r));++e<r;)n[e]=t[e];return n},$T=function(t,n){for(var e=-1,r=t==null?0:t.length,i=0,o=[];++e<r;){var a=t[e];n(a,e,t)&&(o[i++]=a)}return o},tO=function(){return[]},tet=Object.prototype.propertyIsEnumerable,PM=Object.getOwnPropertySymbols,B1=PM?function(t){return t==null?[]:(t=Object(t),$T(PM(t),function(n){return tet.call(t,n)}))}:tO,eet=function(t,n){return nh(t,B1(t),n)},z1=function(t,n){for(var e=-1,r=n.length,i=t.length;++e<r;)t[i+e]=n[e];return t},Kp=KT(Object.getPrototypeOf,Object),eO=Object.getOwnPropertySymbols?function(t){for(var n=[];t;)z1(n,B1(t)),t=Kp(t);return n}:tO,net=function(t,n){return nh(t,eO(t),n)},nO=function(t,n,e){var r=n(t);return Un(t)?r:z1(r,e(t))},Tm=function(t){return nO(t,Ba,B1)},ret=function(t){return nO(t,Rs,eO)},Om=js(Fi,"DataView"),Nm=js(Fi,"Promise"),Tu=js(Fi,"Set"),Dm=js(Fi,"WeakMap"),iet=Ls(Om),oet=Ls(Tl),aet=Ls(Nm),set=Ls(Tu),uet=Ls(Dm),cs=Fa;(Om&&cs(new Om(new ArrayBuffer(1)))!="[object DataView]"||Tl&&cs(new Tl)!="[object Map]"||Nm&&cs(Nm.resolve())!="[object Promise]"||Tu&&cs(new Tu)!="[object Set]"||Dm&&cs(new Dm)!="[object WeakMap]")&&(cs=function(t){var n=Fa(t),e=n=="[object Object]"?t.constructor:void 0,r=e?Ls(e):"";if(r)switch(r){case iet:return"[object DataView]";case oet:return"[object Map]";case aet:return"[object Promise]";case set:return"[object Set]";case uet:return"[object WeakMap]"}return n});var Os=cs,cet=Object.prototype.hasOwnProperty,het=function(t){var n=t.length,e=new t.constructor(n);return n&&typeof t[0]=="string"&&cet.call(t,"index")&&(e.index=t.index,e.input=t.input),e},Vd=Fi.Uint8Array,G1=function(t){var n=new t.constructor(t.byteLength);return new Vd(n).set(new Vd(t)),n},fet=function(t,n){var e=n?G1(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)},det=/\w*$/,pet=function(t){var n=new t.constructor(t.source,det.exec(t));return n.lastIndex=t.lastIndex,n},LM=mi?mi.prototype:void 0,jM=LM?LM.valueOf:void 0,get=function(t){return jM?Object(jM.call(t)):{}},rO=function(t,n){var e=n?G1(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)},vet=function(t,n,e){var r=t.constructor;switch(n){case"[object ArrayBuffer]":return G1(t);case"[object Boolean]":case"[object Date]":return new r(+t);case"[object DataView]":return fet(t,e);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return rO(t,e);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(t);case"[object RegExp]":return pet(t);case"[object Set]":return new r;case"[object Symbol]":return get(t)}},RM=Object.create,iO=function(){function t(){}return function(n){if(!Gr(n))return{};if(RM)return RM(n);t.prototype=n;var e=new t;return t.prototype=void 0,e}}(),oO=function(t){return typeof t.constructor!="function"||Zp(t)?{}:iO(Kp(t))},met=function(t){return Li(t)&&Os(t)=="[object Map]"},FM=Hu&&Hu.isMap,yet=FM?qp(FM):met,bet=function(t){return Li(t)&&Os(t)=="[object Set]"},BM=Hu&&Hu.isSet,xet=BM?qp(BM):bet,En={};En["[object Arguments]"]=En["[object Array]"]=En["[object ArrayBuffer]"]=En["[object DataView]"]=En["[object Boolean]"]=En["[object Date]"]=En["[object Float32Array]"]=En["[object Float64Array]"]=En["[object Int8Array]"]=En["[object Int16Array]"]=En["[object Int32Array]"]=En["[object Map]"]=En["[object Number]"]=En["[object Object]"]=En["[object RegExp]"]=En["[object Set]"]=En["[object String]"]=En["[object Symbol]"]=En["[object Uint8Array]"]=En["[object Uint8ClampedArray]"]=En["[object Uint16Array]"]=En["[object Uint32Array]"]=!0,En["[object Error]"]=En["[object Function]"]=En["[object WeakMap]"]=!1;var aO=function t(n,e,r,i,o,a){var s,u=1&e,c=2&e,l=4&e;if(r&&(s=o?r(n,i,o,a):r(n)),s!==void 0)return s;if(!Gr(n))return n;var h=Un(n);if(h){if(s=het(n),!u)return JT(n,s)}else{var f=Os(n),d=f=="[object Function]"||f=="[object GeneratorFunction]";if(Ts(n))return QT(n,u);if(f=="[object Object]"||f=="[object Arguments]"||d&&!o){if(s=c||d?{}:oO(n),!u)return c?net(n,$tt(s,n)):eet(n,Ztt(s,n))}else{if(!En[f])return o?n:{};s=vet(n,f,u)}}a||(a=new Iu);var p=a.get(n);if(p)return p;a.set(n,s),xet(n)?n.forEach(function(v){s.add(t(v,e,r,v,n,a))}):yet(n)&&n.forEach(function(v,m){s.set(m,t(v,e,r,m,n,a))});var g=h?void 0:(l?c?ret:Tm:c?Rs:Ba)(n);return j1(g||n,function(v,m){g&&(v=n[m=v]),Xp(s,m,t(v,e,r,m,n,a))}),s},wet=function(t){return aO(t,4)},U1=function(t){return function(){return t}},Y1=function(t){return function(n,e,r){for(var i=-1,o=Object(n),a=r(n),s=a.length;s--;){var u=a[t?s:++i];if(e(o[u],u,o)===!1)break}return n}}(),V1=function(t,n){return t&&Y1(t,n,Ba)},Qp=function(t,n){return function(e,r){if(e==null)return e;if(!Jo(e))return t(e,r);for(var i=e.length,o=n?i:-1,a=Object(e);(n?o--:++o<i)&&r(a[o],o,a)!==!1;);return e}}(V1),Fs=function(t){return t},sO=function(t){return typeof t=="function"?t:Fs},uO=function(t,n){return(Un(t)?j1:Qp)(t,sO(n))},cO=uO,Eet=function(t,n){var e=[];return Qp(t,function(r,i,o){n(r,i,o)&&e.push(r)}),e},Met=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},_et=function(t){return this.__data__.has(t)};function id(t){var n=-1,e=t==null?0:t.length;for(this.__data__=new Vp;++n<e;)this.add(t[n])}id.prototype.add=id.prototype.push=Met,id.prototype.has=_et;var lO=id,ket=function(t,n){for(var e=-1,r=t==null?0:t.length;++e<r;)if(n(t[e],e,t))return!0;return!1},hO=function(t,n){return t.has(n)},fO=function(t,n,e,r,i,o){var a=1&e,s=t.length,u=n.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(t),l=o.get(n);if(c&&l)return c==n&&l==t;var h=-1,f=!0,d=2&e?new lO:void 0;for(o.set(t,n),o.set(n,t);++h<s;){var p=t[h],g=n[h];if(r)var v=a?r(g,p,h,n,t,o):r(p,g,h,t,n,o);if(v!==void 0){if(v)continue;f=!1;break}if(d){if(!ket(n,function(m,y){if(!hO(d,y)&&(p===m||i(p,m,e,r,o)))return d.push(y)})){f=!1;break}}else if(p!==g&&!i(p,g,e,r,o)){f=!1;break}}return o.delete(t),o.delete(n),f},Aet=function(t){var n=-1,e=Array(t.size);return t.forEach(function(r,i){e[++n]=[i,r]}),e},W1=function(t){var n=-1,e=Array(t.size);return t.forEach(function(r){e[++n]=r}),e},zM=mi?mi.prototype:void 0,ev=zM?zM.valueOf:void 0,Cet=function(t,n,e,r,i,o,a){switch(e){case"[object DataView]":if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=n.byteLength||!o(new Vd(t),new Vd(n)));case"[object Boolean]":case"[object Date]":case"[object Number]":return rc(+t,+n);case"[object Error]":return t.name==n.name&&t.message==n.message;case"[object RegExp]":case"[object String]":return t==n+"";case"[object Map]":var s=Aet;case"[object Set]":var u=1&r;if(s||(s=W1),t.size!=n.size&&!u)return!1;var c=a.get(t);if(c)return c==n;r|=2,a.set(t,n);var l=fO(s(t),s(n),r,i,o,a);return a.delete(t),l;case"[object Symbol]":if(ev)return ev.call(t)==ev.call(n)}return!1},Iet=Object.prototype.hasOwnProperty,Tet=function(t,n,e,r,i,o){var a=1&e,s=Tm(t),u=s.length;if(u!=Tm(n).length&&!a)return!1;for(var c=u;c--;){var l=s[c];if(!(a?l in n:Iet.call(n,l)))return!1}var h=o.get(t),f=o.get(n);if(h&&f)return h==n&&f==t;var d=!0;o.set(t,n),o.set(n,t);for(var p=a;++c<u;){var g=t[l=s[c]],v=n[l];if(r)var m=a?r(v,g,l,n,t,o):r(g,v,l,t,n,o);if(!(m===void 0?g===v||i(g,v,e,r,o):m)){d=!1;break}p||(p=l=="constructor")}if(d&&!p){var y=t.constructor,b=n.constructor;y==b||!("constructor"in t)||!("constructor"in n)||typeof y=="function"&&y instanceof y&&typeof b=="function"&&b instanceof b||(d=!1)}return o.delete(t),o.delete(n),d},GM=Object.prototype.hasOwnProperty,Oet=function(t,n,e,r,i,o){var a=Un(t),s=Un(n),u=a?"[object Array]":Os(t),c=s?"[object Array]":Os(n),l=(u=u=="[object Arguments]"?"[object Object]":u)=="[object Object]",h=(c=c=="[object Arguments]"?"[object Object]":c)=="[object Object]",f=u==c;if(f&&Ts(t)){if(!Ts(n))return!1;a=!0,l=!1}if(f&&!l)return o||(o=new Iu),a||rh(t)?fO(t,n,e,r,i,o):Cet(t,n,u,e,r,i,o);if(!(1&e)){var d=l&&GM.call(t,"__wrapped__"),p=h&&GM.call(n,"__wrapped__");if(d||p){var g=d?t.value():t,v=p?n.value():n;return o||(o=new Iu),i(g,v,e,r,o)}}return!!f&&(o||(o=new Iu),Tet(t,n,e,r,i,o))},dO=function t(n,e,r,i,o){return n===e||(n==null||e==null||!Li(n)&&!Li(e)?n!=n&&e!=e:Oet(n,e,r,i,t,o))},Net=function(t,n,e,r){var i=e.length,o=i,a=!r;if(t==null)return!o;for(t=Object(t);i--;){var s=e[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<o;){var u=(s=e[i])[0],c=t[u],l=s[1];if(a&&s[2]){if(c===void 0&&!(u in t))return!1}else{var h=new Iu;if(r)var f=r(c,l,u,t,n,h);if(!(f===void 0?dO(l,c,3,r,h):f))return!1}}return!0},pO=function(t){return t==t&&!Gr(t)},Det=function(t){for(var n=Ba(t),e=n.length;e--;){var r=n[e],i=t[r];n[e]=[r,i,pO(i)]}return n},gO=function(t,n){return function(e){return e!=null&&e[t]===n&&(n!==void 0||t in Object(e))}},Pet=function(t){var n=Det(t);return n.length==1&&n[0][2]?gO(n[0][0],n[0][1]):function(e){return e===t||Net(e,t,n)}},Ns=function(t){return typeof t=="symbol"||Li(t)&&Fa(t)=="[object Symbol]"},Let=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jet=/^\w*$/,X1=function(t,n){if(Un(t))return!1;var e=typeof t;return!(e!="number"&&e!="symbol"&&e!="boolean"&&t!=null&&!Ns(t))||jet.test(t)||!Let.test(t)||n!=null&&t in Object(n)};function H1(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new TypeError("Expected a function");var e=function(){var r=arguments,i=n?n.apply(this,r):r[0],o=e.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return e.cache=o.set(i,a)||o,a};return e.cache=new(H1.Cache||Vp),e}H1.Cache=Vp;var Ret=H1,Fet=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bet=/\\(\\)?/g,zet=function(t){var n=Ret(t,function(r){return e.size===500&&e.clear(),r}),e=n.cache;return n}(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(Fet,function(e,r,i,o){n.push(i?o.replace(Bet,"$1"):r||e)}),n}),Ou=function(t,n){for(var e=-1,r=t==null?0:t.length,i=Array(r);++e<r;)i[e]=n(t[e],e,t);return i},UM=mi?mi.prototype:void 0,YM=UM?UM.toString:void 0,Get=function t(n){if(typeof n=="string")return n;if(Un(n))return Ou(n,t)+"";if(Ns(n))return YM?YM.call(n):"";var e=n+"";return e=="0"&&1/n==-1/0?"-0":e},vO=function(t){return t==null?"":Get(t)},Jp=function(t,n){return Un(t)?t:X1(t,n)?[t]:zet(vO(t))},ih=function(t){if(typeof t=="string"||Ns(t))return t;var n=t+"";return n=="0"&&1/t==-1/0?"-0":n},$p=function(t,n){for(var e=0,r=(n=Jp(n,t)).length;t!=null&&e<r;)t=t[ih(n[e++])];return e&&e==r?t:void 0},Uet=function(t,n,e){var r=t==null?void 0:$p(t,n);return r===void 0?e:r},Yet=function(t,n){return t!=null&&n in Object(t)},mO=function(t,n,e){for(var r=-1,i=(n=Jp(n,t)).length,o=!1;++r<i;){var a=ih(n[r]);if(!(o=t!=null&&e(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=t==null?0:t.length)&&R1(i)&&Hp(a,i)&&(Un(t)||Xu(t))},yO=function(t,n){return t!=null&&mO(t,n,Yet)},Vet=function(t,n){return X1(t)&&pO(n)?gO(ih(t),n):function(e){var r=Uet(e,t);return r===void 0&&r===n?yO(e,t):dO(n,r,3)}},bO=function(t){return function(n){return n==null?void 0:n[t]}},Wet=function(t){return function(n){return $p(n,t)}},Xet=function(t){return X1(t)?bO(ih(t)):Wet(t)},$o=function(t){return typeof t=="function"?t:t==null?Fs:typeof t=="object"?Un(t)?Vet(t[0],t[1]):Pet(t):Xet(t)},xO=function(t,n){return(Un(t)?$T:Eet)(t,$o(n))},Het=Object.prototype.hasOwnProperty,qet=function(t,n){return t!=null&&Het.call(t,n)},wO=function(t,n){return t!=null&&mO(t,n,qet)},Zet=Object.prototype.hasOwnProperty,Ket=function(t){if(t==null)return!0;if(Jo(t)&&(Un(t)||typeof t=="string"||typeof t.splice=="function"||Ts(t)||rh(t)||Xu(t)))return!t.length;var n=Os(t);if(n=="[object Map]"||n=="[object Set]")return!t.size;if(Zp(t))return!F1(t).length;for(var e in t)if(Zet.call(t,e))return!1;return!0},EO=function(t){return t===void 0},MO=function(t,n){var e=-1,r=Jo(t)?Array(t.length):[];return Qp(t,function(i,o,a){r[++e]=n(i,o,a)}),r},SO=function(t,n){return(Un(t)?Ou:MO)(t,$o(n))},Qet=function(t,n,e,r){var i=-1,o=t==null?0:t.length;for(r&&o&&(e=t[++i]);++i<o;)e=n(e,t[i],i,t);return e},Jet=function(t,n,e,r,i){return i(t,function(o,a,s){e=r?(r=!1,o):n(e,o,a,s)}),e},_O=function(t,n,e){var r=Un(t)?Qet:Jet,i=arguments.length<3;return r(t,$o(n),e,i,Qp)},$et=function(t){return typeof t=="string"||!Un(t)&&Li(t)&&Fa(t)=="[object String]"},tnt=bO("length"),ent=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),nnt=function(t){return ent.test(t)},rnt="[\\ud800-\\udfff]",Pm="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Lm="\\ud83c[\\udffb-\\udfff]",kO="[^\\ud800-\\udfff]",AO="(?:\\ud83c[\\udde6-\\uddff]){2}",CO="[\\ud800-\\udbff][\\udc00-\\udfff]",VM="(?:"+Pm+"|"+Lm+")?",int="[\\ufe0e\\ufe0f]?"+VM+("(?:\\u200d(?:"+[kO,AO,CO].join("|")+")[\\ufe0e\\ufe0f]?"+VM+")*"),ont="(?:"+[kO+Pm+"?",Pm,AO,CO,rnt].join("|")+")",WM=RegExp(Lm+"(?="+Lm+")|"+ont+int,"g"),ant=function(t){for(var n=WM.lastIndex=0;WM.test(t);)++n;return n},snt=function(t){return nnt(t)?ant(t):tnt(t)},unt=function(t){if(t==null)return 0;if(Jo(t))return $et(t)?snt(t):t.length;var n=Os(t);return n=="[object Map]"||n=="[object Set]"?t.size:F1(t).length},cnt=function(t,n,e){var r=Un(t),i=r||Ts(t)||rh(t);if(n=$o(n),e==null){var o=t&&t.constructor;e=i?r?new o:[]:Gr(t)&&eh(o)?iO(Kp(t)):{}}return(i?j1:V1)(t,function(a,s,u){return n(e,a,s,u)}),e},XM=mi?mi.isConcatSpreadable:void 0,lnt=function(t){return Un(t)||Xu(t)||!!(XM&&t&&t[XM])},q1=function t(n,e,r,i,o){var a=-1,s=n.length;for(r||(r=lnt),o||(o=[]);++a<s;){var u=n[a];e>0&&r(u)?e>1?t(u,e-1,r,i,o):z1(o,u):i||(o[o.length]=u)}return o},hnt=function(t,n,e){switch(e.length){case 0:return t.call(n);case 1:return t.call(n,e[0]);case 2:return t.call(n,e[0],e[1]);case 3:return t.call(n,e[0],e[1],e[2])}return t.apply(n,e)},HM=Math.max,IO=function(t,n,e){return n=HM(n===void 0?t.length-1:n,0),function(){for(var r=arguments,i=-1,o=HM(r.length-n,0),a=Array(o);++i<o;)a[i]=r[n+i];i=-1;for(var s=Array(n+1);++i<n;)s[i]=r[i];return s[n]=e(a),hnt(t,this,s)}},fnt=Yd?function(t,n){return Yd(t,"toString",{configurable:!0,enumerable:!1,value:U1(n),writable:!0})}:Fs,dnt=Date.now,TO=function(t){var n=0,e=0;return function(){var r=dnt(),i=16-(r-e);if(e=r,i>0){if(++n>=800)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}(fnt),tg=function(t,n){return TO(IO(t,n,Fs),t+"")},OO=function(t,n,e,r){for(var i=t.length,o=e+(r?1:-1);r?o--:++o<i;)if(n(t[o],o,t))return o;return-1},pnt=function(t){return t!=t},gnt=function(t,n,e){for(var r=e-1,i=t.length;++r<i;)if(t[r]===n)return r;return-1},vnt=function(t,n,e){return n==n?gnt(t,n,e):OO(t,pnt,e)},mnt=function(t,n){return!!(t!=null&&t.length)&&vnt(t,n,0)>-1},ynt=function(t,n,e){for(var r=-1,i=t==null?0:t.length;++r<i;)if(e(n,t[r]))return!0;return!1},bnt=function(){},xnt=Tu&&1/W1(new Tu([,-0]))[1]==1/0?function(t){return new Tu(t)}:bnt,wnt=function(t,n,e){var r=-1,i=mnt,o=t.length,a=!0,s=[],u=s;if(e)a=!1,i=ynt;else if(o>=200){var c=n?null:xnt(t);if(c)return W1(c);a=!1,i=hO,u=new lO}else u=n?[]:s;t:for(;++r<o;){var l=t[r],h=n?n(l):l;if(l=e||l!==0?l:0,a&&h==h){for(var f=u.length;f--;)if(u[f]===h)continue t;n&&u.push(h),s.push(l)}else i(u,h,e)||(u!==s&&u.push(h),s.push(l))}return s},NO=function(t){return Li(t)&&Jo(t)},Ent=tg(function(t){return wnt(q1(t,1,NO,!0))}),Mnt=function(t,n){return Ou(n,function(e){return t[e]})},Wd,DO=function(t){return t==null?[]:Mnt(t,Ba(t))};try{Wd={clone:wet,constant:U1,each:cO,filter:xO,has:wO,isArray:Un,isEmpty:Ket,isFunction:eh,isUndefined:EO,keys:Ba,map:SO,reduce:_O,size:unt,transform:cnt,union:Ent,values:DO}}catch{}Wd||(Wd=window._);var ae=Wd,Z1=sn;function sn(t){this._isDirected=!ae.has(t,"directed")||t.directed,this._isMultigraph=!!ae.has(t,"multigraph")&&t.multigraph,this._isCompound=!!ae.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=ae.constant(void 0),this._defaultEdgeLabelFn=ae.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function qM(t,n){t[n]?t[n]++:t[n]=1}function ZM(t,n){--t[n]||delete t[n]}function Zc(t,n,e,r){var i=""+n,o=""+e;if(!t&&i>o){var a=i;i=o,o=a}return i+""+o+""+(ae.isUndefined(r)?"\0":r)}function Snt(t,n,e,r){var i=""+n,o=""+e;if(!t&&i>o){var a=i;i=o,o=a}var s={v:i,w:o};return r&&(s.name=r),s}function nv(t,n){return Zc(t,n.v,n.w,n.name)}sn.prototype._nodeCount=0,sn.prototype._edgeCount=0,sn.prototype.isDirected=function(){return this._isDirected},sn.prototype.isMultigraph=function(){return this._isMultigraph},sn.prototype.isCompound=function(){return this._isCompound},sn.prototype.setGraph=function(t){return this._label=t,this},sn.prototype.graph=function(){return this._label},sn.prototype.setDefaultNodeLabel=function(t){return ae.isFunction(t)||(t=ae.constant(t)),this._defaultNodeLabelFn=t,this},sn.prototype.nodeCount=function(){return this._nodeCount},sn.prototype.nodes=function(){return ae.keys(this._nodes)},sn.prototype.sources=function(){var t=this;return ae.filter(this.nodes(),function(n){return ae.isEmpty(t._in[n])})},sn.prototype.sinks=function(){var t=this;return ae.filter(this.nodes(),function(n){return ae.isEmpty(t._out[n])})},sn.prototype.setNodes=function(t,n){var e=arguments,r=this;return ae.each(t,function(i){e.length>1?r.setNode(i,n):r.setNode(i)}),this},sn.prototype.setNode=function(t,n){return ae.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=n),this):(this._nodes[t]=arguments.length>1?n:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]="\0",this._children[t]={},this._children["\0"][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},sn.prototype.node=function(t){return this._nodes[t]},sn.prototype.hasNode=function(t){return ae.has(this._nodes,t)},sn.prototype.removeNode=function(t){var n=this;if(ae.has(this._nodes,t)){var e=function(r){n.removeEdge(n._edgeObjs[r])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],ae.each(this.children(t),function(r){n.setParent(r)}),delete this._children[t]),ae.each(ae.keys(this._in[t]),e),delete this._in[t],delete this._preds[t],ae.each(ae.keys(this._out[t]),e),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},sn.prototype.setParent=function(t,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(ae.isUndefined(n))n="\0";else{for(var e=n+="";!ae.isUndefined(e);e=this.parent(e))if(e===t)throw new Error("Setting "+n+" as parent of "+t+" would create a cycle");this.setNode(n)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=n,this._children[n][t]=!0,this},sn.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},sn.prototype.parent=function(t){if(this._isCompound){var n=this._parent[t];if(n!=="\0")return n}},sn.prototype.children=function(t){if(ae.isUndefined(t)&&(t="\0"),this._isCompound){var n=this._children[t];if(n)return ae.keys(n)}else{if(t==="\0")return this.nodes();if(this.hasNode(t))return[]}},sn.prototype.predecessors=function(t){var n=this._preds[t];if(n)return ae.keys(n)},sn.prototype.successors=function(t){var n=this._sucs[t];if(n)return ae.keys(n)},sn.prototype.neighbors=function(t){var n=this.predecessors(t);if(n)return ae.union(n,this.successors(t))},sn.prototype.isLeaf=function(t){return(this.isDirected()?this.successors(t):this.neighbors(t)).length===0},sn.prototype.filterNodes=function(t){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var e=this;ae.each(this._nodes,function(o,a){t(a)&&n.setNode(a,o)}),ae.each(this._edgeObjs,function(o){n.hasNode(o.v)&&n.hasNode(o.w)&&n.setEdge(o,e.edge(o))});var r={};function i(o){var a=e.parent(o);return a===void 0||n.hasNode(a)?(r[o]=a,a):a in r?r[a]:i(a)}return this._isCompound&&ae.each(n.nodes(),function(o){n.setParent(o,i(o))}),n},sn.prototype.setDefaultEdgeLabel=function(t){return ae.isFunction(t)||(t=ae.constant(t)),this._defaultEdgeLabelFn=t,this},sn.prototype.edgeCount=function(){return this._edgeCount},sn.prototype.edges=function(){return ae.values(this._edgeObjs)},sn.prototype.setPath=function(t,n){var e=this,r=arguments;return ae.reduce(t,function(i,o){return r.length>1?e.setEdge(i,o,n):e.setEdge(i,o),o}),this},sn.prototype.setEdge=function(){var t,n,e,r,i=!1,o=arguments[0];typeof o=="object"&&o!==null&&"v"in o?(t=o.v,n=o.w,e=o.name,arguments.length===2&&(r=arguments[1],i=!0)):(t=o,n=arguments[1],e=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),t=""+t,n=""+n,ae.isUndefined(e)||(e=""+e);var a=Zc(this._isDirected,t,n,e);if(ae.has(this._edgeLabels,a))return i&&(this._edgeLabels[a]=r),this;if(!ae.isUndefined(e)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(n),this._edgeLabels[a]=i?r:this._defaultEdgeLabelFn(t,n,e);var s=Snt(this._isDirected,t,n,e);return t=s.v,n=s.w,Object.freeze(s),this._edgeObjs[a]=s,qM(this._preds[n],t),qM(this._sucs[t],n),this._in[n][a]=s,this._out[t][a]=s,this._edgeCount++,this},sn.prototype.edge=function(t,n,e){var r=arguments.length===1?nv(this._isDirected,arguments[0]):Zc(this._isDirected,t,n,e);return this._edgeLabels[r]},sn.prototype.hasEdge=function(t,n,e){var r=arguments.length===1?nv(this._isDirected,arguments[0]):Zc(this._isDirected,t,n,e);return ae.has(this._edgeLabels,r)},sn.prototype.removeEdge=function(t,n,e){var r=arguments.length===1?nv(this._isDirected,arguments[0]):Zc(this._isDirected,t,n,e),i=this._edgeObjs[r];return i&&(t=i.v,n=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],ZM(this._preds[n],t),ZM(this._sucs[t],n),delete this._in[n][r],delete this._out[t][r],this._edgeCount--),this},sn.prototype.inEdges=function(t,n){var e=this._in[t];if(e){var r=ae.values(e);return n?ae.filter(r,function(i){return i.v===n}):r}},sn.prototype.outEdges=function(t,n){var e=this._out[t];if(e){var r=ae.values(e);return n?ae.filter(r,function(i){return i.w===n}):r}},sn.prototype.nodeEdges=function(t,n){var e=this.inEdges(t,n);if(e)return e.concat(this.outEdges(t,n))};var KM={Graph:Z1,version:"2.1.8"},_nt={write:function(t){var n={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:knt(t),edges:Ant(t)};return ae.isUndefined(t.graph())||(n.value=ae.clone(t.graph())),n},read:function(t){var n=new Z1(t.options).setGraph(t.value);return ae.each(t.nodes,function(e){n.setNode(e.v,e.value),e.parent&&n.setParent(e.v,e.parent)}),ae.each(t.edges,function(e){n.setEdge({v:e.v,w:e.w,name:e.name},e.value)}),n}};function knt(t){return ae.map(t.nodes(),function(n){var e=t.node(n),r=t.parent(n),i={v:n};return ae.isUndefined(e)||(i.value=e),ae.isUndefined(r)||(i.parent=r),i})}function Ant(t){return ae.map(t.edges(),function(n){var e=t.edge(n),r={v:n.v,w:n.w};return ae.isUndefined(n.name)||(r.name=n.name),ae.isUndefined(e)||(r.value=e),r})}var Cnt=function(t){var n,e={},r=[];function i(o){ae.has(e,o)||(e[o]=!0,n.push(o),ae.each(t.successors(o),i),ae.each(t.predecessors(o),i))}return ae.each(t.nodes(),function(o){n=[],i(o),n.length&&r.push(n)}),r},PO=ui;function ui(){this._arr=[],this._keyIndices={}}ui.prototype.size=function(){return this._arr.length},ui.prototype.keys=function(){return this._arr.map(function(t){return t.key})},ui.prototype.has=function(t){return ae.has(this._keyIndices,t)},ui.prototype.priority=function(t){var n=this._keyIndices[t];if(n!==void 0)return this._arr[n].priority},ui.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},ui.prototype.add=function(t,n){var e=this._keyIndices;if(t=String(t),!ae.has(e,t)){var r=this._arr,i=r.length;return e[t]=i,r.push({key:t,priority:n}),this._decrease(i),!0}return!1},ui.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},ui.prototype.decrease=function(t,n){var e=this._keyIndices[t];if(n>this._arr[e].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[e].priority+" New: "+n);this._arr[e].priority=n,this._decrease(e)},ui.prototype._heapify=function(t){var n=this._arr,e=2*t,r=e+1,i=t;e<n.length&&(i=n[e].priority<n[i].priority?e:i,r<n.length&&(i=n[r].priority<n[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},ui.prototype._decrease=function(t){for(var n,e=this._arr,r=e[t].priority;t!==0&&!(e[n=t>>1].priority<r);)this._swap(t,n),t=n},ui.prototype._swap=function(t,n){var e=this._arr,r=this._keyIndices,i=e[t],o=e[n];e[t]=o,e[n]=i,r[o.key]=t,r[i.key]=n};var LO=function(t,n,e,r){return function(i,o,a,s){var u,c,l={},h=new PO,f=function(d){var p=d.v!==u?d.v:d.w,g=l[p],v=a(d),m=c.distance+v;if(v<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+d+" Weight: "+v);m<g.distance&&(g.distance=m,g.predecessor=u,h.decrease(p,m))};for(i.nodes().forEach(function(d){var p=d===o?0:Number.POSITIVE_INFINITY;l[d]={distance:p},h.add(d,p)});h.size()>0&&(u=h.removeMin(),(c=l[u]).distance!==Number.POSITIVE_INFINITY);)s(u).forEach(f);return l}(t,String(n),e||Int,r||function(i){return t.outEdges(i)})},Int=ae.constant(1),Tnt=function(t,n,e){return ae.transform(t.nodes(),function(r,i){r[i]=LO(t,i,n,e)},{})},jO=function(t){var n=0,e=[],r={},i=[];function o(a){var s=r[a]={onStack:!0,lowlink:n,index:n++};if(e.push(a),t.successors(a).forEach(function(l){ae.has(r,l)?r[l].onStack&&(s.lowlink=Math.min(s.lowlink,r[l].index)):(o(l),s.lowlink=Math.min(s.lowlink,r[l].lowlink))}),s.lowlink===s.index){var u,c=[];do u=e.pop(),r[u].onStack=!1,c.push(u);while(a!==u);i.push(c)}}return t.nodes().forEach(function(a){ae.has(r,a)||o(a)}),i},Ont=function(t){return ae.filter(jO(t),function(n){return n.length>1||n.length===1&&t.hasEdge(n[0],n[0])})},Nnt=function(t,n,e){return function(r,i,o){var a={},s=r.nodes();return s.forEach(function(u){a[u]={},a[u][u]={distance:0},s.forEach(function(c){u!==c&&(a[u][c]={distance:Number.POSITIVE_INFINITY})}),o(u).forEach(function(c){var l=c.v===u?c.w:c.v,h=i(c);a[u][l]={distance:h,predecessor:u}})}),s.forEach(function(u){var c=a[u];s.forEach(function(l){var h=a[l];s.forEach(function(f){var d=h[u],p=c[f],g=h[f],v=d.distance+p.distance;v<g.distance&&(g.distance=v,g.predecessor=p.predecessor)})})}),a}(t,n||Dnt,e||function(r){return t.outEdges(r)})},Dnt=ae.constant(1),rv=RO;function RO(t){var n={},e={},r=[];if(ae.each(t.sinks(),function i(o){if(ae.has(e,o))throw new Xd;ae.has(n,o)||(e[o]=!0,n[o]=!0,ae.each(t.predecessors(o),i),delete e[o],r.push(o))}),ae.size(n)!==t.nodeCount())throw new Xd;return r}function Xd(){}RO.CycleException=Xd,Xd.prototype=new Error;var QM=function(t,n,e){ae.isArray(n)||(n=[n]);var r=(t.isDirected()?t.successors:t.neighbors).bind(t),i=[],o={};return ae.each(n,function(a){if(!t.hasNode(a))throw new Error("Graph does not have node: "+a);FO(t,a,e==="post",o,r,i)}),i};function FO(t,n,e,r,i,o){ae.has(r,n)||(r[n]=!0,e||o.push(n),ae.each(i(n),function(a){FO(t,a,e,r,i,o)}),e&&o.push(n))}var Hd,Pnt={Graph:KM.Graph,json:_nt,alg:{components:Cnt,dijkstra:LO,dijkstraAll:Tnt,findCycles:Ont,floydWarshall:Nnt,isAcyclic:function(t){try{rv(t)}catch(n){if(n instanceof rv.CycleException)return!1;throw n}return!0},postorder:function(t,n){return QM(t,n,"post")},preorder:function(t,n){return QM(t,n,"pre")},prim:function(t,n){var e,r=new Z1,i={},o=new PO;function a(u){var c=u.v===e?u.w:u.v,l=o.priority(c);if(l!==void 0){var h=n(u);h<l&&(i[c]=e,o.decrease(c,h))}}if(t.nodeCount()===0)return r;ae.each(t.nodes(),function(u){o.add(u,Number.POSITIVE_INFINITY),r.setNode(u)}),o.decrease(t.nodes()[0],0);for(var s=!1;o.size()>0;){if(e=o.removeMin(),ae.has(i,e))r.setEdge(e,i[e]);else{if(s)throw new Error("Input graph is not connected: "+t);s=!0}t.nodeEdges(e).forEach(a)}return r},tarjan:jO,topsort:rv},version:KM.version};try{Hd=Pnt}catch{}Hd||(Hd=window.graphlib);var Bi=Hd,Lnt=function(t){return aO(t,5)},Nl=function(t,n,e){if(!Gr(e))return!1;var r=typeof n;return!!(r=="number"?Jo(e)&&Hp(n,e.length):r=="string"&&n in e)&&rc(e[n],t)},BO=Object.prototype,jnt=BO.hasOwnProperty,Rnt=tg(function(t,n){t=Object(t);var e=-1,r=n.length,i=r>2?n[2]:void 0;for(i&&Nl(n[0],n[1],i)&&(r=1);++e<r;)for(var o=n[e],a=Rs(o),s=-1,u=a.length;++s<u;){var c=a[s],l=t[c];(l===void 0||rc(l,BO[c])&&!jnt.call(t,c))&&(t[c]=o[c])}return t}),Fnt=function(t){return function(n,e,r){var i=Object(n);if(!Jo(n)){var o=$o(e);n=Ba(n),e=function(s){return o(i[s],s,i)}}var a=t(n,e,r);return a>-1?i[o?n[a]:a]:void 0}},Bnt=/^\s+|\s+$/g,znt=/^[-+]0x[0-9a-f]+$/i,Gnt=/^0b[01]+$/i,Unt=/^0o[0-7]+$/i,Ynt=parseInt,Vnt=function(t){if(typeof t=="number")return t;if(Ns(t))return NaN;if(Gr(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=Gr(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=t.replace(Bnt,"");var e=Gnt.test(t);return e||Unt.test(t)?Ynt(t.slice(2),e?2:8):znt.test(t)?NaN:+t},od=function(t){return t?(t=Vnt(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:t===0?t:0},Wnt=function(t){var n=od(t),e=n%1;return n==n?e?n-e:n:0},Xnt=Math.max,Hnt=Fnt(function(t,n,e){var r=t==null?0:t.length;if(!r)return-1;var i=e==null?0:Wnt(e);return i<0&&(i=Xnt(r+i,0)),OO(t,$o(n),i)}),zO=function(t){return t!=null&&t.length?q1(t,1):[]},qnt=function(t,n){return t==null?t:Y1(t,sO(n),Rs)},Znt=function(t){var n=t==null?0:t.length;return n?t[n-1]:void 0},Knt=function(t,n){var e={};return n=$o(n),V1(t,function(r,i,o){Wp(e,i,n(r,i,o))}),e},K1=function(t,n,e){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=n(o);if(a!=null&&(s===void 0?a==a&&!Ns(a):e(a,s)))var s=a,u=o}return u},Qnt=function(t,n){return t>n},Jnt=function(t){return t&&t.length?K1(t,Fs,Qnt):void 0},jm=function(t,n,e){(e!==void 0&&!rc(t[n],e)||e===void 0&&!(n in t))&&Wp(t,n,e)},$nt=Function.prototype,trt=Object.prototype,GO=$nt.toString,ert=trt.hasOwnProperty,nrt=GO.call(Object),rrt=function(t){if(!Li(t)||Fa(t)!="[object Object]")return!1;var n=Kp(t);if(n===null)return!0;var e=ert.call(n,"constructor")&&n.constructor;return typeof e=="function"&&e instanceof e&&GO.call(e)==nrt},Rm=function(t,n){if((n!=="constructor"||typeof t[n]!="function")&&n!="__proto__")return t[n]},irt=function(t){return nh(t,Rs(t))},ort=function(t,n,e,r,i,o,a){var s=Rm(t,e),u=Rm(n,e),c=a.get(u);if(c)jm(t,e,c);else{var l=o?o(s,u,e+"",t,n,a):void 0,h=l===void 0;if(h){var f=Un(u),d=!f&&Ts(u),p=!f&&!d&&rh(u);l=u,f||d||p?Un(s)?l=s:NO(s)?l=JT(s):d?(h=!1,l=QT(u,!0)):p?(h=!1,l=rO(u,!0)):l=[]:rrt(u)||Xu(u)?(l=s,Xu(s)?l=irt(s):Gr(s)&&!eh(s)||(l=oO(u))):h=!1}h&&(a.set(u,l),i(l,u,r,o,a),a.delete(u)),jm(t,e,l)}},art=function t(n,e,r,i,o){n!==e&&Y1(e,function(a,s){if(o||(o=new Iu),Gr(a))ort(n,e,s,r,t,i,o);else{var u=i?i(Rm(n,s),a,s+"",n,e,o):void 0;u===void 0&&(u=a),jm(n,s,u)}},Rs)},srt=function(t){return tg(function(n,e){var r=-1,i=e.length,o=i>1?e[i-1]:void 0,a=i>2?e[2]:void 0;for(o=t.length>3&&typeof o=="function"?(i--,o):void 0,a&&Nl(e[0],e[1],a)&&(o=i<3?void 0:o,i=1),n=Object(n);++r<i;){var s=e[r];s&&t(n,s,r,o)}return n})}(function(t,n,e){art(t,n,e)}),UO=function(t,n){return t<n},urt=function(t){return t&&t.length?K1(t,Fs,UO):void 0},crt=function(t,n){return t&&t.length?K1(t,$o(n),UO):void 0},lrt=function(){return Fi.Date.now()},hrt=function(t,n,e,r){if(!Gr(t))return t;for(var i=-1,o=(n=Jp(n,t)).length,a=o-1,s=t;s!=null&&++i<o;){var u=ih(n[i]),c=e;if(u==="__proto__"||u==="constructor"||u==="prototype")return t;if(i!=a){var l=s[u];(c=r?r(l,u,s):void 0)===void 0&&(c=Gr(l)?l:Hp(n[i+1])?[]:{})}Xp(s,u,c),s=s[u]}return t},frt=function(t,n,e){for(var r=-1,i=n.length,o={};++r<i;){var a=n[r],s=$p(t,a);e(s,a)&&hrt(o,Jp(a,t),s)}return o},drt=function(t,n){return frt(t,n,function(e,r){return yO(t,r)})},prt=function(t){return TO(IO(t,void 0,zO),t+"")}(function(t,n){return t==null?{}:drt(t,n)}),grt=Math.ceil,vrt=Math.max,mrt=function(t,n,e,r){for(var i=-1,o=vrt(grt((n-t)/(e||1)),0),a=Array(o);o--;)a[r?o:++i]=t,t+=e;return a},yrt=function(t){return function(n,e,r){return r&&typeof r!="number"&&Nl(n,e,r)&&(e=r=void 0),n=od(n),e===void 0?(e=n,n=0):e=od(e),r=r===void 0?n<e?1:-1:od(r),mrt(n,e,r,t)}}(),brt=function(t,n){var e=t.length;for(t.sort(n);e--;)t[e]=t[e].value;return t},xrt=function(t,n){if(t!==n){var e=t!==void 0,r=t===null,i=t==t,o=Ns(t),a=n!==void 0,s=n===null,u=n==n,c=Ns(n);if(!s&&!c&&!o&&t>n||o&&a&&u&&!s&&!c||r&&a&&u||!e&&u||!i)return 1;if(!r&&!o&&!c&&t<n||c&&e&&i&&!r&&!o||s&&e&&i||!a&&i||!u)return-1}return 0},wrt=function(t,n,e){for(var r=-1,i=t.criteria,o=n.criteria,a=i.length,s=e.length;++r<a;){var u=xrt(i[r],o[r]);if(u)return r>=s?u:u*(e[r]=="desc"?-1:1)}return t.index-n.index},Ert=function(t,n,e){n=n.length?Ou(n,function(o){return Un(o)?function(a){return $p(a,o.length===1?o[0]:o)}:o}):[Fs];var r=-1;n=Ou(n,qp($o));var i=MO(t,function(o,a,s){return{criteria:Ou(n,function(u){return u(o)}),index:++r,value:o}});return brt(i,function(o,a){return wrt(o,a,e)})},Mrt=tg(function(t,n){if(t==null)return[];var e=n.length;return e>1&&Nl(t,n[0],n[1])?n=[]:e>2&&Nl(n[0],n[1],n[2])&&(n=[n[0]]),Ert(t,q1(n,1),[])}),Srt=0,_rt=function(t){var n=++Srt;return vO(t)+n},krt=function(t,n,e){for(var r=-1,i=t.length,o=n.length,a={};++r<i;){var s=r<o?n[r]:void 0;e(a,t[r],s)}return a},qd,Art=function(t,n){return krt(t||[],n||[],Xp)};try{qd={cloneDeep:Lnt,constant:U1,defaults:Rnt,each:cO,filter:xO,find:Hnt,flatten:zO,forEach:uO,forIn:qnt,has:wO,isUndefined:EO,last:Znt,map:SO,mapValues:Knt,max:Jnt,merge:srt,min:urt,minBy:crt,now:lrt,pick:prt,range:yrt,reduce:_O,sortBy:Mrt,uniqueId:_rt,values:DO,zipObject:Art}}catch{}qd||(qd=window._);var Z=qd,Crt=ad;function ad(){var t={};t._next=t._prev=t,this._sentinel=t}function JM(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function Irt(t,n){if(t!=="_next"&&t!=="_prev")return n}ad.prototype.dequeue=function(){var t=this._sentinel,n=t._prev;if(n!==t)return JM(n),n},ad.prototype.enqueue=function(t){var n=this._sentinel;t._prev&&t._next&&JM(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n},ad.prototype.toString=function(){for(var t=[],n=this._sentinel,e=n._prev;e!==n;)t.push(JSON.stringify(e,Irt)),e=e._prev;return"["+t.join(", ")+"]"};var Trt=Bi.Graph,Ort=function(t,n){if(t.nodeCount()<=1)return[];var e=function(i,o){var a=new Trt,s=0,u=0;Z.forEach(i.nodes(),function(h){a.setNode(h,{v:h,in:0,out:0})}),Z.forEach(i.edges(),function(h){var f=a.edge(h.v,h.w)||0,d=o(h),p=f+d;a.setEdge(h.v,h.w,p),u=Math.max(u,a.node(h.v).out+=d),s=Math.max(s,a.node(h.w).in+=d)});var c=Z.range(u+s+3).map(function(){return new Crt}),l=s+1;return Z.forEach(a.nodes(),function(h){Fm(c,l,a.node(h))}),{graph:a,buckets:c,zeroIdx:l}}(t,n||Nrt),r=function(i,o,a){for(var s,u=[],c=o[o.length-1],l=o[0];i.nodeCount();){for(;s=l.dequeue();)iv(i,o,a,s);for(;s=c.dequeue();)iv(i,o,a,s);if(i.nodeCount()){for(var h=o.length-2;h>0;--h)if(s=o[h].dequeue()){u=u.concat(iv(i,o,a,s,!0));break}}}return u}(e.graph,e.buckets,e.zeroIdx);return Z.flatten(Z.map(r,function(i){return t.outEdges(i.v,i.w)}),!0)},Nrt=Z.constant(1);function iv(t,n,e,r,i){var o=i?[]:void 0;return Z.forEach(t.inEdges(r.v),function(a){var s=t.edge(a),u=t.node(a.v);i&&o.push({v:a.v,w:a.w}),u.out-=s,Fm(n,e,u)}),Z.forEach(t.outEdges(r.v),function(a){var s=t.edge(a),u=a.w,c=t.node(u);c.in-=s,Fm(n,e,c)}),t.removeNode(r.v),o}function Fm(t,n,e){e.out?e.in?t[e.out-e.in+n].enqueue(e):t[t.length-1].enqueue(e):t[0].enqueue(e)}var $M={run:function(t){var n=t.graph().acyclicer==="greedy"?Ort(t,function(e){return function(r){return e.edge(r).weight}}(t)):function(e){var r=[],i={},o={};function a(s){Z.has(o,s)||(o[s]=!0,i[s]=!0,Z.forEach(e.outEdges(s),function(u){Z.has(i,u.w)?r.push(u):a(u.w)}),delete i[s])}return Z.forEach(e.nodes(),a),r}(t);Z.forEach(n,function(e){var r=t.edge(e);t.removeEdge(e),r.forwardName=e.name,r.reversed=!0,t.setEdge(e.w,e.v,r,Z.uniqueId("rev"))})},undo:function(t){Z.forEach(t.edges(),function(n){var e=t.edge(n);if(e.reversed){t.removeEdge(n);var r=e.forwardName;delete e.reversed,delete e.forwardName,t.setEdge(n.w,n.v,e,r)}})}},tS=Bi.Graph,br={addDummyNode:eS,simplify:function(t){var n=new tS().setGraph(t.graph());return Z.forEach(t.nodes(),function(e){n.setNode(e,t.node(e))}),Z.forEach(t.edges(),function(e){var r=n.edge(e.v,e.w)||{weight:0,minlen:1},i=t.edge(e);n.setEdge(e.v,e.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),n},asNonCompoundGraph:function(t){var n=new tS({multigraph:t.isMultigraph()}).setGraph(t.graph());return Z.forEach(t.nodes(),function(e){t.children(e).length||n.setNode(e,t.node(e))}),Z.forEach(t.edges(),function(e){n.setEdge(e,t.edge(e))}),n},successorWeights:function(t){var n=Z.map(t.nodes(),function(e){var r={};return Z.forEach(t.outEdges(e),function(i){r[i.w]=(r[i.w]||0)+t.edge(i).weight}),r});return Z.zipObject(t.nodes(),n)},predecessorWeights:function(t){var n=Z.map(t.nodes(),function(e){var r={};return Z.forEach(t.inEdges(e),function(i){r[i.v]=(r[i.v]||0)+t.edge(i).weight}),r});return Z.zipObject(t.nodes(),n)},intersectRect:function(t,n){var e,r,i=t.x,o=t.y,a=n.x-i,s=n.y-o,u=t.width/2,c=t.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*u>Math.abs(a)*c?(s<0&&(c=-c),e=c*a/s,r=c):(a<0&&(u=-u),e=u,r=u*s/a),{x:i+e,y:o+r}},buildLayerMatrix:function(t){var n=Z.map(Z.range(nS(t)+1),function(){return[]});return Z.forEach(t.nodes(),function(e){var r=t.node(e),i=r.rank;Z.isUndefined(i)||(n[i][r.order]=e)}),n},normalizeRanks:function(t){var n=Z.min(Z.map(t.nodes(),function(e){return t.node(e).rank}));Z.forEach(t.nodes(),function(e){var r=t.node(e);Z.has(r,"rank")&&(r.rank-=n)})},removeEmptyRanks:function(t){var n=Z.min(Z.map(t.nodes(),function(o){return t.node(o).rank})),e=[];Z.forEach(t.nodes(),function(o){var a=t.node(o).rank-n;e[a]||(e[a]=[]),e[a].push(o)});var r=0,i=t.graph().nodeRankFactor;Z.forEach(e,function(o,a){Z.isUndefined(o)&&a%i!=0?--r:r&&Z.forEach(o,function(s){t.node(s).rank+=r})})},addBorderNode:function(t,n,e,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=e,i.order=r),eS(t,"border",i,n)},maxRank:nS,partition:function(t,n){var e={lhs:[],rhs:[]};return Z.forEach(t,function(r){n(r)?e.lhs.push(r):e.rhs.push(r)}),e},time:function(t,n){var e=Z.now();try{return n()}finally{console.log(t+" time: "+(Z.now()-e)+"ms")}},notime:function(t,n){return n()}};function eS(t,n,e,r){var i;do i=Z.uniqueId(r);while(t.hasNode(i));return e.dummy=n,t.setNode(i,e),i}function nS(t){return Z.max(Z.map(t.nodes(),function(n){var e=t.node(n).rank;if(!Z.isUndefined(e))return e}))}var rS={run:function(t){t.graph().dummyChains=[],Z.forEach(t.edges(),function(n){(function(e,r){var i,o,a,s=r.v,u=e.node(s).rank,c=r.w,l=e.node(c).rank,h=r.name,f=e.edge(r),d=f.labelRank;if(l!==u+1){for(e.removeEdge(r),a=0,++u;u<l;++a,++u)f.points=[],o={width:0,height:0,edgeLabel:f,edgeObj:r,rank:u},i=br.addDummyNode(e,"edge",o,"_d"),u===d&&(o.width=f.width,o.height=f.height,o.dummy="edge-label",o.labelpos=f.labelpos),e.setEdge(s,i,{weight:f.weight},h),a===0&&e.graph().dummyChains.push(i),s=i;e.setEdge(s,c,{weight:f.weight},h)}})(t,n)})},undo:function(t){Z.forEach(t.graph().dummyChains,function(n){var e,r=t.node(n),i=r.edgeLabel;for(t.setEdge(r.edgeObj,i);r.dummy;)e=t.successors(n)[0],t.removeNode(n),i.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),n=e,r=t.node(n)})}},YO=function(t){var n={};Z.forEach(t.sources(),function e(r){var i=t.node(r);if(Z.has(n,r))return i.rank;n[r]=!0;var o=Z.min(Z.map(t.outEdges(r),function(a){return e(a.w)-t.edge(a).minlen}));return o!==Number.POSITIVE_INFINITY&&o!=null||(o=0),i.rank=o})},VO=function(t,n){return t.node(n.w).rank-t.node(n.v).rank-t.edge(n).minlen},Drt=Bi.Graph,Zd=VO,WO=function(t){var n,e,r=new Drt({directed:!1}),i=t.nodes()[0],o=t.nodeCount();for(r.setNode(i,{});Prt(r,t)<o;)n=Lrt(r,t),e=r.hasNode(n.v)?Zd(t,n):-Zd(t,n),jrt(r,t,e);return r};function Prt(t,n){return Z.forEach(t.nodes(),function e(r){Z.forEach(n.nodeEdges(r),function(i){var o=i.v,a=r===o?i.w:o;t.hasNode(a)||Zd(n,i)||(t.setNode(a,{}),t.setEdge(r,a,{}),e(a))})}),t.nodeCount()}function Lrt(t,n){return Z.minBy(n.edges(),function(e){if(t.hasNode(e.v)!==t.hasNode(e.w))return Zd(n,e)})}function jrt(t,n,e){Z.forEach(t.nodes(),function(r){n.node(r).rank+=e})}var Rrt=VO,Frt=YO,Brt=Bi.alg.preorder,zrt=Bi.alg.postorder,Grt=br.simplify,Urt=ls;function ls(t){t=Grt(t),Frt(t);var n,e=WO(t);for(J1(e),Q1(e,t);n=qO(e);)KO(e,t,n,ZO(e,t,n))}function Q1(t,n){var e=zrt(t,t.nodes());e=e.slice(0,e.length-1),Z.forEach(e,function(r){(function(i,o,a){var s=i.node(a).parent;i.edge(a,s).cutvalue=XO(i,o,a)})(t,n,r)})}function XO(t,n,e){var r=t.node(e).parent,i=!0,o=n.edge(e,r),a=0;return o||(i=!1,o=n.edge(r,e)),a=o.weight,Z.forEach(n.nodeEdges(e),function(s){var u,c,l=s.v===e,h=l?s.w:s.v;if(h!==r){var f=l===i,d=n.edge(s).weight;if(a+=f?d:-d,u=e,c=h,t.hasEdge(u,c)){var p=t.edge(e,h).cutvalue;a+=f?-p:p}}}),a}function J1(t,n){arguments.length<2&&(n=t.nodes()[0]),HO(t,{},1,n)}function HO(t,n,e,r,i){var o=e,a=t.node(r);return n[r]=!0,Z.forEach(t.neighbors(r),function(s){Z.has(n,s)||(e=HO(t,n,e,s,r))}),a.low=o,a.lim=e++,i?a.parent=i:delete a.parent,e}function qO(t){return Z.find(t.edges(),function(n){return t.edge(n).cutvalue<0})}function ZO(t,n,e){var r=e.v,i=e.w;n.hasEdge(r,i)||(r=e.w,i=e.v);var o=t.node(r),a=t.node(i),s=o,u=!1;o.lim>a.lim&&(s=a,u=!0);var c=Z.filter(n.edges(),function(l){return u===iS(t,t.node(l.v),s)&&u!==iS(t,t.node(l.w),s)});return Z.minBy(c,function(l){return Rrt(n,l)})}function KO(t,n,e,r){var i=e.v,o=e.w;t.removeEdge(i,o),t.setEdge(r.v,r.w,{}),J1(t),Q1(t,n),function(a,s){var u=Z.find(a.nodes(),function(l){return!s.node(l).parent}),c=Brt(a,u);c=c.slice(1),Z.forEach(c,function(l){var h=a.node(l).parent,f=s.edge(l,h),d=!1;f||(f=s.edge(h,l),d=!0),s.node(l).rank=s.node(h).rank+(d?f.minlen:-f.minlen)})}(t,n)}function iS(t,n,e){return e.low<=n.lim&&n.lim<=e.lim}ls.initLowLimValues=J1,ls.initCutValues=Q1,ls.calcCutValue=XO,ls.leaveEdge=qO,ls.enterEdge=ZO,ls.exchangeEdges=KO;var QO=YO,Yrt=function(t){switch(t.graph().ranker){case"network-simplex":oS(t);break;case"tight-tree":(function(n){QO(n),WO(n)})(t);break;case"longest-path":Vrt(t);break;default:oS(t)}},Vrt=QO;function oS(t){Urt(t)}var Wrt=function(t){var n=function(e){var r={},i=0;function o(a){var s=i;Z.forEach(e.children(a),o),r[a]={low:s,lim:i++}}return Z.forEach(e.children(),o),r}(t);Z.forEach(t.graph().dummyChains,function(e){for(var r=t.node(e),i=r.edgeObj,o=function(h,f,d,p){var g,v,m=[],y=[],b=Math.min(f[d].low,f[p].low),x=Math.max(f[d].lim,f[p].lim);g=d;do g=h.parent(g),m.push(g);while(g&&(f[g].low>b||x>f[g].lim));for(v=g,g=p;(g=h.parent(g))!==v;)y.push(g);return{path:m.concat(y.reverse()),lca:v}}(t,n,i.v,i.w),a=o.path,s=o.lca,u=0,c=a[u],l=!0;e!==i.w;){if(r=t.node(e),l){for(;(c=a[u])!==s&&t.node(c).maxRank<r.rank;)u++;c===s&&(l=!1)}if(!l){for(;u<a.length-1&&t.node(c=a[u+1]).minRank<=r.rank;)u++;c=a[u]}t.setParent(e,c),e=t.successors(e)[0]}})},aS={run:function(t){var n=br.addDummyNode(t,"root",{},"_root"),e=function(a){var s={};function u(c,l){var h=a.children(c);h&&h.length&&Z.forEach(h,function(f){u(f,l+1)}),s[c]=l}return Z.forEach(a.children(),function(c){u(c,1)}),s}(t),r=Z.max(Z.values(e))-1,i=2*r+1;t.graph().nestingRoot=n,Z.forEach(t.edges(),function(a){t.edge(a).minlen*=i});var o=function(a){return Z.reduce(a.edges(),function(s,u){return s+a.edge(u).weight},0)}(t)+1;Z.forEach(t.children(),function(a){JO(t,n,i,o,r,e,a)}),t.graph().nodeRankFactor=i},cleanup:function(t){var n=t.graph();t.removeNode(n.nestingRoot),delete n.nestingRoot,Z.forEach(t.edges(),function(e){t.edge(e).nestingEdge&&t.removeEdge(e)})}};function JO(t,n,e,r,i,o,a){var s=t.children(a);if(s.length){var u=br.addBorderNode(t,"_bt"),c=br.addBorderNode(t,"_bb"),l=t.node(a);t.setParent(u,a),l.borderTop=u,t.setParent(c,a),l.borderBottom=c,Z.forEach(s,function(h){JO(t,n,e,r,i,o,h);var f=t.node(h),d=f.borderTop?f.borderTop:h,p=f.borderBottom?f.borderBottom:h,g=f.borderTop?r:2*r,v=d!==p?1:i-o[a]+1;t.setEdge(u,d,{weight:g,minlen:v,nestingEdge:!0}),t.setEdge(p,c,{weight:g,minlen:v,nestingEdge:!0})}),t.parent(a)||t.setEdge(n,u,{weight:0,minlen:i+o[a]})}else a!==n&&t.setEdge(n,a,{weight:0,minlen:e})}var Xrt=function(t){Z.forEach(t.children(),function n(e){var r=t.children(e),i=t.node(e);if(r.length&&Z.forEach(r,n),Z.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,a=i.maxRank+1;o<a;++o)sS(t,"borderLeft","_bl",e,i,o),sS(t,"borderRight","_br",e,i,o)}})};function sS(t,n,e,r,i,o){var a={width:0,height:0,rank:o,borderType:n},s=i[n][o-1],u=br.addDummyNode(t,"border",a,e);i[n][o]=u,t.setParent(u,r),s&&t.setEdge(s,u,{weight:1})}var uS={adjust:function(t){var n=t.graph().rankdir.toLowerCase();n!=="lr"&&n!=="rl"||cS(t)},undo:function(t){var n=t.graph().rankdir.toLowerCase();n!=="bt"&&n!=="rl"||function(e){Z.forEach(e.nodes(),function(r){ov(e.node(r))}),Z.forEach(e.edges(),function(r){var i=e.edge(r);Z.forEach(i.points,ov),Z.has(i,"y")&&ov(i)})}(t),n!=="lr"&&n!=="rl"||(function(e){Z.forEach(e.nodes(),function(r){av(e.node(r))}),Z.forEach(e.edges(),function(r){var i=e.edge(r);Z.forEach(i.points,av),Z.has(i,"x")&&av(i)})}(t),cS(t))}};function cS(t){Z.forEach(t.nodes(),function(n){lS(t.node(n))}),Z.forEach(t.edges(),function(n){lS(t.edge(n))})}function lS(t){var n=t.width;t.width=t.height,t.height=n}function ov(t){t.y=-t.y}function av(t){var n=t.x;t.x=t.y,t.y=n}var Hrt=function(t){var n={},e=Z.filter(t.nodes(),function(s){return!t.children(s).length}),r=Z.max(Z.map(e,function(s){return t.node(s).rank})),i=Z.map(Z.range(r+1),function(){return[]});function o(s){if(!Z.has(n,s)){n[s]=!0;var u=t.node(s);i[u.rank].push(s),Z.forEach(t.successors(s),o)}}var a=Z.sortBy(e,function(s){return t.node(s).rank});return Z.forEach(a,o),i},qrt=function(t,n){for(var e=0,r=1;r<n.length;++r)e+=Zrt(t,n[r-1],n[r]);return e};function Zrt(t,n,e){for(var r=Z.zipObject(e,Z.map(e,function(c,l){return l})),i=Z.flatten(Z.map(n,function(c){return Z.sortBy(Z.map(t.outEdges(c),function(l){return{pos:r[l.w],weight:t.edge(l).weight}}),"pos")}),!0),o=1;o<e.length;)o<<=1;var a=2*o-1;o-=1;var s=Z.map(new Array(a),function(){return 0}),u=0;return Z.forEach(i.forEach(function(c){var l=c.pos+o;s[l]+=c.weight;for(var h=0;l>0;)l%2&&(h+=s[l+1]),s[l=l-1>>1]+=c.weight;u+=c.weight*h})),u}var Krt=function(t,n){return Z.map(n,function(e){var r=t.inEdges(e);if(r.length){var i=Z.reduce(r,function(o,a){var s=t.edge(a),u=t.node(a.v);return{sum:o.sum+s.weight*u.order,weight:o.weight+s.weight}},{sum:0,weight:0});return{v:e,barycenter:i.sum/i.weight,weight:i.weight}}return{v:e}})},Qrt=function(t,n){var e={};return Z.forEach(t,function(r,i){var o=e[r.v]={indegree:0,in:[],out:[],vs:[r.v],i};Z.isUndefined(r.barycenter)||(o.barycenter=r.barycenter,o.weight=r.weight)}),Z.forEach(n.edges(),function(r){var i=e[r.v],o=e[r.w];Z.isUndefined(i)||Z.isUndefined(o)||(o.indegree++,i.out.push(e[r.w]))}),function(r){var i=[];function o(u){return function(c){c.merged||(Z.isUndefined(c.barycenter)||Z.isUndefined(u.barycenter)||c.barycenter>=u.barycenter)&&function(l,h){var f=0,d=0;l.weight&&(f+=l.barycenter*l.weight,d+=l.weight),h.weight&&(f+=h.barycenter*h.weight,d+=h.weight),l.vs=h.vs.concat(l.vs),l.barycenter=f/d,l.weight=d,l.i=Math.min(h.i,l.i),h.merged=!0}(u,c)}}function a(u){return function(c){c.in.push(u),--c.indegree==0&&r.push(c)}}for(;r.length;){var s=r.pop();i.push(s),Z.forEach(s.in.reverse(),o(s)),Z.forEach(s.out,a(s))}return Z.map(Z.filter(i,function(u){return!u.merged}),function(u){return Z.pick(u,["vs","i","barycenter","weight"])})}(Z.filter(e,function(r){return!r.indegree}))},Jrt=function(t,n){var e=br.partition(t,function(h){return Z.has(h,"barycenter")}),r=e.lhs,i=Z.sortBy(e.rhs,function(h){return-h.i}),o=[],a=0,s=0,u=0;r.sort((c=!!n,function(h,f){return h.barycenter<f.barycenter?-1:h.barycenter>f.barycenter?1:c?f.i-h.i:h.i-f.i})),u=hS(o,i,u),Z.forEach(r,function(h){u+=h.vs.length,o.push(h.vs),a+=h.barycenter*h.weight,s+=h.weight,u=hS(o,i,u)});var c,l={vs:Z.flatten(o,!0)};return s&&(l.barycenter=a/s,l.weight=s),l};function hS(t,n,e){for(var r;n.length&&(r=Z.last(n)).i<=e;)n.pop(),t.push(r.vs),e++;return e}var $rt=function t(n,e,r,i){var o=n.children(e),a=n.node(e),s=a?a.borderLeft:void 0,u=a?a.borderRight:void 0,c={};s&&(o=Z.filter(o,function(g){return g!==s&&g!==u}));var l=Krt(n,o);Z.forEach(l,function(g){if(n.children(g.v).length){var v=t(n,g.v,r,i);c[g.v]=v,Z.has(v,"barycenter")&&(m=g,y=v,Z.isUndefined(m.barycenter)?(m.barycenter=y.barycenter,m.weight=y.weight):(m.barycenter=(m.barycenter*m.weight+y.barycenter*y.weight)/(m.weight+y.weight),m.weight+=y.weight))}var m,y});var h=Qrt(l,r);(function(g,v){Z.forEach(g,function(m){m.vs=Z.flatten(m.vs.map(function(y){return v[y]?v[y].vs:y}),!0)})})(h,c);var f=Jrt(h,i);if(s&&(f.vs=Z.flatten([s,f.vs,u],!0),n.predecessors(s).length)){var d=n.node(n.predecessors(s)[0]),p=n.node(n.predecessors(u)[0]);Z.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+d.order+p.order)/(f.weight+2),f.weight+=2}return f},tit=Bi.Graph,eit=function(t,n,e){var r=function(o){for(var a;o.hasNode(a=Z.uniqueId("_root")););return a}(t),i=new tit({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(o){return t.node(o)});return Z.forEach(t.nodes(),function(o){var a=t.node(o),s=t.parent(o);(a.rank===n||a.minRank<=n&&n<=a.maxRank)&&(i.setNode(o),i.setParent(o,s||r),Z.forEach(t[e](o),function(u){var c=u.v===o?u.w:u.v,l=i.edge(c,o),h=Z.isUndefined(l)?0:l.weight;i.setEdge(c,o,{weight:t.edge(u).weight+h})}),Z.has(a,"minRank")&&i.setNode(o,{borderLeft:a.borderLeft[n],borderRight:a.borderRight[n]}))}),i},nit=function(t,n,e){var r,i={};Z.forEach(e,function(o){for(var a,s,u=t.parent(o);u;){if((a=t.parent(u))?(s=i[a],i[a]=u):(s=r,r=u),s&&s!==u)return void n.setEdge(s,u);u=a}})},rit=Bi.Graph,iit=function(t){var n=br.maxRank(t),e=fS(t,Z.range(1,n+1),"inEdges"),r=fS(t,Z.range(n-1,-1,-1),"outEdges"),i=Hrt(t);dS(t,i);for(var o,a=Number.POSITIVE_INFINITY,s=0,u=0;u<4;++s,++u){oit(s%2?e:r,s%4>=2),i=br.buildLayerMatrix(t);var c=qrt(t,i);c<a&&(u=0,o=Z.cloneDeep(i),a=c)}dS(t,o)};function fS(t,n,e){return Z.map(n,function(r){return eit(t,r,e)})}function oit(t,n){var e=new rit;Z.forEach(t,function(r){var i=r.graph().root,o=$rt(r,i,e,n);Z.forEach(o.vs,function(a,s){r.node(a).order=s}),nit(r,e,o.vs)})}function dS(t,n){Z.forEach(n,function(e){Z.forEach(e,function(r,i){t.node(r).order=i})})}var ait=Bi.Graph,sit=function(t){var n,e=br.buildLayerMatrix(t),r=Z.merge(uit(t,e),cit(t,e)),i={};Z.forEach(["u","d"],function(a){n=a==="u"?e:Z.values(e).reverse(),Z.forEach(["l","r"],function(s){s==="r"&&(n=Z.map(n,function(h){return Z.values(h).reverse()}));var u=(a==="u"?t.predecessors:t.successors).bind(t),c=hit(t,n,r,u),l=fit(t,n,c.root,c.align,s==="r");s==="r"&&(l=Z.mapValues(l,function(h){return-h})),i[a+s]=l})});var o=dit(t,i);return pit(i,o),git(i,t.graph().align)};function uit(t,n){var e={};return Z.reduce(n,function(r,i){var o=0,a=0,s=r.length,u=Z.last(i);return Z.forEach(i,function(c,l){var h=function(d,p){if(d.node(p).dummy)return Z.find(d.predecessors(p),function(g){return d.node(g).dummy})}(t,c),f=h?t.node(h).order:s;(h||c===u)&&(Z.forEach(i.slice(a,l+1),function(d){Z.forEach(t.predecessors(d),function(p){var g=t.node(p),v=g.order;!(v<o||f<v)||g.dummy&&t.node(d).dummy||$O(e,p,d)})}),a=l+1,o=f)}),i}),e}function cit(t,n){var e={};function r(i,o,a,s,u){var c;Z.forEach(Z.range(o,a),function(l){c=i[l],t.node(c).dummy&&Z.forEach(t.predecessors(c),function(h){var f=t.node(h);f.dummy&&(f.order<s||f.order>u)&&$O(e,h,c)})})}return Z.reduce(n,function(i,o){var a,s=-1,u=0;return Z.forEach(o,function(c,l){if(t.node(c).dummy==="border"){var h=t.predecessors(c);h.length&&(a=t.node(h[0]).order,r(o,u,l,s,a),u=l,s=a)}r(o,u,o.length,a,i.length)}),o}),e}function $O(t,n,e){if(n>e){var r=n;n=e,e=r}var i=t[n];i||(t[n]=i={}),i[e]=!0}function lit(t,n,e){if(n>e){var r=n;n=e,e=r}return Z.has(t[n],e)}function hit(t,n,e,r){var i={},o={},a={};return Z.forEach(n,function(s){Z.forEach(s,function(u,c){i[u]=u,o[u]=u,a[u]=c})}),Z.forEach(n,function(s){var u=-1;Z.forEach(s,function(c){var l=r(c);if(l.length)for(var h=((l=Z.sortBy(l,function(g){return a[g]})).length-1)/2,f=Math.floor(h),d=Math.ceil(h);f<=d;++f){var p=l[f];o[c]===c&&u<a[p]&&!lit(e,c,p)&&(o[p]=c,o[c]=i[c]=i[p],u=a[p])}})}),{root:i,align:o}}function fit(t,n,e,r,i){var o={},a=function(c,l,h,f){var d=new ait,p=c.graph(),g=function(v,m,y){return function(b,x,w){var E,M=b.node(x),_=b.node(w),k=0;if(k+=M.width/2,Z.has(M,"labelpos"))switch(M.labelpos.toLowerCase()){case"l":E=-M.width/2;break;case"r":E=M.width/2}if(E&&(k+=y?E:-E),E=0,k+=(M.dummy?m:v)/2,k+=(_.dummy?m:v)/2,k+=_.width/2,Z.has(_,"labelpos"))switch(_.labelpos.toLowerCase()){case"l":E=_.width/2;break;case"r":E=-_.width/2}return E&&(k+=y?E:-E),E=0,k}}(p.nodesep,p.edgesep,f);return Z.forEach(l,function(v){var m;Z.forEach(v,function(y){var b=h[y];if(d.setNode(b),m){var x=h[m],w=d.edge(x,b);d.setEdge(x,b,Math.max(g(c,y,m),w||0))}m=y})}),d}(t,n,e,i),s=i?"borderLeft":"borderRight";function u(c,l){for(var h=a.nodes(),f=h.pop(),d={};f;)d[f]?c(f):(d[f]=!0,h.push(f),h=h.concat(l(f))),f=h.pop()}return u(function(c){o[c]=a.inEdges(c).reduce(function(l,h){return Math.max(l,o[h.v]+a.edge(h))},0)},a.predecessors.bind(a)),u(function(c){var l=a.outEdges(c).reduce(function(f,d){return Math.min(f,o[d.w]-a.edge(d))},Number.POSITIVE_INFINITY),h=t.node(c);l!==Number.POSITIVE_INFINITY&&h.borderType!==s&&(o[c]=Math.max(o[c],l))},a.successors.bind(a)),Z.forEach(r,function(c){o[c]=o[e[c]]}),o}function dit(t,n){return Z.minBy(Z.values(n),function(e){var r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return Z.forIn(e,function(o,a){var s=function(u,c){return u.node(c).width}(t,a)/2;r=Math.max(o+s,r),i=Math.min(o-s,i)}),r-i})}function pit(t,n){var e=Z.values(n),r=Z.min(e),i=Z.max(e);Z.forEach(["u","d"],function(o){Z.forEach(["l","r"],function(a){var s,u=o+a,c=t[u];if(c!==n){var l=Z.values(c);(s=a==="l"?r-Z.min(l):i-Z.max(l))&&(t[u]=Z.mapValues(c,function(h){return h+s}))}})})}function git(t,n){return Z.mapValues(t.ul,function(e,r){if(n)return t[n.toLowerCase()][r];var i=Z.sortBy(Z.map(t,r));return(i[1]+i[2])/2})}var vit=sit,mit=function(t){(function(n){var e=br.buildLayerMatrix(n),r=n.graph().ranksep,i=0;Z.forEach(e,function(o){var a=Z.max(Z.map(o,function(s){return n.node(s).height}));Z.forEach(o,function(s){n.node(s).y=i+a/2}),i+=a+r})})(t=br.asNonCompoundGraph(t)),Z.forEach(vit(t),function(n,e){t.node(e).x=n})},yit=br.normalizeRanks,bit=br.removeEmptyRanks,la=br,xit=Bi.Graph,wit=function(t,n){var e=n&&n.debugTiming?la.time:la.notime;e("layout",function(){var r=e("  buildLayoutGraph",function(){return function(i){var o=new xit({multigraph:!0,compound:!0}),a=uv(i.graph());return o.setGraph(Z.merge({},Mit,sv(a,Eit),Z.pick(a,Sit))),Z.forEach(i.nodes(),function(s){var u=uv(i.node(s));o.setNode(s,Z.defaults(sv(u,_it),kit)),o.setParent(s,i.parent(s))}),Z.forEach(i.edges(),function(s){var u=uv(i.edge(s));o.setEdge(s,Z.merge({},Cit,sv(u,Ait),Z.pick(u,Iit)))}),o}(t)});e("  runLayout",function(){(function(i,o){o("    makeSpaceForEdgeLabels",function(){(function(a){var s=a.graph();s.ranksep/=2,Z.forEach(a.edges(),function(u){var c=a.edge(u);c.minlen*=2,c.labelpos.toLowerCase()!=="c"&&(s.rankdir==="TB"||s.rankdir==="BT"?c.width+=c.labeloffset:c.height+=c.labeloffset)})})(i)}),o("    removeSelfEdges",function(){(function(a){Z.forEach(a.edges(),function(s){if(s.v===s.w){var u=a.node(s.v);u.selfEdges||(u.selfEdges=[]),u.selfEdges.push({e:s,label:a.edge(s)}),a.removeEdge(s)}})})(i)}),o("    acyclic",function(){$M.run(i)}),o("    nestingGraph.run",function(){aS.run(i)}),o("    rank",function(){Yrt(la.asNonCompoundGraph(i))}),o("    injectEdgeLabelProxies",function(){(function(a){Z.forEach(a.edges(),function(s){var u=a.edge(s);if(u.width&&u.height){var c=a.node(s.v),l={rank:(a.node(s.w).rank-c.rank)/2+c.rank,e:s};la.addDummyNode(a,"edge-proxy",l,"_ep")}})})(i)}),o("    removeEmptyRanks",function(){bit(i)}),o("    nestingGraph.cleanup",function(){aS.cleanup(i)}),o("    normalizeRanks",function(){yit(i)}),o("    assignRankMinMax",function(){(function(a){var s=0;Z.forEach(a.nodes(),function(u){var c=a.node(u);c.borderTop&&(c.minRank=a.node(c.borderTop).rank,c.maxRank=a.node(c.borderBottom).rank,s=Z.max(s,c.maxRank))}),a.graph().maxRank=s})(i)}),o("    removeEdgeLabelProxies",function(){(function(a){Z.forEach(a.nodes(),function(s){var u=a.node(s);u.dummy==="edge-proxy"&&(a.edge(u.e).labelRank=u.rank,a.removeNode(s))})})(i)}),o("    normalize.run",function(){rS.run(i)}),o("    parentDummyChains",function(){Wrt(i)}),o("    addBorderSegments",function(){Xrt(i)}),o("    order",function(){iit(i)}),o("    insertSelfEdges",function(){(function(a){var s=la.buildLayerMatrix(a);Z.forEach(s,function(u){var c=0;Z.forEach(u,function(l,h){var f=a.node(l);f.order=h+c,Z.forEach(f.selfEdges,function(d){la.addDummyNode(a,"selfedge",{width:d.label.width,height:d.label.height,rank:f.rank,order:h+ ++c,e:d.e,label:d.label},"_se")}),delete f.selfEdges})})})(i)}),o("    adjustCoordinateSystem",function(){uS.adjust(i)}),o("    position",function(){mit(i)}),o("    positionSelfEdges",function(){(function(a){Z.forEach(a.nodes(),function(s){var u=a.node(s);if(u.dummy==="selfedge"){var c=a.node(u.e.v),l=c.x+c.width/2,h=c.y,f=u.x-l,d=c.height/2;a.setEdge(u.e,u.label),a.removeNode(s),u.label.points=[{x:l+2*f/3,y:h-d},{x:l+5*f/6,y:h-d},{x:l+f,y:h},{x:l+5*f/6,y:h+d},{x:l+2*f/3,y:h+d}],u.label.x=u.x,u.label.y=u.y}})})(i)}),o("    removeBorderNodes",function(){(function(a){Z.forEach(a.nodes(),function(s){if(a.children(s).length){var u=a.node(s),c=a.node(u.borderTop),l=a.node(u.borderBottom),h=a.node(Z.last(u.borderLeft)),f=a.node(Z.last(u.borderRight));u.width=Math.abs(f.x-h.x),u.height=Math.abs(l.y-c.y),u.x=h.x+u.width/2,u.y=c.y+u.height/2}}),Z.forEach(a.nodes(),function(s){a.node(s).dummy==="border"&&a.removeNode(s)})})(i)}),o("    normalize.undo",function(){rS.undo(i)}),o("    fixupEdgeLabelCoords",function(){(function(a){Z.forEach(a.edges(),function(s){var u=a.edge(s);if(Z.has(u,"x"))switch(u.labelpos!=="l"&&u.labelpos!=="r"||(u.width-=u.labeloffset),u.labelpos){case"l":u.x-=u.width/2+u.labeloffset;break;case"r":u.x+=u.width/2+u.labeloffset}})})(i)}),o("    undoCoordinateSystem",function(){uS.undo(i)}),o("    translateGraph",function(){(function(a){var s=Number.POSITIVE_INFINITY,u=0,c=Number.POSITIVE_INFINITY,l=0,h=a.graph(),f=h.marginx||0,d=h.marginy||0;function p(g){var v=g.x,m=g.y,y=g.width,b=g.height;s=Math.min(s,v-y/2),u=Math.max(u,v+y/2),c=Math.min(c,m-b/2),l=Math.max(l,m+b/2)}Z.forEach(a.nodes(),function(g){p(a.node(g))}),Z.forEach(a.edges(),function(g){var v=a.edge(g);Z.has(v,"x")&&p(v)}),s-=f,c-=d,Z.forEach(a.nodes(),function(g){var v=a.node(g);v.x-=s,v.y-=c}),Z.forEach(a.edges(),function(g){var v=a.edge(g);Z.forEach(v.points,function(m){m.x-=s,m.y-=c}),Z.has(v,"x")&&(v.x-=s),Z.has(v,"y")&&(v.y-=c)}),h.width=u-s+f,h.height=l-c+d})(i)}),o("    assignNodeIntersects",function(){(function(a){Z.forEach(a.edges(),function(s){var u,c,l=a.edge(s),h=a.node(s.v),f=a.node(s.w);l.points?(u=l.points[0],c=l.points[l.points.length-1]):(l.points=[],u=f,c=h),l.points.unshift(la.intersectRect(h,u)),l.points.push(la.intersectRect(f,c))})})(i)}),o("    reversePoints",function(){(function(a){Z.forEach(a.edges(),function(s){var u=a.edge(s);u.reversed&&u.points.reverse()})})(i)}),o("    acyclic.undo",function(){$M.undo(i)})})(r,e)}),e("  updateInputGraph",function(){(function(i,o){Z.forEach(i.nodes(),function(a){var s=i.node(a),u=o.node(a);s&&(s.x=u.x,s.y=u.y,o.children(a).length&&(s.width=u.width,s.height=u.height))}),Z.forEach(i.edges(),function(a){var s=i.edge(a),u=o.edge(a);s.points=u.points,Z.has(u,"x")&&(s.x=u.x,s.y=u.y)}),i.graph().width=o.graph().width,i.graph().height=o.graph().height})(t,r)})})},Eit=["nodesep","edgesep","ranksep","marginx","marginy"],Mit={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Sit=["acyclicer","ranker","rankdir","align"],_it=["width","height"],kit={width:0,height:0},Ait=["minlen","weight","width","height","labeloffset"],Cit={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Iit=["labelpos"];function sv(t,n){return Z.mapValues(Z.pick(t,n),Number)}function uv(t){var n={};return Z.forEach(t,function(e,r){n[r.toLowerCase()]=e}),n}var Tit=Bi.Graph,tN={graphlib:Bi,layout:wit,debug:{debugOrdering:function(t){var n=br.buildLayerMatrix(t),e=new Tit({compound:!0,multigraph:!0}).setGraph({});return Z.forEach(t.nodes(),function(r){e.setNode(r,{label:r}),e.setParent(r,"layer"+t.node(r).rank)}),Z.forEach(t.edges(),function(r){e.setEdge(r.v,r.w,{},r.name)}),Z.forEach(n,function(r,i){var o="layer"+i;e.setNode(o,{rank:"same"}),Z.reduce(r,function(a,s){return e.setEdge(a,s,{style:"invis"}),s})}),e}},util:{time:br.time,notime:br.notime},version:"0.8.5"},Oit=tN.graphlib,Nit=tN.layout;class Dit{constructor(n){this.cardinality=1,this.include=Is.UNSPECIFIED,this.isGroupNode=!1,this.parentNode=null,this.type=Rr.NODE,this.name=n.name,this.attr=n.attr||{},this.inputs=n.inputs,this.path=n.path||[],this.width=n.width,this.height=n.height}}class Pit{constructor(){this.nodes={},this.edges=[],this.nodes={},this.edges=[]}}function Lit(t){const n=new Pit;return t.nodes.map(e=>new Dit(e)).forEach(e=>{n.nodes[e.name]=e,e.inputs.forEach(r=>{(function(i,o,a){a.name!==o.name&&i.edges.push(Object.assign(Object.assign({},a.attr),{v:a.name,w:o.name}))})(n,e,r)})}),n}class jit{constructor(n,e={}){this.attr=null,this.bridgeGraph=null,this.cardinality=0,this.depth=1,this.include=Is.UNSPECIFIED,this.isGroupNode=!0,this.parentNode=null,this.type=Rr.META,this.path=[],this.name=n,this.metaGraph=$1(n,Wu.META,e)}getFirstChild(){return this.metaGraph.node(this.metaGraph.nodes()[0])}getChildren(){return this.metaGraph.nodes().map(n=>this.metaGraph.node(n))}leaves(){let n,e=[],r=[this];for(;r.length;){let i=r.shift();i.isGroupNode?(n=i.metaGraph,n.nodes().forEach(o=>r.push(n.node(o)))):e.push(i.name)}return e}}class Rit{constructor(n,e){this.v=n,this.w=e,this.baseEdgeList=[],this.inbound=null,this.name=null}addBaseEdge(n,e){this.baseEdgeList.push(n)}}function eN(t,n={}){return new jit(t,n)}function nN(t,n){return new Rit(t,n)}function $1(t,n,e){const r=e||{},i=new Oit.Graph(r);return i.setGraph({name:t,rankdir:r.rankdir,type:n,align:r.align}),i}class Fit{constructor(n={}){this.graphOptions=n,this.index={},this.graphOptions.compound=!0,this.root=eN(Vu,this.graphOptions),this.index[Vu]=this.root}getNodeMap(){return this.index}node(n){return this.index[n]}setNode(n,e){this.index[n]=e}getBridgeGraph(n){const e=this.index[n];if(!e)throw Error("Could not find node in hierarchy: "+n);if(!("metaGraph"in e))return null;const r=e;if(r.bridgeGraph)return r.bridgeGraph;const i=$1(WT,Wu.BRIDGE,this.graphOptions);if(r.bridgeGraph=i,!e.parentNode||!("metaGraph"in e.parentNode))return i;const o=e.parentNode;return[o.metaGraph,this.getBridgeGraph(o.name)].forEach(a=>{a.edges().filter(s=>s.v===n||s.w===n).forEach(s=>{const u=s.w===n;a.edge(s).baseEdgeList.forEach(c=>{const[l,h]=u?[c.w,s.v]:[c.v,s.w],f=this.getChildName(n,l),d={v:u?h:f,w:u?f:h};let p=i.edge(d);p||(p=nN(d.v,d.w),p.inbound=u,i.setEdge(d.v,d.w,p)),p.addBaseEdge(c,this)})})}),i}getChildName(n,e){let r=this.index[e];for(;r;){if(r.parentNode&&r.parentNode.name===n)return r.name;r=r.parentNode}throw Error("Could not find immediate child for descendant: "+e)}getPredecessors(n){const e=this.index[n];if(!e)throw Error("Could not find node with name: "+n);return this.getOneWayEdges(e,!0)}getSuccessors(n){const e=this.index[n];if(!e)throw Error("Could not find node with name: "+n);return this.getOneWayEdges(e,!1)}getOneWayEdges(n,e){const r=[];if(!n.parentNode||!n.parentNode.isGroupNode)return r;const i=n.parentNode,o=i.metaGraph,a=this.getBridgeGraph(i.name);return pS(o,n,e,r),pS(a,n,e,r),r}}function Bit(t,n){const{rankDirection:e,align:r}=n,i=new Fit({rankdir:e,align:r});return function(o,a){Object.keys(a.nodes).forEach(s=>{const u=a.nodes[s],c=u.path;let l=o.root;l.depth=Math.max(c.length,l.depth);for(let h=0;h<c.length&&(l.depth=Math.max(l.depth,c.length-h),l.cardinality+=u.cardinality,h!==c.length-1);h++){const f=c[h];let d=o.node(f);d||(d=eN(f,o.graphOptions),d.path=u.path.slice(0,h+1),d.parentNode=l,o.setNode(f,d),l.metaGraph.setNode(f,d)),l=d}o.setNode(u.name,u),u.parentNode=l,l.metaGraph.setNode(u.name,u)})}(i,t),function(o,a){const s=o.getNodeMap();let u=[],c=[];const l=(h,f)=>{let d=0;for(;h;)f[d++]=h.name,h=h.parentNode;return d-1};a.edges.forEach(h=>{u=[],c=[];let f=l(a.nodes[h.v],u),d=l(a.nodes[h.w],c);for(;u[f]===c[d];)if(f--,d--,f<0||d<0)throw Error("No difference found between ancestor paths.");const p=s[u[f+1]],g=u[f],v=c[d];let m=p.metaGraph.edge(g,v);m||(m=nN(g,v),p.metaGraph.setEdge(g,v,m)),m.addBaseEdge(h,o)})}(i,t),i}function pS(t,n,e,r){(e?t.inEdges(n.name):t.outEdges(n.name)).forEach(i=>{const o=t.edge(i);r.push(o)})}class zit{constructor(n){this.hierarchy=n,this.index={},this.hasSubHierarchy={},this.root=new vS(this.hierarchy.root,this.hierarchy.graphOptions),this.index[n.root.name]=this.root,this.buildSubHierarchy(n.root.name),this.root.expanded=!0}getRenderInfoNodes(){return Object.values(this.index)}getSubHierarchy(){return this.hasSubHierarchy}buildSubHierarchy(n){if(n in this.hasSubHierarchy)return;this.hasSubHierarchy[n]=!0;const e=this.index[n];if(e.node.type!==Rr.META)return;const r=e,i=r.node.metaGraph,o=r.coreGraph;i.nodes().forEach(l=>{const h=this.getOrCreateRenderNodeByName(l);o.setNode(l,h)}),i.edges().forEach(l=>{const h=i.edge(l),f=new gS(h);o.setEdge(l.v,l.w,f)});const a=r.node.parentNode;if(!a)return;const s=this.getRenderNodeByName(a.name),u=(l,...h)=>h.concat([l?"IN":"OUT"]).join("~~"),c=this.hierarchy.getBridgeGraph(n);c.edges().forEach(l=>{const h=c.edge(l),f=!!i.node(l.w),[d,p]=f?[l.w,l.v]:[l.v,l.w],g=w=>{const E=f?{v:w,w:n}:{v:n,w};return s.coreGraph.edge(E)};let v=g(p);v||(v=g(u(f,p,a.name)));const m=u(f,n),y=u(f,p,n);let b=o.node(y);if(!b){let w=o.node(m);if(!w){const M={name:m,type:Rr.BRIDGE,isGroupNode:!1,cardinality:0,parentNode:null,include:Is.UNSPECIFIED,inbound:f,attr:{}};w=new sd(M),this.index[m]=w,o.setNode(m,w)}const E={name:y,type:Rr.BRIDGE,isGroupNode:!1,cardinality:1,parentNode:null,include:Is.UNSPECIFIED,inbound:f,attr:{}};b=new sd(E),this.index[y]=b,o.setNode(y,b),o.setParent(y,m),w.node.cardinality++}const x=new gS(h);x.adjoiningMetaEdge=v,f?o.setEdge(y,d,x):o.setEdge(d,y,x)})}getOrCreateRenderNodeByName(n){if(!n)return null;if(n in this.index)return this.index[n];const e=this.getNodeByName(n);return e?(this.index[n]=e.isGroupNode?new vS(e,this.hierarchy.graphOptions):new sd(e),this.index[n]):null}getRenderNodeByName(n){return this.index[n]}getNodeByName(n){return this.hierarchy.node(n)}}class sd{constructor(n){this.node=n,this.expanded=!1,this.x=0,this.y=0,this.coreBox={width:0,height:0},this.outboxWidth=0,this.labelOffset=0,this.radius=0,this.labelHeight=0,this.paddingTop=0,this.paddingLeft=0,this.paddingRight=0,this.paddingBottom=0,this.width=n.width||0,this.height=n.height||0,this.displayName=n.name,this.attr=n.attr}}class gS{constructor(n){this.metaEdge=n,this.adjoiningMetaEdge=null,this.weight=1,this.points=[]}}class vS extends sd{constructor(n,e){super(n);const r=n.metaGraph.graph();e.compound=!0,this.coreGraph=$1(r.name,Wu.CORE,e)}}function rN(t,n){t.node.isGroupNode&&function(e,r){const i=Cm(r);e.coreGraph.nodes().map(o=>e.coreGraph.node(o)).forEach(o=>{var a,s,u,c,l,h;const{height:f,width:d}=o;switch(o.node.type){case Rr.NODE:Object.assign(o,i.nodeSize.node),o.height=f||i.nodeSize.node.height,o.width=d||i.nodeSize.node.width;break;case Rr.BRIDGE:Object.assign(o,i.nodeSize.bridge);break;case Rr.META:o.expanded?rN(o,r):(Object.assign(o,i.nodeSize.meta),o.height=i.nodeSize.meta.height,o.width=i.nodeSize.meta.width);break;default:throw Error("Unrecognized node type: "+o.node.type)}if(!o.expanded){const p=o.attr;(function(g,v=!1){if(g.coreBox.width=g.width,g.coreBox.height=g.height,!v){const m=`${g.displayName}`.length,y=3;g.width=Math.max(g.coreBox.width,m*y)}})(o,r&&(o.node.type===0&&!!(!((s=(a=r==null?void 0:r.nodeSize)===null||a===void 0?void 0:a.meta)===null||s===void 0)&&s.width)||o.node.type===1&&(!!(!((c=(u=r==null?void 0:r.nodeSize)===null||u===void 0?void 0:u.node)===null||c===void 0)&&c.width)||!!p.width)||o.node.type===2&&!!(!((h=(l=r==null?void 0:r.nodeSize)===null||l===void 0?void 0:l.bridge)===null||h===void 0)&&h.width)))}})}(t,n),t.node.type===Rr.META&&function(e,r){const i=Cm(r),o=i.subScene.meta;Object.assign(e,o);const{nodeSep:a,rankSep:s,edgeSep:u,align:c}=i.graph.meta,l={nodesep:a,ranksep:s,edgesep:u,align:c};Object.assign(e.coreBox,function(d,p){const{ranksep:g,nodesep:v,edgesep:m,align:y}=p;Object.assign(d.graph(),{ranksep:g,nodesep:v,edgesep:m,align:y});const b=[];if(d.nodes().forEach(_=>{d.node(_).node.type!==Rr.BRIDGE&&b.push(_)}),!b.length)return{width:0,height:0};Nit(d);let x=1/0,w=1/0,E=-1/0,M=-1/0;return b.forEach(_=>{const k=d.node(_),S=.5*k.width,A=k.x-S,C=k.x+S;x=A<x?A:x,E=C>E?C:E;const I=.5*k.height,N=k.y-I,D=k.y+I;w=N<w?N:w,M=D>M?D:M}),d.edges().forEach(_=>{const k=d.edge(_),S=d.node(k.metaEdge.v),A=d.node(k.metaEdge.w);if(k.points.length===3&&function(N){let D=mS(N[0],N[1]);for(let P=1;P<N.length-1;P++){const j=mS(N[P],N[P+1]);if(Math.abs(j-D)>1)return!1;D=j}return!0}(k.points)){if(S!=null){const N=S.expanded?S.x:Bm(S);k.points[0].x=N}if(A!=null){const N=A.expanded?A.x:Bm(A);k.points[2].x=N}k.points=[k.points[0],k.points[1]]}const C=k.points[k.points.length-2];A!=null&&(k.points[k.points.length-1]=yS(C,A));const I=k.points[1];S!=null&&(k.points[0]=yS(I,S)),k.points.forEach(N=>{x=N.x<x?N.x:x,E=N.x>E?N.x:E,w=N.y<w?N.y:w,M=N.y>M?N.y:M})}),d.nodes().forEach(_=>{const k=d.node(_);k.x-=x,k.y-=w}),d.edges().forEach(_=>{d.edge(_).points.forEach(k=>{k.x-=x,k.y-=w})}),{width:E-x,height:M-w}}(e.coreGraph,l));let h=0;e.coreGraph.nodeCount()>0&&h++;const f=h<=1?0:h;e.coreBox.width+=f+f,e.coreBox.height=o.labelHeight+e.coreBox.height,e.width=e.coreBox.width+o.paddingLeft+o.paddingRight,e.height=e.paddingTop+e.coreBox.height+e.paddingBottom}(t,n)}function mS(t,n){const e=n.x-t.x,r=n.y-t.y;return 180*Math.atan(r/e)/Math.PI}function Bm(t){return t.expanded?t.x:t.x-t.width/2+0+t.coreBox.width/2}function yS(t,n){const e=n.expanded?n.x:Bm(n),r=n.y,i=t.x-e,o=t.y-r;let a,s,u=n.expanded?n.width:n.coreBox.width,c=n.expanded?n.height:n.coreBox.height;return Math.abs(o)*u/2>Math.abs(i)*c/2?(o<0&&(c=-c),a=o===0?0:c/2*i/o,s=c/2):(i<0&&(u=-u),a=u/2,s=i===0?0:u/2*o/i),{x:e+a,y:r+s}}function Git(t,n,e){var r,i,o,a;const s=t.nodes.filter((h,f,d)=>d.findIndex(p=>p.id===h.id)!==f).map(h=>h.id);if(s.length)throw new Error(`Duplicated ids found: ${s.join(", ")}`);const u=function(h){const f={nodes:[]},d=h.compound,p=Object.keys(d||{}),g=new Map,v=(y,b=[])=>{if(g.has(y))return g.get(y);for(let x=0;x<p.length;x++){let w=p[x];if(d&&d[w].indexOf(y)!==-1)return b.unshift(w),v(w,b)}return b.length===0&&g.set(y,b),b},m=y=>h.edges.filter(b=>b.w===y).map(b=>({name:b.v}));return h.nodes.forEach(y=>{const b=y.id,x=[...v(b),b];let w=m(b);f.nodes.push({name:b,path:x,inputs:w,width:y.width,height:y.height,attr:Object.assign({},y)})}),f}(t),c=function(h,f){const d=(g,v)=>{for(let m of v.values())if(m.includes(g))return!0;return!1},p=(g,v=[])=>{if(Object.keys(g).length===0)return[...new Set(v)];const m=new Map(Object.keys(g).map(b=>[b,g[b]])),y={};for(let[b,x]of m)d(b,m)?y[b]=x:v=v.concat(b,x);return p(y,v)};return p(h).filter(g=>f.includes(g))}(t.compound||{},(n==null?void 0:n.expanded)||[]),l=function(h,f){return function(d){return new zit(d)}(Bit(Lit(h),f))}(u,{rankDirection:((i=(r=e==null?void 0:e.graph)===null||r===void 0?void 0:r.meta)===null||i===void 0?void 0:i.rankDir)||(n==null?void 0:n.rankDirection)||Ud.graph.meta.rankDir,align:((a=(o=e==null?void 0:e.graph)===null||o===void 0?void 0:o.meta)===null||a===void 0?void 0:a.align)||Ud.graph.meta.align});return function(h,f){f.forEach(d=>{const p=h.getRenderInfoNodes().find(m=>m.displayName===d);let g=p&&p.node&&p.node.name||"";const v=h.getRenderNodeByName(g);if(!v)throw new Error(`No nodes found: ${g}`);v.expanded=!0,h.buildSubHierarchy(g)})}(l,c),rN(l.root,e),iN(l.root)}function Uit(t,n=!1){const e=JSON.parse(JSON.stringify(t)),r={nodes:[e],edges:[...e.edges]};return e.nodes.forEach(function i(o){(o.type===0||o.type===1)&&r.nodes.push(o),o.type===0&&(r.edges=r.edges.concat(o.edges)),Array.isArray(o.nodes)&&o.nodes.forEach(i)}),n&&r.nodes.forEach(i=>{const o=r.nodes.find(a=>a.id===i.parentNodeName);if(o){const a=o.x-o.width/2+o.paddingLeft,s=o.y-o.height/2+o.labelHeight+o.paddingTop;o.id!==Vu&&(i.x+=a,i.y+=s),i.type===0&&i.edges.forEach(u=>{u.points.forEach(c=>{c.x+=i.x-i.width/2+i.paddingLeft,c.y+=i.y-i.height/2+i.labelHeight+i.paddingTop})})}}),r}function Yit(t,n,e,r){var i,o;let a=[];const s=((i=e.find(h=>h.id===t))===null||i===void 0?void 0:i.path)||[],u=((o=e.find(h=>h.id===n))===null||o===void 0?void 0:o.path)||[],c=[Vu,...s].slice(0,s.length).reverse(),l=[Vu,...u].slice(0,u.length);return c.forEach(h=>{const f=e.find(d=>d.id===h);a=a.concat(f.edges.filter(d=>d.baseEdgeList.some(p=>p.v===((r==null?void 0:r.v)||t)&&p.w===((r==null?void 0:r.w)||n))))}),l.filter(h=>!c.includes(h)).forEach(h=>{const f=e.find(d=>d.id===h);a=a.concat(f.edges.filter(d=>d.baseEdgeList.some(p=>p.v===((r==null?void 0:r.v)||t)&&p.w===((r==null?void 0:r.w)||n))))}),a}function iN(t){const n=t.coreGraph.nodes().map(r=>t.coreGraph.node(r));return Object.assign(Object.assign({},bS(t)),{expanded:t.expanded,nodes:t.expanded?(e=n,e.map(r=>r.node.type===Rr.META?iN(r):bS(r))):[],edges:t.expanded?Vit(t):[]});var e}function bS(t){return{id:t.node.name,name:t.node.name,type:t.node.type,cardinality:t.node.cardinality,attr:t.attr,parentNodeName:t.node.parentNode?t.node.parentNode.name:null,coreBox:Object.assign({},t.coreBox),x:t.x,y:t.y,width:t.width,height:t.height,radius:t.radius,labelHeight:t.labelHeight,labelOffset:t.labelOffset,outboxWidth:t.outboxWidth,paddingLeft:t.paddingLeft,paddingTop:t.paddingTop,paddingRight:t.paddingRight,paddingBottom:t.paddingBottom,path:t.node.path}}function Vit(t){return t.coreGraph.edges().map(n=>({renderInfoEdge:t.coreGraph.edge(n),edge:n})).filter(({renderInfoEdge:n})=>n.metaEdge).map(({edge:n,renderInfoEdge:e})=>{const r=function(i,o){const a=o.points.map(s=>Object.assign({},s));if(o.adjoiningMetaEdge){const s=o.adjoiningMetaEdge.points,u=o.metaEdge.inbound,c=u?s[s.length-1]:s[0],l=a[u?0:a.length-1],h=i.x-i.width/2,f=i.y-i.height/2,d=c.x-h,p=c.y-f,g=-i.paddingLeft,v=-(i.paddingTop+i.labelHeight);l.x=d+g,l.y=p+v}return a}(t,e);return{adjoiningEdge:e.adjoiningMetaEdge?{w:e.adjoiningMetaEdge.metaEdge.w,v:e.adjoiningMetaEdge.metaEdge.v}:null,inbound:e.metaEdge.inbound,w:n.w,v:n.v,points:r,weight:e.weight,baseEdgeList:e.metaEdge.baseEdgeList,parentNodeName:t.node.name}})}const Wit=Object.freeze(Object.defineProperty({__proto__:null,BRIDGE_GRAPH_NAME:WT,get GraphType(){return Wu},get HierarchyNodeType(){return Im},get InclusionType(){return Is},LAYOUT_CONFIG:Ud,get NodeType(){return Rr},ROOT_NAME:Vu,buildGraph:Git,flatGraph:Uit,getEdges:Yit,mergeConfig:Cm},Symbol.toStringTag,{value:"Module"})),Xit=xo(Wit);var Hit=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ai=bt&&bt.__assign||function(){return Ai=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ai.apply(this,arguments)},su=bt&&bt.__spreadArray||function(t,n,e){if(e||arguments.length===2)for(var r=0,i=n.length,o;r<i;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};Object.defineProperty(th,"__esModule",{value:!0});th.DagreCompoundLayout=void 0;var qit=Yn,oi=Xit,_f=Ln(),Zit=function(t){Hit(n,t);function n(e){var r=t.call(this)||this;return r.rankdir="TB",r.nodesep=50,r.edgesep=5,r.ranksep=50,r.controlPoints=!0,r.anchorPoint=!0,r.nodes=[],r.edges=[],r.combos=[],r.onLayoutEnd=function(){},r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{rankdir:"TB",align:void 0,begin:void 0,nodeSize:void 0,nodesep:50,ranksep:50,controlPoints:!0,anchorPoint:!0}},n.prototype.init=function(e){var r=e.hiddenNodes||[],i=e.hiddenEdges||[],o=e.hiddenCombos||[];this.nodes=this.getDataByOrder((e.nodes||[]).concat(r)),this.edges=this.getDataByOrder((e.edges||[]).concat(i)),this.combos=(e.combos||[]).concat(o.map(function(a){return Ai(Ai({},a),{collapsed:!0})}))},n.prototype.execute=function(){var e=this,r=e.nodes,i=e.edges;if(r){var o=e.getLayoutConfig(),a=o.graphDef,s=o.graphOption,u=o.graphSettings,c=(0,oi.buildGraph)(a,s,u),l=(0,oi.flatGraph)(c,!0);return this.updatePosition(l),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:r,edges:i}}},n.prototype.getNodePath=function(e){var r=this,i=r.nodes,o=r.combos,a=i.find(function(u){return u.id===e}),s=function(u,c){c===void 0&&(c=[]);var l=o.find(function(h){return h.id===u});return l?(c.unshift(u),l.parentId?s(l.parentId,c):c):c};return a&&a.comboId?s(a.comboId,[e]):[e]},n.prototype.getLayoutConfig=function(){var e,r,i,o=this,a=o.nodes,s=o.edges,u=o.combos,c=o.nodeSize,l=o.rankdir,h=o.align,f=o.edgesep,d=o.nodesep,p=o.ranksep,g=o.settings,v=(u||[]).reduce(function(P,j){var L=a.filter(function(V){return V.comboId===j.id}).map(function(V){return V.id}),R=(u||[]).filter(function(V){return V.parentId===j.id}).map(function(V){return V.id});return(L.length||R.length)&&(P[j.id]=su(su([],L,!0),R,!0)),P},{}),m;c?(0,_f.isArray)(c)?m=function(){return c}:m=function(){return[c,c]}:m=function(P){return P&&P.size?(0,_f.isArray)(P.size)?P.size:(0,_f.isObject)(P.size)?[P.size.width||40,P.size.height||40]:[P.size,P.size]:[40,40]};var y=function(P){return P&&P.size?(0,_f.isArray)(P.size)?P.size:[P.size,P.size]:[80,40]},b=y(u==null?void 0:u[0]),x=b[0],w=b[1],E=(r=(e=o.graphSettings)===null||e===void 0?void 0:e.subScene)===null||r===void 0?void 0:r.meta,M=((i=u.find(function(P){return!P.collapsed}))===null||i===void 0?void 0:i.padding)||[20,20,20,20],_=M[0],k=M[1],S=M[2],A=M[3],C={compound:v,nodes:su([],(a||[]).map(function(P){var j=m(P),L=j[0],R=j[1];return Ai(Ai({},P),{width:L,height:R})}),!0),edges:su([],(s||[]).map(function(P){return Ai(Ai({},P),{v:P.source,w:P.target})}),!0)},I={expanded:(u||[]).filter(function(P){return!P.collapsed}).map(function(P){return P.id})},N={graph:{meta:{align:h,rankDir:l,nodeSep:d,edgeSep:f,rankSep:p}},subScene:{meta:{paddingTop:_||(E==null?void 0:E.paddingTop)||20,paddingRight:k||(E==null?void 0:E.paddingRight)||20,paddingBottom:S||(E==null?void 0:E.paddingBottom)||20,paddingLeft:A||(E==null?void 0:E.paddingLeft)||20,labelHeight:0}},nodeSize:{meta:{width:x,height:w}}},D=(0,oi.mergeConfig)(g,Ai({},(0,oi.mergeConfig)(N,oi.LAYOUT_CONFIG)));return o.graphSettings=D,{graphDef:C,graphOption:I,graphSettings:D}},n.prototype.updatePosition=function(e){var r=e.nodes,i=e.edges;this.updateNodePosition(r,i),this.updateEdgePosition(r,i)},n.prototype.getBegin=function(e,r){var i=this,o=i.begin,a=[0,0];if(o){var s=1/0,u=1/0;e.forEach(function(c){s>c.x&&(s=c.x),u>c.y&&(u=c.y)}),r.forEach(function(c){c.points.forEach(function(l){s>l.x&&(s=l.x),u>l.y&&(u=l.y)})}),a[0]=o[0]-s,a[1]=o[1]-u}return a},n.prototype.updateNodePosition=function(e,r){var i=this,o=i.combos,a=i.nodes,s=i.edges,u=i.anchorPoint,c=i.graphSettings,l=this.getBegin(e,r);e.forEach(function(h){var f,d=h.x,p=h.y,g=h.id,v=h.type,m=h.coreBox;if(v===oi.HierarchyNodeType.META&&g!==oi.ROOT_NAME){var y=o.findIndex(function(M){return M.id===g}),b=(f=c==null?void 0:c.subScene)===null||f===void 0?void 0:f.meta;o[y].offsetX=d+l[0],o[y].offsetY=p+l[1],o[y].fixSize=[m.width,m.height],o[y].fixCollapseSize=[m.width,m.height],h.expanded?o[y].padding=[b==null?void 0:b.paddingTop,b==null?void 0:b.paddingRight,b==null?void 0:b.paddingBottom,b==null?void 0:b.paddingLeft]:o[y].padding=[0,0,0,0]}else if(v===oi.HierarchyNodeType.OP){var y=a.findIndex(function(_){return _.id===g});if(a[y].x=d+l[0],a[y].y=p+l[1],u){var x=[],w=r.filter(function(_){return _.v===g}),E=r.filter(function(_){return _.w===g});w.length>0&&w.forEach(function(_){var k=_.points[0],S=(k.x-d)/h.width+.5,A=(k.y-p)/h.height+.5;x.push([S,A]),_.baseEdgeList.forEach(function(C){var I=s.find(function(N){return N.source===C.v&&N.target===C.w});I&&(I.sourceAnchor=x.length-1)})}),E.length>0&&E.forEach(function(_){var k=_.points[_.points.length-1],S=(k.x-d)/h.width+.5,A=(k.y-p)/h.height+.5;x.push([S,A]),_.baseEdgeList.forEach(function(C){var I=s.find(function(N){return N.source===C.v&&N.target===C.w});I&&(I.targetAnchor=x.length-1)})}),a[y].anchorPoints=x.length>0?x:a[y].anchorPoints||[]}}})},n.prototype.updateEdgePosition=function(e,r){var i=this,o=i.combos,a=i.edges,s=i.controlPoints,u=this.getBegin(e,r);s&&(o.forEach(function(c){c.inEdges=[],c.outEdges=[]}),a.forEach(function(c){var l,h,f,d,p=e.find(function(M){return M.id===c.source}),g=e.find(function(M){return M.id===c.target}),v=[],m=[];if(p&&g)m=(0,oi.getEdges)(p==null?void 0:p.id,g==null?void 0:g.id,e);else if(!p||!g){var y=i.getNodePath(c.source),b=i.getNodePath(c.target),x=y.reverse().slice(p?0:1).find(function(M){return e.find(function(_){return _.id===M})}),w=b.reverse().slice(g?0:1).find(function(M){return e.find(function(_){return _.id===M})});p=e.find(function(M){return M.id===x}),g=e.find(function(M){return M.id===w}),m=(0,oi.getEdges)(p==null?void 0:p.id,g==null?void 0:g.id,e,{v:c.source,w:c.target})}if(v=m.reduce(function(M,_){return su(su([],M,!0),_.points.map(function(k){return Ai(Ai({},k),{x:k.x+u[0],y:k.y+u[1]})}),!0)},[]),v=v.slice(1,-1),c.controlPoints=v,(g==null?void 0:g.type)===oi.NodeType.META){var E=o.findIndex(function(M){return M.id===(g==null?void 0:g.id)});if(!o[E]||!((l=o[E].inEdges)===null||l===void 0)&&l.some(function(M){return M.source===p.id&&M.target===g.id}))return;(h=o[E].inEdges)===null||h===void 0||h.push({source:p.id,target:g.id,controlPoints:v})}if((p==null?void 0:p.type)===oi.NodeType.META){var E=o.findIndex(function(_){return _.id===(p==null?void 0:p.id)});if(!o[E]||!((f=o[E].outEdges)===null||f===void 0)&&f.some(function(_){return _.source===p.id&&_.target===g.id}))return;(d=o[E].outEdges)===null||d===void 0||d.push({source:p.id,target:g.id,controlPoints:v})}}))},n.prototype.getType=function(){return"dagreCompound"},n.prototype.getDataByOrder=function(e){return e.every(function(r){return r.layoutOrder!==void 0})||e.forEach(function(r,i){r.layoutOrder=i}),e.sort(function(r,i){return r.layoutOrder-i.layoutOrder})},n}(qit.Base);th.DagreCompoundLayout=Zit;var tb={},eg={},eb={};const Kit=Object.prototype.toString;function gr(t){const n=Kit.call(t);return n.endsWith("Array]")&&!n.includes("Big")}function Qit(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!gr(t))throw new TypeError("input must be an array");if(t.length===0)throw new TypeError("input must not be empty");var e=n.fromIndex,r=e===void 0?0:e,i=n.toIndex,o=i===void 0?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],s=r+1;s<o;s++)t[s]>a&&(a=t[s]);return a}function Jit(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!gr(t))throw new TypeError("input must be an array");if(t.length===0)throw new TypeError("input must not be empty");var e=n.fromIndex,r=e===void 0?0:e,i=n.toIndex,o=i===void 0?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],s=r+1;s<o;s++)t[s]<a&&(a=t[s]);return a}function xS(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(gr(t)){if(t.length===0)throw new TypeError("input must not be empty")}else throw new TypeError("input must be an array");var e;if(n.output!==void 0){if(!gr(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=Jit(t),i=Qit(t);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,a=o===void 0?n.autoMinMax?r:0:o,s=n.max,u=s===void 0?n.autoMinMax?i:1:s;if(a>=u)throw new RangeError("min option must be smaller than max option");for(var c=(u-a)/(i-r),l=0;l<t.length;l++)e[l]=(t[l]-r)*c+a;return e}const kf=" ".repeat(2),oN=" ".repeat(4);function $it(){return aN(this)}function aN(t,n={}){const{maxRows:e=15,maxColumns:r=10,maxNumSize:i=8,padMinus:o="auto"}=n;return`${t.constructor.name} {
${kf}[
${oN}${tot(t,e,r,i,o)}
${kf}]
${kf}rows: ${t.rows}
${kf}columns: ${t.columns}
}`}function tot(t,n,e,r,i){const{rows:o,columns:a}=t,s=Math.min(o,n),u=Math.min(a,e),c=[];if(i==="auto"){i=!1;t:for(let l=0;l<s;l++)for(let h=0;h<u;h++)if(t.get(l,h)<0){i=!0;break t}}for(let l=0;l<s;l++){let h=[];for(let f=0;f<u;f++)h.push(eot(t.get(l,f),r,i));c.push(`${h.join(" ")}`)}return u!==a&&(c[c.length-1]+=` ... ${a-e} more columns`),s!==o&&c.push(`... ${o-n} more rows`),c.join(`
${oN}`)}function eot(t,n,e){return(t>=0&&e?` ${wS(t,n-1)}`:wS(t,n)).padEnd(n)}function wS(t,n){let e=t.toString();if(e.length<=n)return e;let r=t.toFixed(n);if(r.length>n&&(r=t.toFixed(Math.max(0,n-(r.length-n)))),r.length<=n&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let i=t.toExponential(n);return i.length>n&&(i=t.toExponential(Math.max(0,n-(i.length-n)))),i.slice(0)}function not(t,n){t.prototype.add=function(e){return typeof e=="number"?this.addS(e):this.addM(e)},t.prototype.addS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)+e);return this},t.prototype.addM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)+e.get(r,i));return this},t.add=function(e,r){return new n(e).add(r)},t.prototype.sub=function(e){return typeof e=="number"?this.subS(e):this.subM(e)},t.prototype.subS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)-e);return this},t.prototype.subM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)-e.get(r,i));return this},t.sub=function(e,r){return new n(e).sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(e){return typeof e=="number"?this.mulS(e):this.mulM(e)},t.prototype.mulS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)*e);return this},t.prototype.mulM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)*e.get(r,i));return this},t.mul=function(e,r){return new n(e).mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(e){return typeof e=="number"?this.divS(e):this.divM(e)},t.prototype.divS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)/e);return this},t.prototype.divM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)/e.get(r,i));return this},t.div=function(e,r){return new n(e).div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(e){return typeof e=="number"?this.modS(e):this.modM(e)},t.prototype.modS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)%e);return this},t.prototype.modM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)%e.get(r,i));return this},t.mod=function(e,r){return new n(e).mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(e){return typeof e=="number"?this.andS(e):this.andM(e)},t.prototype.andS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)&e);return this},t.prototype.andM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)&e.get(r,i));return this},t.and=function(e,r){return new n(e).and(r)},t.prototype.or=function(e){return typeof e=="number"?this.orS(e):this.orM(e)},t.prototype.orS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)|e);return this},t.prototype.orM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)|e.get(r,i));return this},t.or=function(e,r){return new n(e).or(r)},t.prototype.xor=function(e){return typeof e=="number"?this.xorS(e):this.xorM(e)},t.prototype.xorS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)^e);return this},t.prototype.xorM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)^e.get(r,i));return this},t.xor=function(e,r){return new n(e).xor(r)},t.prototype.leftShift=function(e){return typeof e=="number"?this.leftShiftS(e):this.leftShiftM(e)},t.prototype.leftShiftS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)<<e);return this},t.prototype.leftShiftM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)<<e.get(r,i));return this},t.leftShift=function(e,r){return new n(e).leftShift(r)},t.prototype.signPropagatingRightShift=function(e){return typeof e=="number"?this.signPropagatingRightShiftS(e):this.signPropagatingRightShiftM(e)},t.prototype.signPropagatingRightShiftS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)>>e);return this},t.prototype.signPropagatingRightShiftM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)>>e.get(r,i));return this},t.signPropagatingRightShift=function(e,r){return new n(e).signPropagatingRightShift(r)},t.prototype.rightShift=function(e){return typeof e=="number"?this.rightShiftS(e):this.rightShiftM(e)},t.prototype.rightShiftS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)>>>e);return this},t.prototype.rightShiftM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,this.get(r,i)>>>e.get(r,i));return this},t.rightShift=function(e,r){return new n(e).rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,~this.get(e,r));return this},t.not=function(e){return new n(e).not()},t.prototype.abs=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.abs(this.get(e,r)));return this},t.abs=function(e){return new n(e).abs()},t.prototype.acos=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.acos(this.get(e,r)));return this},t.acos=function(e){return new n(e).acos()},t.prototype.acosh=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.acosh(this.get(e,r)));return this},t.acosh=function(e){return new n(e).acosh()},t.prototype.asin=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.asin(this.get(e,r)));return this},t.asin=function(e){return new n(e).asin()},t.prototype.asinh=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.asinh(this.get(e,r)));return this},t.asinh=function(e){return new n(e).asinh()},t.prototype.atan=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.atan(this.get(e,r)));return this},t.atan=function(e){return new n(e).atan()},t.prototype.atanh=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.atanh(this.get(e,r)));return this},t.atanh=function(e){return new n(e).atanh()},t.prototype.cbrt=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.cbrt(this.get(e,r)));return this},t.cbrt=function(e){return new n(e).cbrt()},t.prototype.ceil=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.ceil(this.get(e,r)));return this},t.ceil=function(e){return new n(e).ceil()},t.prototype.clz32=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.clz32(this.get(e,r)));return this},t.clz32=function(e){return new n(e).clz32()},t.prototype.cos=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.cos(this.get(e,r)));return this},t.cos=function(e){return new n(e).cos()},t.prototype.cosh=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.cosh(this.get(e,r)));return this},t.cosh=function(e){return new n(e).cosh()},t.prototype.exp=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.exp(this.get(e,r)));return this},t.exp=function(e){return new n(e).exp()},t.prototype.expm1=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.expm1(this.get(e,r)));return this},t.expm1=function(e){return new n(e).expm1()},t.prototype.floor=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.floor(this.get(e,r)));return this},t.floor=function(e){return new n(e).floor()},t.prototype.fround=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.fround(this.get(e,r)));return this},t.fround=function(e){return new n(e).fround()},t.prototype.log=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.log(this.get(e,r)));return this},t.log=function(e){return new n(e).log()},t.prototype.log1p=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.log1p(this.get(e,r)));return this},t.log1p=function(e){return new n(e).log1p()},t.prototype.log10=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.log10(this.get(e,r)));return this},t.log10=function(e){return new n(e).log10()},t.prototype.log2=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.log2(this.get(e,r)));return this},t.log2=function(e){return new n(e).log2()},t.prototype.round=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.round(this.get(e,r)));return this},t.round=function(e){return new n(e).round()},t.prototype.sign=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.sign(this.get(e,r)));return this},t.sign=function(e){return new n(e).sign()},t.prototype.sin=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.sin(this.get(e,r)));return this},t.sin=function(e){return new n(e).sin()},t.prototype.sinh=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.sinh(this.get(e,r)));return this},t.sinh=function(e){return new n(e).sinh()},t.prototype.sqrt=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.sqrt(this.get(e,r)));return this},t.sqrt=function(e){return new n(e).sqrt()},t.prototype.tan=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.tan(this.get(e,r)));return this},t.tan=function(e){return new n(e).tan()},t.prototype.tanh=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.tanh(this.get(e,r)));return this},t.tanh=function(e){return new n(e).tanh()},t.prototype.trunc=function(){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.trunc(this.get(e,r)));return this},t.trunc=function(e){return new n(e).trunc()},t.pow=function(e,r){return new n(e).pow(r)},t.prototype.pow=function(e){return typeof e=="number"?this.powS(e):this.powM(e)},t.prototype.powS=function(e){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.pow(this.get(r,i),e));return this},t.prototype.powM=function(e){if(e=n.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw new RangeError("Matrices dimensions must be equal");for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.set(r,i,Math.pow(this.get(r,i),e.get(r,i)));return this}}function li(t,n,e){let r=e?t.rows:t.rows-1;if(n<0||n>r)throw new RangeError("Row index out of range")}function hi(t,n,e){let r=e?t.columns:t.columns-1;if(n<0||n>r)throw new RangeError("Column index out of range")}function bu(t,n){if(n.to1DArray&&(n=n.to1DArray()),n.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return n}function xu(t,n){if(n.to1DArray&&(n=n.to1DArray()),n.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return n}function nb(t,n){if(!gr(n))throw new TypeError("row indices must be an array");for(let e=0;e<n.length;e++)if(n[e]<0||n[e]>=t.rows)throw new RangeError("row indices are out of range")}function rb(t,n){if(!gr(n))throw new TypeError("column indices must be an array");for(let e=0;e<n.length;e++)if(n[e]<0||n[e]>=t.columns)throw new RangeError("column indices are out of range")}function zm(t,n,e,r,i){if(arguments.length!==5)throw new RangeError("expected 4 arguments");if(Af("startRow",n),Af("endRow",e),Af("startColumn",r),Af("endColumn",i),n>e||r>i||n<0||n>=t.rows||e<0||e>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function ng(t,n=0){let e=[];for(let r=0;r<t;r++)e.push(n);return e}function Af(t,n){if(typeof n!="number")throw new TypeError(`${t} must be a number`)}function uu(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}function rot(t){let n=ng(t.rows);for(let e=0;e<t.rows;++e)for(let r=0;r<t.columns;++r)n[e]+=t.get(e,r);return n}function iot(t){let n=ng(t.columns);for(let e=0;e<t.rows;++e)for(let r=0;r<t.columns;++r)n[r]+=t.get(e,r);return n}function oot(t){let n=0;for(let e=0;e<t.rows;e++)for(let r=0;r<t.columns;r++)n+=t.get(e,r);return n}function aot(t){let n=ng(t.rows,1);for(let e=0;e<t.rows;++e)for(let r=0;r<t.columns;++r)n[e]*=t.get(e,r);return n}function sot(t){let n=ng(t.columns,1);for(let e=0;e<t.rows;++e)for(let r=0;r<t.columns;++r)n[r]*=t.get(e,r);return n}function uot(t){let n=1;for(let e=0;e<t.rows;e++)for(let r=0;r<t.columns;r++)n*=t.get(e,r);return n}function cot(t,n,e){const r=t.rows,i=t.columns,o=[];for(let a=0;a<r;a++){let s=0,u=0,c=0;for(let l=0;l<i;l++)c=t.get(a,l)-e[a],s+=c,u+=c*c;n?o.push((u-s*s/i)/(i-1)):o.push((u-s*s/i)/i)}return o}function lot(t,n,e){const r=t.rows,i=t.columns,o=[];for(let a=0;a<i;a++){let s=0,u=0,c=0;for(let l=0;l<r;l++)c=t.get(l,a)-e[a],s+=c,u+=c*c;n?o.push((u-s*s/r)/(r-1)):o.push((u-s*s/r)/r)}return o}function hot(t,n,e){const r=t.rows,i=t.columns,o=r*i;let a=0,s=0,u=0;for(let c=0;c<r;c++)for(let l=0;l<i;l++)u=t.get(c,l)-e,a+=u,s+=u*u;return n?(s-a*a/o)/(o-1):(s-a*a/o)/o}function fot(t,n){for(let e=0;e<t.rows;e++)for(let r=0;r<t.columns;r++)t.set(e,r,t.get(e,r)-n[e])}function dot(t,n){for(let e=0;e<t.rows;e++)for(let r=0;r<t.columns;r++)t.set(e,r,t.get(e,r)-n[r])}function pot(t,n){for(let e=0;e<t.rows;e++)for(let r=0;r<t.columns;r++)t.set(e,r,t.get(e,r)-n)}function got(t){const n=[];for(let e=0;e<t.rows;e++){let r=0;for(let i=0;i<t.columns;i++)r+=Math.pow(t.get(e,i),2)/(t.columns-1);n.push(Math.sqrt(r))}return n}function vot(t,n){for(let e=0;e<t.rows;e++)for(let r=0;r<t.columns;r++)t.set(e,r,t.get(e,r)/n[e])}function mot(t){const n=[];for(let e=0;e<t.columns;e++){let r=0;for(let i=0;i<t.rows;i++)r+=Math.pow(t.get(i,e),2)/(t.rows-1);n.push(Math.sqrt(r))}return n}function yot(t,n){for(let e=0;e<t.rows;e++)for(let r=0;r<t.columns;r++)t.set(e,r,t.get(e,r)/n[r])}function bot(t){const n=t.size-1;let e=0;for(let r=0;r<t.columns;r++)for(let i=0;i<t.rows;i++)e+=Math.pow(t.get(i,r),2)/n;return Math.sqrt(e)}function xot(t,n){for(let e=0;e<t.rows;e++)for(let r=0;r<t.columns;r++)t.set(e,r,t.get(e,r)/n)}class qe{static from1DArray(n,e,r){if(n*e!==r.length)throw new RangeError("data length does not match given dimensions");let i=new le(n,e);for(let o=0;o<n;o++)for(let a=0;a<e;a++)i.set(o,a,r[o*e+a]);return i}static rowVector(n){let e=new le(1,n.length);for(let r=0;r<n.length;r++)e.set(0,r,n[r]);return e}static columnVector(n){let e=new le(n.length,1);for(let r=0;r<n.length;r++)e.set(r,0,n[r]);return e}static zeros(n,e){return new le(n,e)}static ones(n,e){return new le(n,e).fill(1)}static rand(n,e,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{random:i=Math.random}=r;let o=new le(n,e);for(let a=0;a<n;a++)for(let s=0;s<e;s++)o.set(a,s,i());return o}static randInt(n,e,r={}){if(typeof r!="object")throw new TypeError("options must be an object");const{min:i=0,max:o=1e3,random:a=Math.random}=r;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(o))throw new TypeError("max must be an integer");if(i>=o)throw new RangeError("min must be smaller than max");let s=o-i,u=new le(n,e);for(let c=0;c<n;c++)for(let l=0;l<e;l++){let h=i+Math.round(a()*s);u.set(c,l,h)}return u}static eye(n,e,r){e===void 0&&(e=n),r===void 0&&(r=1);let i=Math.min(n,e),o=this.zeros(n,e);for(let a=0;a<i;a++)o.set(a,a,r);return o}static diag(n,e,r){let i=n.length;e===void 0&&(e=i),r===void 0&&(r=e);let o=Math.min(i,e,r),a=this.zeros(e,r);for(let s=0;s<o;s++)a.set(s,s,n[s]);return a}static min(n,e){n=this.checkMatrix(n),e=this.checkMatrix(e);let r=n.rows,i=n.columns,o=new le(r,i);for(let a=0;a<r;a++)for(let s=0;s<i;s++)o.set(a,s,Math.min(n.get(a,s),e.get(a,s)));return o}static max(n,e){n=this.checkMatrix(n),e=this.checkMatrix(e);let r=n.rows,i=n.columns,o=new this(r,i);for(let a=0;a<r;a++)for(let s=0;s<i;s++)o.set(a,s,Math.max(n.get(a,s),e.get(a,s)));return o}static checkMatrix(n){return qe.isMatrix(n)?n:new le(n)}static isMatrix(n){return n!=null&&n.klass==="Matrix"}get size(){return this.rows*this.columns}apply(n){if(typeof n!="function")throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)n.call(this,e,r);return this}to1DArray(){let n=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)n.push(this.get(e,r));return n}to2DArray(){let n=[];for(let e=0;e<this.rows;e++){n.push([]);for(let r=0;r<this.columns;r++)n[e].push(this.get(e,r))}return n}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let n=0;n<this.rows;n++)for(let e=0;e<=n;e++)if(this.get(n,e)!==this.get(e,n))return!1;return!0}return!1}isEchelonForm(){let n=0,e=0,r=-1,i=!0,o=!1;for(;n<this.rows&&i;){for(e=0,o=!1;e<this.columns&&o===!1;)this.get(n,e)===0?e++:this.get(n,e)===1&&e>r?(o=!0,r=e):(i=!1,o=!0);n++}return i}isReducedEchelonForm(){let n=0,e=0,r=-1,i=!0,o=!1;for(;n<this.rows&&i;){for(e=0,o=!1;e<this.columns&&o===!1;)this.get(n,e)===0?e++:this.get(n,e)===1&&e>r?(o=!0,r=e):(i=!1,o=!0);for(let a=e+1;a<this.rows;a++)this.get(n,a)!==0&&(i=!1);n++}return i}echelonForm(){let n=this.clone(),e=0,r=0;for(;e<n.rows&&r<n.columns;){let i=e;for(let o=e;o<n.rows;o++)n.get(o,r)>n.get(i,r)&&(i=o);if(n.get(i,r)===0)r++;else{n.swapRows(e,i);let o=n.get(e,r);for(let a=r;a<n.columns;a++)n.set(e,a,n.get(e,a)/o);for(let a=e+1;a<n.rows;a++){let s=n.get(a,r)/n.get(e,r);n.set(a,r,0);for(let u=r+1;u<n.columns;u++)n.set(a,u,n.get(a,u)-n.get(e,u)*s)}e++,r++}}return n}reducedEchelonForm(){let n=this.echelonForm(),e=n.columns,r=n.rows,i=r-1;for(;i>=0;)if(n.maxRow(i)===0)i--;else{let o=0,a=!1;for(;o<r&&a===!1;)n.get(i,o)===1?a=!0:o++;for(let s=0;s<i;s++){let u=n.get(s,o);for(let c=o;c<e;c++){let l=n.get(s,c)-u*n.get(i,c);n.set(s,c,l)}}i--}return n}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=n;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let i=new le(this.rows*e,this.columns*r);for(let o=0;o<e;o++)for(let a=0;a<r;a++)i.setSubMatrix(this,this.rows*o,this.columns*a);return i}fill(n){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,n);return this}neg(){return this.mulS(-1)}getRow(n){li(this,n);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(n,r));return e}getRowVector(n){return le.rowVector(this.getRow(n))}setRow(n,e){li(this,n),e=bu(this,e);for(let r=0;r<this.columns;r++)this.set(n,r,e[r]);return this}swapRows(n,e){li(this,n),li(this,e);for(let r=0;r<this.columns;r++){let i=this.get(n,r);this.set(n,r,this.get(e,r)),this.set(e,r,i)}return this}getColumn(n){hi(this,n);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,n));return e}getColumnVector(n){return le.columnVector(this.getColumn(n))}setColumn(n,e){hi(this,n),e=xu(this,e);for(let r=0;r<this.rows;r++)this.set(r,n,e[r]);return this}swapColumns(n,e){hi(this,n),hi(this,e);for(let r=0;r<this.rows;r++){let i=this.get(r,n);this.set(r,n,this.get(r,e)),this.set(r,e,i)}return this}addRowVector(n){n=bu(this,n);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+n[r]);return this}subRowVector(n){n=bu(this,n);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-n[r]);return this}mulRowVector(n){n=bu(this,n);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*n[r]);return this}divRowVector(n){n=bu(this,n);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/n[r]);return this}addColumnVector(n){n=xu(this,n);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+n[e]);return this}subColumnVector(n){n=xu(this,n);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-n[e]);return this}mulColumnVector(n){n=xu(this,n);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*n[e]);return this}divColumnVector(n){n=xu(this,n);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/n[e]);return this}mulRow(n,e){li(this,n);for(let r=0;r<this.columns;r++)this.set(n,r,this.get(n,r)*e);return this}mulColumn(n,e){hi(this,n);for(let r=0;r<this.rows;r++)this.set(r,n,this.get(r,n)*e);return this}max(n){if(this.isEmpty())return NaN;switch(n){case"row":{const e=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>e[r]&&(e[r]=this.get(r,i));return e}case"column":{const e=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>e[i]&&(e[i]=this.get(r,i));return e}case void 0:{let e=this.get(0,0);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>e&&(e=this.get(r,i));return e}default:throw new Error(`invalid option: ${n}`)}}maxIndex(){uu(this);let n=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>n&&(n=this.get(r,i),e[0]=r,e[1]=i);return e}min(n){if(this.isEmpty())return NaN;switch(n){case"row":{const e=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<e[r]&&(e[r]=this.get(r,i));return e}case"column":{const e=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<e[i]&&(e[i]=this.get(r,i));return e}case void 0:{let e=this.get(0,0);for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<e&&(e=this.get(r,i));return e}default:throw new Error(`invalid option: ${n}`)}}minIndex(){uu(this);let n=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<n&&(n=this.get(r,i),e[0]=r,e[1]=i);return e}maxRow(n){if(li(this,n),this.isEmpty())return NaN;let e=this.get(n,0);for(let r=1;r<this.columns;r++)this.get(n,r)>e&&(e=this.get(n,r));return e}maxRowIndex(n){li(this,n),uu(this);let e=this.get(n,0),r=[n,0];for(let i=1;i<this.columns;i++)this.get(n,i)>e&&(e=this.get(n,i),r[1]=i);return r}minRow(n){if(li(this,n),this.isEmpty())return NaN;let e=this.get(n,0);for(let r=1;r<this.columns;r++)this.get(n,r)<e&&(e=this.get(n,r));return e}minRowIndex(n){li(this,n),uu(this);let e=this.get(n,0),r=[n,0];for(let i=1;i<this.columns;i++)this.get(n,i)<e&&(e=this.get(n,i),r[1]=i);return r}maxColumn(n){if(hi(this,n),this.isEmpty())return NaN;let e=this.get(0,n);for(let r=1;r<this.rows;r++)this.get(r,n)>e&&(e=this.get(r,n));return e}maxColumnIndex(n){hi(this,n),uu(this);let e=this.get(0,n),r=[0,n];for(let i=1;i<this.rows;i++)this.get(i,n)>e&&(e=this.get(i,n),r[0]=i);return r}minColumn(n){if(hi(this,n),this.isEmpty())return NaN;let e=this.get(0,n);for(let r=1;r<this.rows;r++)this.get(r,n)<e&&(e=this.get(r,n));return e}minColumnIndex(n){hi(this,n),uu(this);let e=this.get(0,n),r=[0,n];for(let i=1;i<this.rows;i++)this.get(i,n)<e&&(e=this.get(i,n),r[0]=i);return r}diag(){let n=Math.min(this.rows,this.columns),e=[];for(let r=0;r<n;r++)e.push(this.get(r,r));return e}norm(n="frobenius"){let e=0;if(n==="max")return this.max();if(n==="frobenius"){for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)e=e+this.get(r,i)*this.get(r,i);return Math.sqrt(e)}else throw new RangeError(`unknown norm type: ${n}`)}cumulativeSum(){let n=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)n+=this.get(e,r),this.set(e,r,n);return this}dot(n){qe.isMatrix(n)&&(n=n.to1DArray());let e=this.to1DArray();if(e.length!==n.length)throw new RangeError("vectors do not have the same size");let r=0;for(let i=0;i<e.length;i++)r+=e[i]*n[i];return r}mmul(n){n=le.checkMatrix(n);let e=this.rows,r=this.columns,i=n.columns,o=new le(e,i),a=new Float64Array(r);for(let s=0;s<i;s++){for(let u=0;u<r;u++)a[u]=n.get(u,s);for(let u=0;u<e;u++){let c=0;for(let l=0;l<r;l++)c+=this.get(u,l)*a[l];o.set(u,s,c)}}return o}strassen2x2(n){n=le.checkMatrix(n);let e=new le(2,2);const r=this.get(0,0),i=n.get(0,0),o=this.get(0,1),a=n.get(0,1),s=this.get(1,0),u=n.get(1,0),c=this.get(1,1),l=n.get(1,1),h=(r+c)*(i+l),f=(s+c)*i,d=r*(a-l),p=c*(u-i),g=(r+o)*l,v=(s-r)*(i+a),m=(o-c)*(u+l),y=h+p-g+m,b=d+g,x=f+p,w=h-f+d+v;return e.set(0,0,y),e.set(0,1,b),e.set(1,0,x),e.set(1,1,w),e}strassen3x3(n){n=le.checkMatrix(n);let e=new le(3,3);const r=this.get(0,0),i=this.get(0,1),o=this.get(0,2),a=this.get(1,0),s=this.get(1,1),u=this.get(1,2),c=this.get(2,0),l=this.get(2,1),h=this.get(2,2),f=n.get(0,0),d=n.get(0,1),p=n.get(0,2),g=n.get(1,0),v=n.get(1,1),m=n.get(1,2),y=n.get(2,0),b=n.get(2,1),x=n.get(2,2),w=(r+i+o-a-s-l-h)*v,E=(r-a)*(-d+v),M=s*(-f+d+g-v-m-y+x),_=(-r+a+s)*(f-d+v),k=(a+s)*(-f+d),S=r*f,A=(-r+c+l)*(f-p+m),C=(-r+c)*(p-m),I=(c+l)*(-f+p),N=(r+i+o-s-u-c-l)*m,D=l*(-f+p+g-v-m-y+b),P=(-o+l+h)*(v+y-b),j=(o-h)*(v-b),L=o*y,R=(l+h)*(-y+b),V=(-o+s+u)*(m+y-x),tt=(o-u)*(m-x),ut=(s+u)*(-y+x),dt=i*g,J=u*b,Et=a*p,Bt=c*d,Vt=h*x,se=S+L+dt,re=w+_+k+S+P+L+R,ue=S+A+I+N+L+V+ut,de=E+M+_+S+L+V+tt,Ze=E+_+k+S+J,Ne=L+V+tt+ut+Et,Re=S+A+C+D+P+j+L,pn=P+j+L+R+Bt,en=S+A+C+I+Vt;return e.set(0,0,se),e.set(0,1,re),e.set(0,2,ue),e.set(1,0,de),e.set(1,1,Ze),e.set(1,2,Ne),e.set(2,0,Re),e.set(2,1,pn),e.set(2,2,en),e}mmulStrassen(n){n=le.checkMatrix(n);let e=this.clone(),r=e.rows,i=e.columns,o=n.rows,a=n.columns;i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);function s(h,f,d){let p=h.rows,g=h.columns;if(p===f&&g===d)return h;{let v=qe.zeros(f,d);return v=v.setSubMatrix(h,0,0),v}}let u=Math.max(r,o),c=Math.max(i,a);e=s(e,u,c),n=s(n,u,c);function l(h,f,d,p){if(d<=512||p<=512)return h.mmul(f);d%2===1&&p%2===1?(h=s(h,d+1,p+1),f=s(f,d+1,p+1)):d%2===1?(h=s(h,d+1,p),f=s(f,d+1,p)):p%2===1&&(h=s(h,d,p+1),f=s(f,d,p+1));let g=parseInt(h.rows/2,10),v=parseInt(h.columns/2,10),m=h.subMatrix(0,g-1,0,v-1),y=f.subMatrix(0,g-1,0,v-1),b=h.subMatrix(0,g-1,v,h.columns-1),x=f.subMatrix(0,g-1,v,f.columns-1),w=h.subMatrix(g,h.rows-1,0,v-1),E=f.subMatrix(g,f.rows-1,0,v-1),M=h.subMatrix(g,h.rows-1,v,h.columns-1),_=f.subMatrix(g,f.rows-1,v,f.columns-1),k=l(qe.add(m,M),qe.add(y,_),g,v),S=l(qe.add(w,M),y,g,v),A=l(m,qe.sub(x,_),g,v),C=l(M,qe.sub(E,y),g,v),I=l(qe.add(m,b),_,g,v),N=l(qe.sub(w,m),qe.add(y,x),g,v),D=l(qe.sub(b,M),qe.add(E,_),g,v),P=qe.add(k,C);P.sub(I),P.add(D);let j=qe.add(A,I),L=qe.add(S,C),R=qe.sub(k,S);R.add(A),R.add(N);let V=qe.zeros(2*P.rows,2*P.columns);return V=V.setSubMatrix(P,0,0),V=V.setSubMatrix(j,P.rows,0),V=V.setSubMatrix(L,0,P.columns),V=V.setSubMatrix(R,P.rows,P.columns),V.subMatrix(0,d-1,0,p-1)}return l(e,n,u,c)}scaleRows(n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{min:e=0,max:r=1}=n;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let i=new le(this.rows,this.columns);for(let o=0;o<this.rows;o++){const a=this.getRow(o);a.length>0&&xS(a,{min:e,max:r,output:a}),i.setRow(o,a)}return i}scaleColumns(n={}){if(typeof n!="object")throw new TypeError("options must be an object");const{min:e=0,max:r=1}=n;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let i=new le(this.rows,this.columns);for(let o=0;o<this.columns;o++){const a=this.getColumn(o);a.length&&xS(a,{min:e,max:r,output:a}),i.setColumn(o,a)}return i}flipRows(){const n=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<n;r++){let i=this.get(e,r),o=this.get(e,this.columns-1-r);this.set(e,r,o),this.set(e,this.columns-1-r,i)}return this}flipColumns(){const n=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<n;r++){let i=this.get(r,e),o=this.get(this.rows-1-r,e);this.set(r,e,o),this.set(this.rows-1-r,e,i)}return this}kroneckerProduct(n){n=le.checkMatrix(n);let e=this.rows,r=this.columns,i=n.rows,o=n.columns,a=new le(e*i,r*o);for(let s=0;s<e;s++)for(let u=0;u<r;u++)for(let c=0;c<i;c++)for(let l=0;l<o;l++)a.set(i*s+c,o*u+l,this.get(s,u)*n.get(c,l));return a}kroneckerSum(n){if(n=le.checkMatrix(n),!this.isSquare()||!n.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=n.rows,i=this.kroneckerProduct(le.eye(r,r)),o=le.eye(e,e).kroneckerProduct(n);return i.add(o)}transpose(){let n=new le(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)n.set(r,e,this.get(e,r));return n}sortRows(n=ES){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(n));return this}sortColumns(n=ES){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(n));return this}subMatrix(n,e,r,i){zm(this,n,e,r,i);let o=new le(e-n+1,i-r+1);for(let a=n;a<=e;a++)for(let s=r;s<=i;s++)o.set(a-n,s-r,this.get(a,s));return o}subMatrixRow(n,e,r){if(e===void 0&&(e=0),r===void 0&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let i=new le(n.length,r-e+1);for(let o=0;o<n.length;o++)for(let a=e;a<=r;a++){if(n[o]<0||n[o]>=this.rows)throw new RangeError(`Row index out of range: ${n[o]}`);i.set(o,a-e,this.get(n[o],a))}return i}subMatrixColumn(n,e,r){if(e===void 0&&(e=0),r===void 0&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let i=new le(r-e+1,n.length);for(let o=0;o<n.length;o++)for(let a=e;a<=r;a++){if(n[o]<0||n[o]>=this.columns)throw new RangeError(`Column index out of range: ${n[o]}`);i.set(a-e,o,this.get(a,n[o]))}return i}setSubMatrix(n,e,r){if(n=le.checkMatrix(n),n.isEmpty())return this;let i=e+n.rows-1,o=r+n.columns-1;zm(this,e,i,r,o);for(let a=0;a<n.rows;a++)for(let s=0;s<n.columns;s++)this.set(e+a,r+s,n.get(a,s));return this}selection(n,e){nb(this,n),rb(this,e);let r=new le(n.length,e.length);for(let i=0;i<n.length;i++){let o=n[i];for(let a=0;a<e.length;a++){let s=e[a];r.set(i,a,this.get(o,s))}}return r}trace(){let n=Math.min(this.rows,this.columns),e=0;for(let r=0;r<n;r++)e+=this.get(r,r);return e}clone(){let n=new le(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)n.set(e,r,this.get(e,r));return n}sum(n){switch(n){case"row":return rot(this);case"column":return iot(this);case void 0:return oot(this);default:throw new Error(`invalid option: ${n}`)}}product(n){switch(n){case"row":return aot(this);case"column":return sot(this);case void 0:return uot(this);default:throw new Error(`invalid option: ${n}`)}}mean(n){const e=this.sum(n);switch(n){case"row":{for(let r=0;r<this.rows;r++)e[r]/=this.columns;return e}case"column":{for(let r=0;r<this.columns;r++)e[r]/=this.rows;return e}case void 0:return e/this.size;default:throw new Error(`invalid option: ${n}`)}}variance(n,e={}){if(typeof n=="object"&&(e=n,n=void 0),typeof e!="object")throw new TypeError("options must be an object");const{unbiased:r=!0,mean:i=this.mean(n)}=e;if(typeof r!="boolean")throw new TypeError("unbiased must be a boolean");switch(n){case"row":{if(!gr(i))throw new TypeError("mean must be an array");return cot(this,r,i)}case"column":{if(!gr(i))throw new TypeError("mean must be an array");return lot(this,r,i)}case void 0:{if(typeof i!="number")throw new TypeError("mean must be a number");return hot(this,r,i)}default:throw new Error(`invalid option: ${n}`)}}standardDeviation(n,e){typeof n=="object"&&(e=n,n=void 0);const r=this.variance(n,e);if(n===void 0)return Math.sqrt(r);for(let i=0;i<r.length;i++)r[i]=Math.sqrt(r[i]);return r}center(n,e={}){if(typeof n=="object"&&(e=n,n=void 0),typeof e!="object")throw new TypeError("options must be an object");const{center:r=this.mean(n)}=e;switch(n){case"row":{if(!gr(r))throw new TypeError("center must be an array");return fot(this,r),this}case"column":{if(!gr(r))throw new TypeError("center must be an array");return dot(this,r),this}case void 0:{if(typeof r!="number")throw new TypeError("center must be a number");return pot(this,r),this}default:throw new Error(`invalid option: ${n}`)}}scale(n,e={}){if(typeof n=="object"&&(e=n,n=void 0),typeof e!="object")throw new TypeError("options must be an object");let r=e.scale;switch(n){case"row":{if(r===void 0)r=got(this);else if(!gr(r))throw new TypeError("scale must be an array");return vot(this,r),this}case"column":{if(r===void 0)r=mot(this);else if(!gr(r))throw new TypeError("scale must be an array");return yot(this,r),this}case void 0:{if(r===void 0)r=bot(this);else if(typeof r!="number")throw new TypeError("scale must be a number");return xot(this,r),this}default:throw new Error(`invalid option: ${n}`)}}toString(n){return aN(this,n)}}qe.prototype.klass="Matrix";typeof Symbol<"u"&&(qe.prototype[Symbol.for("nodejs.util.inspect.custom")]=$it);function ES(t,n){return t-n}function wot(t){return t.every(n=>typeof n=="number")}qe.random=qe.rand;qe.randomInt=qe.randInt;qe.diagonal=qe.diag;qe.prototype.diagonal=qe.prototype.diag;qe.identity=qe.eye;qe.prototype.negate=qe.prototype.neg;qe.prototype.tensorProduct=qe.prototype.kroneckerProduct;class le extends qe{constructor(n,e){if(super(),le.isMatrix(n))return n.clone();if(Number.isInteger(n)&&n>=0)if(this.data=[],Number.isInteger(e)&&e>=0)for(let r=0;r<n;r++)this.data.push(new Float64Array(e));else throw new TypeError("nColumns must be a positive integer");else if(gr(n)){const r=n;if(n=r.length,e=n?r[0].length:0,typeof e!="number")throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<n;i++){if(r[i].length!==e)throw new RangeError("Inconsistent array dimensions");if(!wot(r[i]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[i]))}}else throw new TypeError("First argument must be a positive number or an array");this.rows=n,this.columns=e}set(n,e,r){return this.data[n][e]=r,this}get(n,e){return this.data[n][e]}removeRow(n){return li(this,n),this.data.splice(n,1),this.rows-=1,this}addRow(n,e){return e===void 0&&(e=n,n=this.rows),li(this,n,!0),e=Float64Array.from(bu(this,e)),this.data.splice(n,0,e),this.rows+=1,this}removeColumn(n){hi(this,n);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let i=0;i<n;i++)r[i]=this.data[e][i];for(let i=n+1;i<this.columns;i++)r[i-1]=this.data[e][i];this.data[e]=r}return this.columns-=1,this}addColumn(n,e){typeof e>"u"&&(e=n,n=this.columns),hi(this,n,!0),e=xu(this,e);for(let r=0;r<this.rows;r++){const i=new Float64Array(this.columns+1);let o=0;for(;o<n;o++)i[o]=this.data[r][o];for(i[o++]=e[r];o<this.columns+1;o++)i[o]=this.data[r][o-1];this.data[r]=i}return this.columns+=1,this}}not(qe,le);class ta extends qe{constructor(n,e,r){super(),this.matrix=n,this.rows=e,this.columns=r}}class Eot extends ta{constructor(n,e){hi(n,e),super(n,n.rows,1),this.column=e}set(n,e,r){return this.matrix.set(n,this.column,r),this}get(n){return this.matrix.get(n,this.column)}}class Mot extends ta{constructor(n,e){rb(n,e),super(n,n.rows,e.length),this.columnIndices=e}set(n,e,r){return this.matrix.set(n,this.columnIndices[e],r),this}get(n,e){return this.matrix.get(n,this.columnIndices[e])}}class Sot extends ta{constructor(n){super(n,n.rows,n.columns)}set(n,e,r){return this.matrix.set(n,this.columns-e-1,r),this}get(n,e){return this.matrix.get(n,this.columns-e-1)}}class _ot extends ta{constructor(n){super(n,n.rows,n.columns)}set(n,e,r){return this.matrix.set(this.rows-n-1,e,r),this}get(n,e){return this.matrix.get(this.rows-n-1,e)}}class kot extends ta{constructor(n,e){li(n,e),super(n,1,n.columns),this.row=e}set(n,e,r){return this.matrix.set(this.row,e,r),this}get(n,e){return this.matrix.get(this.row,e)}}class Aot extends ta{constructor(n,e){nb(n,e),super(n,e.length,n.columns),this.rowIndices=e}set(n,e,r){return this.matrix.set(this.rowIndices[n],e,r),this}get(n,e){return this.matrix.get(this.rowIndices[n],e)}}class ud extends ta{constructor(n,e,r){nb(n,e),rb(n,r),super(n,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(n,e,r){return this.matrix.set(this.rowIndices[n],this.columnIndices[e],r),this}get(n,e){return this.matrix.get(this.rowIndices[n],this.columnIndices[e])}}class Cot extends ta{constructor(n,e,r,i,o){zm(n,e,r,i,o),super(n,r-e+1,o-i+1),this.startRow=e,this.startColumn=i}set(n,e,r){return this.matrix.set(this.startRow+n,this.startColumn+e,r),this}get(n,e){return this.matrix.get(this.startRow+n,this.startColumn+e)}}class Iot extends ta{constructor(n){super(n,n.columns,n.rows)}set(n,e,r){return this.matrix.set(e,n,r),this}get(n,e){return this.matrix.get(e,n)}}class sN extends qe{constructor(n,e={}){const{rows:r=1}=e;if(n.length%r!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=n.length/r,this.data=n}set(n,e,r){let i=this._calculateIndex(n,e);return this.data[i]=r,this}get(n,e){let r=this._calculateIndex(n,e);return this.data[r]}_calculateIndex(n,e){return n*this.columns+e}}class $r extends qe{constructor(n){super(),this.data=n,this.rows=n.length,this.columns=n[0].length}set(n,e,r){return this.data[n][e]=r,this}get(n,e){return this.data[n][e]}}function Tot(t,n){if(gr(t))return t[0]&&gr(t[0])?new $r(t):new sN(t,n);throw new Error("the argument is not an array")}class Kd{constructor(n){n=$r.checkMatrix(n);let e=n.clone(),r=e.rows,i=e.columns,o=new Float64Array(r),a=1,s,u,c,l,h,f,d,p,g;for(s=0;s<r;s++)o[s]=s;for(p=new Float64Array(r),u=0;u<i;u++){for(s=0;s<r;s++)p[s]=e.get(s,u);for(s=0;s<r;s++){for(g=Math.min(s,u),h=0,c=0;c<g;c++)h+=e.get(s,c)*p[c];p[s]-=h,e.set(s,u,p[s])}for(l=u,s=u+1;s<r;s++)Math.abs(p[s])>Math.abs(p[l])&&(l=s);if(l!==u){for(c=0;c<i;c++)f=e.get(l,c),e.set(l,c,e.get(u,c)),e.set(u,c,f);d=o[l],o[l]=o[u],o[u]=d,a=-a}if(u<r&&e.get(u,u)!==0)for(s=u+1;s<r;s++)e.set(s,u,e.get(s,u)/e.get(u,u))}this.LU=e,this.pivotVector=o,this.pivotSign=a}isSingular(){let n=this.LU,e=n.columns;for(let r=0;r<e;r++)if(n.get(r,r)===0)return!0;return!1}solve(n){n=le.checkMatrix(n);let e=this.LU;if(e.rows!==n.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let r=n.columns,i=n.subMatrixRow(this.pivotVector,0,r-1),o=e.columns,a,s,u;for(u=0;u<o;u++)for(a=u+1;a<o;a++)for(s=0;s<r;s++)i.set(a,s,i.get(a,s)-i.get(u,s)*e.get(a,u));for(u=o-1;u>=0;u--){for(s=0;s<r;s++)i.set(u,s,i.get(u,s)/e.get(u,u));for(a=0;a<u;a++)for(s=0;s<r;s++)i.set(a,s,i.get(a,s)-i.get(u,s)*e.get(a,u))}return i}get determinant(){let n=this.LU;if(!n.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=n.columns;for(let i=0;i<r;i++)e*=n.get(i,i);return e}get lowerTriangularMatrix(){let n=this.LU,e=n.rows,r=n.columns,i=new le(e,r);for(let o=0;o<e;o++)for(let a=0;a<r;a++)o>a?i.set(o,a,n.get(o,a)):o===a?i.set(o,a,1):i.set(o,a,0);return i}get upperTriangularMatrix(){let n=this.LU,e=n.rows,r=n.columns,i=new le(e,r);for(let o=0;o<e;o++)for(let a=0;a<r;a++)o<=a?i.set(o,a,n.get(o,a)):i.set(o,a,0);return i}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function Go(t,n){let e=0;return Math.abs(t)>Math.abs(n)?(e=n/t,Math.abs(t)*Math.sqrt(1+e*e)):n!==0?(e=t/n,Math.abs(n)*Math.sqrt(1+e*e)):0}class Gm{constructor(n){n=$r.checkMatrix(n);let e=n.clone(),r=n.rows,i=n.columns,o=new Float64Array(i),a,s,u,c;for(u=0;u<i;u++){let l=0;for(a=u;a<r;a++)l=Go(l,e.get(a,u));if(l!==0){for(e.get(u,u)<0&&(l=-l),a=u;a<r;a++)e.set(a,u,e.get(a,u)/l);for(e.set(u,u,e.get(u,u)+1),s=u+1;s<i;s++){for(c=0,a=u;a<r;a++)c+=e.get(a,u)*e.get(a,s);for(c=-c/e.get(u,u),a=u;a<r;a++)e.set(a,s,e.get(a,s)+c*e.get(a,u))}}o[u]=-l}this.QR=e,this.Rdiag=o}solve(n){n=le.checkMatrix(n);let e=this.QR,r=e.rows;if(n.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let i=n.columns,o=n.clone(),a=e.columns,s,u,c,l;for(c=0;c<a;c++)for(u=0;u<i;u++){for(l=0,s=c;s<r;s++)l+=e.get(s,c)*o.get(s,u);for(l=-l/e.get(c,c),s=c;s<r;s++)o.set(s,u,o.get(s,u)+l*e.get(s,c))}for(c=a-1;c>=0;c--){for(u=0;u<i;u++)o.set(c,u,o.get(c,u)/this.Rdiag[c]);for(s=0;s<c;s++)for(u=0;u<i;u++)o.set(s,u,o.get(s,u)-o.get(c,u)*e.get(s,c))}return o.subMatrix(0,a-1,0,i-1)}isFullRank(){let n=this.QR.columns;for(let e=0;e<n;e++)if(this.Rdiag[e]===0)return!1;return!0}get upperTriangularMatrix(){let n=this.QR,e=n.columns,r=new le(e,e),i,o;for(i=0;i<e;i++)for(o=0;o<e;o++)i<o?r.set(i,o,n.get(i,o)):i===o?r.set(i,o,this.Rdiag[i]):r.set(i,o,0);return r}get orthogonalMatrix(){let n=this.QR,e=n.rows,r=n.columns,i=new le(e,r),o,a,s,u;for(s=r-1;s>=0;s--){for(o=0;o<e;o++)i.set(o,s,0);for(i.set(s,s,1),a=s;a<r;a++)if(n.get(s,s)!==0){for(u=0,o=s;o<e;o++)u+=n.get(o,s)*i.get(o,a);for(u=-u/n.get(s,s),o=s;o<e;o++)i.set(o,a,i.get(o,a)+u*n.get(o,s))}}return i}}class qu{constructor(n,e={}){if(n=$r.checkMatrix(n),n.isEmpty())throw new Error("Matrix must be non-empty");let r=n.rows,i=n.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:a=!0,autoTranspose:s=!1}=e;let u=!!o,c=!!a,l=!1,h;if(r<i)if(!s)h=n.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{h=n.transpose(),r=h.rows,i=h.columns,l=!0;let S=u;u=c,c=S}else h=n.clone();let f=Math.min(r,i),d=Math.min(r+1,i),p=new Float64Array(d),g=new le(r,f),v=new le(i,i),m=new Float64Array(i),y=new Float64Array(r),b=new Float64Array(d);for(let S=0;S<d;S++)b[S]=S;let x=Math.min(r-1,i),w=Math.max(0,Math.min(i-2,r)),E=Math.max(x,w);for(let S=0;S<E;S++){if(S<x){p[S]=0;for(let A=S;A<r;A++)p[S]=Go(p[S],h.get(A,S));if(p[S]!==0){h.get(S,S)<0&&(p[S]=-p[S]);for(let A=S;A<r;A++)h.set(A,S,h.get(A,S)/p[S]);h.set(S,S,h.get(S,S)+1)}p[S]=-p[S]}for(let A=S+1;A<i;A++){if(S<x&&p[S]!==0){let C=0;for(let I=S;I<r;I++)C+=h.get(I,S)*h.get(I,A);C=-C/h.get(S,S);for(let I=S;I<r;I++)h.set(I,A,h.get(I,A)+C*h.get(I,S))}m[A]=h.get(S,A)}if(u&&S<x)for(let A=S;A<r;A++)g.set(A,S,h.get(A,S));if(S<w){m[S]=0;for(let A=S+1;A<i;A++)m[S]=Go(m[S],m[A]);if(m[S]!==0){m[S+1]<0&&(m[S]=0-m[S]);for(let A=S+1;A<i;A++)m[A]/=m[S];m[S+1]+=1}if(m[S]=-m[S],S+1<r&&m[S]!==0){for(let A=S+1;A<r;A++)y[A]=0;for(let A=S+1;A<r;A++)for(let C=S+1;C<i;C++)y[A]+=m[C]*h.get(A,C);for(let A=S+1;A<i;A++){let C=-m[A]/m[S+1];for(let I=S+1;I<r;I++)h.set(I,A,h.get(I,A)+C*y[I])}}if(c)for(let A=S+1;A<i;A++)v.set(A,S,m[A])}}let M=Math.min(i,r+1);if(x<i&&(p[x]=h.get(x,x)),r<M&&(p[M-1]=0),w+1<M&&(m[w]=h.get(w,M-1)),m[M-1]=0,u){for(let S=x;S<f;S++){for(let A=0;A<r;A++)g.set(A,S,0);g.set(S,S,1)}for(let S=x-1;S>=0;S--)if(p[S]!==0){for(let A=S+1;A<f;A++){let C=0;for(let I=S;I<r;I++)C+=g.get(I,S)*g.get(I,A);C=-C/g.get(S,S);for(let I=S;I<r;I++)g.set(I,A,g.get(I,A)+C*g.get(I,S))}for(let A=S;A<r;A++)g.set(A,S,-g.get(A,S));g.set(S,S,1+g.get(S,S));for(let A=0;A<S-1;A++)g.set(A,S,0)}else{for(let A=0;A<r;A++)g.set(A,S,0);g.set(S,S,1)}}if(c)for(let S=i-1;S>=0;S--){if(S<w&&m[S]!==0)for(let A=S+1;A<i;A++){let C=0;for(let I=S+1;I<i;I++)C+=v.get(I,S)*v.get(I,A);C=-C/v.get(S+1,S);for(let I=S+1;I<i;I++)v.set(I,A,v.get(I,A)+C*v.get(I,S))}for(let A=0;A<i;A++)v.set(A,S,0);v.set(S,S,1)}let _=M-1,k=Number.EPSILON;for(;M>0;){let S,A;for(S=M-2;S>=-1&&S!==-1;S--){const C=Number.MIN_VALUE+k*Math.abs(p[S]+Math.abs(p[S+1]));if(Math.abs(m[S])<=C||Number.isNaN(m[S])){m[S]=0;break}}if(S===M-2)A=4;else{let C;for(C=M-1;C>=S&&C!==S;C--){let I=(C!==M?Math.abs(m[C]):0)+(C!==S+1?Math.abs(m[C-1]):0);if(Math.abs(p[C])<=k*I){p[C]=0;break}}C===S?A=3:C===M-1?A=1:(A=2,S=C)}switch(S++,A){case 1:{let C=m[M-2];m[M-2]=0;for(let I=M-2;I>=S;I--){let N=Go(p[I],C),D=p[I]/N,P=C/N;if(p[I]=N,I!==S&&(C=-P*m[I-1],m[I-1]=D*m[I-1]),c)for(let j=0;j<i;j++)N=D*v.get(j,I)+P*v.get(j,M-1),v.set(j,M-1,-P*v.get(j,I)+D*v.get(j,M-1)),v.set(j,I,N)}break}case 2:{let C=m[S-1];m[S-1]=0;for(let I=S;I<M;I++){let N=Go(p[I],C),D=p[I]/N,P=C/N;if(p[I]=N,C=-P*m[I],m[I]=D*m[I],u)for(let j=0;j<r;j++)N=D*g.get(j,I)+P*g.get(j,S-1),g.set(j,S-1,-P*g.get(j,I)+D*g.get(j,S-1)),g.set(j,I,N)}break}case 3:{const C=Math.max(Math.abs(p[M-1]),Math.abs(p[M-2]),Math.abs(m[M-2]),Math.abs(p[S]),Math.abs(m[S])),I=p[M-1]/C,N=p[M-2]/C,D=m[M-2]/C,P=p[S]/C,j=m[S]/C,L=((N+I)*(N-I)+D*D)/2,R=I*D*(I*D);let V=0;(L!==0||R!==0)&&(L<0?V=0-Math.sqrt(L*L+R):V=Math.sqrt(L*L+R),V=R/(L+V));let tt=(P+I)*(P-I)+V,ut=P*j;for(let dt=S;dt<M-1;dt++){let J=Go(tt,ut);J===0&&(J=Number.MIN_VALUE);let Et=tt/J,Bt=ut/J;if(dt!==S&&(m[dt-1]=J),tt=Et*p[dt]+Bt*m[dt],m[dt]=Et*m[dt]-Bt*p[dt],ut=Bt*p[dt+1],p[dt+1]=Et*p[dt+1],c)for(let Vt=0;Vt<i;Vt++)J=Et*v.get(Vt,dt)+Bt*v.get(Vt,dt+1),v.set(Vt,dt+1,-Bt*v.get(Vt,dt)+Et*v.get(Vt,dt+1)),v.set(Vt,dt,J);if(J=Go(tt,ut),J===0&&(J=Number.MIN_VALUE),Et=tt/J,Bt=ut/J,p[dt]=J,tt=Et*m[dt]+Bt*p[dt+1],p[dt+1]=-Bt*m[dt]+Et*p[dt+1],ut=Bt*m[dt+1],m[dt+1]=Et*m[dt+1],u&&dt<r-1)for(let Vt=0;Vt<r;Vt++)J=Et*g.get(Vt,dt)+Bt*g.get(Vt,dt+1),g.set(Vt,dt+1,-Bt*g.get(Vt,dt)+Et*g.get(Vt,dt+1)),g.set(Vt,dt,J)}m[M-2]=tt;break}case 4:{if(p[S]<=0&&(p[S]=p[S]<0?-p[S]:0,c))for(let C=0;C<=_;C++)v.set(C,S,-v.get(C,S));for(;S<_&&!(p[S]>=p[S+1]);){let C=p[S];if(p[S]=p[S+1],p[S+1]=C,c&&S<i-1)for(let I=0;I<i;I++)C=v.get(I,S+1),v.set(I,S+1,v.get(I,S)),v.set(I,S,C);if(u&&S<r-1)for(let I=0;I<r;I++)C=g.get(I,S+1),g.set(I,S+1,g.get(I,S)),g.set(I,S,C);S++}M--;break}}}if(l){let S=v;v=g,g=S}this.m=r,this.n=i,this.s=p,this.U=g,this.V=v}solve(n){let e=n,r=this.threshold,i=this.s.length,o=le.zeros(i,i);for(let f=0;f<i;f++)Math.abs(this.s[f])<=r?o.set(f,f,0):o.set(f,f,1/this.s[f]);let a=this.U,s=this.rightSingularVectors,u=s.mmul(o),c=s.rows,l=a.rows,h=le.zeros(c,l);for(let f=0;f<c;f++)for(let d=0;d<l;d++){let p=0;for(let g=0;g<i;g++)p+=u.get(f,g)*a.get(d,g);h.set(f,d,p)}return h.mmul(e)}solveForDiagonal(n){return this.solve(le.diag(n))}inverse(){let n=this.V,e=this.threshold,r=n.rows,i=n.columns,o=new le(r,this.s.length);for(let l=0;l<r;l++)for(let h=0;h<i;h++)Math.abs(this.s[h])>e&&o.set(l,h,n.get(l,h)/this.s[h]);let a=this.U,s=a.rows,u=a.columns,c=new le(r,s);for(let l=0;l<r;l++)for(let h=0;h<s;h++){let f=0;for(let d=0;d<u;d++)f+=o.get(l,d)*a.get(h,d);c.set(l,h,f)}return c}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let n=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let i=0,o=r.length;i<o;i++)r[i]>n&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return le.diag(this.s)}}function Oot(t,n=!1){return t=$r.checkMatrix(t),n?new qu(t).inverse():uN(t,le.eye(t.rows))}function uN(t,n,e=!1){return t=$r.checkMatrix(t),n=$r.checkMatrix(n),e?new qu(t).solve(n):t.isSquare()?new Kd(t).solve(n):new Gm(t).solve(n)}function cd(t){if(t=le.checkMatrix(t),t.isSquare()){if(t.columns===0)return 1;let n,e,r,i;if(t.columns===2)return n=t.get(0,0),e=t.get(0,1),r=t.get(1,0),i=t.get(1,1),n*i-e*r;if(t.columns===3){let o,a,s;return o=new ud(t,[1,2],[1,2]),a=new ud(t,[1,2],[0,2]),s=new ud(t,[1,2],[0,1]),n=t.get(0,0),e=t.get(0,1),r=t.get(0,2),n*cd(o)-e*cd(a)+r*cd(s)}else return new Kd(t).determinant}else throw Error("determinant can only be calculated for a square matrix")}function Not(t,n){let e=[];for(let r=0;r<t;r++)r!==n&&e.push(r);return e}function Dot(t,n,e,r=1e-9,i=1e-9){if(t>i)return new Array(n.rows+1).fill(0);{let o=n.addRow(e,[0]);for(let a=0;a<o.rows;a++)Math.abs(o.get(a,0))<r&&o.set(a,0,0);return o.to1DArray()}}function Pot(t,n={}){const{thresholdValue:e=1e-9,thresholdError:r=1e-9}=n;t=le.checkMatrix(t);let i=t.rows,o=new le(i,i);for(let a=0;a<i;a++){let s=le.columnVector(t.getRow(a)),u=t.subMatrixRow(Not(i,a)).transpose(),c=new qu(u).solve(s),l=le.sub(s,u.mmul(c)).abs().max();o.setRow(a,Dot(l,c,a,e,r))}return o}function Lot(t,n=Number.EPSILON){if(t=le.checkMatrix(t),t.isEmpty())return t.transpose();let e=new qu(t,{autoTranspose:!0}),r=e.leftSingularVectors,i=e.rightSingularVectors,o=e.diagonal;for(let a=0;a<o.length;a++)Math.abs(o[a])>n?o[a]=1/o[a]:o[a]=0;return i.mmul(le.diag(o).mmul(r.transpose()))}function jot(t,n=t,e={}){t=new le(t);let r=!1;if(typeof n=="object"&&!le.isMatrix(n)&&!gr(n)?(e=n,n=t,r=!0):n=new le(n),t.rows!==n.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0}=e;i&&(t=t.center("column"),r||(n=n.center("column")));const o=t.transpose().mmul(n);for(let a=0;a<o.rows;a++)for(let s=0;s<o.columns;s++)o.set(a,s,o.get(a,s)*(1/(t.rows-1)));return o}function Rot(t,n=t,e={}){t=new le(t);let r=!1;if(typeof n=="object"&&!le.isMatrix(n)&&!gr(n)?(e=n,n=t,r=!0):n=new le(n),t.rows!==n.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0,scale:o=!0}=e;i&&(t.center("column"),r||n.center("column")),o&&(t.scale("column"),r||n.scale("column"));const a=t.standardDeviation("column",{unbiased:!0}),s=r?a:n.standardDeviation("column",{unbiased:!0}),u=t.transpose().mmul(n);for(let c=0;c<u.rows;c++)for(let l=0;l<u.columns;l++)u.set(c,l,u.get(c,l)*(1/(a[c]*s[l]))*(1/(t.rows-1)));return u}class MS{constructor(n,e={}){const{assumeSymmetric:r=!1}=e;if(n=$r.checkMatrix(n),!n.isSquare())throw new Error("Matrix is not a square matrix");if(n.isEmpty())throw new Error("Matrix must be non-empty");let i=n.columns,o=new le(i,i),a=new Float64Array(i),s=new Float64Array(i),u=n,c,l,h=!1;if(r?h=!0:h=n.isSymmetric(),h){for(c=0;c<i;c++)for(l=0;l<i;l++)o.set(c,l,u.get(c,l));Fot(i,s,a,o),Bot(i,s,a,o)}else{let f=new le(i,i),d=new Float64Array(i);for(l=0;l<i;l++)for(c=0;c<i;c++)f.set(c,l,u.get(c,l));zot(i,f,d,o),Got(i,s,a,o,f)}this.n=i,this.e=s,this.d=a,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let n=this.n,e=this.e,r=this.d,i=new le(n,n),o,a;for(o=0;o<n;o++){for(a=0;a<n;a++)i.set(o,a,0);i.set(o,o,r[o]),e[o]>0?i.set(o,o+1,e[o]):e[o]<0&&i.set(o,o-1,e[o])}return i}}function Fot(t,n,e,r){let i,o,a,s,u,c,l,h;for(u=0;u<t;u++)e[u]=r.get(t-1,u);for(s=t-1;s>0;s--){for(h=0,a=0,c=0;c<s;c++)h=h+Math.abs(e[c]);if(h===0)for(n[s]=e[s-1],u=0;u<s;u++)e[u]=r.get(s-1,u),r.set(s,u,0),r.set(u,s,0);else{for(c=0;c<s;c++)e[c]/=h,a+=e[c]*e[c];for(i=e[s-1],o=Math.sqrt(a),i>0&&(o=-o),n[s]=h*o,a=a-i*o,e[s-1]=i-o,u=0;u<s;u++)n[u]=0;for(u=0;u<s;u++){for(i=e[u],r.set(u,s,i),o=n[u]+r.get(u,u)*i,c=u+1;c<=s-1;c++)o+=r.get(c,u)*e[c],n[c]+=r.get(c,u)*i;n[u]=o}for(i=0,u=0;u<s;u++)n[u]/=a,i+=n[u]*e[u];for(l=i/(a+a),u=0;u<s;u++)n[u]-=l*e[u];for(u=0;u<s;u++){for(i=e[u],o=n[u],c=u;c<=s-1;c++)r.set(c,u,r.get(c,u)-(i*n[c]+o*e[c]));e[u]=r.get(s-1,u),r.set(s,u,0)}}e[s]=a}for(s=0;s<t-1;s++){if(r.set(t-1,s,r.get(s,s)),r.set(s,s,1),a=e[s+1],a!==0){for(c=0;c<=s;c++)e[c]=r.get(c,s+1)/a;for(u=0;u<=s;u++){for(o=0,c=0;c<=s;c++)o+=r.get(c,s+1)*r.get(c,u);for(c=0;c<=s;c++)r.set(c,u,r.get(c,u)-o*e[c])}}for(c=0;c<=s;c++)r.set(c,s+1,0)}for(u=0;u<t;u++)e[u]=r.get(t-1,u),r.set(t-1,u,0);r.set(t-1,t-1,1),n[0]=0}function Bot(t,n,e,r){let i,o,a,s,u,c,l,h,f,d,p,g,v,m,y,b;for(a=1;a<t;a++)n[a-1]=n[a];n[t-1]=0;let x=0,w=0,E=Number.EPSILON;for(c=0;c<t;c++){for(w=Math.max(w,Math.abs(e[c])+Math.abs(n[c])),l=c;l<t&&!(Math.abs(n[l])<=E*w);)l++;if(l>c)do{for(i=e[c],h=(e[c+1]-i)/(2*n[c]),f=Go(h,1),h<0&&(f=-f),e[c]=n[c]/(h+f),e[c+1]=n[c]*(h+f),d=e[c+1],o=i-e[c],a=c+2;a<t;a++)e[a]-=o;for(x=x+o,h=e[l],p=1,g=p,v=p,m=n[c+1],y=0,b=0,a=l-1;a>=c;a--)for(v=g,g=p,b=y,i=p*n[a],o=p*h,f=Go(h,n[a]),n[a+1]=y*f,y=n[a]/f,p=h/f,h=p*e[a]-y*i,e[a+1]=o+y*(p*i+y*e[a]),u=0;u<t;u++)o=r.get(u,a+1),r.set(u,a+1,y*r.get(u,a)+p*o),r.set(u,a,p*r.get(u,a)-y*o);h=-y*b*v*m*n[c]/d,n[c]=y*h,e[c]=p*h}while(Math.abs(n[c])>E*w);e[c]=e[c]+x,n[c]=0}for(a=0;a<t-1;a++){for(u=a,h=e[a],s=a+1;s<t;s++)e[s]<h&&(u=s,h=e[s]);if(u!==a)for(e[u]=e[a],e[a]=h,s=0;s<t;s++)h=r.get(s,a),r.set(s,a,r.get(s,u)),r.set(s,u,h)}}function zot(t,n,e,r){let i=0,o=t-1,a,s,u,c,l,h,f;for(h=i+1;h<=o-1;h++){for(f=0,c=h;c<=o;c++)f=f+Math.abs(n.get(c,h-1));if(f!==0){for(u=0,c=o;c>=h;c--)e[c]=n.get(c,h-1)/f,u+=e[c]*e[c];for(s=Math.sqrt(u),e[h]>0&&(s=-s),u=u-e[h]*s,e[h]=e[h]-s,l=h;l<t;l++){for(a=0,c=o;c>=h;c--)a+=e[c]*n.get(c,l);for(a=a/u,c=h;c<=o;c++)n.set(c,l,n.get(c,l)-a*e[c])}for(c=0;c<=o;c++){for(a=0,l=o;l>=h;l--)a+=e[l]*n.get(c,l);for(a=a/u,l=h;l<=o;l++)n.set(c,l,n.get(c,l)-a*e[l])}e[h]=f*e[h],n.set(h,h-1,f*s)}}for(c=0;c<t;c++)for(l=0;l<t;l++)r.set(c,l,c===l?1:0);for(h=o-1;h>=i+1;h--)if(n.get(h,h-1)!==0){for(c=h+1;c<=o;c++)e[c]=n.get(c,h-1);for(l=h;l<=o;l++){for(s=0,c=h;c<=o;c++)s+=e[c]*r.get(c,l);for(s=s/e[h]/n.get(h,h-1),c=h;c<=o;c++)r.set(c,l,r.get(c,l)+s*e[c])}}}function Got(t,n,e,r,i){let o=t-1,a=0,s=t-1,u=Number.EPSILON,c=0,l=0,h=0,f=0,d=0,p=0,g=0,v=0,m,y,b,x,w,E,M,_,k,S,A,C,I,N,D;for(m=0;m<t;m++)for((m<a||m>s)&&(e[m]=i.get(m,m),n[m]=0),y=Math.max(m-1,0);y<t;y++)l=l+Math.abs(i.get(m,y));for(;o>=a;){for(x=o;x>a&&(p=Math.abs(i.get(x-1,x-1))+Math.abs(i.get(x,x)),p===0&&(p=l),!(Math.abs(i.get(x,x-1))<u*p));)x--;if(x===o)i.set(o,o,i.get(o,o)+c),e[o]=i.get(o,o),n[o]=0,o--,v=0;else if(x===o-1){if(M=i.get(o,o-1)*i.get(o-1,o),h=(i.get(o-1,o-1)-i.get(o,o))/2,f=h*h+M,g=Math.sqrt(Math.abs(f)),i.set(o,o,i.get(o,o)+c),i.set(o-1,o-1,i.get(o-1,o-1)+c),_=i.get(o,o),f>=0){for(g=h>=0?h+g:h-g,e[o-1]=_+g,e[o]=e[o-1],g!==0&&(e[o]=_-M/g),n[o-1]=0,n[o]=0,_=i.get(o,o-1),p=Math.abs(_)+Math.abs(g),h=_/p,f=g/p,d=Math.sqrt(h*h+f*f),h=h/d,f=f/d,y=o-1;y<t;y++)g=i.get(o-1,y),i.set(o-1,y,f*g+h*i.get(o,y)),i.set(o,y,f*i.get(o,y)-h*g);for(m=0;m<=o;m++)g=i.get(m,o-1),i.set(m,o-1,f*g+h*i.get(m,o)),i.set(m,o,f*i.get(m,o)-h*g);for(m=a;m<=s;m++)g=r.get(m,o-1),r.set(m,o-1,f*g+h*r.get(m,o)),r.set(m,o,f*r.get(m,o)-h*g)}else e[o-1]=_+h,e[o]=_+h,n[o-1]=g,n[o]=-g;o=o-2,v=0}else{if(_=i.get(o,o),k=0,M=0,x<o&&(k=i.get(o-1,o-1),M=i.get(o,o-1)*i.get(o-1,o)),v===10){for(c+=_,m=a;m<=o;m++)i.set(m,m,i.get(m,m)-_);p=Math.abs(i.get(o,o-1))+Math.abs(i.get(o-1,o-2)),_=k=.75*p,M=-.4375*p*p}if(v===30&&(p=(k-_)/2,p=p*p+M,p>0)){for(p=Math.sqrt(p),k<_&&(p=-p),p=_-M/((k-_)/2+p),m=a;m<=o;m++)i.set(m,m,i.get(m,m)-p);c+=p,_=k=M=.964}for(v=v+1,w=o-2;w>=x&&(g=i.get(w,w),d=_-g,p=k-g,h=(d*p-M)/i.get(w+1,w)+i.get(w,w+1),f=i.get(w+1,w+1)-g-d-p,d=i.get(w+2,w+1),p=Math.abs(h)+Math.abs(f)+Math.abs(d),h=h/p,f=f/p,d=d/p,!(w===x||Math.abs(i.get(w,w-1))*(Math.abs(f)+Math.abs(d))<u*(Math.abs(h)*(Math.abs(i.get(w-1,w-1))+Math.abs(g)+Math.abs(i.get(w+1,w+1))))));)w--;for(m=w+2;m<=o;m++)i.set(m,m-2,0),m>w+2&&i.set(m,m-3,0);for(b=w;b<=o-1&&(N=b!==o-1,b!==w&&(h=i.get(b,b-1),f=i.get(b+1,b-1),d=N?i.get(b+2,b-1):0,_=Math.abs(h)+Math.abs(f)+Math.abs(d),_!==0&&(h=h/_,f=f/_,d=d/_)),_!==0);b++)if(p=Math.sqrt(h*h+f*f+d*d),h<0&&(p=-p),p!==0){for(b!==w?i.set(b,b-1,-p*_):x!==w&&i.set(b,b-1,-i.get(b,b-1)),h=h+p,_=h/p,k=f/p,g=d/p,f=f/h,d=d/h,y=b;y<t;y++)h=i.get(b,y)+f*i.get(b+1,y),N&&(h=h+d*i.get(b+2,y),i.set(b+2,y,i.get(b+2,y)-h*g)),i.set(b,y,i.get(b,y)-h*_),i.set(b+1,y,i.get(b+1,y)-h*k);for(m=0;m<=Math.min(o,b+3);m++)h=_*i.get(m,b)+k*i.get(m,b+1),N&&(h=h+g*i.get(m,b+2),i.set(m,b+2,i.get(m,b+2)-h*d)),i.set(m,b,i.get(m,b)-h),i.set(m,b+1,i.get(m,b+1)-h*f);for(m=a;m<=s;m++)h=_*r.get(m,b)+k*r.get(m,b+1),N&&(h=h+g*r.get(m,b+2),r.set(m,b+2,r.get(m,b+2)-h*d)),r.set(m,b,r.get(m,b)-h),r.set(m,b+1,r.get(m,b+1)-h*f)}}}if(l!==0){for(o=t-1;o>=0;o--)if(h=e[o],f=n[o],f===0)for(x=o,i.set(o,o,1),m=o-1;m>=0;m--){for(M=i.get(m,m)-h,d=0,y=x;y<=o;y++)d=d+i.get(m,y)*i.get(y,o);if(n[m]<0)g=M,p=d;else if(x=m,n[m]===0?i.set(m,o,M!==0?-d/M:-d/(u*l)):(_=i.get(m,m+1),k=i.get(m+1,m),f=(e[m]-h)*(e[m]-h)+n[m]*n[m],E=(_*p-g*d)/f,i.set(m,o,E),i.set(m+1,o,Math.abs(_)>Math.abs(g)?(-d-M*E)/_:(-p-k*E)/g)),E=Math.abs(i.get(m,o)),u*E*E>1)for(y=m;y<=o;y++)i.set(y,o,i.get(y,o)/E)}else if(f<0)for(x=o-1,Math.abs(i.get(o,o-1))>Math.abs(i.get(o-1,o))?(i.set(o-1,o-1,f/i.get(o,o-1)),i.set(o-1,o,-(i.get(o,o)-h)/i.get(o,o-1))):(D=Cf(0,-i.get(o-1,o),i.get(o-1,o-1)-h,f),i.set(o-1,o-1,D[0]),i.set(o-1,o,D[1])),i.set(o,o-1,0),i.set(o,o,1),m=o-2;m>=0;m--){for(S=0,A=0,y=x;y<=o;y++)S=S+i.get(m,y)*i.get(y,o-1),A=A+i.get(m,y)*i.get(y,o);if(M=i.get(m,m)-h,n[m]<0)g=M,d=S,p=A;else if(x=m,n[m]===0?(D=Cf(-S,-A,M,f),i.set(m,o-1,D[0]),i.set(m,o,D[1])):(_=i.get(m,m+1),k=i.get(m+1,m),C=(e[m]-h)*(e[m]-h)+n[m]*n[m]-f*f,I=(e[m]-h)*2*f,C===0&&I===0&&(C=u*l*(Math.abs(M)+Math.abs(f)+Math.abs(_)+Math.abs(k)+Math.abs(g))),D=Cf(_*d-g*S+f*A,_*p-g*A-f*S,C,I),i.set(m,o-1,D[0]),i.set(m,o,D[1]),Math.abs(_)>Math.abs(g)+Math.abs(f)?(i.set(m+1,o-1,(-S-M*i.get(m,o-1)+f*i.get(m,o))/_),i.set(m+1,o,(-A-M*i.get(m,o)-f*i.get(m,o-1))/_)):(D=Cf(-d-k*i.get(m,o-1),-p-k*i.get(m,o),g,f),i.set(m+1,o-1,D[0]),i.set(m+1,o,D[1]))),E=Math.max(Math.abs(i.get(m,o-1)),Math.abs(i.get(m,o))),u*E*E>1)for(y=m;y<=o;y++)i.set(y,o-1,i.get(y,o-1)/E),i.set(y,o,i.get(y,o)/E)}for(m=0;m<t;m++)if(m<a||m>s)for(y=m;y<t;y++)r.set(m,y,i.get(m,y));for(y=t-1;y>=a;y--)for(m=a;m<=s;m++){for(g=0,b=a;b<=Math.min(y,s);b++)g=g+r.get(m,b)*i.get(b,y);r.set(m,y,g)}}}function Cf(t,n,e,r){let i,o;return Math.abs(e)>Math.abs(r)?(i=r/e,o=e+i*r,[(t+i*n)/o,(n-i*t)/o]):(i=e/r,o=r+i*e,[(i*t+n)/o,(i*n-t)/o])}class SS{constructor(n){if(n=$r.checkMatrix(n),!n.isSymmetric())throw new Error("Matrix is not symmetric");let e=n,r=e.rows,i=new le(r,r),o=!0,a,s,u;for(s=0;s<r;s++){let c=0;for(u=0;u<s;u++){let l=0;for(a=0;a<u;a++)l+=i.get(u,a)*i.get(s,a);l=(e.get(s,u)-l)/i.get(u,u),i.set(s,u,l),c=c+l*l}for(c=e.get(s,s)-c,o&=c>0,i.set(s,s,Math.sqrt(Math.max(c,0))),u=s+1;u<r;u++)i.set(s,u,0)}this.L=i,this.positiveDefinite=!!o}isPositiveDefinite(){return this.positiveDefinite}solve(n){n=$r.checkMatrix(n);let e=this.L,r=e.rows;if(n.rows!==r)throw new Error("Matrix dimensions do not match");if(this.isPositiveDefinite()===!1)throw new Error("Matrix is not positive definite");let i=n.columns,o=n.clone(),a,s,u;for(u=0;u<r;u++)for(s=0;s<i;s++){for(a=0;a<u;a++)o.set(u,s,o.get(u,s)-o.get(a,s)*e.get(u,a));o.set(u,s,o.get(u,s)/e.get(u,u))}for(u=r-1;u>=0;u--)for(s=0;s<i;s++){for(a=u+1;a<r;a++)o.set(u,s,o.get(u,s)-o.get(a,s)*e.get(a,u));o.set(u,s,o.get(u,s)/e.get(u,u))}return o}get lowerTriangularMatrix(){return this.L}}class _S{constructor(n,e={}){n=$r.checkMatrix(n);let{Y:r}=e;const{scaleScores:i=!1,maxIterations:o=1e3,terminationCriteria:a=1e-10}=e;let s;if(r){if(gr(r)&&typeof r[0]=="number"?r=le.columnVector(r):r=$r.checkMatrix(r),r.rows!==n.rows)throw new Error("Y should have the same number of rows as X");s=r.getColumnVector(0)}else s=n.getColumnVector(0);let u=1,c,l,h,f;for(let d=0;d<o&&u>a;d++)h=n.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),h=h.div(h.norm()),c=n.mmul(h).div(h.transpose().mmul(h).get(0,0)),d>0&&(u=c.clone().sub(f).pow(2).sum()),f=c.clone(),r?(l=r.transpose().mmul(c).div(c.transpose().mmul(c).get(0,0)),l=l.div(l.norm()),s=r.mmul(l).div(l.transpose().mmul(l).get(0,0))):s=c;if(r){let d=n.transpose().mmul(c).div(c.transpose().mmul(c).get(0,0));d=d.div(d.norm());let p=n.clone().sub(c.clone().mmul(d.transpose())),g=s.transpose().mmul(c).div(c.transpose().mmul(c).get(0,0)),v=r.clone().sub(c.clone().mulS(g.get(0,0)).mmul(l.transpose()));this.t=c,this.p=d.transpose(),this.w=h.transpose(),this.q=l,this.u=s,this.s=c.transpose().mmul(c),this.xResidual=p,this.yResidual=v,this.betas=g}else this.w=h.transpose(),this.s=c.transpose().mmul(c).sqrt(),i?this.t=c.clone().div(this.s.get(0,0)):this.t=c,this.xResidual=n.sub(c.mmul(h.transpose()))}}const Uot=Object.freeze(Object.defineProperty({__proto__:null,AbstractMatrix:qe,CHO:SS,CholeskyDecomposition:SS,EVD:MS,EigenvalueDecomposition:MS,LU:Kd,LuDecomposition:Kd,Matrix:le,MatrixColumnSelectionView:Mot,MatrixColumnView:Eot,MatrixFlipColumnView:Sot,MatrixFlipRowView:_ot,MatrixRowSelectionView:Aot,MatrixRowView:kot,MatrixSelectionView:ud,MatrixSubView:Cot,MatrixTransposeView:Iot,NIPALS:_S,Nipals:_S,QR:Gm,QrDecomposition:Gm,SVD:qu,SingularValueDecomposition:qu,WrapperMatrix1D:sN,WrapperMatrix2D:$r,correlation:Rot,covariance:jot,default:le,determinant:cd,inverse:Oot,linearDependencies:Pot,pseudoInverse:Lot,solve:uN,wrap:Tot},Symbol.toStringTag,{value:"Module"})),cN=xo(Uot);Object.defineProperty(eb,"__esModule",{value:!0});var Cc=cN,Yot=function(){function t(n){this.distances=n.distances,this.dimension=n.dimension||2,this.linkDistance=n.linkDistance}return t.prototype.layout=function(){var n=this,e=n.dimension,r=n.distances,i=n.linkDistance;try{var o=Cc.Matrix.mul(Cc.Matrix.pow(r,2),-.5),a=o.mean("row"),s=o.mean("column"),u=o.mean();o.add(u).subRowVector(a).subColumnVector(s);var c=new Cc.SingularValueDecomposition(o),l=Cc.Matrix.sqrt(c.diagonalMatrix).diagonal();return c.leftSingularVectors.toJSON().map(function(g){return Cc.Matrix.mul([g],[l]).toJSON()[0].splice(0,e)})}catch{for(var h=[],f=0;f<r.length;f++){var d=Math.random()*i,p=Math.random()*i;h.push([d,p])}return h}},t}();eb.default=Yot;var ib={};Object.defineProperty(ib,"__esModule",{value:!0});var Vot=800,Wot=function(){function t(n){this.disp=[],this.positions=n.positions,this.adjMatrix=n.adjMatrix,this.focusID=n.focusID,this.radii=n.radii,this.iterations=n.iterations||10,this.height=n.height||10,this.width=n.width||10,this.speed=n.speed||100,this.gravity=n.gravity||10,this.nodeSizeFunc=n.nodeSizeFunc,this.k=n.k||5,this.strictRadial=n.strictRadial,this.nodes=n.nodes}return t.prototype.layout=function(){var n=this,e=n.positions,r=[],i=n.iterations,o=n.width/10;n.maxDisplace=o,n.disp=r;for(var a=0;a<i;a++)e.forEach(function(s,u){r[u]={x:0,y:0}}),n.getRepulsion(),n.updatePositions();return e},t.prototype.getRepulsion=function(){var n=this,e=n.positions,r=n.nodes,i=n.disp,o=n.k,a=n.radii||[];e.forEach(function(s,u){i[u]={x:0,y:0},e.forEach(function(c,l){if(u!==l&&a[u]===a[l]){var h=s[0]-c[0],f=s[1]-c[1],d=Math.sqrt(h*h+f*f);if(d===0){d=1;var p=u>l?1:-1;h=.01*p,f=.01*p}if(d<n.nodeSizeFunc(r[u])/2+n.nodeSizeFunc(r[l])/2){var g=o*o/d;i[u].x+=h/d*g,i[u].y+=f/d*g}}})})},t.prototype.updatePositions=function(){var n=this,e=n.positions,r=n.disp,i=n.speed,o=n.strictRadial,a=n.focusID,s=n.maxDisplace||n.width/10;o&&r.forEach(function(c,l){var h=e[l][0]-e[a][0],f=e[l][1]-e[a][1],d=Math.sqrt(h*h+f*f),p=f/d,g=-h/d,v=Math.sqrt(c.x*c.x+c.y*c.y),m=Math.acos((p*c.x+g*c.y)/v);m>Math.PI/2&&(m-=Math.PI/2,p*=-1,g*=-1);var y=Math.cos(m)*v;c.x=p*y,c.y=g*y});var u=n.radii;e.forEach(function(c,l){if(l!==a){var h=Math.sqrt(r[l].x*r[l].x+r[l].y*r[l].y);if(h>0&&l!==a){var f=Math.min(s*(i/Vot),h);if(c[0]+=r[l].x/h*f,c[1]+=r[l].y/h*f,o){var d=c[0]-e[a][0],p=c[1]-e[a][1],g=Math.sqrt(d*d+p*p);d=d/g*u[l],p=p/g*u[l],c[0]=e[a][0]+d,c[1]=e[a][1]+p}}}})},t}();ib.default=Wot;var Xot=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),lN=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(eg,"__esModule",{value:!0});eg.RadialLayout=void 0;var ai=Ln(),Hot=Yn,qot=lN(eb),Zot=lN(ib);function Kot(t){for(var n=t.length,e=t[0].length,r=[],i=0;i<n;i++){for(var o=[],a=0;a<e;a++)t[i][a]!==0?o.push(1/(t[i][a]*t[i][a])):o.push(0);r.push(o)}return r}function Qot(t,n){var e=-1;return t.forEach(function(r,i){r.id===n&&(e=i)}),e}function kS(t,n){return Math.sqrt((t[0]-n[0])*(t[0]-n[0])+(t[1]-n[1])*(t[1]-n[1]))}var Jot=function(t){Xot(n,t);function n(e){var r=t.call(this)||this;return r.maxIteration=1e3,r.focusNode=null,r.unitRadius=null,r.linkDistance=50,r.preventOverlap=!1,r.strictRadial=!0,r.maxPreventOverlapIteration=200,r.sortStrength=10,r.nodes=[],r.edges=[],r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,strictRadial:!0,maxPreventOverlapIteration:200,sortBy:void 0,sortStrength:10}},n.prototype.execute=function(){var e=this,r=e.nodes,i=e.edges||[];if(!r||r.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}!e.width&&typeof window<"u"&&(e.width=window.innerWidth),!e.height&&typeof window<"u"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]);var o=e.center;if(r.length===1){r[0].x=o[0],r[0].y=o[1],e.onLayoutEnd&&e.onLayoutEnd();return}var a=e.linkDistance,s=null;if((0,ai.isString)(e.focusNode)){for(var u=!1,c=0;c<r.length;c++)r[c].id===e.focusNode&&(s=r[c],e.focusNode=s,u=!0,c=r.length);u||(s=null)}else s=e.focusNode;s||(s=r[0],e.focusNode=s);var l=Qot(r,s.id);l<0&&(l=0),e.focusIndex=l;var h=(0,ai.getAdjMatrix)({nodes:r,edges:i},!1),f=(0,ai.floydWarshall)(h),d=e.maxToFocus(f,l);e.handleInfinity(f,l,d+1),e.distances=f;var p=f[l],g=e.width||500,v=e.height||500,m=g-o[0]>o[0]?o[0]:g-o[0],y=v-o[1]>o[1]?o[1]:v-o[1];m===0&&(m=g/2),y===0&&(y=v/2);var b=y>m?m:y,x=Math.max.apply(Math,p),w=[];p.forEach(function(L,R){e.unitRadius||(e.unitRadius=b/x),w[R]=L*e.unitRadius}),e.radii=w;var E=e.eIdealDisMatrix();e.eIdealDistances=E;var M=Kot(E);e.weights=M;var _=new qot.default({linkDistance:a,distances:E}),k=_.layout();k.forEach(function(L){(0,ai.isNaN)(L[0])&&(L[0]=Math.random()*a),(0,ai.isNaN)(L[1])&&(L[1]=Math.random()*a)}),e.positions=k,k.forEach(function(L,R){r[R].x=L[0]+o[0],r[R].y=L[1]+o[1]}),k.forEach(function(L){L[0]-=k[l][0],L[1]-=k[l][1]}),e.run();var S=e.preventOverlap,A=e.nodeSize,C,I=e.strictRadial;if(S){var N=e.nodeSpacing,D;(0,ai.isNumber)(N)?D=function(){return N}:(0,ai.isFunction)(N)?D=N:D=function(){return 0},A?(0,ai.isArray)(A)?C=function(L){var R=A[0]>A[1]?A[0]:A[1];return R+D(L)}:C=function(L){return A+D(L)}:C=function(L){if(L.size){if((0,ai.isArray)(L.size)){var R=L.size[0]>L.size[1]?L.size[0]:L.size[1];return R+D(L)}if((0,ai.isObject)(L.size)){var R=L.size.width>L.size.height?L.size.width:L.size.height;return R+D(L)}return L.size+D(L)}return 10+D(L)};var P={nodes:r,nodeSizeFunc:C,adjMatrix:h,positions:k,radii:w,height:v,width:g,strictRadial:I,focusID:l,iterations:e.maxPreventOverlapIteration||200,k:k.length/4.5},j=new Zot.default(P);k=j.layout()}return k.forEach(function(L,R){r[R].x=L[0]+o[0],r[R].y=L[1]+o[1]}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:r,edges:i}},n.prototype.run=function(){for(var e=this,r=e.maxIteration,i=e.positions||[],o=e.weights||[],a=e.eIdealDistances||[],s=e.radii||[],u=0;u<=r;u++){var c=u/r;e.oneIteration(c,i,s,a,o)}},n.prototype.oneIteration=function(e,r,i,o,a){var s=this,u=1-e,c=s.focusIndex;r.forEach(function(l,h){var f=kS(l,[0,0]),d=f===0?0:1/f;if(h!==c){var p=0,g=0,v=0;r.forEach(function(y,b){if(h!==b){var x=kS(l,y),w=x===0?0:1/x,E=o[b][h];v+=a[h][b],p+=a[h][b]*(y[0]+E*(l[0]-y[0])*w),g+=a[h][b]*(y[1]+E*(l[1]-y[1])*w)}});var m=i[h]===0?0:1/i[h];v*=u,v+=e*m*m,p*=u,p+=e*m*l[0]*d,l[0]=p/v,g*=u,g+=e*m*l[1]*d,l[1]=g/v}})},n.prototype.eIdealDisMatrix=function(){var e=this,r=e.nodes;if(!r)return[];var i=e.distances,o=e.linkDistance,a=e.radii||[],s=e.unitRadius||50,u=[];return i&&i.forEach(function(c,l){var h=[];c.forEach(function(f,d){if(l===d)h.push(0);else if(a[l]===a[d])if(e.sortBy==="data")h.push(f*(Math.abs(l-d)*e.sortStrength)/(a[l]/s));else if(e.sortBy){var p=r[l][e.sortBy]||0,g=r[d][e.sortBy]||0;(0,ai.isString)(p)&&(p=p.charCodeAt(0)),(0,ai.isString)(g)&&(g=g.charCodeAt(0)),h.push(f*(Math.abs(p-g)*e.sortStrength)/(a[l]/s))}else h.push(f*o/(a[l]/s));else{var v=(o+s)/2;h.push(f*v)}}),u.push(h)}),u},n.prototype.handleInfinity=function(e,r,i){for(var o=e.length,a=0;a<o;a++)if(e[r][a]===1/0){e[r][a]=i,e[a][r]=i;for(var s=0;s<o;s++)e[a][s]!==1/0&&e[r][s]===1/0&&(e[r][s]=i+e[a][s],e[s][r]=i+e[a][s])}for(var a=0;a<o;a++)if(a!==r){for(var s=0;s<o;s++)if(e[a][s]===1/0){var u=Math.abs(e[r][a]-e[r][s]);u=u===0?1:u,e[a][s]=u}}},n.prototype.maxToFocus=function(e,r){for(var i=0,o=0;o<e[r].length;o++)e[r][o]!==1/0&&(i=e[r][o]>i?e[r][o]:i);return i},n.prototype.getType=function(){return"radial"},n}(Hot.Base);eg.RadialLayout=Jot;(function(t){var n=bt&&bt.__createBinding||(Object.create?function(r,i,o,a){a===void 0&&(a=o);var s=Object.getOwnPropertyDescriptor(i,o);(!s||("get"in s?!i.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return i[o]}}),Object.defineProperty(r,a,s)}:function(r,i,o,a){a===void 0&&(a=o),r[a]=i[o]}),e=bt&&bt.__exportStar||function(r,i){for(var o in r)o!=="default"&&!Object.prototype.hasOwnProperty.call(i,o)&&n(i,r,o)};Object.defineProperty(t,"__esModule",{value:!0}),e(eg,t)})(tb);var oh={},$ot=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(oh,"__esModule",{value:!0});oh.ConcentricLayout=void 0;var Hi=Ln(),tat=Yn,eat=function(t){$ot(n,t);function n(e){var r=t.call(this)||this;return r.nodeSize=30,r.minNodeSpacing=10,r.nodeSpacing=10,r.preventOverlap=!1,r.equidistant=!1,r.startAngle=3/2*Math.PI,r.clockwise=!0,r.sortBy="degree",r.nodes=[],r.edges=[],r.width=300,r.height=300,r.onLayoutEnd=function(){},r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{nodeSize:30,minNodeSpacing:10,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"}},n.prototype.execute=function(){var e,r,i=this,o=i.nodes,a=i.edges,s=o.length;if(s===0){(e=i.onLayoutEnd)===null||e===void 0||e.call(i);return}!i.width&&typeof window<"u"&&(i.width=window.innerWidth),!i.height&&typeof window<"u"&&(i.height=window.innerHeight),i.center||(i.center=[i.width/2,i.height/2]);var u=i.center;if(s===1){o[0].x=u[0],o[0].y=u[1],(r=i.onLayoutEnd)===null||r===void 0||r.call(i);return}var c=i.nodeSize,l=i.nodeSpacing,h=[],f,d=0;(0,Hi.isArray)(c)?f=Math.max(c[0],c[1]):f=c,(0,Hi.isArray)(l)?d=Math.max(l[0],l[1]):(0,Hi.isNumber)(l)&&(d=l),o.forEach(function(I){h.push(I);var N=f;(0,Hi.isArray)(I.size)?N=Math.max(I.size[0],I.size[1]):(0,Hi.isNumber)(I.size)?N=I.size:(0,Hi.isObject)(I.size)&&(N=Math.max(I.size.width,I.size.height)),f=Math.max(f,N),(0,Hi.isFunction)(l)&&(d=Math.max(l(I),d))}),i.clockwise=i.counterclockwise!==void 0?!i.counterclockwise:i.clockwise;var p={},g={};if(h.forEach(function(I,N){p[I.id]=I,g[I.id]=N}),(i.sortBy==="degree"||!(0,Hi.isString)(i.sortBy)||h[0][i.sortBy]===void 0)&&(i.sortBy="degree",!(0,Hi.isNumber)(o[0].degree))){var v=(0,Hi.getDegree)(o.length,g,a);h.forEach(function(I,N){I.degree=v[N].all})}h.sort(function(I,N){return N[i.sortBy]-I[i.sortBy]}),i.maxValueNode=h[0],i.maxLevelDiff=i.maxLevelDiff||i.maxValueNode[i.sortBy]/4;var m=[[]],y=m[0];h.forEach(function(I){if(y.length>0){var N=Math.abs(y[0][i.sortBy]-I[i.sortBy]);i.maxLevelDiff&&N>=i.maxLevelDiff&&(y=[],m.push(y))}y.push(I)});var b=f+(d||i.minNodeSpacing);if(!i.preventOverlap){var x=m.length>0&&m[0].length>1,w=Math.min(i.width,i.height)/2-b,E=w/(m.length+(x?1:0));b=Math.min(b,E)}var M=0;if(m.forEach(function(I){var N=i.sweep;N===void 0&&(N=2*Math.PI-2*Math.PI/I.length);var D=I.dTheta=N/Math.max(1,I.length-1);if(I.length>1&&i.preventOverlap){var P=Math.cos(D)-Math.cos(0),j=Math.sin(D)-Math.sin(0),L=Math.sqrt(b*b/(P*P+j*j));M=Math.max(L,M)}I.r=M,M+=b}),i.equidistant){for(var _=0,k=0,S=0;S<m.length;S++){var A=m[S],C=A.r-k;_=Math.max(_,C)}k=0,m.forEach(function(I,N){N===0&&(k=I.r),I.r=k,k+=_})}return m.forEach(function(I){var N=I.dTheta,D=I.r;I.forEach(function(P,j){var L=i.startAngle+(i.clockwise?1:-1)*N*j;P.x=u[0]+D*Math.cos(L),P.y=u[1]+D*Math.sin(L)})}),i.onLayoutEnd&&i.onLayoutEnd(),{nodes:o,edges:a}},n.prototype.getType=function(){return"concentric"},n}(tat.Base);oh.ConcentricLayout=eat;var ah={},nat=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(ah,"__esModule",{value:!0});ah.MDSLayout=void 0;var Ic=cN,cv=Ln(),rat=Yn,iat=function(t){nat(n,t);function n(e){var r=t.call(this)||this;return r.center=[0,0],r.linkDistance=50,r.nodes=[],r.edges=[],r.onLayoutEnd=function(){},r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{center:[0,0],linkDistance:50}},n.prototype.execute=function(){var e=this,r=e.nodes,i=e.edges,o=i===void 0?[]:i,a=e.center;if(!r||r.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}if(r.length===1){r[0].x=a[0],r[0].y=a[1],e.onLayoutEnd&&e.onLayoutEnd();return}var s=e.linkDistance,u=(0,cv.getAdjMatrix)({nodes:r,edges:o},!1),c=(0,cv.floydWarshall)(u);e.handleInfinity(c);var l=(0,cv.scaleMatrix)(c,s);e.scaledDistances=l;var h=e.runMDS();return e.positions=h,h.forEach(function(f,d){r[d].x=f[0]+a[0],r[d].y=f[1]+a[1]}),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:r,edges:o}},n.prototype.runMDS=function(){var e=this,r=2,i=e.scaledDistances,o=Ic.Matrix.mul(Ic.Matrix.pow(i,2),-.5),a=o.mean("row"),s=o.mean("column"),u=o.mean();o.add(u).subRowVector(a).subColumnVector(s);var c=new Ic.SingularValueDecomposition(o),l=Ic.Matrix.sqrt(c.diagonalMatrix).diagonal();return c.leftSingularVectors.toJSON().map(function(h){return Ic.Matrix.mul([h],[l]).toJSON()[0].splice(0,r)})},n.prototype.handleInfinity=function(e){var r=-999999;e.forEach(function(i){i.forEach(function(o){o!==1/0&&r<o&&(r=o)})}),e.forEach(function(i,o){i.forEach(function(a,s){a===1/0&&(e[o][s]=r)})})},n.prototype.getType=function(){return"mds"},n}(rat.Base);ah.MDSLayout=iat;var sh={},oat=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(sh,"__esModule",{value:!0});sh.FruchtermanLayout=void 0;var aat=Yn,Gn=Ln(),sat=800,uat=function(t){oat(n,t);function n(e){var r=t.call(this)||this;return r.maxIteration=1e3,r.workerEnabled=!1,r.gravity=10,r.speed=5,r.clustering=!1,r.clusterGravity=10,r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.onLayoutEnd=function(){},r.tick=function(){},r.animate=!0,r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10,animate:!0}},n.prototype.execute=function(){var e=this,r,i,o=this,a=o.nodes;if(o.timeInterval!==void 0&&typeof window<"u"&&window.clearInterval(o.timeInterval),!a||a.length===0){(r=o.onLayoutEnd)===null||r===void 0||r.call(o);return}!o.width&&typeof window<"u"&&(o.width=window.innerWidth),!o.height&&typeof window<"u"&&(o.height=window.innerHeight),o.center||(o.center=[o.width/2,o.height/2]);var s=o.center;if(a.length===1){a[0].x=s[0],a[0].y=s[1],(i=o.onLayoutEnd)===null||i===void 0||i.call(o);return}var u={},c={};return a.forEach(function(l,h){(0,Gn.isNumber)(l.x)||(l.x=Math.random()*e.width),(0,Gn.isNumber)(l.y)||(l.y=Math.random()*e.height),u[l.id]=l,c[l.id]=h}),o.nodeMap=u,o.nodeIdxMap=c,o.run()},n.prototype.run=function(){var e,r=this,i=r.nodes;if(i){var o=r.edges,a=r.maxIteration,s=r.workerEnabled,u=r.clustering,c=r.animate,l={};if(u&&i.forEach(function(d){l[d.cluster]===void 0&&(l[d.cluster]={name:d.cluster,cx:0,cy:0,count:0})}),s||!c){for(var h=0;h<a;h++)r.runOneStep(l);(e=r.onLayoutEnd)===null||e===void 0||e.call(r)}else{if(typeof window>"u")return;var f=0;this.timeInterval=window.setInterval(function(){var d;r.runOneStep(l),f++,f>=a&&((d=r.onLayoutEnd)===null||d===void 0||d.call(r),window.clearInterval(r.timeInterval))},0)}return{nodes:i,edges:o}}},n.prototype.runOneStep=function(e){var r,i=this,o=i.nodes;if(o){var a=i.edges,s=i.center,u=i.gravity,c=i.speed,l=i.clustering,h=i.height*i.width,f=Math.sqrt(h)/10,d=h/(o.length+1),p=Math.sqrt(d),g=[];if(o.forEach(function(y,b){g[b]={x:0,y:0}}),i.applyCalculate(o,a,g,p,d),l){for(var v in e)e[v].cx=0,e[v].cy=0,e[v].count=0;o.forEach(function(y){var b=e[y.cluster];(0,Gn.isNumber)(y.x)&&(b.cx+=y.x),(0,Gn.isNumber)(y.y)&&(b.cy+=y.y),b.count++});for(var v in e)e[v].cx/=e[v].count,e[v].cy/=e[v].count;var m=i.clusterGravity||u;o.forEach(function(y,b){if(!(!(0,Gn.isNumber)(y.x)||!(0,Gn.isNumber)(y.y))){var x=e[y.cluster],w=Math.sqrt((y.x-x.cx)*(y.x-x.cx)+(y.y-x.cy)*(y.y-x.cy)),E=p*m;g[b].x-=E*(y.x-x.cx)/w,g[b].y-=E*(y.y-x.cy)/w}})}o.forEach(function(y,b){if(!(!(0,Gn.isNumber)(y.x)||!(0,Gn.isNumber)(y.y))){var x=.01*p*u;g[b].x-=x*(y.x-s[0]),g[b].y-=x*(y.y-s[1])}}),o.forEach(function(y,b){if((0,Gn.isNumber)(y.fx)&&(0,Gn.isNumber)(y.fy)){y.x=y.fx,y.y=y.fy;return}if(!(!(0,Gn.isNumber)(y.x)||!(0,Gn.isNumber)(y.y))){var x=Math.sqrt(g[b].x*g[b].x+g[b].y*g[b].y);if(x>0){var w=Math.min(f*(c/sat),x);y.x+=g[b].x/x*w,y.y+=g[b].y/x*w}}}),(r=i.tick)===null||r===void 0||r.call(i)}},n.prototype.applyCalculate=function(e,r,i,o,a){var s=this;s.calRepulsive(e,i,a),r&&s.calAttractive(r,i,o)},n.prototype.calRepulsive=function(e,r,i){e.forEach(function(o,a){r[a]={x:0,y:0},e.forEach(function(s,u){if(a!==u&&!(!(0,Gn.isNumber)(o.x)||!(0,Gn.isNumber)(s.x)||!(0,Gn.isNumber)(o.y)||!(0,Gn.isNumber)(s.y))){var c=o.x-s.x,l=o.y-s.y,h=c*c+l*l;if(h===0){h=1;var f=a>u?1:-1;c=.01*f,l=.01*f}var d=i/h;r[a].x+=c*d,r[a].y+=l*d}})})},n.prototype.calAttractive=function(e,r,i){var o=this;e.forEach(function(a){var s=(0,Gn.getEdgeTerminal)(a,"source"),u=(0,Gn.getEdgeTerminal)(a,"target");if(!(!s||!u)){var c=o.nodeIdxMap[s],l=o.nodeIdxMap[u];if(c!==l){var h=o.nodeMap[s],f=o.nodeMap[u];if(!(!(0,Gn.isNumber)(f.x)||!(0,Gn.isNumber)(h.x)||!(0,Gn.isNumber)(f.y)||!(0,Gn.isNumber)(h.y))){var d=f.x-h.x,p=f.y-h.y,g=Math.sqrt(d*d+p*p),v=g*g/i;r[l].x-=d/g*v,r[l].y-=p/g*v,r[c].x+=d/g*v,r[c].y+=p/g*v}}}})},n.prototype.stop=function(){this.timeInterval&&typeof window<"u"&&window.clearInterval(this.timeInterval)},n.prototype.destroy=function(){var e=this;e.stop(),e.tick=null,e.nodes=null,e.edges=null,e.destroyed=!0},n.prototype.getType=function(){return"fruchterman"},n}(aat.Base);sh.FruchtermanLayout=uat;var uh={};function AS(t,n,e,r,i,o,a){try{var s=t[o](a),u=s.value}catch(c){e(c);return}s.done?n(u):Promise.resolve(u).then(r,i)}function Ma(t){return function(){var n=this,e=arguments;return new Promise(function(r,i){var o=t.apply(n,e);function a(u){AS(o,r,i,a,s,"next",u)}function s(u){AS(o,r,i,a,s,"throw",u)}a(void 0)})}}function Zu(t){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Zu(t)}function cat(t,n){if(Zu(t)!=="object"||t===null)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var r=e.call(t,n||"default");if(Zu(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}function hN(t){var n=cat(t,"string");return Zu(n)==="symbol"?n:String(n)}function Qt(t,n,e){return n=hN(n),n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function zi(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function CS(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hN(r.key),r)}}function Gi(t,n,e){return n&&CS(t.prototype,n),e&&CS(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}var lat=typeof bt=="object"&&bt&&bt.Object===Object&&bt,fN=lat,hat=fN,fat=typeof self=="object"&&self&&self.Object===Object&&self,dat=hat||fat||Function("return this")(),pat=dat,gat=pat,vat=gat.Symbol,dN=vat,IS=dN,pN=Object.prototype,mat=pN.hasOwnProperty,yat=pN.toString,Tc=IS?IS.toStringTag:void 0;function bat(t){var n=mat.call(t,Tc),e=t[Tc];try{t[Tc]=void 0;var r=!0}catch{}var i=yat.call(t);return r&&(n?t[Tc]=e:delete t[Tc]),i}var xat=bat,wat=Object.prototype,Eat=wat.toString;function Mat(t){return Eat.call(t)}var Sat=Mat,TS=dN,_at=xat,kat=Sat,Aat="[object Null]",Cat="[object Undefined]",OS=TS?TS.toStringTag:void 0;function Iat(t){return t==null?t===void 0?Cat:Aat:OS&&OS in Object(t)?_at(t):kat(t)}var ob=Iat,Tat=9007199254740991;function Oat(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Tat}var Nat=Oat;function Dat(t){return t!=null&&typeof t=="object"}var ab=Dat,Pat=ob,Lat=Nat,jat=ab,Rat="[object Arguments]",Fat="[object Array]",Bat="[object Boolean]",zat="[object Date]",Gat="[object Error]",Uat="[object Function]",Yat="[object Map]",Vat="[object Number]",Wat="[object Object]",Xat="[object RegExp]",Hat="[object Set]",qat="[object String]",Zat="[object WeakMap]",Kat="[object ArrayBuffer]",Qat="[object DataView]",Jat="[object Float32Array]",$at="[object Float64Array]",tst="[object Int8Array]",est="[object Int16Array]",nst="[object Int32Array]",rst="[object Uint8Array]",ist="[object Uint8ClampedArray]",ost="[object Uint16Array]",ast="[object Uint32Array]",kn={};kn[Jat]=kn[$at]=kn[tst]=kn[est]=kn[nst]=kn[rst]=kn[ist]=kn[ost]=kn[ast]=!0;kn[Rat]=kn[Fat]=kn[Kat]=kn[Bat]=kn[Qat]=kn[zat]=kn[Gat]=kn[Uat]=kn[Yat]=kn[Vat]=kn[Wat]=kn[Xat]=kn[Hat]=kn[qat]=kn[Zat]=!1;function sst(t){return jat(t)&&Lat(t.length)&&!!kn[Pat(t)]}var ust=sst;function cst(t){return function(n){return t(n)}}var lst=cst,Qd={exports:{}};Qd.exports;(function(t,n){var e=fN,r=n&&!n.nodeType&&n,i=r&&!0&&t&&!t.nodeType&&t,o=i&&i.exports===r,a=o&&e.process,s=function(){try{var u=i&&i.require&&i.require("util").types;return u||a&&a.binding&&a.binding("util")}catch{}}();t.exports=s})(Qd,Qd.exports);var hst=Qd.exports,fst=ust,dst=lst,NS=hst,DS=NS&&NS.isTypedArray,pst=DS?dst(DS):fst,gst=pst;const Jd=bo(gst);var vst=ob,mst=ab,yst="[object Number]";function bst(t){return typeof t=="number"||mst(t)&&vst(t)==yst}var xst=bst;const wst=bo(xst);var Est=Array.isArray,Mst=Est;const Sst=bo(Mst);var gN={exports:{}},vN={exports:{}};(function(t){function n(e){"@babel/helpers - typeof";return t.exports=n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(vN);var _st=vN.exports;(function(t){var n=_st.default;function e(){t.exports=e=function(){return r},t.exports.__esModule=!0,t.exports.default=t.exports;var r={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(D,P,j){D[P]=j.value},s=typeof Symbol=="function"?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function h(D,P,j){return Object.defineProperty(D,P,{value:j,enumerable:!0,configurable:!0,writable:!0}),D[P]}try{h({},"")}catch{h=function(D,P,j){return D[P]=j}}function f(D,P,j,L){var R=P&&P.prototype instanceof g?P:g,V=Object.create(R.prototype),tt=new C(L||[]);return a(V,"_invoke",{value:_(D,j,tt)}),V}function d(D,P,j){try{return{type:"normal",arg:D.call(P,j)}}catch(L){return{type:"throw",arg:L}}}r.wrap=f;var p={};function g(){}function v(){}function m(){}var y={};h(y,u,function(){return this});var b=Object.getPrototypeOf,x=b&&b(b(I([])));x&&x!==i&&o.call(x,u)&&(y=x);var w=m.prototype=g.prototype=Object.create(y);function E(D){["next","throw","return"].forEach(function(P){h(D,P,function(j){return this._invoke(P,j)})})}function M(D,P){function j(R,V,tt,ut){var dt=d(D[R],D,V);if(dt.type!=="throw"){var J=dt.arg,Et=J.value;return Et&&n(Et)=="object"&&o.call(Et,"__await")?P.resolve(Et.__await).then(function(Bt){j("next",Bt,tt,ut)},function(Bt){j("throw",Bt,tt,ut)}):P.resolve(Et).then(function(Bt){J.value=Bt,tt(J)},function(Bt){return j("throw",Bt,tt,ut)})}ut(dt.arg)}var L;a(this,"_invoke",{value:function(R,V){function tt(){return new P(function(ut,dt){j(R,V,ut,dt)})}return L=L?L.then(tt,tt):tt()}})}function _(D,P,j){var L="suspendedStart";return function(R,V){if(L==="executing")throw new Error("Generator is already running");if(L==="completed"){if(R==="throw")throw V;return N()}for(j.method=R,j.arg=V;;){var tt=j.delegate;if(tt){var ut=k(tt,j);if(ut){if(ut===p)continue;return ut}}if(j.method==="next")j.sent=j._sent=j.arg;else if(j.method==="throw"){if(L==="suspendedStart")throw L="completed",j.arg;j.dispatchException(j.arg)}else j.method==="return"&&j.abrupt("return",j.arg);L="executing";var dt=d(D,P,j);if(dt.type==="normal"){if(L=j.done?"completed":"suspendedYield",dt.arg===p)continue;return{value:dt.arg,done:j.done}}dt.type==="throw"&&(L="completed",j.method="throw",j.arg=dt.arg)}}}function k(D,P){var j=P.method,L=D.iterator[j];if(L===void 0)return P.delegate=null,j==="throw"&&D.iterator.return&&(P.method="return",P.arg=void 0,k(D,P),P.method==="throw")||j!=="return"&&(P.method="throw",P.arg=new TypeError("The iterator does not provide a '"+j+"' method")),p;var R=d(L,D.iterator,P.arg);if(R.type==="throw")return P.method="throw",P.arg=R.arg,P.delegate=null,p;var V=R.arg;return V?V.done?(P[D.resultName]=V.value,P.next=D.nextLoc,P.method!=="return"&&(P.method="next",P.arg=void 0),P.delegate=null,p):V:(P.method="throw",P.arg=new TypeError("iterator result is not an object"),P.delegate=null,p)}function S(D){var P={tryLoc:D[0]};1 in D&&(P.catchLoc=D[1]),2 in D&&(P.finallyLoc=D[2],P.afterLoc=D[3]),this.tryEntries.push(P)}function A(D){var P=D.completion||{};P.type="normal",delete P.arg,D.completion=P}function C(D){this.tryEntries=[{tryLoc:"root"}],D.forEach(S,this),this.reset(!0)}function I(D){if(D){var P=D[u];if(P)return P.call(D);if(typeof D.next=="function")return D;if(!isNaN(D.length)){var j=-1,L=function R(){for(;++j<D.length;)if(o.call(D,j))return R.value=D[j],R.done=!1,R;return R.value=void 0,R.done=!0,R};return L.next=L}}return{next:N}}function N(){return{value:void 0,done:!0}}return v.prototype=m,a(w,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:v,configurable:!0}),v.displayName=h(m,l,"GeneratorFunction"),r.isGeneratorFunction=function(D){var P=typeof D=="function"&&D.constructor;return!!P&&(P===v||(P.displayName||P.name)==="GeneratorFunction")},r.mark=function(D){return Object.setPrototypeOf?Object.setPrototypeOf(D,m):(D.__proto__=m,h(D,l,"GeneratorFunction")),D.prototype=Object.create(w),D},r.awrap=function(D){return{__await:D}},E(M.prototype),h(M.prototype,c,function(){return this}),r.AsyncIterator=M,r.async=function(D,P,j,L,R){R===void 0&&(R=Promise);var V=new M(f(D,P,j,L),R);return r.isGeneratorFunction(P)?V:V.next().then(function(tt){return tt.done?tt.value:V.next()})},E(w),h(w,l,"Generator"),h(w,u,function(){return this}),h(w,"toString",function(){return"[object Generator]"}),r.keys=function(D){var P=Object(D),j=[];for(var L in P)j.push(L);return j.reverse(),function R(){for(;j.length;){var V=j.pop();if(V in P)return R.value=V,R.done=!1,R}return R.done=!0,R}},r.values=I,C.prototype={constructor:C,reset:function(D){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!D)for(var P in this)P.charAt(0)==="t"&&o.call(this,P)&&!isNaN(+P.slice(1))&&(this[P]=void 0)},stop:function(){this.done=!0;var D=this.tryEntries[0].completion;if(D.type==="throw")throw D.arg;return this.rval},dispatchException:function(D){if(this.done)throw D;var P=this;function j(dt,J){return V.type="throw",V.arg=D,P.next=dt,J&&(P.method="next",P.arg=void 0),!!J}for(var L=this.tryEntries.length-1;L>=0;--L){var R=this.tryEntries[L],V=R.completion;if(R.tryLoc==="root")return j("end");if(R.tryLoc<=this.prev){var tt=o.call(R,"catchLoc"),ut=o.call(R,"finallyLoc");if(tt&&ut){if(this.prev<R.catchLoc)return j(R.catchLoc,!0);if(this.prev<R.finallyLoc)return j(R.finallyLoc)}else if(tt){if(this.prev<R.catchLoc)return j(R.catchLoc,!0)}else{if(!ut)throw new Error("try statement without catch or finally");if(this.prev<R.finallyLoc)return j(R.finallyLoc)}}}},abrupt:function(D,P){for(var j=this.tryEntries.length-1;j>=0;--j){var L=this.tryEntries[j];if(L.tryLoc<=this.prev&&o.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var R=L;break}}R&&(D==="break"||D==="continue")&&R.tryLoc<=P&&P<=R.finallyLoc&&(R=null);var V=R?R.completion:{};return V.type=D,V.arg=P,R?(this.method="next",this.next=R.finallyLoc,p):this.complete(V)},complete:function(D,P){if(D.type==="throw")throw D.arg;return D.type==="break"||D.type==="continue"?this.next=D.arg:D.type==="return"?(this.rval=this.arg=D.arg,this.method="return",this.next="end"):D.type==="normal"&&P&&(this.next=P),p},finish:function(D){for(var P=this.tryEntries.length-1;P>=0;--P){var j=this.tryEntries[P];if(j.finallyLoc===D)return this.complete(j.completion,j.afterLoc),A(j),p}},catch:function(D){for(var P=this.tryEntries.length-1;P>=0;--P){var j=this.tryEntries[P];if(j.tryLoc===D){var L=j.completion;if(L.type==="throw"){var R=L.arg;A(j)}return R}}throw new Error("illegal catch attempt")},delegateYield:function(D,P,j){return this.delegate={iterator:I(D),resultName:P,nextLoc:j},this.method==="next"&&(this.arg=void 0),p}},r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(gN);var kst=gN.exports,ld=kst(),Ast=ld;try{regeneratorRuntime=ld}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=ld:Function("r","regeneratorRuntime = r")(ld)}const Sr=bo(Ast);var Cst=1;function mN(){return Cst++}var Tt;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.MAX_EXT=32776]="MAX_EXT",t[t.MIN_EXT=32775]="MIN_EXT",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.CULL_FACE=2884]="CULL_FACE",t[t.BLEND=3042]="BLEND",t[t.DITHER=3024]="DITHER",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.TEXTURE1=33985]="TEXTURE1",t[t.TEXTURE2=33986]="TEXTURE2",t[t.TEXTURE3=33987]="TEXTURE3",t[t.TEXTURE4=33988]="TEXTURE4",t[t.TEXTURE5=33989]="TEXTURE5",t[t.TEXTURE6=33990]="TEXTURE6",t[t.TEXTURE7=33991]="TEXTURE7",t[t.TEXTURE8=33992]="TEXTURE8",t[t.TEXTURE9=33993]="TEXTURE9",t[t.TEXTURE10=33994]="TEXTURE10",t[t.TEXTURE11=33995]="TEXTURE11",t[t.TEXTURE12=33996]="TEXTURE12",t[t.TEXTURE13=33997]="TEXTURE13",t[t.TEXTURE14=33998]="TEXTURE14",t[t.TEXTURE15=33999]="TEXTURE15",t[t.TEXTURE16=34e3]="TEXTURE16",t[t.TEXTURE17=34001]="TEXTURE17",t[t.TEXTURE18=34002]="TEXTURE18",t[t.TEXTURE19=34003]="TEXTURE19",t[t.TEXTURE20=34004]="TEXTURE20",t[t.TEXTURE21=34005]="TEXTURE21",t[t.TEXTURE22=34006]="TEXTURE22",t[t.TEXTURE23=34007]="TEXTURE23",t[t.TEXTURE24=34008]="TEXTURE24",t[t.TEXTURE25=34009]="TEXTURE25",t[t.TEXTURE26=34010]="TEXTURE26",t[t.TEXTURE27=34011]="TEXTURE27",t[t.TEXTURE28=34012]="TEXTURE28",t[t.TEXTURE29=34013]="TEXTURE29",t[t.TEXTURE30=34014]="TEXTURE30",t[t.TEXTURE31=34015]="TEXTURE31",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.COPY_SRC=1]="COPY_SRC",t[t.COPY_DST=2]="COPY_DST",t[t.SAMPLED=4]="SAMPLED",t[t.STORAGE=8]="STORAGE",t[t.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(Tt||(Tt={}));var Ist=function(){function t(){zi(this,t),this.config=void 0}return Gi(t,[{key:"get",value:function(){return this.config}},{key:"set",value:function(n){this.config=n}}]),t}(),Dl;(function(t){t.Void="Void",t.Boolean="Boolean",t.Float="Float",t.Uint32="Uint32",t.Int32="Int32",t.Vector="Vector",t.Vector2Float="vec2<f32>",t.Vector3Float="vec3<f32>",t.Vector4Float="vec4<f32>",t.Vector2Boolean="vec2<bool>",t.Vector3Boolean="vec3<bool>",t.Vector4Boolean="vec4<bool>",t.Vector2Uint="vec2<u32>",t.Vector3Uint="vec3<u32>",t.Vector4Uint="vec4<u32>",t.Vector2Int="vec2<i32>",t.Vector3Int="vec3<i32>",t.Vector4Int="vec4<i32>",t.Matrix="Matrix",t.Matrix3x3Float="mat3x3<f32>",t.Matrix4x4Float="mat4x4<i32>",t.Struct="Struct",t.FloatArray="Float[]",t.Vector4FloatArray="vec4<f32>[]"})(Dl||(Dl={}));var PS;(function(t){t.Program="Program",t.Identifier="Identifier",t.VariableDeclaration="VariableDeclaration",t.BlockStatement="BlockStatement",t.ReturnStatement="ReturnStatement",t.FunctionDeclaration="FunctionDeclaration",t.VariableDeclarator="VariableDeclarator",t.AssignmentExpression="AssignmentExpression",t.LogicalExpression="LogicalExpression",t.BinaryExpression="BinaryExpression",t.ArrayExpression="ArrayExpression",t.UnaryExpression="UnaryExpression",t.UpdateExpression="UpdateExpression",t.FunctionExpression="FunctionExpression",t.MemberExpression="MemberExpression",t.ConditionalExpression="ConditionalExpression",t.ExpressionStatement="ExpressionStatement",t.CallExpression="CallExpression",t.NumThreadStatement="NumThreadStatement",t.StorageStatement="StorageStatement",t.DoWhileStatement="DoWhileStatement",t.WhileStatement="WhileStatement",t.ForStatement="ForStatement",t.BreakStatement="BreakStatement",t.ContinueStatement="ContinueStatement",t.IfStatement="IfStatement",t.ImportedFunctionStatement="ImportedFunctionStatement"})(PS||(PS={}));var Ku;(function(t){t.Input="Input",t.Output="Output",t.Uniform="Uniform",t.Workgroup="Workgroup",t.UniformConstant="UniformConstant",t.Image="Image",t.StorageBuffer="StorageBuffer",t.Private="Private",t.Function="Function"})(Ku||(Ku={}));var ol;(function(t){t.GLSL100="GLSL100",t.GLSL450="GLSL450",t.WGSL="WGSL"})(ol||(ol={}));var Tst="__DefineValuePlaceholder__";function Ost(){if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function LS(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,r)}return e}function jS(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?LS(Object(e),!0).forEach(function(r){Qt(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):LS(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}var yN=function(){function t(n,e){zi(this,t),this.engine=n,this.configService=e,this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return Gi(t,[{key:"init",value:function(){var n=this.configService.get(),e=n.canvas,r=n.engineOptions;this.initPromise=this.engine.init(jS({canvas:e||Ost(),antialiasing:!1},r))}},{key:"setBundle",value:function(n){this.compiledBundle=JSON.parse(JSON.stringify(n))}},{key:"setDispatch",value:function(n){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=n),this}},{key:"setMaxIteration",value:function(n){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=n),this}},{key:"setBinding",value:function(n,e){var r=this;if(typeof n=="string"){var i=wst(e)||Jd(e)||Sst(e);if(this.compiledBundle&&this.compiledBundle.context){var o=this.compiledBundle.context.defines.find(function(s){return s.name===n});if(o)return o.value=e,this;var a=this.compiledBundle.context.uniforms.find(function(s){return s.name===n});a&&(i?(a.data=e,a.isReferer=!1,a.storageClass===Ku.Uniform?this.model&&this.model.updateUniform(n,e):this.model&&this.model.updateBuffer(n,e)):(a.isReferer=!0,a.data=e))}}else Object.keys(n).forEach(function(s){r.setBinding(s,n[s])});return this}},{key:"execute",value:function(){var n=Ma(Sr.mark(function r(){var i=this,o,a,s=arguments;return Sr.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(o=s.length>0&&s[0]!==void 0?s[0]:1,!this.dirty){u.next=6;break}return this.compiledBundle.context&&(o>1?this.compiledBundle.context.maxIteration=o:this.compiledBundle.context.maxIteration++),u.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter(function(c){var l=c.isReferer;return l}).forEach(function(c){var l=c.data,h=c.name;i.model.confirmInput(l.model,h)}),a=0;a<o;a++)this.model.run();return this.engine.endFrame(),u.abrupt("return",this);case 12:case"end":return u.stop()}},r,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"getOutput",value:function(){var n=Ma(Sr.mark(function r(){return Sr.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",this.model.readData());case 1:case"end":return i.stop()}},r,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"compile",value:function(){var n=Ma(Sr.mark(function r(){var i,o,a;return Sr.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.initPromise;case 2:return i=jS({},this.compiledBundle.context),o=this.engine.supportWebGPU?this.engine.useWGSL?ol.WGSL:ol.GLSL450:ol.GLSL100,a=this.compiledBundle.shaders[o],i.defines.filter(function(u){return u.runtime}).forEach(function(u){var c="".concat(Tst).concat(u.name);a=a.replace(c,"".concat(u.value))}),i.shader=a,i.uniforms.forEach(function(u){if(!u.data&&u.storageClass===Ku.StorageBuffer){var c=1;u.type===Dl.FloatArray?c=1:u.type===Dl.Vector4FloatArray&&(c=4),u.data=new Float32Array(i.output.length*c).fill(0)}}),this.compiledBundle.context=i,s.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=s.sent;case 12:case"end":return s.stop()}},r,this)}));function e(){return n.apply(this,arguments)}return e}()}]),t}(),bN={exports:{}};(function(t,n){(function(e,r){t.exports=r()})(bt,function(){var e=function(T){return T instanceof Uint8Array||T instanceof Uint16Array||T instanceof Uint32Array||T instanceof Int8Array||T instanceof Int16Array||T instanceof Int32Array||T instanceof Float32Array||T instanceof Float64Array||T instanceof Uint8ClampedArray},r=function(T,z){for(var X=Object.keys(z),ht=0;ht<X.length;++ht)T[X[ht]]=z[X[ht]];return T},i=`
`;function o(T){return typeof atob<"u"?atob(T):"base64:"+T}function a(T){var z=new Error("(regl) "+T);throw console.error(z),z}function s(T,z){T||a(z)}function u(T){return T?": "+T:""}function c(T,z,X){T in z||a("unknown parameter ("+T+")"+u(X)+". possible values: "+Object.keys(z).join())}function l(T,z){e(T)||a("invalid parameter type"+u(z)+". must be a typed array")}function h(T,z){switch(z){case"number":return typeof T=="number";case"object":return typeof T=="object";case"string":return typeof T=="string";case"boolean":return typeof T=="boolean";case"function":return typeof T=="function";case"undefined":return typeof T>"u";case"symbol":return typeof T=="symbol"}}function f(T,z,X){h(T,z)||a("invalid parameter type"+u(X)+". expected "+z+", got "+typeof T)}function d(T,z){T>=0&&(T|0)===T||a("invalid parameter type, ("+T+")"+u(z)+". must be a nonnegative integer")}function p(T,z,X){z.indexOf(T)<0&&a("invalid value"+u(X)+". must be one of: "+z)}var g=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function v(T){Object.keys(T).forEach(function(z){g.indexOf(z)<0&&a('invalid regl constructor argument "'+z+'". must be one of '+g)})}function m(T,z){for(T=T+"";T.length<z;)T=" "+T;return T}function y(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function b(T,z){this.number=T,this.line=z,this.errors=[]}function x(T,z,X){this.file=T,this.line=z,this.message=X}function w(){var T=new Error,z=(T.stack||T).toString(),X=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(z);if(X)return X[1];var ht=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(z);return ht?ht[1]:"unknown"}function E(){var T=new Error,z=(T.stack||T).toString(),X=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(z);if(X)return X[1];var ht=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(z);return ht?ht[1]:"unknown"}function M(T,z){var X=T.split(`
`),ht=1,wt=0,lt={unknown:new y,0:new y};lt.unknown.name=lt[0].name=z||w(),lt.unknown.lines.push(new b(0,""));for(var pt=0;pt<X.length;++pt){var Ct=X[pt],Ot=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Ct);if(Ot)switch(Ot[1]){case"line":var Rt=/(\d+)(\s+\d+)?/.exec(Ot[2]);Rt&&(ht=Rt[1]|0,Rt[2]&&(wt=Rt[2]|0,wt in lt||(lt[wt]=new y)));break;case"define":var Nt=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Ot[2]);Nt&&(lt[wt].name=Nt[1]?o(Nt[2]):Nt[2]);break}lt[wt].lines.push(new b(ht++,Ct))}return Object.keys(lt).forEach(function(zt){var Ht=lt[zt];Ht.lines.forEach(function(It){Ht.index[It.number]=It})}),lt}function _(T){var z=[];return T.split(`
`).forEach(function(X){if(!(X.length<5)){var ht=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(X);ht?z.push(new x(ht[1]|0,ht[2]|0,ht[3].trim())):X.length>0&&z.push(new x("unknown",0,X))}}),z}function k(T,z){z.forEach(function(X){var ht=T[X.file];if(ht){var wt=ht.index[X.line];if(wt){wt.errors.push(X),ht.hasErrors=!0;return}}T.unknown.hasErrors=!0,T.unknown.lines[0].errors.push(X)})}function S(T,z,X,ht,wt){if(!T.getShaderParameter(z,T.COMPILE_STATUS)){var lt=T.getShaderInfoLog(z),pt=ht===T.FRAGMENT_SHADER?"fragment":"vertex";j(X,"string",pt+" shader source must be a string",wt);var Ct=M(X,wt),Ot=_(lt);k(Ct,Ot),Object.keys(Ct).forEach(function(Rt){var Nt=Ct[Rt];if(!Nt.hasErrors)return;var zt=[""],Ht=[""];function It(Gt,rt){zt.push(Gt),Ht.push(rt||"")}It("file number "+Rt+": "+Nt.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),Nt.lines.forEach(function(Gt){if(Gt.errors.length>0){It(m(Gt.number,4)+"|  ","background-color:yellow; font-weight:bold"),It(Gt.line+i,"color:red; background-color:yellow; font-weight:bold");var rt=0;Gt.errors.forEach(function(gt){var Lt=gt.message,Kt=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Lt);if(Kt){var St=Kt[1];switch(Lt=Kt[2],St){case"assign":St="=";break}rt=Math.max(Gt.line.indexOf(St,rt),0)}else rt=0;It(m("| ",6)),It(m("^^^",rt+3)+i,"font-weight:bold"),It(m("| ",6)),It(Lt+i,"font-weight:bold")}),It(m("| ",6)+i)}else It(m(Gt.number,4)+"|  "),It(Gt.line+i,"color:red")}),typeof document<"u"&&!window.chrome?(Ht[0]=zt.join("%c"),console.log.apply(console,Ht)):console.log(zt.join(""))}),s.raise("Error compiling "+pt+" shader, "+Ct[0].name)}}function A(T,z,X,ht,wt){if(!T.getProgramParameter(z,T.LINK_STATUS)){var lt=T.getProgramInfoLog(z),pt=M(X,wt),Ct=M(ht,wt),Ot='Error linking program with vertex shader, "'+Ct[0].name+'", and fragment shader "'+pt[0].name+'"';typeof document<"u"?console.log("%c"+Ot+i+"%c"+lt,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Ot+i+lt),s.raise(Ot)}}function C(T){T._commandRef=w()}function I(T,z,X,ht){C(T);function wt(Ot){return Ot?ht.id(Ot):0}T._fragId=wt(T.static.frag),T._vertId=wt(T.static.vert);function lt(Ot,Rt){Object.keys(Rt).forEach(function(Nt){Ot[ht.id(Nt)]=!0})}var pt=T._uniformSet={};lt(pt,z.static),lt(pt,z.dynamic);var Ct=T._attributeSet={};lt(Ct,X.static),lt(Ct,X.dynamic),T._hasCount="count"in T.static||"count"in T.dynamic||"elements"in T.static||"elements"in T.dynamic}function N(T,z){var X=E();a(T+" in command "+(z||w())+(X==="unknown"?"":" called from "+X))}function D(T,z,X){T||N(z,X||w())}function P(T,z,X,ht){T in z||N("unknown parameter ("+T+")"+u(X)+". possible values: "+Object.keys(z).join(),ht||w())}function j(T,z,X,ht){h(T,z)||N("invalid parameter type"+u(X)+". expected "+z+", got "+typeof T,ht||w())}function L(T){T()}function R(T,z,X){T.texture?p(T.texture._texture.internalformat,z,"unsupported texture format for attachment"):p(T.renderbuffer._renderbuffer.format,X,"unsupported renderbuffer format for attachment")}var V=33071,tt=9728,ut=9984,dt=9985,J=9986,Et=9987,Bt=5120,Vt=5121,se=5122,re=5123,ue=5124,de=5125,Ze=5126,Ne=32819,Re=32820,pn=33635,en=34042,fn=36193,De={};De[Bt]=De[Vt]=1,De[se]=De[re]=De[fn]=De[pn]=De[Ne]=De[Re]=2,De[ue]=De[de]=De[Ze]=De[en]=4;function Vn(T,z){return T===Re||T===Ne||T===pn?2:T===en?4:De[T]*z}function Wt(T){return!(T&T-1)&&!!T}function ee(T,z,X){var ht,wt=z.width,lt=z.height,pt=z.channels;s(wt>0&&wt<=X.maxTextureSize&&lt>0&&lt<=X.maxTextureSize,"invalid texture shape"),(T.wrapS!==V||T.wrapT!==V)&&s(Wt(wt)&&Wt(lt),"incompatible wrap mode for texture, both width and height must be power of 2"),z.mipmask===1?wt!==1&&lt!==1&&s(T.minFilter!==ut&&T.minFilter!==J&&T.minFilter!==dt&&T.minFilter!==Et,"min filter requires mipmap"):(s(Wt(wt)&&Wt(lt),"texture must be a square power of 2 to support mipmapping"),s(z.mipmask===(wt<<1)-1,"missing or incomplete mipmap data")),z.type===Ze&&(X.extensions.indexOf("oes_texture_float_linear")<0&&s(T.minFilter===tt&&T.magFilter===tt,"filter not supported, must enable oes_texture_float_linear"),s(!T.genMipmaps,"mipmap generation not supported with float textures"));var Ct=z.images;for(ht=0;ht<16;++ht)if(Ct[ht]){var Ot=wt>>ht,Rt=lt>>ht;s(z.mipmask&1<<ht,"missing mipmap data");var Nt=Ct[ht];if(s(Nt.width===Ot&&Nt.height===Rt,"invalid shape for mip images"),s(Nt.format===z.format&&Nt.internalformat===z.internalformat&&Nt.type===z.type,"incompatible type for mip image"),!Nt.compressed)if(Nt.data){var zt=Math.ceil(Vn(Nt.type,pt)*Ot/Nt.unpackAlignment)*Nt.unpackAlignment;s(Nt.data.byteLength===zt*Rt,"invalid data for image, buffer size is inconsistent with image format")}else Nt.element||Nt.copy}else T.genMipmaps||s((z.mipmask&1<<ht)===0,"extra mipmap data");z.compressed&&s(!T.genMipmaps,"mipmap generation for compressed images not supported")}function ot(T,z,X,ht){var wt=T.width,lt=T.height,pt=T.channels;s(wt>0&&wt<=ht.maxTextureSize&&lt>0&&lt<=ht.maxTextureSize,"invalid texture shape"),s(wt===lt,"cube map must be square"),s(z.wrapS===V&&z.wrapT===V,"wrap mode not supported by cube map");for(var Ct=0;Ct<X.length;++Ct){var Ot=X[Ct];s(Ot.width===wt&&Ot.height===lt,"inconsistent cube map face shape"),z.genMipmaps&&(s(!Ot.compressed,"can not generate mipmap for compressed textures"),s(Ot.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Rt=Ot.images,Nt=0;Nt<16;++Nt){var zt=Rt[Nt];if(zt){var Ht=wt>>Nt,It=lt>>Nt;s(Ot.mipmask&1<<Nt,"missing mipmap data"),s(zt.width===Ht&&zt.height===It,"invalid shape for mip images"),s(zt.format===T.format&&zt.internalformat===T.internalformat&&zt.type===T.type,"incompatible type for mip image"),zt.compressed||(zt.data?s(zt.data.byteLength===Ht*It*Math.max(Vn(zt.type,pt),zt.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):zt.element||zt.copy)}}}}var O=r(s,{optional:L,raise:a,commandRaise:N,command:D,parameter:c,commandParameter:P,constructor:v,type:f,commandType:j,isTypedArray:l,nni:d,oneOf:p,shaderError:S,linkError:A,callSite:E,saveCommandRef:C,saveDrawInfo:I,framebufferFormat:R,guessCommand:w,texture2D:ee,textureCube:ot}),ct=0,Xt=0,jt=5,te=6;function _t(T,z){this.id=ct++,this.type=T,this.data=z}function Zt(T){return T.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function me(T){if(T.length===0)return[];var z=T.charAt(0),X=T.charAt(T.length-1);if(T.length>1&&z===X&&(z==='"'||z==="'"))return['"'+Zt(T.substr(1,T.length-2))+'"'];var ht=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(T);if(ht)return me(T.substr(0,ht.index)).concat(me(ht[1])).concat(me(T.substr(ht.index+ht[0].length)));var wt=T.split(".");if(wt.length===1)return['"'+Zt(T)+'"'];for(var lt=[],pt=0;pt<wt.length;++pt)lt=lt.concat(me(wt[pt]));return lt}function Ce(T){return"["+me(T).join("][")+"]"}function _e(T,z){return new _t(T,Ce(z+""))}function Qn(T){return typeof T=="function"&&!T._reglType||T instanceof _t}function dn(T,z){if(typeof T=="function")return new _t(Xt,T);if(typeof T=="number"||typeof T=="boolean")return new _t(jt,T);if(Array.isArray(T))return new _t(te,T.map((X,ht)=>dn(X,z+"["+ht+"]")));if(T instanceof _t)return T;O(!1,"invalid option type in uniform "+z)}var He={DynamicVariable:_t,define:_e,isDynamic:Qn,unbox:dn,accessor:Ce},un={next:typeof requestAnimationFrame=="function"?function(T){return requestAnimationFrame(T)}:function(T){return setTimeout(T,16)},cancel:typeof cancelAnimationFrame=="function"?function(T){return cancelAnimationFrame(T)}:clearTimeout},yn=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function hn(){var T={"":0},z=[""];return{id:function(X){var ht=T[X];return ht||(ht=T[X]=z.length,z.push(X),ht)},str:function(X){return z[X]}}}function bn(T,z,X){var ht=document.createElement("canvas");r(ht.style,{border:0,margin:0,padding:0,top:0,left:0}),T.appendChild(ht),T===document.body&&(ht.style.position="absolute",r(T.style,{margin:0,padding:0}));function wt(){var Ct=window.innerWidth,Ot=window.innerHeight;if(T!==document.body){var Rt=T.getBoundingClientRect();Ct=Rt.right-Rt.left,Ot=Rt.bottom-Rt.top}ht.width=X*Ct,ht.height=X*Ot,r(ht.style,{width:Ct+"px",height:Ot+"px"})}var lt;T!==document.body&&typeof ResizeObserver=="function"?(lt=new ResizeObserver(function(){setTimeout(wt)}),lt.observe(T)):window.addEventListener("resize",wt,!1);function pt(){lt?lt.disconnect():window.removeEventListener("resize",wt),T.removeChild(ht)}return wt(),{canvas:ht,onDestroy:pt}}function xr(T,z){function X(ht){try{return T.getContext(ht,z)}catch{return null}}return X("webgl")||X("experimental-webgl")||X("webgl-experimental")}function Wn(T){return typeof T.nodeName=="string"&&typeof T.appendChild=="function"&&typeof T.getBoundingClientRect=="function"}function _o(T){return typeof T.drawArrays=="function"||typeof T.drawElements=="function"}function ea(T){return typeof T=="string"?T.split():(O(Array.isArray(T),"invalid extension array"),T)}function na(T){return typeof T=="string"?(O(typeof document<"u","not supported outside of DOM"),document.querySelector(T)):T}function Ga(T){var z=T||{},X,ht,wt,lt,pt={},Ct=[],Ot=[],Rt=typeof window>"u"?1:window.devicePixelRatio,Nt=!1,zt=function(Gt){Gt&&O.raise(Gt)},Ht=function(){};if(typeof z=="string"?(O(typeof document<"u","selector queries only supported in DOM enviroments"),X=document.querySelector(z),O(X,"invalid query string for element")):typeof z=="object"?Wn(z)?X=z:_o(z)?(lt=z,wt=lt.canvas):(O.constructor(z),"gl"in z?lt=z.gl:"canvas"in z?wt=na(z.canvas):"container"in z&&(ht=na(z.container)),"attributes"in z&&(pt=z.attributes,O.type(pt,"object","invalid context attributes")),"extensions"in z&&(Ct=ea(z.extensions)),"optionalExtensions"in z&&(Ot=ea(z.optionalExtensions)),"onDone"in z&&(O.type(z.onDone,"function","invalid or missing onDone callback"),zt=z.onDone),"profile"in z&&(Nt=!!z.profile),"pixelRatio"in z&&(Rt=+z.pixelRatio,O(Rt>0,"invalid pixel ratio"))):O.raise("invalid arguments to regl"),X&&(X.nodeName.toLowerCase()==="canvas"?wt=X:ht=X),!lt){if(!wt){O(typeof document<"u","must manually specify webgl context outside of DOM environments");var It=bn(ht||document.body,zt,Rt);if(!It)return null;wt=It.canvas,Ht=It.onDestroy}pt.premultipliedAlpha===void 0&&(pt.premultipliedAlpha=!0),lt=xr(wt,pt)}return lt?{gl:lt,canvas:wt,container:ht,extensions:Ct,optionalExtensions:Ot,pixelRatio:Rt,profile:Nt,onDone:zt,onDestroy:Ht}:(Ht(),zt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function xi(T,z){var X={};function ht(pt){O.type(pt,"string","extension name must be string");var Ct=pt.toLowerCase(),Ot;try{Ot=X[Ct]=T.getExtension(Ct)}catch{}return!!Ot}for(var wt=0;wt<z.extensions.length;++wt){var lt=z.extensions[wt];if(!ht(lt))return z.onDestroy(),z.onDone('"'+lt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return z.optionalExtensions.forEach(ht),{extensions:X,restore:function(){Object.keys(X).forEach(function(pt){if(X[pt]&&!ht(pt))throw new Error("(regl): error restoring extension "+pt)})}}}function jn(T,z){for(var X=Array(T),ht=0;ht<T;++ht)X[ht]=z(ht);return X}var Ua=5120,Ya=5121,Va=5122,Ur=5123,On=5124,Yr=5125,ke=5126;function gn(T){for(var z=16;z<=1<<28;z*=16)if(T<=z)return z;return 0}function Ue(T){var z,X;return z=(T>65535)<<4,T>>>=z,X=(T>255)<<3,T>>>=X,z|=X,X=(T>15)<<2,T>>>=X,z|=X,X=(T>3)<<1,T>>>=X,z|=X,z|T>>1}function wn(){var T=jn(8,function(){return[]});function z(lt){var pt=gn(lt),Ct=T[Ue(pt)>>2];return Ct.length>0?Ct.pop():new ArrayBuffer(pt)}function X(lt){T[Ue(lt.byteLength)>>2].push(lt)}function ht(lt,pt){var Ct=null;switch(lt){case Ua:Ct=new Int8Array(z(pt),0,pt);break;case Ya:Ct=new Uint8Array(z(pt),0,pt);break;case Va:Ct=new Int16Array(z(2*pt),0,pt);break;case Ur:Ct=new Uint16Array(z(2*pt),0,pt);break;case On:Ct=new Int32Array(z(4*pt),0,pt);break;case Yr:Ct=new Uint32Array(z(4*pt),0,pt);break;case ke:Ct=new Float32Array(z(4*pt),0,pt);break;default:return null}return Ct.length!==pt?Ct.subarray(0,pt):Ct}function wt(lt){X(lt.buffer)}return{alloc:z,free:X,allocType:ht,freeType:wt}}var Ke=wn();Ke.zero=wn();var ko=3408,Ao=3410,wi=3411,Co=3412,Io=3413,Ui=3414,og=3415,ag=33901,sg=33902,ug=3379,cg=3386,lg=34921,hg=36347,fg=36348,dg=35661,pg=35660,gg=34930,vg=36349,mg=34076,yg=34024,f5=7936,d5=7937,p5=7938,g5=35724,v5=34047,m5=36063,y5=34852,gh=3553,Eb=34067,b5=34069,x5=33984,ic=6408,bg=5126,Mb=5121,xg=36160,w5=36053,E5=36064,M5=16384,S5=function(T,z){var X=1;z.ext_texture_filter_anisotropic&&(X=T.getParameter(v5));var ht=1,wt=1;z.webgl_draw_buffers&&(ht=T.getParameter(y5),wt=T.getParameter(m5));var lt=!!z.oes_texture_float;if(lt){var pt=T.createTexture();T.bindTexture(gh,pt),T.texImage2D(gh,0,ic,1,1,0,ic,bg,null);var Ct=T.createFramebuffer();if(T.bindFramebuffer(xg,Ct),T.framebufferTexture2D(xg,E5,gh,pt,0),T.bindTexture(gh,null),T.checkFramebufferStatus(xg)!==w5)lt=!1;else{T.viewport(0,0,1,1),T.clearColor(1,0,0,1),T.clear(M5);var Ot=Ke.allocType(bg,4);T.readPixels(0,0,1,1,ic,bg,Ot),T.getError()?lt=!1:(T.deleteFramebuffer(Ct),T.deleteTexture(pt),lt=Ot[0]===1),Ke.freeType(Ot)}}var Rt=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Nt=!0;if(!Rt){var zt=T.createTexture(),Ht=Ke.allocType(Mb,36);T.activeTexture(x5),T.bindTexture(Eb,zt),T.texImage2D(b5,0,ic,3,3,0,ic,Mb,Ht),Ke.freeType(Ht),T.bindTexture(Eb,null),T.deleteTexture(zt),Nt=!T.getError()}return{colorBits:[T.getParameter(Ao),T.getParameter(wi),T.getParameter(Co),T.getParameter(Io)],depthBits:T.getParameter(Ui),stencilBits:T.getParameter(og),subpixelBits:T.getParameter(ko),extensions:Object.keys(z).filter(function(It){return!!z[It]}),maxAnisotropic:X,maxDrawbuffers:ht,maxColorAttachments:wt,pointSizeDims:T.getParameter(ag),lineWidthDims:T.getParameter(sg),maxViewportDims:T.getParameter(cg),maxCombinedTextureUnits:T.getParameter(dg),maxCubeMapSize:T.getParameter(mg),maxRenderbufferSize:T.getParameter(yg),maxTextureUnits:T.getParameter(gg),maxTextureSize:T.getParameter(ug),maxAttributes:T.getParameter(lg),maxVertexUniforms:T.getParameter(hg),maxVertexTextureUnits:T.getParameter(pg),maxVaryingVectors:T.getParameter(fg),maxFragmentUniforms:T.getParameter(vg),glsl:T.getParameter(g5),renderer:T.getParameter(d5),vendor:T.getParameter(f5),version:T.getParameter(p5),readFloat:lt,npotTextureCube:Nt}};function Ei(T){return!!T&&typeof T=="object"&&Array.isArray(T.shape)&&Array.isArray(T.stride)&&typeof T.offset=="number"&&T.shape.length===T.stride.length&&(Array.isArray(T.data)||e(T.data))}var Vr=function(T){return Object.keys(T).map(function(z){return T[z]})},vh={shape:C5,flatten:A5};function _5(T,z,X){for(var ht=0;ht<z;++ht)X[ht]=T[ht]}function k5(T,z,X,ht){for(var wt=0,lt=0;lt<z;++lt)for(var pt=T[lt],Ct=0;Ct<X;++Ct)ht[wt++]=pt[Ct]}function Sb(T,z,X,ht,wt,lt){for(var pt=lt,Ct=0;Ct<z;++Ct)for(var Ot=T[Ct],Rt=0;Rt<X;++Rt)for(var Nt=Ot[Rt],zt=0;zt<ht;++zt)wt[pt++]=Nt[zt]}function _b(T,z,X,ht,wt){for(var lt=1,pt=X+1;pt<z.length;++pt)lt*=z[pt];var Ct=z[X];if(z.length-X===4){var Ot=z[X+1],Rt=z[X+2],Nt=z[X+3];for(pt=0;pt<Ct;++pt)Sb(T[pt],Ot,Rt,Nt,ht,wt),wt+=lt}else for(pt=0;pt<Ct;++pt)_b(T[pt],z,X+1,ht,wt),wt+=lt}function A5(T,z,X,ht){var wt=1;if(z.length)for(var lt=0;lt<z.length;++lt)wt*=z[lt];else wt=0;var pt=ht||Ke.allocType(X,wt);switch(z.length){case 0:break;case 1:_5(T,z[0],pt);break;case 2:k5(T,z[0],z[1],pt);break;case 3:Sb(T,z[0],z[1],z[2],pt,0);break;default:_b(T,z,0,pt,0)}return pt}function C5(T){for(var z=[],X=T;X.length;X=X[0])z.push(X.length);return z}var wg={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},I5=5120,T5=5122,O5=5124,N5=5121,D5=5123,P5=5125,L5=5126,j5=5126,Wa={int8:I5,int16:T5,int32:O5,uint8:N5,uint16:D5,uint32:P5,float:L5,float32:j5},R5=35048,F5=35040,mh={dynamic:R5,stream:F5,static:35044},Eg=vh.flatten,kb=vh.shape,Ab=35044,B5=35040,Mg=5121,Sg=5126,ra=[];ra[5120]=1,ra[5122]=2,ra[5124]=4,ra[5121]=1,ra[5123]=2,ra[5125]=4,ra[5126]=4;function yh(T){return wg[Object.prototype.toString.call(T)]|0}function Cb(T,z){for(var X=0;X<z.length;++X)T[X]=z[X]}function Ib(T,z,X,ht,wt,lt,pt){for(var Ct=0,Ot=0;Ot<X;++Ot)for(var Rt=0;Rt<ht;++Rt)T[Ct++]=z[wt*Ot+lt*Rt+pt]}function z5(T,z,X,ht){var wt=0,lt={};function pt(rt){this.id=wt++,this.buffer=T.createBuffer(),this.type=rt,this.usage=Ab,this.byteLength=0,this.dimension=1,this.dtype=Mg,this.persistentData=null,X.profile&&(this.stats={size:0})}pt.prototype.bind=function(){T.bindBuffer(this.type,this.buffer)},pt.prototype.destroy=function(){Ht(this)};var Ct=[];function Ot(rt,gt){var Lt=Ct.pop();return Lt||(Lt=new pt(rt)),Lt.bind(),zt(Lt,gt,B5,0,1,!1),Lt}function Rt(rt){Ct.push(rt)}function Nt(rt,gt,Lt){rt.byteLength=gt.byteLength,T.bufferData(rt.type,gt,Lt)}function zt(rt,gt,Lt,Kt,St,$t){var At;if(rt.usage=Lt,Array.isArray(gt)){if(rt.dtype=Kt||Sg,gt.length>0){var Ut;if(Array.isArray(gt[0])){At=kb(gt);for(var kt=1,Yt=1;Yt<At.length;++Yt)kt*=At[Yt];rt.dimension=kt,Ut=Eg(gt,At,rt.dtype),Nt(rt,Ut,Lt),$t?rt.persistentData=Ut:Ke.freeType(Ut)}else if(typeof gt[0]=="number"){rt.dimension=St;var ge=Ke.allocType(rt.dtype,gt.length);Cb(ge,gt),Nt(rt,ge,Lt),$t?rt.persistentData=ge:Ke.freeType(ge)}else e(gt[0])?(rt.dimension=gt[0].length,rt.dtype=Kt||yh(gt[0])||Sg,Ut=Eg(gt,[gt.length,gt[0].length],rt.dtype),Nt(rt,Ut,Lt),$t?rt.persistentData=Ut:Ke.freeType(Ut)):O.raise("invalid buffer data")}}else if(e(gt))rt.dtype=Kt||yh(gt),rt.dimension=St,Nt(rt,gt,Lt),$t&&(rt.persistentData=new Uint8Array(new Uint8Array(gt.buffer)));else if(Ei(gt)){At=gt.shape;var Ae=gt.stride,qt=gt.offset,Ft=0,Mt=0,Se=0,Pe=0;At.length===1?(Ft=At[0],Mt=1,Se=Ae[0],Pe=0):At.length===2?(Ft=At[0],Mt=At[1],Se=Ae[0],Pe=Ae[1]):O.raise("invalid shape"),rt.dtype=Kt||yh(gt.data)||Sg,rt.dimension=Mt;var ie=Ke.allocType(rt.dtype,Ft*Mt);Ib(ie,gt.data,Ft,Mt,Se,Pe,qt),Nt(rt,ie,Lt),$t?rt.persistentData=ie:Ke.freeType(ie)}else gt instanceof ArrayBuffer?(rt.dtype=Mg,rt.dimension=St,Nt(rt,gt,Lt),$t&&(rt.persistentData=new Uint8Array(new Uint8Array(gt)))):O.raise("invalid buffer data")}function Ht(rt){z.bufferCount--,ht(rt);var gt=rt.buffer;O(gt,"buffer must not be deleted already"),T.deleteBuffer(gt),rt.buffer=null,delete lt[rt.id]}function It(rt,gt,Lt,Kt){z.bufferCount++;var St=new pt(gt);lt[St.id]=St;function $t(kt){var Yt=Ab,ge=null,Ae=0,qt=0,Ft=1;return Array.isArray(kt)||e(kt)||Ei(kt)||kt instanceof ArrayBuffer?ge=kt:typeof kt=="number"?Ae=kt|0:kt&&(O.type(kt,"object","buffer arguments must be an object, a number or an array"),"data"in kt&&(O(ge===null||Array.isArray(ge)||e(ge)||Ei(ge),"invalid data for buffer"),ge=kt.data),"usage"in kt&&(O.parameter(kt.usage,mh,"invalid buffer usage"),Yt=mh[kt.usage]),"type"in kt&&(O.parameter(kt.type,Wa,"invalid buffer type"),qt=Wa[kt.type]),"dimension"in kt&&(O.type(kt.dimension,"number","invalid dimension"),Ft=kt.dimension|0),"length"in kt&&(O.nni(Ae,"buffer length must be a nonnegative integer"),Ae=kt.length|0)),St.bind(),ge?zt(St,ge,Yt,qt,Ft,Kt):(Ae&&T.bufferData(St.type,Ae,Yt),St.dtype=qt||Mg,St.usage=Yt,St.dimension=Ft,St.byteLength=Ae),X.profile&&(St.stats.size=St.byteLength*ra[St.dtype]),$t}function At(kt,Yt){O(Yt+kt.byteLength<=St.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+kt.byteLength+" starting from offset "+Yt+" to a buffer of size "+St.byteLength),T.bufferSubData(St.type,Yt,kt)}function Ut(kt,Yt){var ge=(Yt||0)|0,Ae;if(St.bind(),e(kt)||kt instanceof ArrayBuffer)At(kt,ge);else if(Array.isArray(kt)){if(kt.length>0)if(typeof kt[0]=="number"){var qt=Ke.allocType(St.dtype,kt.length);Cb(qt,kt),At(qt,ge),Ke.freeType(qt)}else if(Array.isArray(kt[0])||e(kt[0])){Ae=kb(kt);var Ft=Eg(kt,Ae,St.dtype);At(Ft,ge),Ke.freeType(Ft)}else O.raise("invalid buffer data")}else if(Ei(kt)){Ae=kt.shape;var Mt=kt.stride,Se=0,Pe=0,ie=0,Be=0;Ae.length===1?(Se=Ae[0],Pe=1,ie=Mt[0],Be=0):Ae.length===2?(Se=Ae[0],Pe=Ae[1],ie=Mt[0],Be=Mt[1]):O.raise("invalid shape");var Ie=Array.isArray(kt.data)?St.dtype:yh(kt.data),Fe=Ke.allocType(Ie,Se*Pe);Ib(Fe,kt.data,Se,Pe,ie,Be,kt.offset),At(Fe,ge),Ke.freeType(Fe)}else O.raise("invalid data for buffer subdata");return $t}return Lt||$t(rt),$t._reglType="buffer",$t._buffer=St,$t.subdata=Ut,X.profile&&($t.stats=St.stats),$t.destroy=function(){Ht(St)},$t}function Gt(){Vr(lt).forEach(function(rt){rt.buffer=T.createBuffer(),T.bindBuffer(rt.type,rt.buffer),T.bufferData(rt.type,rt.persistentData||rt.byteLength,rt.usage)})}return X.profile&&(z.getTotalBufferSize=function(){var rt=0;return Object.keys(lt).forEach(function(gt){rt+=lt[gt].stats.size}),rt}),{create:It,createStream:Ot,destroyStream:Rt,clear:function(){Vr(lt).forEach(Ht),Ct.forEach(Ht)},getBuffer:function(rt){return rt&&rt._buffer instanceof pt?rt._buffer:null},restore:Gt,_initBuffer:zt}}var G5=0,U5=0,Y5=1,V5=1,W5=4,X5=4,Bs={points:G5,point:U5,lines:Y5,line:V5,triangles:W5,triangle:X5,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},H5=0,q5=1,oc=4,Z5=5120,zs=5121,Tb=5122,Gs=5123,Ob=5124,Xa=5125,_g=34963,K5=35040,Q5=35044;function J5(T,z,X,ht){var wt={},lt=0,pt={uint8:zs,uint16:Gs};z.oes_element_index_uint&&(pt.uint32=Xa);function Ct(Gt){this.id=lt++,wt[this.id]=this,this.buffer=Gt,this.primType=oc,this.vertCount=0,this.type=0}Ct.prototype.bind=function(){this.buffer.bind()};var Ot=[];function Rt(Gt){var rt=Ot.pop();return rt||(rt=new Ct(X.create(null,_g,!0,!1)._buffer)),zt(rt,Gt,K5,-1,-1,0,0),rt}function Nt(Gt){Ot.push(Gt)}function zt(Gt,rt,gt,Lt,Kt,St,$t){Gt.buffer.bind();var At;if(rt){var Ut=$t;!$t&&(!e(rt)||Ei(rt)&&!e(rt.data))&&(Ut=z.oes_element_index_uint?Xa:Gs),X._initBuffer(Gt.buffer,rt,gt,Ut,3)}else T.bufferData(_g,St,gt),Gt.buffer.dtype=At||zs,Gt.buffer.usage=gt,Gt.buffer.dimension=3,Gt.buffer.byteLength=St;if(At=$t,!$t){switch(Gt.buffer.dtype){case zs:case Z5:At=zs;break;case Gs:case Tb:At=Gs;break;case Xa:case Ob:At=Xa;break;default:O.raise("unsupported type for element array")}Gt.buffer.dtype=At}Gt.type=At,O(At!==Xa||!!z.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var kt=Kt;kt<0&&(kt=Gt.buffer.byteLength,At===Gs?kt>>=1:At===Xa&&(kt>>=2)),Gt.vertCount=kt;var Yt=Lt;if(Lt<0){Yt=oc;var ge=Gt.buffer.dimension;ge===1&&(Yt=H5),ge===2&&(Yt=q5),ge===3&&(Yt=oc)}Gt.primType=Yt}function Ht(Gt){ht.elementsCount--,O(Gt.buffer!==null,"must not double destroy elements"),delete wt[Gt.id],Gt.buffer.destroy(),Gt.buffer=null}function It(Gt,rt){var gt=X.create(null,_g,!0),Lt=new Ct(gt._buffer);ht.elementsCount++;function Kt(St){if(!St)gt(),Lt.primType=oc,Lt.vertCount=0,Lt.type=zs;else if(typeof St=="number")gt(St),Lt.primType=oc,Lt.vertCount=St|0,Lt.type=zs;else{var $t=null,At=Q5,Ut=-1,kt=-1,Yt=0,ge=0;Array.isArray(St)||e(St)||Ei(St)?$t=St:(O.type(St,"object","invalid arguments for elements"),"data"in St&&($t=St.data,O(Array.isArray($t)||e($t)||Ei($t),"invalid data for element buffer")),"usage"in St&&(O.parameter(St.usage,mh,"invalid element buffer usage"),At=mh[St.usage]),"primitive"in St&&(O.parameter(St.primitive,Bs,"invalid element buffer primitive"),Ut=Bs[St.primitive]),"count"in St&&(O(typeof St.count=="number"&&St.count>=0,"invalid vertex count for elements"),kt=St.count|0),"type"in St&&(O.parameter(St.type,pt,"invalid buffer type"),ge=pt[St.type]),"length"in St?Yt=St.length|0:(Yt=kt,ge===Gs||ge===Tb?Yt*=2:(ge===Xa||ge===Ob)&&(Yt*=4))),zt(Lt,$t,At,Ut,kt,Yt,ge)}return Kt}return Kt(Gt),Kt._reglType="elements",Kt._elements=Lt,Kt.subdata=function(St,$t){return gt.subdata(St,$t),Kt},Kt.destroy=function(){Ht(Lt)},Kt}return{create:It,createStream:Rt,destroyStream:Nt,getElements:function(Gt){return typeof Gt=="function"&&Gt._elements instanceof Ct?Gt._elements:null},clear:function(){Vr(wt).forEach(Ht)}}}var Nb=new Float32Array(1),$5=new Uint32Array(Nb.buffer),tD=5123;function Db(T){for(var z=Ke.allocType(tD,T.length),X=0;X<T.length;++X)if(isNaN(T[X]))z[X]=65535;else if(T[X]===1/0)z[X]=31744;else if(T[X]===-1/0)z[X]=64512;else{Nb[0]=T[X];var ht=$5[0],wt=ht>>>31<<15,lt=(ht<<1>>>24)-127,pt=ht>>13&1024-1;if(lt<-24)z[X]=wt;else if(lt<-14){var Ct=-14-lt;z[X]=wt+(pt+1024>>Ct)}else lt>15?z[X]=wt+31744:z[X]=wt+(lt+15<<10)+pt}return z}function Nn(T){return Array.isArray(T)||e(T)}var Pb=function(T){return!(T&T-1)&&!!T},eD=34467,Yi=3553,kg=34067,bh=34069,Ha=6408,Ag=6406,xh=6407,ac=6409,wh=6410,Lb=32854,Cg=32855,jb=36194,nD=32819,rD=32820,iD=33635,oD=34042,Ig=6402,Eh=34041,Tg=35904,Og=35906,Us=36193,Ng=33776,Dg=33777,Pg=33778,Lg=33779,Rb=35986,Fb=35987,Bb=34798,zb=35840,Gb=35841,Ub=35842,Yb=35843,Vb=36196,Ys=5121,jg=5123,Rg=5125,sc=5126,aD=10242,sD=10243,uD=10497,Fg=33071,cD=33648,lD=10240,hD=10241,Bg=9728,fD=9729,zg=9984,Wb=9985,Xb=9986,Gg=9987,dD=33170,Mh=4352,pD=4353,gD=4354,vD=34046,mD=3317,yD=37440,bD=37441,xD=37443,Hb=37444,uc=33984,wD=[zg,Xb,Wb,Gg],Sh=[0,ac,wh,xh,Ha],ri={};ri[ac]=ri[Ag]=ri[Ig]=1,ri[Eh]=ri[wh]=2,ri[xh]=ri[Tg]=3,ri[Ha]=ri[Og]=4;function Vs(T){return"[object "+T+"]"}var qb=Vs("HTMLCanvasElement"),Zb=Vs("OffscreenCanvas"),Kb=Vs("CanvasRenderingContext2D"),Qb=Vs("ImageBitmap"),Jb=Vs("HTMLImageElement"),$b=Vs("HTMLVideoElement"),ED=Object.keys(wg).concat([qb,Zb,Kb,Qb,Jb,$b]),Ws=[];Ws[Ys]=1,Ws[sc]=4,Ws[Us]=2,Ws[jg]=2,Ws[Rg]=4;var cr=[];cr[Lb]=2,cr[Cg]=2,cr[jb]=2,cr[Eh]=4,cr[Ng]=.5,cr[Dg]=.5,cr[Pg]=1,cr[Lg]=1,cr[Rb]=.5,cr[Fb]=1,cr[Bb]=1,cr[zb]=.5,cr[Gb]=.25,cr[Ub]=.5,cr[Yb]=.25,cr[Vb]=.5;function tx(T){return Array.isArray(T)&&(T.length===0||typeof T[0]=="number")}function ex(T){if(!Array.isArray(T))return!1;var z=T.length;return!(z===0||!Nn(T[0]))}function qa(T){return Object.prototype.toString.call(T)}function nx(T){return qa(T)===qb}function rx(T){return qa(T)===Zb}function MD(T){return qa(T)===Kb}function SD(T){return qa(T)===Qb}function _D(T){return qa(T)===Jb}function kD(T){return qa(T)===$b}function Ug(T){if(!T)return!1;var z=qa(T);return ED.indexOf(z)>=0?!0:tx(T)||ex(T)||Ei(T)}function ix(T){return wg[Object.prototype.toString.call(T)]|0}function AD(T,z){var X=z.length;switch(T.type){case Ys:case jg:case Rg:case sc:var ht=Ke.allocType(T.type,X);ht.set(z),T.data=ht;break;case Us:T.data=Db(z);break;default:O.raise("unsupported texture type, must specify a typed array")}}function ox(T,z){return Ke.allocType(T.type===Us?sc:T.type,z)}function ax(T,z){T.type===Us?(T.data=Db(z),Ke.freeType(z)):T.data=z}function CD(T,z,X,ht,wt,lt){for(var pt=T.width,Ct=T.height,Ot=T.channels,Rt=pt*Ct*Ot,Nt=ox(T,Rt),zt=0,Ht=0;Ht<Ct;++Ht)for(var It=0;It<pt;++It)for(var Gt=0;Gt<Ot;++Gt)Nt[zt++]=z[X*It+ht*Ht+wt*Gt+lt];ax(T,Nt)}function _h(T,z,X,ht,wt,lt){var pt;if(typeof cr[T]<"u"?pt=cr[T]:pt=ri[T]*Ws[z],lt&&(pt*=6),wt){for(var Ct=0,Ot=X;Ot>=1;)Ct+=pt*Ot*Ot,Ot/=2;return Ct}else return pt*X*ht}function ID(T,z,X,ht,wt,lt,pt){var Ct={"don't care":Mh,"dont care":Mh,nice:gD,fast:pD},Ot={repeat:uD,clamp:Fg,mirror:cD},Rt={nearest:Bg,linear:fD},Nt=r({mipmap:Gg,"nearest mipmap nearest":zg,"linear mipmap nearest":Wb,"nearest mipmap linear":Xb,"linear mipmap linear":Gg},Rt),zt={none:0,browser:Hb},Ht={uint8:Ys,rgba4:nD,rgb565:iD,"rgb5 a1":rD},It={alpha:Ag,luminance:ac,"luminance alpha":wh,rgb:xh,rgba:Ha,rgba4:Lb,"rgb5 a1":Cg,rgb565:jb},Gt={};z.ext_srgb&&(It.srgb=Tg,It.srgba=Og),z.oes_texture_float&&(Ht.float32=Ht.float=sc),z.oes_texture_half_float&&(Ht.float16=Ht["half float"]=Us),z.webgl_depth_texture&&(r(It,{depth:Ig,"depth stencil":Eh}),r(Ht,{uint16:jg,uint32:Rg,"depth stencil":oD})),z.webgl_compressed_texture_s3tc&&r(Gt,{"rgb s3tc dxt1":Ng,"rgba s3tc dxt1":Dg,"rgba s3tc dxt3":Pg,"rgba s3tc dxt5":Lg}),z.webgl_compressed_texture_atc&&r(Gt,{"rgb atc":Rb,"rgba atc explicit alpha":Fb,"rgba atc interpolated alpha":Bb}),z.webgl_compressed_texture_pvrtc&&r(Gt,{"rgb pvrtc 4bppv1":zb,"rgb pvrtc 2bppv1":Gb,"rgba pvrtc 4bppv1":Ub,"rgba pvrtc 2bppv1":Yb}),z.webgl_compressed_texture_etc1&&(Gt["rgb etc1"]=Vb);var rt=Array.prototype.slice.call(T.getParameter(eD));Object.keys(Gt).forEach(function(W){var ft=Gt[W];rt.indexOf(ft)>=0&&(It[W]=ft)});var gt=Object.keys(It);X.textureFormats=gt;var Lt=[];Object.keys(It).forEach(function(W){var ft=It[W];Lt[ft]=W});var Kt=[];Object.keys(Ht).forEach(function(W){var ft=Ht[W];Kt[ft]=W});var St=[];Object.keys(Rt).forEach(function(W){var ft=Rt[W];St[ft]=W});var $t=[];Object.keys(Nt).forEach(function(W){var ft=Nt[W];$t[ft]=W});var At=[];Object.keys(Ot).forEach(function(W){var ft=Ot[W];At[ft]=W});var Ut=gt.reduce(function(W,ft){var st=It[ft];return st===ac||st===Ag||st===ac||st===wh||st===Ig||st===Eh||z.ext_srgb&&(st===Tg||st===Og)?W[st]=st:st===Cg||ft.indexOf("rgba")>=0?W[st]=Ha:W[st]=xh,W},{});function kt(){this.internalformat=Ha,this.format=Ha,this.type=Ys,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Hb,this.width=0,this.height=0,this.channels=0}function Yt(W,ft){W.internalformat=ft.internalformat,W.format=ft.format,W.type=ft.type,W.compressed=ft.compressed,W.premultiplyAlpha=ft.premultiplyAlpha,W.flipY=ft.flipY,W.unpackAlignment=ft.unpackAlignment,W.colorSpace=ft.colorSpace,W.width=ft.width,W.height=ft.height,W.channels=ft.channels}function ge(W,ft){if(!(typeof ft!="object"||!ft)){if("premultiplyAlpha"in ft&&(O.type(ft.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),W.premultiplyAlpha=ft.premultiplyAlpha),"flipY"in ft&&(O.type(ft.flipY,"boolean","invalid texture flip"),W.flipY=ft.flipY),"alignment"in ft&&(O.oneOf(ft.alignment,[1,2,4,8],"invalid texture unpack alignment"),W.unpackAlignment=ft.alignment),"colorSpace"in ft&&(O.parameter(ft.colorSpace,zt,"invalid colorSpace"),W.colorSpace=zt[ft.colorSpace]),"type"in ft){var st=ft.type;O(z.oes_texture_float||!(st==="float"||st==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),O(z.oes_texture_half_float||!(st==="half float"||st==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),O(z.webgl_depth_texture||!(st==="uint16"||st==="uint32"||st==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),O.parameter(st,Ht,"invalid texture type"),W.type=Ht[st]}var ne=W.width,ze=W.height,U=W.channels,F=!1;"shape"in ft?(O(Array.isArray(ft.shape)&&ft.shape.length>=2,"shape must be an array"),ne=ft.shape[0],ze=ft.shape[1],ft.shape.length===3&&(U=ft.shape[2],O(U>0&&U<=4,"invalid number of channels"),F=!0),O(ne>=0&&ne<=X.maxTextureSize,"invalid width"),O(ze>=0&&ze<=X.maxTextureSize,"invalid height")):("radius"in ft&&(ne=ze=ft.radius,O(ne>=0&&ne<=X.maxTextureSize,"invalid radius")),"width"in ft&&(ne=ft.width,O(ne>=0&&ne<=X.maxTextureSize,"invalid width")),"height"in ft&&(ze=ft.height,O(ze>=0&&ze<=X.maxTextureSize,"invalid height")),"channels"in ft&&(U=ft.channels,O(U>0&&U<=4,"invalid number of channels"),F=!0)),W.width=ne|0,W.height=ze|0,W.channels=U|0;var q=!1;if("format"in ft){var nt=ft.format;O(z.webgl_depth_texture||!(nt==="depth"||nt==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),O.parameter(nt,It,"invalid texture format");var it=W.internalformat=It[nt];W.format=Ut[it],nt in Ht&&("type"in ft||(W.type=Ht[nt])),nt in Gt&&(W.compressed=!0),q=!0}!F&&q?W.channels=ri[W.format]:F&&!q?W.channels!==Sh[W.format]&&(W.format=W.internalformat=Sh[W.channels]):q&&F&&O(W.channels===ri[W.format],"number of channels inconsistent with specified format")}}function Ae(W){T.pixelStorei(yD,W.flipY),T.pixelStorei(bD,W.premultiplyAlpha),T.pixelStorei(xD,W.colorSpace),T.pixelStorei(mD,W.unpackAlignment)}function qt(){kt.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Ft(W,ft){var st=null;if(Ug(ft)?st=ft:ft&&(O.type(ft,"object","invalid pixel data type"),ge(W,ft),"x"in ft&&(W.xOffset=ft.x|0),"y"in ft&&(W.yOffset=ft.y|0),Ug(ft.data)&&(st=ft.data)),O(!W.compressed||st instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),ft.copy){O(!st,"can not specify copy and data field for the same texture");var ne=wt.viewportWidth,ze=wt.viewportHeight;W.width=W.width||ne-W.xOffset,W.height=W.height||ze-W.yOffset,W.needsCopy=!0,O(W.xOffset>=0&&W.xOffset<ne&&W.yOffset>=0&&W.yOffset<ze&&W.width>0&&W.width<=ne&&W.height>0&&W.height<=ze,"copy texture read out of bounds")}else if(!st)W.width=W.width||1,W.height=W.height||1,W.channels=W.channels||4;else if(e(st))W.channels=W.channels||4,W.data=st,!("type"in ft)&&W.type===Ys&&(W.type=ix(st));else if(tx(st))W.channels=W.channels||4,AD(W,st),W.alignment=1,W.needsFree=!0;else if(Ei(st)){var U=st.data;!Array.isArray(U)&&W.type===Ys&&(W.type=ix(U));var F=st.shape,q=st.stride,nt,it,Q,K,$,Y;F.length===3?(Q=F[2],Y=q[2]):(O(F.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Q=1,Y=1),nt=F[0],it=F[1],K=q[0],$=q[1],W.alignment=1,W.width=nt,W.height=it,W.channels=Q,W.format=W.internalformat=Sh[Q],W.needsFree=!0,CD(W,U,K,$,Y,st.offset)}else if(nx(st)||rx(st)||MD(st))nx(st)||rx(st)?W.element=st:W.element=st.canvas,W.width=W.element.width,W.height=W.element.height,W.channels=4;else if(SD(st))W.element=st,W.width=st.width,W.height=st.height,W.channels=4;else if(_D(st))W.element=st,W.width=st.naturalWidth,W.height=st.naturalHeight,W.channels=4;else if(kD(st))W.element=st,W.width=st.videoWidth,W.height=st.videoHeight,W.channels=4;else if(ex(st)){var H=W.width||st[0].length,G=W.height||st.length,et=W.channels;Nn(st[0][0])?et=et||st[0][0].length:et=et||1;for(var at=vh.shape(st),yt=1,xt=0;xt<at.length;++xt)yt*=at[xt];var vt=ox(W,yt);vh.flatten(st,at,"",vt),ax(W,vt),W.alignment=1,W.width=H,W.height=G,W.channels=et,W.format=W.internalformat=Sh[et],W.needsFree=!0}W.type===sc?O(X.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):W.type===Us&&O(X.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Mt(W,ft,st){var ne=W.element,ze=W.data,U=W.internalformat,F=W.format,q=W.type,nt=W.width,it=W.height;Ae(W),ne?T.texImage2D(ft,st,F,F,q,ne):W.compressed?T.compressedTexImage2D(ft,st,U,nt,it,0,ze):W.needsCopy?(ht(),T.copyTexImage2D(ft,st,F,W.xOffset,W.yOffset,nt,it,0)):T.texImage2D(ft,st,F,nt,it,0,F,q,ze||null)}function Se(W,ft,st,ne,ze){var U=W.element,F=W.data,q=W.internalformat,nt=W.format,it=W.type,Q=W.width,K=W.height;Ae(W),U?T.texSubImage2D(ft,ze,st,ne,nt,it,U):W.compressed?T.compressedTexSubImage2D(ft,ze,st,ne,q,Q,K,F):W.needsCopy?(ht(),T.copyTexSubImage2D(ft,ze,st,ne,W.xOffset,W.yOffset,Q,K)):T.texSubImage2D(ft,ze,st,ne,Q,K,nt,it,F)}var Pe=[];function ie(){return Pe.pop()||new qt}function Be(W){W.needsFree&&Ke.freeType(W.data),qt.call(W),Pe.push(W)}function Ie(){kt.call(this),this.genMipmaps=!1,this.mipmapHint=Mh,this.mipmask=0,this.images=Array(16)}function Fe(W,ft,st){var ne=W.images[0]=ie();W.mipmask=1,ne.width=W.width=ft,ne.height=W.height=st,ne.channels=W.channels=4}function rn(W,ft){var st=null;if(Ug(ft))st=W.images[0]=ie(),Yt(st,W),Ft(st,ft),W.mipmask=1;else if(ge(W,ft),Array.isArray(ft.mipmap))for(var ne=ft.mipmap,ze=0;ze<ne.length;++ze)st=W.images[ze]=ie(),Yt(st,W),st.width>>=ze,st.height>>=ze,Ft(st,ne[ze]),W.mipmask|=1<<ze;else st=W.images[0]=ie(),Yt(st,W),Ft(st,ft),W.mipmask=1;Yt(W,W.images[0]),W.compressed&&(W.internalformat===Ng||W.internalformat===Dg||W.internalformat===Pg||W.internalformat===Lg)&&O(W.width%4===0&&W.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Fn(W,ft){for(var st=W.images,ne=0;ne<st.length;++ne){if(!st[ne])return;Mt(st[ne],ft,ne)}}var Jn=[];function Ye(){var W=Jn.pop()||new Ie;kt.call(W),W.mipmask=0;for(var ft=0;ft<16;++ft)W.images[ft]=null;return W}function Xn(W){for(var ft=W.images,st=0;st<ft.length;++st)ft[st]&&Be(ft[st]),ft[st]=null;Jn.push(W)}function vn(){this.minFilter=Bg,this.magFilter=Bg,this.wrapS=Fg,this.wrapT=Fg,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Mh}function Bn(W,ft){if("min"in ft){var st=ft.min;O.parameter(st,Nt),W.minFilter=Nt[st],wD.indexOf(W.minFilter)>=0&&!("faces"in ft)&&(W.genMipmaps=!0)}if("mag"in ft){var ne=ft.mag;O.parameter(ne,Rt),W.magFilter=Rt[ne]}var ze=W.wrapS,U=W.wrapT;if("wrap"in ft){var F=ft.wrap;typeof F=="string"?(O.parameter(F,Ot),ze=U=Ot[F]):Array.isArray(F)&&(O.parameter(F[0],Ot),O.parameter(F[1],Ot),ze=Ot[F[0]],U=Ot[F[1]])}else{if("wrapS"in ft){var q=ft.wrapS;O.parameter(q,Ot),ze=Ot[q]}if("wrapT"in ft){var nt=ft.wrapT;O.parameter(nt,Ot),U=Ot[nt]}}if(W.wrapS=ze,W.wrapT=U,"anisotropic"in ft){var it=ft.anisotropic;O(typeof it=="number"&&it>=1&&it<=X.maxAnisotropic,"aniso samples must be between 1 and "),W.anisotropic=ft.anisotropic}if("mipmap"in ft){var Q=!1;switch(typeof ft.mipmap){case"string":O.parameter(ft.mipmap,Ct,"invalid mipmap hint"),W.mipmapHint=Ct[ft.mipmap],W.genMipmaps=!0,Q=!0;break;case"boolean":Q=W.genMipmaps=ft.mipmap;break;case"object":O(Array.isArray(ft.mipmap),"invalid mipmap type"),W.genMipmaps=!1,Q=!0;break;default:O.raise("invalid mipmap type")}Q&&!("min"in ft)&&(W.minFilter=zg)}}function Hn(W,ft){T.texParameteri(ft,hD,W.minFilter),T.texParameteri(ft,lD,W.magFilter),T.texParameteri(ft,aD,W.wrapS),T.texParameteri(ft,sD,W.wrapT),z.ext_texture_filter_anisotropic&&T.texParameteri(ft,vD,W.anisotropic),W.genMipmaps&&(T.hint(dD,W.mipmapHint),T.generateMipmap(ft))}var qn=0,er={},lr=X.maxTextureUnits,Dn=Array(lr).map(function(){return null});function Le(W){kt.call(this),this.mipmask=0,this.internalformat=Ha,this.id=qn++,this.refCount=1,this.target=W,this.texture=T.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new vn,pt.profile&&(this.stats={size:0})}function hr(W){T.activeTexture(uc),T.bindTexture(W.target,W.texture)}function ln(){var W=Dn[0];W?T.bindTexture(W.target,W.texture):T.bindTexture(Yi,null)}function be(W){var ft=W.texture;O(ft,"must not double destroy texture");var st=W.unit,ne=W.target;st>=0&&(T.activeTexture(uc+st),T.bindTexture(ne,null),Dn[st]=null),T.deleteTexture(ft),W.texture=null,W.params=null,W.pixels=null,W.refCount=0,delete er[W.id],lt.textureCount--}r(Le.prototype,{bind:function(){var W=this;W.bindCount+=1;var ft=W.unit;if(ft<0){for(var st=0;st<lr;++st){var ne=Dn[st];if(ne){if(ne.bindCount>0)continue;ne.unit=-1}Dn[st]=W,ft=st;break}ft>=lr&&O.raise("insufficient number of texture units"),pt.profile&&lt.maxTextureUnits<ft+1&&(lt.maxTextureUnits=ft+1),W.unit=ft,T.activeTexture(uc+ft),T.bindTexture(W.target,W.texture)}return ft},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&be(this)}});function Ge(W,ft){var st=new Le(Yi);er[st.id]=st,lt.textureCount++;function ne(F,q){var nt=st.texInfo;vn.call(nt);var it=Ye();return typeof F=="number"?typeof q=="number"?Fe(it,F|0,q|0):Fe(it,F|0,F|0):F?(O.type(F,"object","invalid arguments to regl.texture"),Bn(nt,F),rn(it,F)):Fe(it,1,1),nt.genMipmaps&&(it.mipmask=(it.width<<1)-1),st.mipmask=it.mipmask,Yt(st,it),O.texture2D(nt,it,X),st.internalformat=it.internalformat,ne.width=it.width,ne.height=it.height,hr(st),Fn(it,Yi),Hn(nt,Yi),ln(),Xn(it),pt.profile&&(st.stats.size=_h(st.internalformat,st.type,it.width,it.height,nt.genMipmaps,!1)),ne.format=Lt[st.internalformat],ne.type=Kt[st.type],ne.mag=St[nt.magFilter],ne.min=$t[nt.minFilter],ne.wrapS=At[nt.wrapS],ne.wrapT=At[nt.wrapT],ne}function ze(F,q,nt,it){O(!!F,"must specify image data");var Q=q|0,K=nt|0,$=it|0,Y=ie();return Yt(Y,st),Y.width=0,Y.height=0,Ft(Y,F),Y.width=Y.width||(st.width>>$)-Q,Y.height=Y.height||(st.height>>$)-K,O(st.type===Y.type&&st.format===Y.format&&st.internalformat===Y.internalformat,"incompatible format for texture.subimage"),O(Q>=0&&K>=0&&Q+Y.width<=st.width&&K+Y.height<=st.height,"texture.subimage write out of bounds"),O(st.mipmask&1<<$,"missing mipmap data"),O(Y.data||Y.element||Y.needsCopy,"missing image data"),hr(st),Se(Y,Yi,Q,K,$),ln(),Be(Y),ne}function U(F,q){var nt=F|0,it=q|0||nt;if(nt===st.width&&it===st.height)return ne;ne.width=st.width=nt,ne.height=st.height=it,hr(st);for(var Q=0;st.mipmask>>Q;++Q){var K=nt>>Q,$=it>>Q;if(!K||!$)break;T.texImage2D(Yi,Q,st.format,K,$,0,st.format,st.type,null)}return ln(),pt.profile&&(st.stats.size=_h(st.internalformat,st.type,nt,it,!1,!1)),ne}return ne(W,ft),ne.subimage=ze,ne.resize=U,ne._reglType="texture2d",ne._texture=st,pt.profile&&(ne.stats=st.stats),ne.destroy=function(){st.decRef()},ne}function Qe(W,ft,st,ne,ze,U){var F=new Le(kg);er[F.id]=F,lt.cubeCount++;var q=new Array(6);function nt(K,$,Y,H,G,et){var at,yt=F.texInfo;for(vn.call(yt),at=0;at<6;++at)q[at]=Ye();if(typeof K=="number"||!K){var xt=K|0||1;for(at=0;at<6;++at)Fe(q[at],xt,xt)}else if(typeof K=="object")if($)rn(q[0],K),rn(q[1],$),rn(q[2],Y),rn(q[3],H),rn(q[4],G),rn(q[5],et);else if(Bn(yt,K),ge(F,K),"faces"in K){var vt=K.faces;for(O(Array.isArray(vt)&&vt.length===6,"cube faces must be a length 6 array"),at=0;at<6;++at)O(typeof vt[at]=="object"&&!!vt[at],"invalid input for cube map face"),Yt(q[at],F),rn(q[at],vt[at])}else for(at=0;at<6;++at)rn(q[at],K);else O.raise("invalid arguments to cube map");for(Yt(F,q[0]),X.npotTextureCube||O(Pb(F.width)&&Pb(F.height),"your browser does not support non power or two texture dimensions"),yt.genMipmaps?F.mipmask=(q[0].width<<1)-1:F.mipmask=q[0].mipmask,O.textureCube(F,yt,q,X),F.internalformat=q[0].internalformat,nt.width=q[0].width,nt.height=q[0].height,hr(F),at=0;at<6;++at)Fn(q[at],bh+at);for(Hn(yt,kg),ln(),pt.profile&&(F.stats.size=_h(F.internalformat,F.type,nt.width,nt.height,yt.genMipmaps,!0)),nt.format=Lt[F.internalformat],nt.type=Kt[F.type],nt.mag=St[yt.magFilter],nt.min=$t[yt.minFilter],nt.wrapS=At[yt.wrapS],nt.wrapT=At[yt.wrapT],at=0;at<6;++at)Xn(q[at]);return nt}function it(K,$,Y,H,G){O(!!$,"must specify image data"),O(typeof K=="number"&&K===(K|0)&&K>=0&&K<6,"invalid face");var et=Y|0,at=H|0,yt=G|0,xt=ie();return Yt(xt,F),xt.width=0,xt.height=0,Ft(xt,$),xt.width=xt.width||(F.width>>yt)-et,xt.height=xt.height||(F.height>>yt)-at,O(F.type===xt.type&&F.format===xt.format&&F.internalformat===xt.internalformat,"incompatible format for texture.subimage"),O(et>=0&&at>=0&&et+xt.width<=F.width&&at+xt.height<=F.height,"texture.subimage write out of bounds"),O(F.mipmask&1<<yt,"missing mipmap data"),O(xt.data||xt.element||xt.needsCopy,"missing image data"),hr(F),Se(xt,bh+K,et,at,yt),ln(),Be(xt),nt}function Q(K){var $=K|0;if($!==F.width){nt.width=F.width=$,nt.height=F.height=$,hr(F);for(var Y=0;Y<6;++Y)for(var H=0;F.mipmask>>H;++H)T.texImage2D(bh+Y,H,F.format,$>>H,$>>H,0,F.format,F.type,null);return ln(),pt.profile&&(F.stats.size=_h(F.internalformat,F.type,nt.width,nt.height,!1,!0)),nt}}return nt(W,ft,st,ne,ze,U),nt.subimage=it,nt.resize=Q,nt._reglType="textureCube",nt._texture=F,pt.profile&&(nt.stats=F.stats),nt.destroy=function(){F.decRef()},nt}function Pn(){for(var W=0;W<lr;++W)T.activeTexture(uc+W),T.bindTexture(Yi,null),Dn[W]=null;Vr(er).forEach(be),lt.cubeCount=0,lt.textureCount=0}pt.profile&&(lt.getTotalTextureSize=function(){var W=0;return Object.keys(er).forEach(function(ft){W+=er[ft].stats.size}),W});function Wi(){for(var W=0;W<lr;++W){var ft=Dn[W];ft&&(ft.bindCount=0,ft.unit=-1,Dn[W]=null)}Vr(er).forEach(function(st){st.texture=T.createTexture(),T.bindTexture(st.target,st.texture);for(var ne=0;ne<32;++ne)if(st.mipmask&1<<ne)if(st.target===Yi)T.texImage2D(Yi,ne,st.internalformat,st.width>>ne,st.height>>ne,0,st.internalformat,st.type,null);else for(var ze=0;ze<6;++ze)T.texImage2D(bh+ze,ne,st.internalformat,st.width>>ne,st.height>>ne,0,st.internalformat,st.type,null);Hn(st.texInfo,st.target)})}function es(){for(var W=0;W<lr;++W){var ft=Dn[W];ft&&(ft.bindCount=0,ft.unit=-1,Dn[W]=null),T.activeTexture(uc+W),T.bindTexture(Yi,null),T.bindTexture(kg,null)}}return{create2D:Ge,createCube:Qe,clear:Pn,getTexture:function(W){return null},restore:Wi,refresh:es}}var ia=36161,kh=32854,sx=32855,ux=36194,cx=33189,lx=36168,hx=34041,fx=35907,dx=34836,px=34842,gx=34843,Mi=[];Mi[kh]=2,Mi[sx]=2,Mi[ux]=2,Mi[cx]=2,Mi[lx]=1,Mi[hx]=4,Mi[fx]=4,Mi[dx]=16,Mi[px]=8,Mi[gx]=6;function vx(T,z,X){return Mi[T]*z*X}var TD=function(T,z,X,ht,wt){var lt={rgba4:kh,rgb565:ux,"rgb5 a1":sx,depth:cx,stencil:lx,"depth stencil":hx};z.ext_srgb&&(lt.srgba=fx),z.ext_color_buffer_half_float&&(lt.rgba16f=px,lt.rgb16f=gx),z.webgl_color_buffer_float&&(lt.rgba32f=dx);var pt=[];Object.keys(lt).forEach(function(It){var Gt=lt[It];pt[Gt]=It});var Ct=0,Ot={};function Rt(It){this.id=Ct++,this.refCount=1,this.renderbuffer=It,this.format=kh,this.width=0,this.height=0,wt.profile&&(this.stats={size:0})}Rt.prototype.decRef=function(){--this.refCount<=0&&Nt(this)};function Nt(It){var Gt=It.renderbuffer;O(Gt,"must not double destroy renderbuffer"),T.bindRenderbuffer(ia,null),T.deleteRenderbuffer(Gt),It.renderbuffer=null,It.refCount=0,delete Ot[It.id],ht.renderbufferCount--}function zt(It,Gt){var rt=new Rt(T.createRenderbuffer());Ot[rt.id]=rt,ht.renderbufferCount++;function gt(Kt,St){var $t=0,At=0,Ut=kh;if(typeof Kt=="object"&&Kt){var kt=Kt;if("shape"in kt){var Yt=kt.shape;O(Array.isArray(Yt)&&Yt.length>=2,"invalid renderbuffer shape"),$t=Yt[0]|0,At=Yt[1]|0}else"radius"in kt&&($t=At=kt.radius|0),"width"in kt&&($t=kt.width|0),"height"in kt&&(At=kt.height|0);"format"in kt&&(O.parameter(kt.format,lt,"invalid renderbuffer format"),Ut=lt[kt.format])}else typeof Kt=="number"?($t=Kt|0,typeof St=="number"?At=St|0:At=$t):Kt?O.raise("invalid arguments to renderbuffer constructor"):$t=At=1;if(O($t>0&&At>0&&$t<=X.maxRenderbufferSize&&At<=X.maxRenderbufferSize,"invalid renderbuffer size"),!($t===rt.width&&At===rt.height&&Ut===rt.format))return gt.width=rt.width=$t,gt.height=rt.height=At,rt.format=Ut,T.bindRenderbuffer(ia,rt.renderbuffer),T.renderbufferStorage(ia,Ut,$t,At),O(T.getError()===0,"invalid render buffer format"),wt.profile&&(rt.stats.size=vx(rt.format,rt.width,rt.height)),gt.format=pt[rt.format],gt}function Lt(Kt,St){var $t=Kt|0,At=St|0||$t;return $t===rt.width&&At===rt.height||(O($t>0&&At>0&&$t<=X.maxRenderbufferSize&&At<=X.maxRenderbufferSize,"invalid renderbuffer size"),gt.width=rt.width=$t,gt.height=rt.height=At,T.bindRenderbuffer(ia,rt.renderbuffer),T.renderbufferStorage(ia,rt.format,$t,At),O(T.getError()===0,"invalid render buffer format"),wt.profile&&(rt.stats.size=vx(rt.format,rt.width,rt.height))),gt}return gt(It,Gt),gt.resize=Lt,gt._reglType="renderbuffer",gt._renderbuffer=rt,wt.profile&&(gt.stats=rt.stats),gt.destroy=function(){rt.decRef()},gt}wt.profile&&(ht.getTotalRenderbufferSize=function(){var It=0;return Object.keys(Ot).forEach(function(Gt){It+=Ot[Gt].stats.size}),It});function Ht(){Vr(Ot).forEach(function(It){It.renderbuffer=T.createRenderbuffer(),T.bindRenderbuffer(ia,It.renderbuffer),T.renderbufferStorage(ia,It.format,It.width,It.height)}),T.bindRenderbuffer(ia,null)}return{create:zt,clear:function(){Vr(Ot).forEach(Nt)},restore:Ht}},To=36160,Yg=36161,Za=3553,Ah=34069,mx=36064,yx=36096,bx=36128,xx=33306,wx=36053,OD=36054,ND=36055,DD=36057,PD=36061,LD=36193,jD=5121,RD=5126,Ex=6407,Mx=6408,FD=6402,BD=[Ex,Mx],Vg=[];Vg[Mx]=4,Vg[Ex]=3;var Ch=[];Ch[jD]=1,Ch[RD]=4,Ch[LD]=2;var zD=32854,GD=32855,UD=36194,YD=33189,VD=36168,Sx=34041,WD=35907,XD=34836,HD=34842,qD=34843,ZD=[zD,GD,UD,WD,HD,qD,XD],Xs={};Xs[wx]="complete",Xs[OD]="incomplete attachment",Xs[DD]="incomplete dimensions",Xs[ND]="incomplete, missing attachment",Xs[PD]="unsupported";function KD(T,z,X,ht,wt,lt){var pt={cur:null,next:null,dirty:!1,setFBO:null},Ct=["rgba"],Ot=["rgba4","rgb565","rgb5 a1"];z.ext_srgb&&Ot.push("srgba"),z.ext_color_buffer_half_float&&Ot.push("rgba16f","rgb16f"),z.webgl_color_buffer_float&&Ot.push("rgba32f");var Rt=["uint8"];z.oes_texture_half_float&&Rt.push("half float","float16"),z.oes_texture_float&&Rt.push("float","float32");function Nt(qt,Ft,Mt){this.target=qt,this.texture=Ft,this.renderbuffer=Mt;var Se=0,Pe=0;Ft?(Se=Ft.width,Pe=Ft.height):Mt&&(Se=Mt.width,Pe=Mt.height),this.width=Se,this.height=Pe}function zt(qt){qt&&(qt.texture&&qt.texture._texture.decRef(),qt.renderbuffer&&qt.renderbuffer._renderbuffer.decRef())}function Ht(qt,Ft,Mt){if(qt)if(qt.texture){var Se=qt.texture._texture,Pe=Math.max(1,Se.width),ie=Math.max(1,Se.height);O(Pe===Ft&&ie===Mt,"inconsistent width/height for supplied texture"),Se.refCount+=1}else{var Be=qt.renderbuffer._renderbuffer;O(Be.width===Ft&&Be.height===Mt,"inconsistent width/height for renderbuffer"),Be.refCount+=1}}function It(qt,Ft){Ft&&(Ft.texture?T.framebufferTexture2D(To,qt,Ft.target,Ft.texture._texture.texture,0):T.framebufferRenderbuffer(To,qt,Yg,Ft.renderbuffer._renderbuffer.renderbuffer))}function Gt(qt){var Ft=Za,Mt=null,Se=null,Pe=qt;typeof qt=="object"&&(Pe=qt.data,"target"in qt&&(Ft=qt.target|0)),O.type(Pe,"function","invalid attachment data");var ie=Pe._reglType;return ie==="texture2d"?(Mt=Pe,O(Ft===Za)):ie==="textureCube"?(Mt=Pe,O(Ft>=Ah&&Ft<Ah+6,"invalid cube map target")):ie==="renderbuffer"?(Se=Pe,Ft=Yg):O.raise("invalid regl object for attachment"),new Nt(Ft,Mt,Se)}function rt(qt,Ft,Mt,Se,Pe){if(Mt){var ie=ht.create2D({width:qt,height:Ft,format:Se,type:Pe});return ie._texture.refCount=0,new Nt(Za,ie,null)}else{var Be=wt.create({width:qt,height:Ft,format:Se});return Be._renderbuffer.refCount=0,new Nt(Yg,null,Be)}}function gt(qt){return qt&&(qt.texture||qt.renderbuffer)}function Lt(qt,Ft,Mt){qt&&(qt.texture?qt.texture.resize(Ft,Mt):qt.renderbuffer&&qt.renderbuffer.resize(Ft,Mt),qt.width=Ft,qt.height=Mt)}var Kt=0,St={};function $t(){this.id=Kt++,St[this.id]=this,this.framebuffer=T.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function At(qt){qt.colorAttachments.forEach(zt),zt(qt.depthAttachment),zt(qt.stencilAttachment),zt(qt.depthStencilAttachment)}function Ut(qt){var Ft=qt.framebuffer;O(Ft,"must not double destroy framebuffer"),T.deleteFramebuffer(Ft),qt.framebuffer=null,lt.framebufferCount--,delete St[qt.id]}function kt(qt){var Ft;T.bindFramebuffer(To,qt.framebuffer);var Mt=qt.colorAttachments;for(Ft=0;Ft<Mt.length;++Ft)It(mx+Ft,Mt[Ft]);for(Ft=Mt.length;Ft<X.maxColorAttachments;++Ft)T.framebufferTexture2D(To,mx+Ft,Za,null,0);T.framebufferTexture2D(To,xx,Za,null,0),T.framebufferTexture2D(To,yx,Za,null,0),T.framebufferTexture2D(To,bx,Za,null,0),It(yx,qt.depthAttachment),It(bx,qt.stencilAttachment),It(xx,qt.depthStencilAttachment);var Se=T.checkFramebufferStatus(To);!T.isContextLost()&&Se!==wx&&O.raise("framebuffer configuration not supported, status = "+Xs[Se]),T.bindFramebuffer(To,pt.next?pt.next.framebuffer:null),pt.cur=pt.next,T.getError()}function Yt(qt,Ft){var Mt=new $t;lt.framebufferCount++;function Se(ie,Be){var Ie;O(pt.next!==Mt,"can not update framebuffer which is currently in use");var Fe=0,rn=0,Fn=!0,Jn=!0,Ye=null,Xn=!0,vn="rgba",Bn="uint8",Hn=1,qn=null,er=null,lr=null,Dn=!1;if(typeof ie=="number")Fe=ie|0,rn=Be|0||Fe;else if(!ie)Fe=rn=1;else{O.type(ie,"object","invalid arguments for framebuffer");var Le=ie;if("shape"in Le){var hr=Le.shape;O(Array.isArray(hr)&&hr.length>=2,"invalid shape for framebuffer"),Fe=hr[0],rn=hr[1]}else"radius"in Le&&(Fe=rn=Le.radius),"width"in Le&&(Fe=Le.width),"height"in Le&&(rn=Le.height);("color"in Le||"colors"in Le)&&(Ye=Le.color||Le.colors,Array.isArray(Ye)&&O(Ye.length===1||z.webgl_draw_buffers,"multiple render targets not supported")),Ye||("colorCount"in Le&&(Hn=Le.colorCount|0,O(Hn>0,"invalid color buffer count")),"colorTexture"in Le&&(Xn=!!Le.colorTexture,vn="rgba4"),"colorType"in Le&&(Bn=Le.colorType,Xn?(O(z.oes_texture_float||!(Bn==="float"||Bn==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),O(z.oes_texture_half_float||!(Bn==="half float"||Bn==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Bn==="half float"||Bn==="float16"?(O(z.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),vn="rgba16f"):(Bn==="float"||Bn==="float32")&&(O(z.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),vn="rgba32f"),O.oneOf(Bn,Rt,"invalid color type")),"colorFormat"in Le&&(vn=Le.colorFormat,Ct.indexOf(vn)>=0?Xn=!0:Ot.indexOf(vn)>=0?Xn=!1:Xn?O.oneOf(Le.colorFormat,Ct,"invalid color format for texture"):O.oneOf(Le.colorFormat,Ot,"invalid color format for renderbuffer"))),("depthTexture"in Le||"depthStencilTexture"in Le)&&(Dn=!!(Le.depthTexture||Le.depthStencilTexture),O(!Dn||z.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Le&&(typeof Le.depth=="boolean"?Fn=Le.depth:(qn=Le.depth,Jn=!1)),"stencil"in Le&&(typeof Le.stencil=="boolean"?Jn=Le.stencil:(er=Le.stencil,Fn=!1)),"depthStencil"in Le&&(typeof Le.depthStencil=="boolean"?Fn=Jn=Le.depthStencil:(lr=Le.depthStencil,Fn=!1,Jn=!1))}var ln=null,be=null,Ge=null,Qe=null;if(Array.isArray(Ye))ln=Ye.map(Gt);else if(Ye)ln=[Gt(Ye)];else for(ln=new Array(Hn),Ie=0;Ie<Hn;++Ie)ln[Ie]=rt(Fe,rn,Xn,vn,Bn);O(z.webgl_draw_buffers||ln.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),O(ln.length<=X.maxColorAttachments,"too many color attachments, not supported"),Fe=Fe||ln[0].width,rn=rn||ln[0].height,qn?be=Gt(qn):Fn&&!Jn&&(be=rt(Fe,rn,Dn,"depth","uint32")),er?Ge=Gt(er):Jn&&!Fn&&(Ge=rt(Fe,rn,!1,"stencil","uint8")),lr?Qe=Gt(lr):!qn&&!er&&Jn&&Fn&&(Qe=rt(Fe,rn,Dn,"depth stencil","depth stencil")),O(!!qn+!!er+!!lr<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Pn=null;for(Ie=0;Ie<ln.length;++Ie)if(Ht(ln[Ie],Fe,rn),O(!ln[Ie]||ln[Ie].texture&&BD.indexOf(ln[Ie].texture._texture.format)>=0||ln[Ie].renderbuffer&&ZD.indexOf(ln[Ie].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Ie+" is invalid"),ln[Ie]&&ln[Ie].texture){var Wi=Vg[ln[Ie].texture._texture.format]*Ch[ln[Ie].texture._texture.type];Pn===null?Pn=Wi:O(Pn===Wi,"all color attachments much have the same number of bits per pixel.")}return Ht(be,Fe,rn),O(!be||be.texture&&be.texture._texture.format===FD||be.renderbuffer&&be.renderbuffer._renderbuffer.format===YD,"invalid depth attachment for framebuffer object"),Ht(Ge,Fe,rn),O(!Ge||Ge.renderbuffer&&Ge.renderbuffer._renderbuffer.format===VD,"invalid stencil attachment for framebuffer object"),Ht(Qe,Fe,rn),O(!Qe||Qe.texture&&Qe.texture._texture.format===Sx||Qe.renderbuffer&&Qe.renderbuffer._renderbuffer.format===Sx,"invalid depth-stencil attachment for framebuffer object"),At(Mt),Mt.width=Fe,Mt.height=rn,Mt.colorAttachments=ln,Mt.depthAttachment=be,Mt.stencilAttachment=Ge,Mt.depthStencilAttachment=Qe,Se.color=ln.map(gt),Se.depth=gt(be),Se.stencil=gt(Ge),Se.depthStencil=gt(Qe),Se.width=Mt.width,Se.height=Mt.height,kt(Mt),Se}function Pe(ie,Be){O(pt.next!==Mt,"can not resize a framebuffer which is currently in use");var Ie=Math.max(ie|0,1),Fe=Math.max(Be|0||Ie,1);if(Ie===Mt.width&&Fe===Mt.height)return Se;for(var rn=Mt.colorAttachments,Fn=0;Fn<rn.length;++Fn)Lt(rn[Fn],Ie,Fe);return Lt(Mt.depthAttachment,Ie,Fe),Lt(Mt.stencilAttachment,Ie,Fe),Lt(Mt.depthStencilAttachment,Ie,Fe),Mt.width=Se.width=Ie,Mt.height=Se.height=Fe,kt(Mt),Se}return Se(qt,Ft),r(Se,{resize:Pe,_reglType:"framebuffer",_framebuffer:Mt,destroy:function(){Ut(Mt),At(Mt)},use:function(ie){pt.setFBO({framebuffer:Se},ie)}})}function ge(qt){var Ft=Array(6);function Mt(Pe){var ie;O(Ft.indexOf(pt.next)<0,"can not update framebuffer which is currently in use");var Be={color:null},Ie=0,Fe=null,rn="rgba",Fn="uint8",Jn=1;if(typeof Pe=="number")Ie=Pe|0;else if(!Pe)Ie=1;else{O.type(Pe,"object","invalid arguments for framebuffer");var Ye=Pe;if("shape"in Ye){var Xn=Ye.shape;O(Array.isArray(Xn)&&Xn.length>=2,"invalid shape for framebuffer"),O(Xn[0]===Xn[1],"cube framebuffer must be square"),Ie=Xn[0]}else"radius"in Ye&&(Ie=Ye.radius|0),"width"in Ye?(Ie=Ye.width|0,"height"in Ye&&O(Ye.height===Ie,"must be square")):"height"in Ye&&(Ie=Ye.height|0);("color"in Ye||"colors"in Ye)&&(Fe=Ye.color||Ye.colors,Array.isArray(Fe)&&O(Fe.length===1||z.webgl_draw_buffers,"multiple render targets not supported")),Fe||("colorCount"in Ye&&(Jn=Ye.colorCount|0,O(Jn>0,"invalid color buffer count")),"colorType"in Ye&&(O.oneOf(Ye.colorType,Rt,"invalid color type"),Fn=Ye.colorType),"colorFormat"in Ye&&(rn=Ye.colorFormat,O.oneOf(Ye.colorFormat,Ct,"invalid color format for texture"))),"depth"in Ye&&(Be.depth=Ye.depth),"stencil"in Ye&&(Be.stencil=Ye.stencil),"depthStencil"in Ye&&(Be.depthStencil=Ye.depthStencil)}var vn;if(Fe)if(Array.isArray(Fe))for(vn=[],ie=0;ie<Fe.length;++ie)vn[ie]=Fe[ie];else vn=[Fe];else{vn=Array(Jn);var Bn={radius:Ie,format:rn,type:Fn};for(ie=0;ie<Jn;++ie)vn[ie]=ht.createCube(Bn)}for(Be.color=Array(vn.length),ie=0;ie<vn.length;++ie){var Hn=vn[ie];O(typeof Hn=="function"&&Hn._reglType==="textureCube","invalid cube map"),Ie=Ie||Hn.width,O(Hn.width===Ie&&Hn.height===Ie,"invalid cube map shape"),Be.color[ie]={target:Ah,data:vn[ie]}}for(ie=0;ie<6;++ie){for(var qn=0;qn<vn.length;++qn)Be.color[qn].target=Ah+ie;ie>0&&(Be.depth=Ft[0].depth,Be.stencil=Ft[0].stencil,Be.depthStencil=Ft[0].depthStencil),Ft[ie]?Ft[ie](Be):Ft[ie]=Yt(Be)}return r(Mt,{width:Ie,height:Ie,color:vn})}function Se(Pe){var ie,Be=Pe|0;if(O(Be>0&&Be<=X.maxCubeMapSize,"invalid radius for cube fbo"),Be===Mt.width)return Mt;var Ie=Mt.color;for(ie=0;ie<Ie.length;++ie)Ie[ie].resize(Be);for(ie=0;ie<6;++ie)Ft[ie].resize(Be);return Mt.width=Mt.height=Be,Mt}return Mt(qt),r(Mt,{faces:Ft,resize:Se,_reglType:"framebufferCube",destroy:function(){Ft.forEach(function(Pe){Pe.destroy()})}})}function Ae(){pt.cur=null,pt.next=null,pt.dirty=!0,Vr(St).forEach(function(qt){qt.framebuffer=T.createFramebuffer(),kt(qt)})}return r(pt,{getFramebuffer:function(qt){if(typeof qt=="function"&&qt._reglType==="framebuffer"){var Ft=qt._framebuffer;if(Ft instanceof $t)return Ft}return null},create:Yt,createCube:ge,clear:function(){Vr(St).forEach(Ut)},restore:Ae})}var QD=5126,_x=34962;function Wg(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=QD,this.offset=0,this.stride=0,this.divisor=0}function JD(T,z,X,ht,wt){for(var lt=X.maxAttributes,pt=new Array(lt),Ct=0;Ct<lt;++Ct)pt[Ct]=new Wg;var Ot=0,Rt={},Nt={Record:Wg,scope:{},state:pt,currentVAO:null,targetVAO:null,restore:Ht()?St:function(){},createVAO:$t,getVAO:Gt,destroyBuffer:zt,setVAO:Ht()?rt:gt,clear:Ht()?Lt:function(){}};function zt(At){for(var Ut=0;Ut<pt.length;++Ut){var kt=pt[Ut];kt.buffer===At&&(T.disableVertexAttribArray(Ut),kt.buffer=null)}}function Ht(){return z.oes_vertex_array_object}function It(){return z.angle_instanced_arrays}function Gt(At){return typeof At=="function"&&At._vao?At._vao:null}function rt(At){if(At!==Nt.currentVAO){var Ut=Ht();At?Ut.bindVertexArrayOES(At.vao):Ut.bindVertexArrayOES(null),Nt.currentVAO=At}}function gt(At){if(At!==Nt.currentVAO){if(At)At.bindAttrs();else for(var Ut=It(),kt=0;kt<pt.length;++kt){var Yt=pt[kt];Yt.buffer?(T.enableVertexAttribArray(kt),T.vertexAttribPointer(kt,Yt.size,Yt.type,Yt.normalized,Yt.stride,Yt.offfset),Ut&&Yt.divisor&&Ut.vertexAttribDivisorANGLE(kt,Yt.divisor)):(T.disableVertexAttribArray(kt),T.vertexAttrib4f(kt,Yt.x,Yt.y,Yt.z,Yt.w))}Nt.currentVAO=At}}function Lt(){Vr(Rt).forEach(function(At){At.destroy()})}function Kt(){this.id=++Ot,this.attributes=[];var At=Ht();At?this.vao=At.createVertexArrayOES():this.vao=null,Rt[this.id]=this,this.buffers=[]}Kt.prototype.bindAttrs=function(){for(var At=It(),Ut=this.attributes,kt=0;kt<Ut.length;++kt){var Yt=Ut[kt];Yt.buffer?(T.enableVertexAttribArray(kt),T.bindBuffer(_x,Yt.buffer.buffer),T.vertexAttribPointer(kt,Yt.size,Yt.type,Yt.normalized,Yt.stride,Yt.offset),At&&Yt.divisor&&At.vertexAttribDivisorANGLE(kt,Yt.divisor)):(T.disableVertexAttribArray(kt),T.vertexAttrib4f(kt,Yt.x,Yt.y,Yt.z,Yt.w))}for(var ge=Ut.length;ge<lt;++ge)T.disableVertexAttribArray(ge)},Kt.prototype.refresh=function(){var At=Ht();At&&(At.bindVertexArrayOES(this.vao),this.bindAttrs(),Nt.currentVAO=this)},Kt.prototype.destroy=function(){if(this.vao){var At=Ht();this===Nt.currentVAO&&(Nt.currentVAO=null,At.bindVertexArrayOES(null)),At.deleteVertexArrayOES(this.vao),this.vao=null}Rt[this.id]&&(delete Rt[this.id],ht.vaoCount-=1)};function St(){var At=Ht();At&&Vr(Rt).forEach(function(Ut){Ut.refresh()})}function $t(At){var Ut=new Kt;ht.vaoCount+=1;function kt(Yt){O(Array.isArray(Yt),"arguments to vertex array constructor must be an array"),O(Yt.length<lt,"too many attributes"),O(Yt.length>0,"must specify at least one attribute");var ge={},Ae=Ut.attributes;Ae.length=Yt.length;for(var qt=0;qt<Yt.length;++qt){var Ft=Yt[qt],Mt=Ae[qt]=new Wg,Se=Ft.data||Ft;if(Array.isArray(Se)||e(Se)||Ei(Se)){var Pe;Ut.buffers[qt]&&(Pe=Ut.buffers[qt],e(Se)&&Pe._buffer.byteLength>=Se.byteLength?Pe.subdata(Se):(Pe.destroy(),Ut.buffers[qt]=null)),Ut.buffers[qt]||(Pe=Ut.buffers[qt]=wt.create(Ft,_x,!1,!0)),Mt.buffer=wt.getBuffer(Pe),Mt.size=Mt.buffer.dimension|0,Mt.normalized=!1,Mt.type=Mt.buffer.dtype,Mt.offset=0,Mt.stride=0,Mt.divisor=0,Mt.state=1,ge[qt]=1}else wt.getBuffer(Ft)?(Mt.buffer=wt.getBuffer(Ft),Mt.size=Mt.buffer.dimension|0,Mt.normalized=!1,Mt.type=Mt.buffer.dtype,Mt.offset=0,Mt.stride=0,Mt.divisor=0,Mt.state=1):wt.getBuffer(Ft.buffer)?(Mt.buffer=wt.getBuffer(Ft.buffer),Mt.size=(+Ft.size||Mt.buffer.dimension)|0,Mt.normalized=!!Ft.normalized||!1,"type"in Ft?(O.parameter(Ft.type,Wa,"invalid buffer type"),Mt.type=Wa[Ft.type]):Mt.type=Mt.buffer.dtype,Mt.offset=(Ft.offset||0)|0,Mt.stride=(Ft.stride||0)|0,Mt.divisor=(Ft.divisor||0)|0,Mt.state=1,O(Mt.size>=1&&Mt.size<=4,"size must be between 1 and 4"),O(Mt.offset>=0,"invalid offset"),O(Mt.stride>=0&&Mt.stride<=255,"stride must be between 0 and 255"),O(Mt.divisor>=0,"divisor must be positive"),O(!Mt.divisor||!!z.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Ft?(O(qt>0,"first attribute must not be a constant"),Mt.x=+Ft.x||0,Mt.y=+Ft.y||0,Mt.z=+Ft.z||0,Mt.w=+Ft.w||0,Mt.state=2):O(!1,"invalid attribute spec for location "+qt)}for(var ie=0;ie<Ut.buffers.length;++ie)!ge[ie]&&Ut.buffers[ie]&&(Ut.buffers[ie].destroy(),Ut.buffers[ie]=null);return Ut.refresh(),kt}return kt.destroy=function(){for(var Yt=0;Yt<Ut.buffers.length;++Yt)Ut.buffers[Yt]&&Ut.buffers[Yt].destroy();Ut.buffers.length=0,Ut.destroy()},kt._vao=Ut,kt._reglType="vao",kt(At)}return Nt}var kx=35632,$D=35633,tP=35718,eP=35721;function nP(T,z,X,ht){var wt={},lt={};function pt(rt,gt,Lt,Kt){this.name=rt,this.id=gt,this.location=Lt,this.info=Kt}function Ct(rt,gt){for(var Lt=0;Lt<rt.length;++Lt)if(rt[Lt].id===gt.id){rt[Lt].location=gt.location;return}rt.push(gt)}function Ot(rt,gt,Lt){var Kt=rt===kx?wt:lt,St=Kt[gt];if(!St){var $t=z.str(gt);St=T.createShader(rt),T.shaderSource(St,$t),T.compileShader(St),O.shaderError(T,St,$t,rt,Lt),Kt[gt]=St}return St}var Rt={},Nt=[],zt=0;function Ht(rt,gt){this.id=zt++,this.fragId=rt,this.vertId=gt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,ht.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function It(rt,gt,Lt){var Kt,St,$t=Ot(kx,rt.fragId),At=Ot($D,rt.vertId),Ut=rt.program=T.createProgram();if(T.attachShader(Ut,$t),T.attachShader(Ut,At),Lt)for(Kt=0;Kt<Lt.length;++Kt){var kt=Lt[Kt];T.bindAttribLocation(Ut,kt[0],kt[1])}T.linkProgram(Ut),O.linkError(T,Ut,z.str(rt.fragId),z.str(rt.vertId),gt);var Yt=T.getProgramParameter(Ut,tP);ht.profile&&(rt.stats.uniformsCount=Yt);var ge=rt.uniforms;for(Kt=0;Kt<Yt;++Kt)if(St=T.getActiveUniform(Ut,Kt),St)if(St.size>1)for(var Ae=0;Ae<St.size;++Ae){var qt=St.name.replace("[0]","["+Ae+"]");Ct(ge,new pt(qt,z.id(qt),T.getUniformLocation(Ut,qt),St))}else Ct(ge,new pt(St.name,z.id(St.name),T.getUniformLocation(Ut,St.name),St));var Ft=T.getProgramParameter(Ut,eP);ht.profile&&(rt.stats.attributesCount=Ft);var Mt=rt.attributes;for(Kt=0;Kt<Ft;++Kt)St=T.getActiveAttrib(Ut,Kt),St&&Ct(Mt,new pt(St.name,z.id(St.name),T.getAttribLocation(Ut,St.name),St))}ht.profile&&(X.getMaxUniformsCount=function(){var rt=0;return Nt.forEach(function(gt){gt.stats.uniformsCount>rt&&(rt=gt.stats.uniformsCount)}),rt},X.getMaxAttributesCount=function(){var rt=0;return Nt.forEach(function(gt){gt.stats.attributesCount>rt&&(rt=gt.stats.attributesCount)}),rt});function Gt(){wt={},lt={};for(var rt=0;rt<Nt.length;++rt)It(Nt[rt],null,Nt[rt].attributes.map(function(gt){return[gt.location,gt.name]}))}return{clear:function(){var rt=T.deleteShader.bind(T);Vr(wt).forEach(rt),wt={},Vr(lt).forEach(rt),lt={},Nt.forEach(function(gt){T.deleteProgram(gt.program)}),Nt.length=0,Rt={},X.shaderCount=0},program:function(rt,gt,Lt,Kt){O.command(rt>=0,"missing vertex shader",Lt),O.command(gt>=0,"missing fragment shader",Lt);var St=Rt[gt];St||(St=Rt[gt]={});var $t=St[rt];if($t&&($t.refCount++,!Kt))return $t;var At=new Ht(gt,rt);return X.shaderCount++,It(At,Lt,Kt),$t||(St[rt]=At),Nt.push(At),r(At,{destroy:function(){if(At.refCount--,At.refCount<=0){T.deleteProgram(At.program);var Ut=Nt.indexOf(At);Nt.splice(Ut,1),X.shaderCount--}St[At.vertId].refCount<=0&&(T.deleteShader(lt[At.vertId]),delete lt[At.vertId],delete Rt[At.fragId][At.vertId]),Object.keys(Rt[At.fragId]).length||(T.deleteShader(wt[At.fragId]),delete wt[At.fragId],delete Rt[At.fragId])}})},restore:Gt,shader:Ot,frag:-1,vert:-1}}var rP=6408,cc=5121,iP=3333,Ih=5126;function oP(T,z,X,ht,wt,lt,pt){function Ct(Nt){var zt;z.next===null?(O(wt.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),zt=cc):(O(z.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),zt=z.next.colorAttachments[0].texture._texture.type,lt.oes_texture_float?(O(zt===cc||zt===Ih,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),zt===Ih&&O(pt.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):O(zt===cc,"Reading from a framebuffer is only allowed for the type 'uint8'"));var Ht=0,It=0,Gt=ht.framebufferWidth,rt=ht.framebufferHeight,gt=null;e(Nt)?gt=Nt:Nt&&(O.type(Nt,"object","invalid arguments to regl.read()"),Ht=Nt.x|0,It=Nt.y|0,O(Ht>=0&&Ht<ht.framebufferWidth,"invalid x offset for regl.read"),O(It>=0&&It<ht.framebufferHeight,"invalid y offset for regl.read"),Gt=(Nt.width||ht.framebufferWidth-Ht)|0,rt=(Nt.height||ht.framebufferHeight-It)|0,gt=Nt.data||null),gt&&(zt===cc?O(gt instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):zt===Ih&&O(gt instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),O(Gt>0&&Gt+Ht<=ht.framebufferWidth,"invalid width for read pixels"),O(rt>0&&rt+It<=ht.framebufferHeight,"invalid height for read pixels"),X();var Lt=Gt*rt*4;return gt||(zt===cc?gt=new Uint8Array(Lt):zt===Ih&&(gt=gt||new Float32Array(Lt))),O.isTypedArray(gt,"data buffer for regl.read() must be a typedarray"),O(gt.byteLength>=Lt,"data buffer for regl.read() too small"),T.pixelStorei(iP,4),T.readPixels(Ht,It,Gt,rt,rP,zt,gt),gt}function Ot(Nt){var zt;return z.setFBO({framebuffer:Nt.framebuffer},function(){zt=Ct(Nt)}),zt}function Rt(Nt){return!Nt||!("framebuffer"in Nt)?Ct(Nt):Ot(Nt)}return Rt}function Hs(T){return Array.prototype.slice.call(T)}function qs(T){return Hs(T).join("")}function aP(){var T=0,z=[],X=[];function ht(zt){for(var Ht=0;Ht<X.length;++Ht)if(X[Ht]===zt)return z[Ht];var It="g"+T++;return z.push(It),X.push(zt),It}function wt(){var zt=[];function Ht(){zt.push.apply(zt,Hs(arguments))}var It=[];function Gt(){var rt="v"+T++;return It.push(rt),arguments.length>0&&(zt.push(rt,"="),zt.push.apply(zt,Hs(arguments)),zt.push(";")),rt}return r(Ht,{def:Gt,toString:function(){return qs([It.length>0?"var "+It.join(",")+";":"",qs(zt)])}})}function lt(){var zt=wt(),Ht=wt(),It=zt.toString,Gt=Ht.toString;function rt(gt,Lt){Ht(gt,Lt,"=",zt.def(gt,Lt),";")}return r(function(){zt.apply(zt,Hs(arguments))},{def:zt.def,entry:zt,exit:Ht,save:rt,set:function(gt,Lt,Kt){rt(gt,Lt),zt(gt,Lt,"=",Kt,";")},toString:function(){return It()+Gt()}})}function pt(){var zt=qs(arguments),Ht=lt(),It=lt(),Gt=Ht.toString,rt=It.toString;return r(Ht,{then:function(){return Ht.apply(Ht,Hs(arguments)),this},else:function(){return It.apply(It,Hs(arguments)),this},toString:function(){var gt=rt();return gt&&(gt="else{"+gt+"}"),qs(["if(",zt,"){",Gt(),"}",gt])}})}var Ct=wt(),Ot={};function Rt(zt,Ht){var It=[];function Gt(){var St="a"+It.length;return It.push(St),St}Ht=Ht||0;for(var rt=0;rt<Ht;++rt)Gt();var gt=lt(),Lt=gt.toString,Kt=Ot[zt]=r(gt,{arg:Gt,toString:function(){return qs(["function(",It.join(),"){",Lt(),"}"])}});return Kt}function Nt(){var zt=['"use strict";',Ct,"return {"];Object.keys(Ot).forEach(function(Gt){zt.push('"',Gt,'":',Ot[Gt].toString(),",")}),zt.push("}");var Ht=qs(zt).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),It=Function.apply(null,z.concat(Ht));return It.apply(null,X)}return{global:Ct,link:ht,block:wt,proc:Rt,scope:lt,cond:pt,compile:Nt}}var Zs="xyzw".split(""),Ax=5121,Ks=1,Xg=2,Hg=0,qg=1,Zg=2,Kg=3,Th=4,Cx=5,Ix=6,Tx="dither",Ox="blend.enable",Nx="blend.color",Qg="blend.equation",Jg="blend.func",Dx="depth.enable",Px="depth.func",Lx="depth.range",jx="depth.mask",$g="colorMask",Rx="cull.enable",Fx="cull.face",t0="frontFace",e0="lineWidth",Bx="polygonOffset.enable",n0="polygonOffset.offset",zx="sample.alpha",Gx="sample.enable",r0="sample.coverage",Ux="stencil.enable",Yx="stencil.mask",i0="stencil.func",o0="stencil.opFront",lc="stencil.opBack",Vx="scissor.enable",Oh="scissor.box",Oo="viewport",hc="profile",Ka="framebuffer",fc="vert",dc="frag",Qa="elements",Ja="primitive",$a="count",Nh="offset",Dh="instances",pc="vao",a0="Width",s0="Height",Qs=Ka+a0,Js=Ka+s0,sP=Oo+a0,uP=Oo+s0,Wx="drawingBuffer",Xx=Wx+a0,Hx=Wx+s0,cP=[Jg,Qg,i0,o0,lc,r0,Oo,Oh,n0],$s=34962,lP=34963,hP=35632,fP=35633,qx=3553,dP=34067,pP=2884,gP=3042,vP=3024,mP=2960,yP=2929,bP=3089,xP=32823,wP=32926,EP=32928,u0=5126,Ph=35664,Lh=35665,jh=35666,c0=5124,Rh=35667,Fh=35668,Bh=35669,l0=35670,zh=35671,Gh=35672,Uh=35673,gc=35674,vc=35675,mc=35676,yc=35678,bc=35680,Zx=4,xc=1028,ts=1029,Kx=2304,h0=2305,MP=32775,SP=32776,_P=519,oa=7680,Qx=0,Jx=1,$x=32774,kP=513,tw=36160,AP=36064,Vi={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ew=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],tu={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},aa={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},nw={frag:hP,vert:fP},f0={cw:Kx,ccw:h0};function Yh(T){return Array.isArray(T)||e(T)||Ei(T)}function rw(T){return T.sort(function(z,X){return z===Oo?-1:X===Oo?1:z<X?-1:1})}function Ir(T,z,X,ht){this.thisDep=T,this.contextDep=z,this.propDep=X,this.append=ht}function sa(T){return T&&!(T.thisDep||T.contextDep||T.propDep)}function Rn(T){return new Ir(!1,!1,!1,T)}function Dr(T,z){var X=T.type;if(X===Hg){var ht=T.data.length;return new Ir(!0,ht>=1,ht>=2,z)}else if(X===Th){var wt=T.data;return new Ir(wt.thisDep,wt.contextDep,wt.propDep,z)}else{if(X===Cx)return new Ir(!1,!1,!1,z);if(X===Ix){for(var lt=!1,pt=!1,Ct=!1,Ot=0;Ot<T.data.length;++Ot){var Rt=T.data[Ot];if(Rt.type===qg)Ct=!0;else if(Rt.type===Zg)pt=!0;else if(Rt.type===Kg)lt=!0;else if(Rt.type===Hg){lt=!0;var Nt=Rt.data;Nt>=1&&(pt=!0),Nt>=2&&(Ct=!0)}else Rt.type===Th&&(lt=lt||Rt.data.thisDep,pt=pt||Rt.data.contextDep,Ct=Ct||Rt.data.propDep)}return new Ir(lt,pt,Ct,z)}else return new Ir(X===Kg,X===Zg,X===qg,z)}}var iw=new Ir(!1,!1,!1,function(){});function CP(T,z,X,ht,wt,lt,pt,Ct,Ot,Rt,Nt,zt,Ht,It,Gt){var rt=Rt.Record,gt={add:32774,subtract:32778,"reverse subtract":32779};X.ext_blend_minmax&&(gt.min=MP,gt.max=SP);var Lt=X.angle_instanced_arrays,Kt=X.webgl_draw_buffers,St={dirty:!0,profile:Gt.profile},$t={},At=[],Ut={},kt={};function Yt(U){return U.replace(".","_")}function ge(U,F,q){var nt=Yt(U);At.push(U),$t[nt]=St[nt]=!!q,Ut[nt]=F}function Ae(U,F,q){var nt=Yt(U);At.push(U),Array.isArray(q)?(St[nt]=q.slice(),$t[nt]=q.slice()):St[nt]=$t[nt]=q,kt[nt]=F}ge(Tx,vP),ge(Ox,gP),Ae(Nx,"blendColor",[0,0,0,0]),Ae(Qg,"blendEquationSeparate",[$x,$x]),Ae(Jg,"blendFuncSeparate",[Jx,Qx,Jx,Qx]),ge(Dx,yP,!0),Ae(Px,"depthFunc",kP),Ae(Lx,"depthRange",[0,1]),Ae(jx,"depthMask",!0),Ae($g,$g,[!0,!0,!0,!0]),ge(Rx,pP),Ae(Fx,"cullFace",ts),Ae(t0,t0,h0),Ae(e0,e0,1),ge(Bx,xP),Ae(n0,"polygonOffset",[0,0]),ge(zx,wP),ge(Gx,EP),Ae(r0,"sampleCoverage",[1,!1]),ge(Ux,mP),Ae(Yx,"stencilMask",-1),Ae(i0,"stencilFunc",[_P,0,-1]),Ae(o0,"stencilOpSeparate",[xc,oa,oa,oa]),Ae(lc,"stencilOpSeparate",[ts,oa,oa,oa]),ge(Vx,bP),Ae(Oh,"scissor",[0,0,T.drawingBufferWidth,T.drawingBufferHeight]),Ae(Oo,Oo,[0,0,T.drawingBufferWidth,T.drawingBufferHeight]);var qt={gl:T,context:Ht,strings:z,next:$t,current:St,draw:zt,elements:lt,buffer:wt,shader:Nt,attributes:Rt.state,vao:Rt,uniforms:Ot,framebuffer:Ct,extensions:X,timer:It,isBufferArgs:Yh},Ft={primTypes:Bs,compareFuncs:tu,blendFuncs:Vi,blendEquations:gt,stencilOps:aa,glTypes:Wa,orientationType:f0};O.optional(function(){qt.isArrayLike=Nn}),Kt&&(Ft.backBuffer=[ts],Ft.drawBuffer=jn(ht.maxDrawbuffers,function(U){return U===0?[0]:jn(U,function(F){return AP+F})}));var Mt=0;function Se(){var U=aP(),F=U.link,q=U.global;U.id=Mt++,U.batchId="0";var nt=F(qt),it=U.shared={props:"a0"};Object.keys(qt).forEach(function(H){it[H]=q.def(nt,".",H)}),O.optional(function(){U.CHECK=F(O),U.commandStr=O.guessCommand(),U.command=F(U.commandStr),U.assert=function(H,G,et){H("if(!(",G,"))",this.CHECK,".commandRaise(",F(et),",",this.command,");")},Ft.invalidBlendCombinations=ew});var Q=U.next={},K=U.current={};Object.keys(kt).forEach(function(H){Array.isArray(St[H])&&(Q[H]=q.def(it.next,".",H),K[H]=q.def(it.current,".",H))});var $=U.constants={};Object.keys(Ft).forEach(function(H){$[H]=q.def(JSON.stringify(Ft[H]))}),U.invoke=function(H,G){switch(G.type){case Hg:var et=["this",it.context,it.props,U.batchId];return H.def(F(G.data),".call(",et.slice(0,Math.max(G.data.length+1,4)),")");case qg:return H.def(it.props,G.data);case Zg:return H.def(it.context,G.data);case Kg:return H.def("this",G.data);case Th:return G.data.append(U,H),G.data.ref;case Cx:return G.data.toString();case Ix:return G.data.map(function(at){return U.invoke(H,at)})}},U.attribCache={};var Y={};return U.scopeAttrib=function(H){var G=z.id(H);if(G in Y)return Y[G];var et=Rt.scope[G];et||(et=Rt.scope[G]=new rt);var at=Y[G]=F(et);return at},U}function Pe(U){var F=U.static,q=U.dynamic,nt;if(hc in F){var it=!!F[hc];nt=Rn(function(K,$){return it}),nt.enable=it}else if(hc in q){var Q=q[hc];nt=Dr(Q,function(K,$){return K.invoke($,Q)})}return nt}function ie(U,F){var q=U.static,nt=U.dynamic;if(Ka in q){var it=q[Ka];return it?(it=Ct.getFramebuffer(it),O.command(it,"invalid framebuffer object"),Rn(function(K,$){var Y=K.link(it),H=K.shared;$.set(H.framebuffer,".next",Y);var G=H.context;return $.set(G,"."+Qs,Y+".width"),$.set(G,"."+Js,Y+".height"),Y})):Rn(function(K,$){var Y=K.shared;$.set(Y.framebuffer,".next","null");var H=Y.context;return $.set(H,"."+Qs,H+"."+Xx),$.set(H,"."+Js,H+"."+Hx),"null"})}else if(Ka in nt){var Q=nt[Ka];return Dr(Q,function(K,$){var Y=K.invoke($,Q),H=K.shared,G=H.framebuffer,et=$.def(G,".getFramebuffer(",Y,")");O.optional(function(){K.assert($,"!"+Y+"||"+et,"invalid framebuffer object")}),$.set(G,".next",et);var at=H.context;return $.set(at,"."+Qs,et+"?"+et+".width:"+at+"."+Xx),$.set(at,"."+Js,et+"?"+et+".height:"+at+"."+Hx),et})}else return null}function Be(U,F,q){var nt=U.static,it=U.dynamic;function Q(Y){if(Y in nt){var H=nt[Y];O.commandType(H,"object","invalid "+Y,q.commandStr);var G=!0,et=H.x|0,at=H.y|0,yt,xt;return"width"in H?(yt=H.width|0,O.command(yt>=0,"invalid "+Y,q.commandStr)):G=!1,"height"in H?(xt=H.height|0,O.command(xt>=0,"invalid "+Y,q.commandStr)):G=!1,new Ir(!G&&F&&F.thisDep,!G&&F&&F.contextDep,!G&&F&&F.propDep,function(ce,je){var oe=ce.shared.context,xe=yt;"width"in H||(xe=je.def(oe,".",Qs,"-",et));var Oe=xt;return"height"in H||(Oe=je.def(oe,".",Js,"-",at)),[et,at,xe,Oe]})}else if(Y in it){var vt=it[Y],Pt=Dr(vt,function(ce,je){var oe=ce.invoke(je,vt);O.optional(function(){ce.assert(je,oe+"&&typeof "+oe+'==="object"',"invalid "+Y)});var xe=ce.shared.context,Oe=je.def(oe,".x|0"),on=je.def(oe,".y|0"),Cn=je.def('"width" in ',oe,"?",oe,".width|0:","(",xe,".",Qs,"-",Oe,")"),Tr=je.def('"height" in ',oe,"?",oe,".height|0:","(",xe,".",Js,"-",on,")");return O.optional(function(){ce.assert(je,Cn+">=0&&"+Tr+">=0","invalid "+Y)}),[Oe,on,Cn,Tr]});return F&&(Pt.thisDep=Pt.thisDep||F.thisDep,Pt.contextDep=Pt.contextDep||F.contextDep,Pt.propDep=Pt.propDep||F.propDep),Pt}else return F?new Ir(F.thisDep,F.contextDep,F.propDep,function(ce,je){var oe=ce.shared.context;return[0,0,je.def(oe,".",Qs),je.def(oe,".",Js)]}):null}var K=Q(Oo);if(K){var $=K;K=new Ir(K.thisDep,K.contextDep,K.propDep,function(Y,H){var G=$.append(Y,H),et=Y.shared.context;return H.set(et,"."+sP,G[2]),H.set(et,"."+uP,G[3]),G})}return{viewport:K,scissor_box:Q(Oh)}}function Ie(U,F){var q=U.static,nt=typeof q[dc]=="string"&&typeof q[fc]=="string";if(nt){if(Object.keys(F.dynamic).length>0)return null;var it=F.static,Q=Object.keys(it);if(Q.length>0&&typeof it[Q[0]]=="number"){for(var K=[],$=0;$<Q.length;++$)O(typeof it[Q[$]]=="number","must specify all vertex attribute locations when using vaos"),K.push([it[Q[$]]|0,Q[$]]);return K}}return null}function Fe(U,F,q){var nt=U.static,it=U.dynamic;function Q(G){if(G in nt){var et=z.id(nt[G]);O.optional(function(){Nt.shader(nw[G],et,O.guessCommand())});var at=Rn(function(){return et});return at.id=et,at}else if(G in it){var yt=it[G];return Dr(yt,function(xt,vt){var Pt=xt.invoke(vt,yt),ce=vt.def(xt.shared.strings,".id(",Pt,")");return O.optional(function(){vt(xt.shared.shader,".shader(",nw[G],",",ce,",",xt.command,");")}),ce})}return null}var K=Q(dc),$=Q(fc),Y=null,H;return sa(K)&&sa($)?(Y=Nt.program($.id,K.id,null,q),H=Rn(function(G,et){return G.link(Y)})):H=new Ir(K&&K.thisDep||$&&$.thisDep,K&&K.contextDep||$&&$.contextDep,K&&K.propDep||$&&$.propDep,function(G,et){var at=G.shared.shader,yt;K?yt=K.append(G,et):yt=et.def(at,".",dc);var xt;$?xt=$.append(G,et):xt=et.def(at,".",fc);var vt=at+".program("+xt+","+yt;return O.optional(function(){vt+=","+G.command}),et.def(vt+")")}),{frag:K,vert:$,progVar:H,program:Y}}function rn(U,F){var q=U.static,nt=U.dynamic;function it(){if(Qa in q){var G=q[Qa];Yh(G)?G=lt.getElements(lt.create(G,!0)):G&&(G=lt.getElements(G),O.command(G,"invalid elements",F.commandStr));var et=Rn(function(yt,xt){if(G){var vt=yt.link(G);return yt.ELEMENTS=vt,vt}return yt.ELEMENTS=null,null});return et.value=G,et}else if(Qa in nt){var at=nt[Qa];return Dr(at,function(yt,xt){var vt=yt.shared,Pt=vt.isBufferArgs,ce=vt.elements,je=yt.invoke(xt,at),oe=xt.def("null"),xe=xt.def(Pt,"(",je,")"),Oe=yt.cond(xe).then(oe,"=",ce,".createStream(",je,");").else(oe,"=",ce,".getElements(",je,");");return O.optional(function(){yt.assert(Oe.else,"!"+je+"||"+oe,"invalid elements")}),xt.entry(Oe),xt.exit(yt.cond(xe).then(ce,".destroyStream(",oe,");")),yt.ELEMENTS=oe,oe})}return null}var Q=it();function K(){if(Ja in q){var G=q[Ja];return O.commandParameter(G,Bs,"invalid primitve",F.commandStr),Rn(function(at,yt){return Bs[G]})}else if(Ja in nt){var et=nt[Ja];return Dr(et,function(at,yt){var xt=at.constants.primTypes,vt=at.invoke(yt,et);return O.optional(function(){at.assert(yt,vt+" in "+xt,"invalid primitive, must be one of "+Object.keys(Bs))}),yt.def(xt,"[",vt,"]")})}else if(Q)return sa(Q)?Q.value?Rn(function(at,yt){return yt.def(at.ELEMENTS,".primType")}):Rn(function(){return Zx}):new Ir(Q.thisDep,Q.contextDep,Q.propDep,function(at,yt){var xt=at.ELEMENTS;return yt.def(xt,"?",xt,".primType:",Zx)});return null}function $(G,et){if(G in q){var at=q[G]|0;return O.command(!et||at>=0,"invalid "+G,F.commandStr),Rn(function(xt,vt){return et&&(xt.OFFSET=at),at})}else if(G in nt){var yt=nt[G];return Dr(yt,function(xt,vt){var Pt=xt.invoke(vt,yt);return et&&(xt.OFFSET=Pt,O.optional(function(){xt.assert(vt,Pt+">=0","invalid "+G)})),Pt})}else if(et&&Q)return Rn(function(xt,vt){return xt.OFFSET="0",0});return null}var Y=$(Nh,!0);function H(){if($a in q){var G=q[$a]|0;return O.command(typeof G=="number"&&G>=0,"invalid vertex count",F.commandStr),Rn(function(){return G})}else if($a in nt){var et=nt[$a];return Dr(et,function(xt,vt){var Pt=xt.invoke(vt,et);return O.optional(function(){xt.assert(vt,"typeof "+Pt+'==="number"&&'+Pt+">=0&&"+Pt+"===("+Pt+"|0)","invalid vertex count")}),Pt})}else if(Q)if(sa(Q)){if(Q)return Y?new Ir(Y.thisDep,Y.contextDep,Y.propDep,function(xt,vt){var Pt=vt.def(xt.ELEMENTS,".vertCount-",xt.OFFSET);return O.optional(function(){xt.assert(vt,Pt+">=0","invalid vertex offset/element buffer too small")}),Pt}):Rn(function(xt,vt){return vt.def(xt.ELEMENTS,".vertCount")});var at=Rn(function(){return-1});return O.optional(function(){at.MISSING=!0}),at}else{var yt=new Ir(Q.thisDep||Y.thisDep,Q.contextDep||Y.contextDep,Q.propDep||Y.propDep,function(xt,vt){var Pt=xt.ELEMENTS;return xt.OFFSET?vt.def(Pt,"?",Pt,".vertCount-",xt.OFFSET,":-1"):vt.def(Pt,"?",Pt,".vertCount:-1")});return O.optional(function(){yt.DYNAMIC=!0}),yt}return null}return{elements:Q,primitive:K(),count:H(),instances:$(Dh,!1),offset:Y}}function Fn(U,F){var q=U.static,nt=U.dynamic,it={};return At.forEach(function(Q){var K=Yt(Q);function $(Y,H){if(Q in q){var G=Y(q[Q]);it[K]=Rn(function(){return G})}else if(Q in nt){var et=nt[Q];it[K]=Dr(et,function(at,yt){return H(at,yt,at.invoke(yt,et))})}}switch(Q){case Rx:case Ox:case Tx:case Ux:case Dx:case Vx:case Bx:case zx:case Gx:case jx:return $(function(Y){return O.commandType(Y,"boolean",Q,F.commandStr),Y},function(Y,H,G){return O.optional(function(){Y.assert(H,"typeof "+G+'==="boolean"',"invalid flag "+Q,Y.commandStr)}),G});case Px:return $(function(Y){return O.commandParameter(Y,tu,"invalid "+Q,F.commandStr),tu[Y]},function(Y,H,G){var et=Y.constants.compareFuncs;return O.optional(function(){Y.assert(H,G+" in "+et,"invalid "+Q+", must be one of "+Object.keys(tu))}),H.def(et,"[",G,"]")});case Lx:return $(function(Y){return O.command(Nn(Y)&&Y.length===2&&typeof Y[0]=="number"&&typeof Y[1]=="number"&&Y[0]<=Y[1],"depth range is 2d array",F.commandStr),Y},function(Y,H,G){O.optional(function(){Y.assert(H,Y.shared.isArrayLike+"("+G+")&&"+G+".length===2&&typeof "+G+'[0]==="number"&&typeof '+G+'[1]==="number"&&'+G+"[0]<="+G+"[1]","depth range must be a 2d array")});var et=H.def("+",G,"[0]"),at=H.def("+",G,"[1]");return[et,at]});case Jg:return $(function(Y){O.commandType(Y,"object","blend.func",F.commandStr);var H="srcRGB"in Y?Y.srcRGB:Y.src,G="srcAlpha"in Y?Y.srcAlpha:Y.src,et="dstRGB"in Y?Y.dstRGB:Y.dst,at="dstAlpha"in Y?Y.dstAlpha:Y.dst;return O.commandParameter(H,Vi,K+".srcRGB",F.commandStr),O.commandParameter(G,Vi,K+".srcAlpha",F.commandStr),O.commandParameter(et,Vi,K+".dstRGB",F.commandStr),O.commandParameter(at,Vi,K+".dstAlpha",F.commandStr),O.command(ew.indexOf(H+", "+et)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+H+", "+et+")",F.commandStr),[Vi[H],Vi[et],Vi[G],Vi[at]]},function(Y,H,G){var et=Y.constants.blendFuncs;O.optional(function(){Y.assert(H,G+"&&typeof "+G+'==="object"',"invalid blend func, must be an object")});function at(oe,xe){var Oe=H.def('"',oe,xe,'" in ',G,"?",G,".",oe,xe,":",G,".",oe);return O.optional(function(){Y.assert(H,Oe+" in "+et,"invalid "+Q+"."+oe+xe+", must be one of "+Object.keys(Vi))}),Oe}var yt=at("src","RGB"),xt=at("dst","RGB");O.optional(function(){var oe=Y.constants.invalidBlendCombinations;Y.assert(H,oe+".indexOf("+yt+'+", "+'+xt+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var vt=H.def(et,"[",yt,"]"),Pt=H.def(et,"[",at("src","Alpha"),"]"),ce=H.def(et,"[",xt,"]"),je=H.def(et,"[",at("dst","Alpha"),"]");return[vt,ce,Pt,je]});case Qg:return $(function(Y){if(typeof Y=="string")return O.commandParameter(Y,gt,"invalid "+Q,F.commandStr),[gt[Y],gt[Y]];if(typeof Y=="object")return O.commandParameter(Y.rgb,gt,Q+".rgb",F.commandStr),O.commandParameter(Y.alpha,gt,Q+".alpha",F.commandStr),[gt[Y.rgb],gt[Y.alpha]];O.commandRaise("invalid blend.equation",F.commandStr)},function(Y,H,G){var et=Y.constants.blendEquations,at=H.def(),yt=H.def(),xt=Y.cond("typeof ",G,'==="string"');return O.optional(function(){function vt(Pt,ce,je){Y.assert(Pt,je+" in "+et,"invalid "+ce+", must be one of "+Object.keys(gt))}vt(xt.then,Q,G),Y.assert(xt.else,G+"&&typeof "+G+'==="object"',"invalid "+Q),vt(xt.else,Q+".rgb",G+".rgb"),vt(xt.else,Q+".alpha",G+".alpha")}),xt.then(at,"=",yt,"=",et,"[",G,"];"),xt.else(at,"=",et,"[",G,".rgb];",yt,"=",et,"[",G,".alpha];"),H(xt),[at,yt]});case Nx:return $(function(Y){return O.command(Nn(Y)&&Y.length===4,"blend.color must be a 4d array",F.commandStr),jn(4,function(H){return+Y[H]})},function(Y,H,G){return O.optional(function(){Y.assert(H,Y.shared.isArrayLike+"("+G+")&&"+G+".length===4","blend.color must be a 4d array")}),jn(4,function(et){return H.def("+",G,"[",et,"]")})});case Yx:return $(function(Y){return O.commandType(Y,"number",K,F.commandStr),Y|0},function(Y,H,G){return O.optional(function(){Y.assert(H,"typeof "+G+'==="number"',"invalid stencil.mask")}),H.def(G,"|0")});case i0:return $(function(Y){O.commandType(Y,"object",K,F.commandStr);var H=Y.cmp||"keep",G=Y.ref||0,et="mask"in Y?Y.mask:-1;return O.commandParameter(H,tu,Q+".cmp",F.commandStr),O.commandType(G,"number",Q+".ref",F.commandStr),O.commandType(et,"number",Q+".mask",F.commandStr),[tu[H],G,et]},function(Y,H,G){var et=Y.constants.compareFuncs;O.optional(function(){function vt(){Y.assert(H,Array.prototype.join.call(arguments,""),"invalid stencil.func")}vt(G+"&&typeof ",G,'==="object"'),vt('!("cmp" in ',G,")||(",G,".cmp in ",et,")")});var at=H.def('"cmp" in ',G,"?",et,"[",G,".cmp]",":",oa),yt=H.def(G,".ref|0"),xt=H.def('"mask" in ',G,"?",G,".mask|0:-1");return[at,yt,xt]});case o0:case lc:return $(function(Y){O.commandType(Y,"object",K,F.commandStr);var H=Y.fail||"keep",G=Y.zfail||"keep",et=Y.zpass||"keep";return O.commandParameter(H,aa,Q+".fail",F.commandStr),O.commandParameter(G,aa,Q+".zfail",F.commandStr),O.commandParameter(et,aa,Q+".zpass",F.commandStr),[Q===lc?ts:xc,aa[H],aa[G],aa[et]]},function(Y,H,G){var et=Y.constants.stencilOps;O.optional(function(){Y.assert(H,G+"&&typeof "+G+'==="object"',"invalid "+Q)});function at(yt){return O.optional(function(){Y.assert(H,'!("'+yt+'" in '+G+")||("+G+"."+yt+" in "+et+")","invalid "+Q+"."+yt+", must be one of "+Object.keys(aa))}),H.def('"',yt,'" in ',G,"?",et,"[",G,".",yt,"]:",oa)}return[Q===lc?ts:xc,at("fail"),at("zfail"),at("zpass")]});case n0:return $(function(Y){O.commandType(Y,"object",K,F.commandStr);var H=Y.factor|0,G=Y.units|0;return O.commandType(H,"number",K+".factor",F.commandStr),O.commandType(G,"number",K+".units",F.commandStr),[H,G]},function(Y,H,G){O.optional(function(){Y.assert(H,G+"&&typeof "+G+'==="object"',"invalid "+Q)});var et=H.def(G,".factor|0"),at=H.def(G,".units|0");return[et,at]});case Fx:return $(function(Y){var H=0;return Y==="front"?H=xc:Y==="back"&&(H=ts),O.command(!!H,K,F.commandStr),H},function(Y,H,G){return O.optional(function(){Y.assert(H,G+'==="front"||'+G+'==="back"',"invalid cull.face")}),H.def(G,'==="front"?',xc,":",ts)});case e0:return $(function(Y){return O.command(typeof Y=="number"&&Y>=ht.lineWidthDims[0]&&Y<=ht.lineWidthDims[1],"invalid line width, must be a positive number between "+ht.lineWidthDims[0]+" and "+ht.lineWidthDims[1],F.commandStr),Y},function(Y,H,G){return O.optional(function(){Y.assert(H,"typeof "+G+'==="number"&&'+G+">="+ht.lineWidthDims[0]+"&&"+G+"<="+ht.lineWidthDims[1],"invalid line width")}),G});case t0:return $(function(Y){return O.commandParameter(Y,f0,K,F.commandStr),f0[Y]},function(Y,H,G){return O.optional(function(){Y.assert(H,G+'==="cw"||'+G+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),H.def(G+'==="cw"?'+Kx+":"+h0)});case $g:return $(function(Y){return O.command(Nn(Y)&&Y.length===4,"color.mask must be length 4 array",F.commandStr),Y.map(function(H){return!!H})},function(Y,H,G){return O.optional(function(){Y.assert(H,Y.shared.isArrayLike+"("+G+")&&"+G+".length===4","invalid color.mask")}),jn(4,function(et){return"!!"+G+"["+et+"]"})});case r0:return $(function(Y){O.command(typeof Y=="object"&&Y,K,F.commandStr);var H="value"in Y?Y.value:1,G=!!Y.invert;return O.command(typeof H=="number"&&H>=0&&H<=1,"sample.coverage.value must be a number between 0 and 1",F.commandStr),[H,G]},function(Y,H,G){O.optional(function(){Y.assert(H,G+"&&typeof "+G+'==="object"',"invalid sample.coverage")});var et=H.def('"value" in ',G,"?+",G,".value:1"),at=H.def("!!",G,".invert");return[et,at]})}}),it}function Jn(U,F){var q=U.static,nt=U.dynamic,it={};return Object.keys(q).forEach(function(Q){var K=q[Q],$;if(typeof K=="number"||typeof K=="boolean")$=Rn(function(){return K});else if(typeof K=="function"){var Y=K._reglType;Y==="texture2d"||Y==="textureCube"?$=Rn(function(H){return H.link(K)}):Y==="framebuffer"||Y==="framebufferCube"?(O.command(K.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Q+'"',F.commandStr),$=Rn(function(H){return H.link(K.color[0])})):O.commandRaise('invalid data for uniform "'+Q+'"',F.commandStr)}else Nn(K)?$=Rn(function(H){var G=H.global.def("[",jn(K.length,function(et){return O.command(typeof K[et]=="number"||typeof K[et]=="boolean","invalid uniform "+Q,H.commandStr),K[et]}),"]");return G}):O.commandRaise('invalid or missing data for uniform "'+Q+'"',F.commandStr);$.value=K,it[Q]=$}),Object.keys(nt).forEach(function(Q){var K=nt[Q];it[Q]=Dr(K,function($,Y){return $.invoke(Y,K)})}),it}function Ye(U,F){var q=U.static,nt=U.dynamic,it={};return Object.keys(q).forEach(function(Q){var K=q[Q],$=z.id(Q),Y=new rt;if(Yh(K))Y.state=Ks,Y.buffer=wt.getBuffer(wt.create(K,$s,!1,!0)),Y.type=0;else{var H=wt.getBuffer(K);if(H)Y.state=Ks,Y.buffer=H,Y.type=0;else if(O.command(typeof K=="object"&&K,"invalid data for attribute "+Q,F.commandStr),"constant"in K){var G=K.constant;Y.buffer="null",Y.state=Xg,typeof G=="number"?Y.x=G:(O.command(Nn(G)&&G.length>0&&G.length<=4,"invalid constant for attribute "+Q,F.commandStr),Zs.forEach(function(ce,je){je<G.length&&(Y[ce]=G[je])}))}else{Yh(K.buffer)?H=wt.getBuffer(wt.create(K.buffer,$s,!1,!0)):H=wt.getBuffer(K.buffer),O.command(!!H,'missing buffer for attribute "'+Q+'"',F.commandStr);var et=K.offset|0;O.command(et>=0,'invalid offset for attribute "'+Q+'"',F.commandStr);var at=K.stride|0;O.command(at>=0&&at<256,'invalid stride for attribute "'+Q+'", must be integer betweeen [0, 255]',F.commandStr);var yt=K.size|0;O.command(!("size"in K)||yt>0&&yt<=4,'invalid size for attribute "'+Q+'", must be 1,2,3,4',F.commandStr);var xt=!!K.normalized,vt=0;"type"in K&&(O.commandParameter(K.type,Wa,"invalid type for attribute "+Q,F.commandStr),vt=Wa[K.type]);var Pt=K.divisor|0;"divisor"in K&&(O.command(Pt===0||Lt,'cannot specify divisor for attribute "'+Q+'", instancing not supported',F.commandStr),O.command(Pt>=0,'invalid divisor for attribute "'+Q+'"',F.commandStr)),O.optional(function(){var ce=F.commandStr,je=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(K).forEach(function(oe){O.command(je.indexOf(oe)>=0,'unknown parameter "'+oe+'" for attribute pointer "'+Q+'" (valid parameters are '+je+")",ce)})}),Y.buffer=H,Y.state=Ks,Y.size=yt,Y.normalized=xt,Y.type=vt||H.dtype,Y.offset=et,Y.stride=at,Y.divisor=Pt}}it[Q]=Rn(function(ce,je){var oe=ce.attribCache;if($ in oe)return oe[$];var xe={isStream:!1};return Object.keys(Y).forEach(function(Oe){xe[Oe]=Y[Oe]}),Y.buffer&&(xe.buffer=ce.link(Y.buffer),xe.type=xe.type||xe.buffer+".dtype"),oe[$]=xe,xe})}),Object.keys(nt).forEach(function(Q){var K=nt[Q];function $(Y,H){var G=Y.invoke(H,K),et=Y.shared,at=Y.constants,yt=et.isBufferArgs,xt=et.buffer;O.optional(function(){Y.assert(H,G+"&&(typeof "+G+'==="object"||typeof '+G+'==="function")&&('+yt+"("+G+")||"+xt+".getBuffer("+G+")||"+xt+".getBuffer("+G+".buffer)||"+yt+"("+G+'.buffer)||("constant" in '+G+"&&(typeof "+G+'.constant==="number"||'+et.isArrayLike+"("+G+".constant))))",'invalid dynamic attribute "'+Q+'"')});var vt={isStream:H.def(!1)},Pt=new rt;Pt.state=Ks,Object.keys(Pt).forEach(function(xe){vt[xe]=H.def(""+Pt[xe])});var ce=vt.buffer,je=vt.type;H("if(",yt,"(",G,")){",vt.isStream,"=true;",ce,"=",xt,".createStream(",$s,",",G,");",je,"=",ce,".dtype;","}else{",ce,"=",xt,".getBuffer(",G,");","if(",ce,"){",je,"=",ce,".dtype;",'}else if("constant" in ',G,"){",vt.state,"=",Xg,";","if(typeof "+G+'.constant === "number"){',vt[Zs[0]],"=",G,".constant;",Zs.slice(1).map(function(xe){return vt[xe]}).join("="),"=0;","}else{",Zs.map(function(xe,Oe){return vt[xe]+"="+G+".constant.length>"+Oe+"?"+G+".constant["+Oe+"]:0;"}).join(""),"}}else{","if(",yt,"(",G,".buffer)){",ce,"=",xt,".createStream(",$s,",",G,".buffer);","}else{",ce,"=",xt,".getBuffer(",G,".buffer);","}",je,'="type" in ',G,"?",at.glTypes,"[",G,".type]:",ce,".dtype;",vt.normalized,"=!!",G,".normalized;");function oe(xe){H(vt[xe],"=",G,".",xe,"|0;")}return oe("size"),oe("offset"),oe("stride"),oe("divisor"),H("}}"),H.exit("if(",vt.isStream,"){",xt,".destroyStream(",ce,");","}"),vt}it[Q]=Dr(K,$)}),it}function Xn(U,F){var q=U.static,nt=U.dynamic;if(pc in q){var it=q[pc];return it!==null&&Rt.getVAO(it)===null&&(it=Rt.createVAO(it)),Rn(function(K){return K.link(Rt.getVAO(it))})}else if(pc in nt){var Q=nt[pc];return Dr(Q,function(K,$){var Y=K.invoke($,Q);return $.def(K.shared.vao+".getVAO("+Y+")")})}return null}function vn(U){var F=U.static,q=U.dynamic,nt={};return Object.keys(F).forEach(function(it){var Q=F[it];nt[it]=Rn(function(K,$){return typeof Q=="number"||typeof Q=="boolean"?""+Q:K.link(Q)})}),Object.keys(q).forEach(function(it){var Q=q[it];nt[it]=Dr(Q,function(K,$){return K.invoke($,Q)})}),nt}function Bn(U,F,q,nt,it){var Q=U.static,K=U.dynamic;O.optional(function(){var oe=[Ka,fc,dc,Qa,Ja,Nh,$a,Dh,hc,pc].concat(At);function xe(Oe){Object.keys(Oe).forEach(function(on){O.command(oe.indexOf(on)>=0,'unknown parameter "'+on+'"',it.commandStr)})}xe(Q),xe(K)});var $=Ie(U,F),Y=ie(U),H=Be(U,Y,it),G=rn(U,it),et=Fn(U,it),at=Fe(U,it,$);function yt(oe){var xe=H[oe];xe&&(et[oe]=xe)}yt(Oo),yt(Yt(Oh));var xt=Object.keys(et).length>0,vt={framebuffer:Y,draw:G,shader:at,state:et,dirty:xt,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(vt.profile=Pe(U),vt.uniforms=Jn(q,it),vt.drawVAO=vt.scopeVAO=Xn(U),!vt.drawVAO&&at.program&&!$&&X.angle_instanced_arrays){var Pt=!0,ce=at.program.attributes.map(function(oe){var xe=F.static[oe];return Pt=Pt&&!!xe,xe});if(Pt&&ce.length>0){var je=Rt.getVAO(Rt.createVAO(ce));vt.drawVAO=new Ir(null,null,null,function(oe,xe){return oe.link(je)}),vt.useVAO=!0}}return $?vt.useVAO=!0:vt.attributes=Ye(F,it),vt.context=vn(nt),vt}function Hn(U,F,q){var nt=U.shared,it=nt.context,Q=U.scope();Object.keys(q).forEach(function(K){F.save(it,"."+K);var $=q[K],Y=$.append(U,F);Array.isArray(Y)?Q(it,".",K,"=[",Y.join(),"];"):Q(it,".",K,"=",Y,";")}),F(Q)}function qn(U,F,q,nt){var it=U.shared,Q=it.gl,K=it.framebuffer,$;Kt&&($=F.def(it.extensions,".webgl_draw_buffers"));var Y=U.constants,H=Y.drawBuffer,G=Y.backBuffer,et;q?et=q.append(U,F):et=F.def(K,".next"),nt||F("if(",et,"!==",K,".cur){"),F("if(",et,"){",Q,".bindFramebuffer(",tw,",",et,".framebuffer);"),Kt&&F($,".drawBuffersWEBGL(",H,"[",et,".colorAttachments.length]);"),F("}else{",Q,".bindFramebuffer(",tw,",null);"),Kt&&F($,".drawBuffersWEBGL(",G,");"),F("}",K,".cur=",et,";"),nt||F("}")}function er(U,F,q){var nt=U.shared,it=nt.gl,Q=U.current,K=U.next,$=nt.current,Y=nt.next,H=U.cond($,".dirty");At.forEach(function(G){var et=Yt(G);if(!(et in q.state)){var at,yt;if(et in K){at=K[et],yt=Q[et];var xt=jn(St[et].length,function(Pt){return H.def(at,"[",Pt,"]")});H(U.cond(xt.map(function(Pt,ce){return Pt+"!=="+yt+"["+ce+"]"}).join("||")).then(it,".",kt[et],"(",xt,");",xt.map(function(Pt,ce){return yt+"["+ce+"]="+Pt}).join(";"),";"))}else{at=H.def(Y,".",et);var vt=U.cond(at,"!==",$,".",et);H(vt),et in Ut?vt(U.cond(at).then(it,".enable(",Ut[et],");").else(it,".disable(",Ut[et],");"),$,".",et,"=",at,";"):vt(it,".",kt[et],"(",at,");",$,".",et,"=",at,";")}}}),Object.keys(q.state).length===0&&H($,".dirty=false;"),F(H)}function lr(U,F,q,nt){var it=U.shared,Q=U.current,K=it.current,$=it.gl;rw(Object.keys(q)).forEach(function(Y){var H=q[Y];if(!(nt&&!nt(H))){var G=H.append(U,F);if(Ut[Y]){var et=Ut[Y];sa(H)?G?F($,".enable(",et,");"):F($,".disable(",et,");"):F(U.cond(G).then($,".enable(",et,");").else($,".disable(",et,");")),F(K,".",Y,"=",G,";")}else if(Nn(G)){var at=Q[Y];F($,".",kt[Y],"(",G,");",G.map(function(yt,xt){return at+"["+xt+"]="+yt}).join(";"),";")}else F($,".",kt[Y],"(",G,");",K,".",Y,"=",G,";")}})}function Dn(U,F){Lt&&(U.instancing=F.def(U.shared.extensions,".angle_instanced_arrays"))}function Le(U,F,q,nt,it){var Q=U.shared,K=U.stats,$=Q.current,Y=Q.timer,H=q.profile;function G(){return typeof performance>"u"?"Date.now()":"performance.now()"}var et,at;function yt(oe){et=F.def(),oe(et,"=",G(),";"),typeof it=="string"?oe(K,".count+=",it,";"):oe(K,".count++;"),It&&(nt?(at=F.def(),oe(at,"=",Y,".getNumPendingQueries();")):oe(Y,".beginQuery(",K,");"))}function xt(oe){oe(K,".cpuTime+=",G(),"-",et,";"),It&&(nt?oe(Y,".pushScopeStats(",at,",",Y,".getNumPendingQueries(),",K,");"):oe(Y,".endQuery();"))}function vt(oe){var xe=F.def($,".profile");F($,".profile=",oe,";"),F.exit($,".profile=",xe,";")}var Pt;if(H){if(sa(H)){H.enable?(yt(F),xt(F.exit),vt("true")):vt("false");return}Pt=H.append(U,F),vt(Pt)}else Pt=F.def($,".profile");var ce=U.block();yt(ce),F("if(",Pt,"){",ce,"}");var je=U.block();xt(je),F.exit("if(",Pt,"){",je,"}")}function hr(U,F,q,nt,it){var Q=U.shared;function K(Y){switch(Y){case Ph:case Rh:case zh:return 2;case Lh:case Fh:case Gh:return 3;case jh:case Bh:case Uh:return 4;default:return 1}}function $(Y,H,G){var et=Q.gl,at=F.def(Y,".location"),yt=F.def(Q.attributes,"[",at,"]"),xt=G.state,vt=G.buffer,Pt=[G.x,G.y,G.z,G.w],ce=["buffer","normalized","offset","stride"];function je(){F("if(!",yt,".buffer){",et,".enableVertexAttribArray(",at,");}");var xe=G.type,Oe;if(G.size?Oe=F.def(G.size,"||",H):Oe=H,F("if(",yt,".type!==",xe,"||",yt,".size!==",Oe,"||",ce.map(function(Cn){return yt+"."+Cn+"!=="+G[Cn]}).join("||"),"){",et,".bindBuffer(",$s,",",vt,".buffer);",et,".vertexAttribPointer(",[at,Oe,xe,G.normalized,G.stride,G.offset],");",yt,".type=",xe,";",yt,".size=",Oe,";",ce.map(function(Cn){return yt+"."+Cn+"="+G[Cn]+";"}).join(""),"}"),Lt){var on=G.divisor;F("if(",yt,".divisor!==",on,"){",U.instancing,".vertexAttribDivisorANGLE(",[at,on],");",yt,".divisor=",on,";}")}}function oe(){F("if(",yt,".buffer){",et,".disableVertexAttribArray(",at,");",yt,".buffer=null;","}if(",Zs.map(function(xe,Oe){return yt+"."+xe+"!=="+Pt[Oe]}).join("||"),"){",et,".vertexAttrib4f(",at,",",Pt,");",Zs.map(function(xe,Oe){return yt+"."+xe+"="+Pt[Oe]+";"}).join(""),"}")}xt===Ks?je():xt===Xg?oe():(F("if(",xt,"===",Ks,"){"),je(),F("}else{"),oe(),F("}"))}nt.forEach(function(Y){var H=Y.name,G=q.attributes[H],et;if(G){if(!it(G))return;et=G.append(U,F)}else{if(!it(iw))return;var at=U.scopeAttrib(H);O.optional(function(){U.assert(F,at+".state","missing attribute "+H)}),et={},Object.keys(new rt).forEach(function(yt){et[yt]=F.def(at,".",yt)})}$(U.link(Y),K(Y.info.type),et)})}function ln(U,F,q,nt,it){for(var Q=U.shared,K=Q.gl,$,Y=0;Y<nt.length;++Y){var H=nt[Y],G=H.name,et=H.info.type,at=q.uniforms[G],yt=U.link(H),xt=yt+".location",vt;if(at){if(!it(at))continue;if(sa(at)){var Pt=at.value;if(O.command(Pt!==null&&typeof Pt<"u",'missing uniform "'+G+'"',U.commandStr),et===yc||et===bc){O.command(typeof Pt=="function"&&(et===yc&&(Pt._reglType==="texture2d"||Pt._reglType==="framebuffer")||et===bc&&(Pt._reglType==="textureCube"||Pt._reglType==="framebufferCube")),"invalid texture for uniform "+G,U.commandStr);var ce=U.link(Pt._texture||Pt.color[0]._texture);F(K,".uniform1i(",xt,",",ce+".bind());"),F.exit(ce,".unbind();")}else if(et===gc||et===vc||et===mc){O.optional(function(){O.command(Nn(Pt),"invalid matrix for uniform "+G,U.commandStr),O.command(et===gc&&Pt.length===4||et===vc&&Pt.length===9||et===mc&&Pt.length===16,"invalid length for matrix uniform "+G,U.commandStr)});var je=U.global.def("new Float32Array(["+Array.prototype.slice.call(Pt)+"])"),oe=2;et===vc?oe=3:et===mc&&(oe=4),F(K,".uniformMatrix",oe,"fv(",xt,",false,",je,");")}else{switch(et){case u0:O.commandType(Pt,"number","uniform "+G,U.commandStr),$="1f";break;case Ph:O.command(Nn(Pt)&&Pt.length===2,"uniform "+G,U.commandStr),$="2f";break;case Lh:O.command(Nn(Pt)&&Pt.length===3,"uniform "+G,U.commandStr),$="3f";break;case jh:O.command(Nn(Pt)&&Pt.length===4,"uniform "+G,U.commandStr),$="4f";break;case l0:O.commandType(Pt,"boolean","uniform "+G,U.commandStr),$="1i";break;case c0:O.commandType(Pt,"number","uniform "+G,U.commandStr),$="1i";break;case zh:O.command(Nn(Pt)&&Pt.length===2,"uniform "+G,U.commandStr),$="2i";break;case Rh:O.command(Nn(Pt)&&Pt.length===2,"uniform "+G,U.commandStr),$="2i";break;case Gh:O.command(Nn(Pt)&&Pt.length===3,"uniform "+G,U.commandStr),$="3i";break;case Fh:O.command(Nn(Pt)&&Pt.length===3,"uniform "+G,U.commandStr),$="3i";break;case Uh:O.command(Nn(Pt)&&Pt.length===4,"uniform "+G,U.commandStr),$="4i";break;case Bh:O.command(Nn(Pt)&&Pt.length===4,"uniform "+G,U.commandStr),$="4i";break}F(K,".uniform",$,"(",xt,",",Nn(Pt)?Array.prototype.slice.call(Pt):Pt,");")}continue}else vt=at.append(U,F)}else{if(!it(iw))continue;vt=F.def(Q.uniforms,"[",z.id(G),"]")}et===yc?(O(!Array.isArray(vt),"must specify a scalar prop for textures"),F("if(",vt,"&&",vt,'._reglType==="framebuffer"){',vt,"=",vt,".color[0];","}")):et===bc&&(O(!Array.isArray(vt),"must specify a scalar prop for cube maps"),F("if(",vt,"&&",vt,'._reglType==="framebufferCube"){',vt,"=",vt,".color[0];","}")),O.optional(function(){function Tr(Si,hw){U.assert(F,Si,'bad data or missing for uniform "'+G+'".  '+hw)}function d0(Si){O(!Array.isArray(vt),"must not specify an array type for uniform"),Tr("typeof "+vt+'==="'+Si+'"',"invalid type, expected "+Si)}function ii(Si,hw){Array.isArray(vt)?O(vt.length===Si,"must have length "+Si):Tr(Q.isArrayLike+"("+vt+")&&"+vt+".length==="+Si,"invalid vector, should have length "+Si,U.commandStr)}function lw(Si){O(!Array.isArray(vt),"must not specify a value type"),Tr("typeof "+vt+'==="function"&&'+vt+'._reglType==="texture'+(Si===qx?"2d":"Cube")+'"',"invalid texture type",U.commandStr)}switch(et){case c0:d0("number");break;case Rh:ii(2);break;case Fh:ii(3);break;case Bh:ii(4);break;case u0:d0("number");break;case Ph:ii(2);break;case Lh:ii(3);break;case jh:ii(4);break;case l0:d0("boolean");break;case zh:ii(2);break;case Gh:ii(3);break;case Uh:ii(4);break;case gc:ii(4);break;case vc:ii(9);break;case mc:ii(16);break;case yc:lw(qx);break;case bc:lw(dP);break}});var xe=1;switch(et){case yc:case bc:var Oe=F.def(vt,"._texture");F(K,".uniform1i(",xt,",",Oe,".bind());"),F.exit(Oe,".unbind();");continue;case c0:case l0:$="1i";break;case Rh:case zh:$="2i",xe=2;break;case Fh:case Gh:$="3i",xe=3;break;case Bh:case Uh:$="4i",xe=4;break;case u0:$="1f";break;case Ph:$="2f",xe=2;break;case Lh:$="3f",xe=3;break;case jh:$="4f",xe=4;break;case gc:$="Matrix2fv";break;case vc:$="Matrix3fv";break;case mc:$="Matrix4fv";break}if(F(K,".uniform",$,"(",xt,","),$.charAt(0)==="M"){var on=Math.pow(et-gc+2,2),Cn=U.global.def("new Float32Array(",on,")");Array.isArray(vt)?F("false,(",jn(on,function(Tr){return Cn+"["+Tr+"]="+vt[Tr]}),",",Cn,")"):F("false,(Array.isArray(",vt,")||",vt," instanceof Float32Array)?",vt,":(",jn(on,function(Tr){return Cn+"["+Tr+"]="+vt+"["+Tr+"]"}),",",Cn,")")}else xe>1?F(jn(xe,function(Tr){return Array.isArray(vt)?vt[Tr]:vt+"["+Tr+"]"})):(O(!Array.isArray(vt),"uniform value must not be an array"),F(vt));F(");")}}function be(U,F,q,nt){var it=U.shared,Q=it.gl,K=it.draw,$=nt.draw;function Y(){var Oe=$.elements,on,Cn=F;return Oe?((Oe.contextDep&&nt.contextDynamic||Oe.propDep)&&(Cn=q),on=Oe.append(U,Cn)):on=Cn.def(K,".",Qa),on&&Cn("if("+on+")"+Q+".bindBuffer("+lP+","+on+".buffer.buffer);"),on}function H(){var Oe=$.count,on,Cn=F;return Oe?((Oe.contextDep&&nt.contextDynamic||Oe.propDep)&&(Cn=q),on=Oe.append(U,Cn),O.optional(function(){Oe.MISSING&&U.assert(F,"false","missing vertex count"),Oe.DYNAMIC&&U.assert(Cn,on+">=0","missing vertex count")})):(on=Cn.def(K,".",$a),O.optional(function(){U.assert(Cn,on+">=0","missing vertex count")})),on}var G=Y();function et(Oe){var on=$[Oe];return on?on.contextDep&&nt.contextDynamic||on.propDep?on.append(U,q):on.append(U,F):F.def(K,".",Oe)}var at=et(Ja),yt=et(Nh),xt=H();if(typeof xt=="number"){if(xt===0)return}else q("if(",xt,"){"),q.exit("}");var vt,Pt;Lt&&(vt=et(Dh),Pt=U.instancing);var ce=G+".type",je=$.elements&&sa($.elements);function oe(){function Oe(){q(Pt,".drawElementsInstancedANGLE(",[at,xt,ce,yt+"<<(("+ce+"-"+Ax+")>>1)",vt],");")}function on(){q(Pt,".drawArraysInstancedANGLE(",[at,yt,xt,vt],");")}G?je?Oe():(q("if(",G,"){"),Oe(),q("}else{"),on(),q("}")):on()}function xe(){function Oe(){q(Q+".drawElements("+[at,xt,ce,yt+"<<(("+ce+"-"+Ax+")>>1)"]+");")}function on(){q(Q+".drawArrays("+[at,yt,xt]+");")}G?je?Oe():(q("if(",G,"){"),Oe(),q("}else{"),on(),q("}")):on()}Lt&&(typeof vt!="number"||vt>=0)?typeof vt=="string"?(q("if(",vt,">0){"),oe(),q("}else if(",vt,"<0){"),xe(),q("}")):oe():xe()}function Ge(U,F,q,nt,it){var Q=Se(),K=Q.proc("body",it);return O.optional(function(){Q.commandStr=F.commandStr,Q.command=Q.link(F.commandStr)}),Lt&&(Q.instancing=K.def(Q.shared.extensions,".angle_instanced_arrays")),U(Q,K,q,nt),Q.compile().body}function Qe(U,F,q,nt){Dn(U,F),q.useVAO?q.drawVAO?F(U.shared.vao,".setVAO(",q.drawVAO.append(U,F),");"):F(U.shared.vao,".setVAO(",U.shared.vao,".targetVAO);"):(F(U.shared.vao,".setVAO(null);"),hr(U,F,q,nt.attributes,function(){return!0})),ln(U,F,q,nt.uniforms,function(){return!0}),be(U,F,F,q)}function Pn(U,F){var q=U.proc("draw",1);Dn(U,q),Hn(U,q,F.context),qn(U,q,F.framebuffer),er(U,q,F),lr(U,q,F.state),Le(U,q,F,!1,!0);var nt=F.shader.progVar.append(U,q);if(q(U.shared.gl,".useProgram(",nt,".program);"),F.shader.program)Qe(U,q,F,F.shader.program);else{q(U.shared.vao,".setVAO(null);");var it=U.global.def("{}"),Q=q.def(nt,".id"),K=q.def(it,"[",Q,"]");q(U.cond(K).then(K,".call(this,a0);").else(K,"=",it,"[",Q,"]=",U.link(function($){return Ge(Qe,U,F,$,1)}),"(",nt,");",K,".call(this,a0);"))}Object.keys(F.state).length>0&&q(U.shared.current,".dirty=true;")}function Wi(U,F,q,nt){U.batchId="a1",Dn(U,F);function it(){return!0}hr(U,F,q,nt.attributes,it),ln(U,F,q,nt.uniforms,it),be(U,F,F,q)}function es(U,F,q,nt){Dn(U,F);var it=q.contextDep,Q=F.def(),K="a0",$="a1",Y=F.def();U.shared.props=Y,U.batchId=Q;var H=U.scope(),G=U.scope();F(H.entry,"for(",Q,"=0;",Q,"<",$,";++",Q,"){",Y,"=",K,"[",Q,"];",G,"}",H.exit);function et(ce){return ce.contextDep&&it||ce.propDep}function at(ce){return!et(ce)}if(q.needsContext&&Hn(U,G,q.context),q.needsFramebuffer&&qn(U,G,q.framebuffer),lr(U,G,q.state,et),q.profile&&et(q.profile)&&Le(U,G,q,!1,!0),nt)q.useVAO?q.drawVAO?et(q.drawVAO)?G(U.shared.vao,".setVAO(",q.drawVAO.append(U,G),");"):H(U.shared.vao,".setVAO(",q.drawVAO.append(U,H),");"):H(U.shared.vao,".setVAO(",U.shared.vao,".targetVAO);"):(H(U.shared.vao,".setVAO(null);"),hr(U,H,q,nt.attributes,at),hr(U,G,q,nt.attributes,et)),ln(U,H,q,nt.uniforms,at),ln(U,G,q,nt.uniforms,et),be(U,H,G,q);else{var yt=U.global.def("{}"),xt=q.shader.progVar.append(U,G),vt=G.def(xt,".id"),Pt=G.def(yt,"[",vt,"]");G(U.shared.gl,".useProgram(",xt,".program);","if(!",Pt,"){",Pt,"=",yt,"[",vt,"]=",U.link(function(ce){return Ge(Wi,U,q,ce,2)}),"(",xt,");}",Pt,".call(this,a0[",Q,"],",Q,");")}}function W(U,F){var q=U.proc("batch",2);U.batchId="0",Dn(U,q);var nt=!1,it=!0;Object.keys(F.context).forEach(function(yt){nt=nt||F.context[yt].propDep}),nt||(Hn(U,q,F.context),it=!1);var Q=F.framebuffer,K=!1;Q?(Q.propDep?nt=K=!0:Q.contextDep&&nt&&(K=!0),K||qn(U,q,Q)):qn(U,q,null),F.state.viewport&&F.state.viewport.propDep&&(nt=!0);function $(yt){return yt.contextDep&&nt||yt.propDep}er(U,q,F),lr(U,q,F.state,function(yt){return!$(yt)}),(!F.profile||!$(F.profile))&&Le(U,q,F,!1,"a1"),F.contextDep=nt,F.needsContext=it,F.needsFramebuffer=K;var Y=F.shader.progVar;if(Y.contextDep&&nt||Y.propDep)es(U,q,F,null);else{var H=Y.append(U,q);if(q(U.shared.gl,".useProgram(",H,".program);"),F.shader.program)es(U,q,F,F.shader.program);else{q(U.shared.vao,".setVAO(null);");var G=U.global.def("{}"),et=q.def(H,".id"),at=q.def(G,"[",et,"]");q(U.cond(at).then(at,".call(this,a0,a1);").else(at,"=",G,"[",et,"]=",U.link(function(yt){return Ge(es,U,F,yt,2)}),"(",H,");",at,".call(this,a0,a1);"))}}Object.keys(F.state).length>0&&q(U.shared.current,".dirty=true;")}function ft(U,F){var q=U.proc("scope",3);U.batchId="a2";var nt=U.shared,it=nt.current;Hn(U,q,F.context),F.framebuffer&&F.framebuffer.append(U,q),rw(Object.keys(F.state)).forEach(function(K){var $=F.state[K],Y=$.append(U,q);Nn(Y)?Y.forEach(function(H,G){q.set(U.next[K],"["+G+"]",H)}):q.set(nt.next,"."+K,Y)}),Le(U,q,F,!0,!0),[Qa,Nh,$a,Dh,Ja].forEach(function(K){var $=F.draw[K];$&&q.set(nt.draw,"."+K,""+$.append(U,q))}),Object.keys(F.uniforms).forEach(function(K){var $=F.uniforms[K].append(U,q);Array.isArray($)&&($="["+$.join()+"]"),q.set(nt.uniforms,"["+z.id(K)+"]",$)}),Object.keys(F.attributes).forEach(function(K){var $=F.attributes[K].append(U,q),Y=U.scopeAttrib(K);Object.keys(new rt).forEach(function(H){q.set(Y,"."+H,$[H])})}),F.scopeVAO&&q.set(nt.vao,".targetVAO",F.scopeVAO.append(U,q));function Q(K){var $=F.shader[K];$&&q.set(nt.shader,"."+K,$.append(U,q))}Q(fc),Q(dc),Object.keys(F.state).length>0&&(q(it,".dirty=true;"),q.exit(it,".dirty=true;")),q("a1(",U.shared.context,",a0,",U.batchId,");")}function st(U){if(!(typeof U!="object"||Nn(U))){for(var F=Object.keys(U),q=0;q<F.length;++q)if(He.isDynamic(U[F[q]]))return!0;return!1}}function ne(U,F,q){var nt=F.static[q];if(!nt||!st(nt))return;var it=U.global,Q=Object.keys(nt),K=!1,$=!1,Y=!1,H=U.global.def("{}");Q.forEach(function(et){var at=nt[et];if(He.isDynamic(at)){typeof at=="function"&&(at=nt[et]=He.unbox(at));var yt=Dr(at,null);K=K||yt.thisDep,Y=Y||yt.propDep,$=$||yt.contextDep}else{switch(it(H,".",et,"="),typeof at){case"number":it(at);break;case"string":it('"',at,'"');break;case"object":Array.isArray(at)&&it("[",at.join(),"]");break;default:it(U.link(at));break}it(";")}});function G(et,at){Q.forEach(function(yt){var xt=nt[yt];if(He.isDynamic(xt)){var vt=et.invoke(at,xt);at(H,".",yt,"=",vt,";")}})}F.dynamic[q]=new He.DynamicVariable(Th,{thisDep:K,contextDep:$,propDep:Y,ref:H,append:G}),delete F.static[q]}function ze(U,F,q,nt,it){var Q=Se();Q.stats=Q.link(it),Object.keys(F.static).forEach(function($){ne(Q,F,$)}),cP.forEach(function($){ne(Q,U,$)});var K=Bn(U,F,q,nt,Q);return Pn(Q,K),ft(Q,K),W(Q,K),r(Q.compile(),{destroy:function(){K.shader.program.destroy()}})}return{next:$t,current:St,procs:function(){var U=Se(),F=U.proc("poll"),q=U.proc("refresh"),nt=U.block();F(nt),q(nt);var it=U.shared,Q=it.gl,K=it.next,$=it.current;nt($,".dirty=false;"),qn(U,F),qn(U,q,null,!0);var Y;Lt&&(Y=U.link(Lt)),X.oes_vertex_array_object&&q(U.link(X.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var H=0;H<ht.maxAttributes;++H){var G=q.def(it.attributes,"[",H,"]"),et=U.cond(G,".buffer");et.then(Q,".enableVertexAttribArray(",H,");",Q,".bindBuffer(",$s,",",G,".buffer.buffer);",Q,".vertexAttribPointer(",H,",",G,".size,",G,".type,",G,".normalized,",G,".stride,",G,".offset);").else(Q,".disableVertexAttribArray(",H,");",Q,".vertexAttrib4f(",H,",",G,".x,",G,".y,",G,".z,",G,".w);",G,".buffer=null;"),q(et),Lt&&q(Y,".vertexAttribDivisorANGLE(",H,",",G,".divisor);")}return q(U.shared.vao,".currentVAO=null;",U.shared.vao,".setVAO(",U.shared.vao,".targetVAO);"),Object.keys(Ut).forEach(function(at){var yt=Ut[at],xt=nt.def(K,".",at),vt=U.block();vt("if(",xt,"){",Q,".enable(",yt,")}else{",Q,".disable(",yt,")}",$,".",at,"=",xt,";"),q(vt),F("if(",xt,"!==",$,".",at,"){",vt,"}")}),Object.keys(kt).forEach(function(at){var yt=kt[at],xt=St[at],vt,Pt,ce=U.block();if(ce(Q,".",yt,"("),Nn(xt)){var je=xt.length;vt=U.global.def(K,".",at),Pt=U.global.def($,".",at),ce(jn(je,function(oe){return vt+"["+oe+"]"}),");",jn(je,function(oe){return Pt+"["+oe+"]="+vt+"["+oe+"];"}).join("")),F("if(",jn(je,function(oe){return vt+"["+oe+"]!=="+Pt+"["+oe+"]"}).join("||"),"){",ce,"}")}else vt=nt.def(K,".",at),Pt=nt.def($,".",at),ce(vt,");",$,".",at,"=",vt,";"),F("if(",vt,"!==",Pt,"){",ce,"}");q(ce)}),U.compile()}(),compile:ze}}function IP(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var TP=34918,OP=34919,ow=35007,NP=function(T,z){if(!z.ext_disjoint_timer_query)return null;var X=[];function ht(){return X.pop()||z.ext_disjoint_timer_query.createQueryEXT()}function wt(Lt){X.push(Lt)}var lt=[];function pt(Lt){var Kt=ht();z.ext_disjoint_timer_query.beginQueryEXT(ow,Kt),lt.push(Kt),It(lt.length-1,lt.length,Lt)}function Ct(){z.ext_disjoint_timer_query.endQueryEXT(ow)}function Ot(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Rt=[];function Nt(){return Rt.pop()||new Ot}function zt(Lt){Rt.push(Lt)}var Ht=[];function It(Lt,Kt,St){var $t=Nt();$t.startQueryIndex=Lt,$t.endQueryIndex=Kt,$t.sum=0,$t.stats=St,Ht.push($t)}var Gt=[],rt=[];function gt(){var Lt,Kt,St=lt.length;if(St!==0){rt.length=Math.max(rt.length,St+1),Gt.length=Math.max(Gt.length,St+1),Gt[0]=0,rt[0]=0;var $t=0;for(Lt=0,Kt=0;Kt<lt.length;++Kt){var At=lt[Kt];z.ext_disjoint_timer_query.getQueryObjectEXT(At,OP)?($t+=z.ext_disjoint_timer_query.getQueryObjectEXT(At,TP),wt(At)):lt[Lt++]=At,Gt[Kt+1]=$t,rt[Kt+1]=Lt}for(lt.length=Lt,Lt=0,Kt=0;Kt<Ht.length;++Kt){var Ut=Ht[Kt],kt=Ut.startQueryIndex,Yt=Ut.endQueryIndex;Ut.sum+=Gt[Yt]-Gt[kt];var ge=rt[kt],Ae=rt[Yt];Ae===ge?(Ut.stats.gpuTime+=Ut.sum/1e6,zt(Ut)):(Ut.startQueryIndex=ge,Ut.endQueryIndex=Ae,Ht[Lt++]=Ut)}Ht.length=Lt}}return{beginQuery:pt,endQuery:Ct,pushScopeStats:It,update:gt,getNumPendingQueries:function(){return lt.length},clear:function(){X.push.apply(X,lt);for(var Lt=0;Lt<X.length;Lt++)z.ext_disjoint_timer_query.deleteQueryEXT(X[Lt]);lt.length=0,X.length=0},restore:function(){lt.length=0,X.length=0}}},DP=16384,PP=256,LP=1024,jP=34962,aw="webglcontextlost",sw="webglcontextrestored",uw=1,RP=2,FP=3;function cw(T,z){for(var X=0;X<T.length;++X)if(T[X]===z)return X;return-1}function BP(T){var z=Ga(T);if(!z)return null;var X=z.gl,ht=X.getContextAttributes(),wt=X.isContextLost(),lt=xi(X,z);if(!lt)return null;var pt=hn(),Ct=IP(),Ot=lt.extensions,Rt=NP(X,Ot),Nt=yn(),zt=X.drawingBufferWidth,Ht=X.drawingBufferHeight,It={tick:0,time:0,viewportWidth:zt,viewportHeight:Ht,framebufferWidth:zt,framebufferHeight:Ht,drawingBufferWidth:zt,drawingBufferHeight:Ht,pixelRatio:z.pixelRatio},Gt={},rt={elements:null,primitive:4,count:-1,offset:0,instances:-1},gt=S5(X,Ot),Lt=z5(X,Ct,z,St),Kt=JD(X,Ot,gt,Ct,Lt);function St(be){return Kt.destroyBuffer(be)}var $t=J5(X,Ot,Lt,Ct),At=nP(X,pt,Ct,z),Ut=ID(X,Ot,gt,function(){ge.procs.poll()},It,Ct,z),kt=TD(X,Ot,gt,Ct,z),Yt=KD(X,Ot,gt,Ut,kt,Ct),ge=CP(X,pt,Ot,gt,Lt,$t,Ut,Yt,Gt,Kt,At,rt,It,Rt,z),Ae=oP(X,Yt,ge.procs.poll,It,ht,Ot,gt),qt=ge.next,Ft=X.canvas,Mt=[],Se=[],Pe=[],ie=[z.onDestroy],Be=null;function Ie(){if(Mt.length===0){Rt&&Rt.update(),Be=null;return}Be=un.next(Ie),lr();for(var be=Mt.length-1;be>=0;--be){var Ge=Mt[be];Ge&&Ge(It,null,0)}X.flush(),Rt&&Rt.update()}function Fe(){!Be&&Mt.length>0&&(Be=un.next(Ie))}function rn(){Be&&(un.cancel(Ie),Be=null)}function Fn(be){be.preventDefault(),wt=!0,rn(),Se.forEach(function(Ge){Ge()})}function Jn(be){X.getError(),wt=!1,lt.restore(),At.restore(),Lt.restore(),Ut.restore(),kt.restore(),Yt.restore(),Kt.restore(),Rt&&Rt.restore(),ge.procs.refresh(),Fe(),Pe.forEach(function(Ge){Ge()})}Ft&&(Ft.addEventListener(aw,Fn,!1),Ft.addEventListener(sw,Jn,!1));function Ye(){Mt.length=0,rn(),Ft&&(Ft.removeEventListener(aw,Fn),Ft.removeEventListener(sw,Jn)),At.clear(),Yt.clear(),kt.clear(),Ut.clear(),$t.clear(),Lt.clear(),Kt.clear(),Rt&&Rt.clear(),ie.forEach(function(be){be()})}function Xn(be){O(!!be,"invalid args to regl({...})"),O.type(be,"object","invalid args to regl({...})");function Ge(it){var Q=r({},it);delete Q.uniforms,delete Q.attributes,delete Q.context,delete Q.vao,"stencil"in Q&&Q.stencil.op&&(Q.stencil.opBack=Q.stencil.opFront=Q.stencil.op,delete Q.stencil.op);function K($){if($ in Q){var Y=Q[$];delete Q[$],Object.keys(Y).forEach(function(H){Q[$+"."+H]=Y[H]})}}return K("blend"),K("depth"),K("cull"),K("stencil"),K("polygonOffset"),K("scissor"),K("sample"),"vao"in it&&(Q.vao=it.vao),Q}function Qe(it,Q){var K={},$={};return Object.keys(it).forEach(function(Y){var H=it[Y];if(He.isDynamic(H)){$[Y]=He.unbox(H,Y);return}else if(Q&&Array.isArray(H)){for(var G=0;G<H.length;++G)if(He.isDynamic(H[G])){$[Y]=He.unbox(H,Y);return}}K[Y]=H}),{dynamic:$,static:K}}var Pn=Qe(be.context||{},!0),Wi=Qe(be.uniforms||{},!0),es=Qe(be.attributes||{},!1),W=Qe(Ge(be),!1),ft={gpuTime:0,cpuTime:0,count:0},st=ge.compile(W,es,Wi,Pn,ft),ne=st.draw,ze=st.batch,U=st.scope,F=[];function q(it){for(;F.length<it;)F.push(null);return F}function nt(it,Q){var K;if(wt&&O.raise("context lost"),typeof it=="function")return U.call(this,null,it,0);if(typeof Q=="function")if(typeof it=="number")for(K=0;K<it;++K)U.call(this,null,Q,K);else if(Array.isArray(it))for(K=0;K<it.length;++K)U.call(this,it[K],Q,K);else return U.call(this,it,Q,0);else if(typeof it=="number"){if(it>0)return ze.call(this,q(it|0),it|0)}else if(Array.isArray(it)){if(it.length)return ze.call(this,it,it.length)}else return ne.call(this,it)}return r(nt,{stats:ft,destroy:function(){st.destroy()}})}var vn=Yt.setFBO=Xn({framebuffer:He.define.call(null,uw,"framebuffer")});function Bn(be,Ge){var Qe=0;ge.procs.poll();var Pn=Ge.color;Pn&&(X.clearColor(+Pn[0]||0,+Pn[1]||0,+Pn[2]||0,+Pn[3]||0),Qe|=DP),"depth"in Ge&&(X.clearDepth(+Ge.depth),Qe|=PP),"stencil"in Ge&&(X.clearStencil(Ge.stencil|0),Qe|=LP),O(!!Qe,"called regl.clear with no buffer specified"),X.clear(Qe)}function Hn(be){if(O(typeof be=="object"&&be,"regl.clear() takes an object as input"),"framebuffer"in be)if(be.framebuffer&&be.framebuffer_reglType==="framebufferCube")for(var Ge=0;Ge<6;++Ge)vn(r({framebuffer:be.framebuffer.faces[Ge]},be),Bn);else vn(be,Bn);else Bn(null,be)}function qn(be){O.type(be,"function","regl.frame() callback must be a function"),Mt.push(be);function Ge(){var Qe=cw(Mt,be);O(Qe>=0,"cannot cancel a frame twice");function Pn(){var Wi=cw(Mt,Pn);Mt[Wi]=Mt[Mt.length-1],Mt.length-=1,Mt.length<=0&&rn()}Mt[Qe]=Pn}return Fe(),{cancel:Ge}}function er(){var be=qt.viewport,Ge=qt.scissor_box;be[0]=be[1]=Ge[0]=Ge[1]=0,It.viewportWidth=It.framebufferWidth=It.drawingBufferWidth=be[2]=Ge[2]=X.drawingBufferWidth,It.viewportHeight=It.framebufferHeight=It.drawingBufferHeight=be[3]=Ge[3]=X.drawingBufferHeight}function lr(){It.tick+=1,It.time=Le(),er(),ge.procs.poll()}function Dn(){Ut.refresh(),er(),ge.procs.refresh(),Rt&&Rt.update()}function Le(){return(yn()-Nt)/1e3}Dn();function hr(be,Ge){O.type(Ge,"function","listener callback must be a function");var Qe;switch(be){case"frame":return qn(Ge);case"lost":Qe=Se;break;case"restore":Qe=Pe;break;case"destroy":Qe=ie;break;default:O.raise("invalid event, must be one of frame,lost,restore,destroy")}return Qe.push(Ge),{cancel:function(){for(var Pn=0;Pn<Qe.length;++Pn)if(Qe[Pn]===Ge){Qe[Pn]=Qe[Qe.length-1],Qe.pop();return}}}}var ln=r(Xn,{clear:Hn,prop:He.define.bind(null,uw),context:He.define.bind(null,RP),this:He.define.bind(null,FP),draw:Xn({}),buffer:function(be){return Lt.create(be,jP,!1,!1)},elements:function(be){return $t.create(be,!1)},texture:Ut.create2D,cube:Ut.createCube,renderbuffer:kt.create,framebuffer:Yt.create,framebufferCube:Yt.createCube,vao:Kt.createVAO,attributes:ht,frame:qn,on:hr,limits:gt,hasExtension:function(be){return gt.extensions.indexOf(be.toLowerCase())>=0},read:Ae,destroy:Ye,_gl:X,_refresh:Dn,poll:function(){lr(),Rt&&Rt.update()},now:Le,stats:Ct});return z.onDone(null,ln),ln}return BP})})(bN);var Nst=bN.exports;const Dst=bo(Nst);var Pst=function(){function t(n,e){zi(this,t),this.attribute=void 0,this.buffer=void 0;var r=e.buffer,i=e.offset,o=e.stride,a=e.normalized,s=e.size,u=e.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:o||0,normalized:a||!1,divisor:u||0},s&&(this.attribute.size=s)}return Gi(t,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(n){this.buffer.subData(n)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),t}(),Po,Oc,Lo,si,Nc,ha,Dc,If,qi,is,wr,Zi,Ki,Tf,Lst=(Po={},Qt(Po,Tt.POINTS,"points"),Qt(Po,Tt.LINES,"lines"),Qt(Po,Tt.LINE_LOOP,"line loop"),Qt(Po,Tt.LINE_STRIP,"line strip"),Qt(Po,Tt.TRIANGLES,"triangles"),Qt(Po,Tt.TRIANGLE_FAN,"triangle fan"),Qt(Po,Tt.TRIANGLE_STRIP,"triangle strip"),Po),xN=(Oc={},Qt(Oc,Tt.STATIC_DRAW,"static"),Qt(Oc,Tt.DYNAMIC_DRAW,"dynamic"),Qt(Oc,Tt.STREAM_DRAW,"stream"),Oc),sb=(Lo={},Qt(Lo,Tt.BYTE,"int8"),Qt(Lo,Tt.UNSIGNED_INT,"int16"),Qt(Lo,Tt.INT,"int32"),Qt(Lo,Tt.UNSIGNED_BYTE,"uint8"),Qt(Lo,Tt.UNSIGNED_SHORT,"uint16"),Qt(Lo,Tt.UNSIGNED_INT,"uint32"),Qt(Lo,Tt.FLOAT,"float"),Lo),jst=(si={},Qt(si,Tt.ALPHA,"alpha"),Qt(si,Tt.LUMINANCE,"luminance"),Qt(si,Tt.LUMINANCE_ALPHA,"luminance alpha"),Qt(si,Tt.RGB,"rgb"),Qt(si,Tt.RGBA,"rgba"),Qt(si,Tt.RGBA4,"rgba4"),Qt(si,Tt.RGB5_A1,"rgb5 a1"),Qt(si,Tt.RGB565,"rgb565"),Qt(si,Tt.DEPTH_COMPONENT,"depth"),Qt(si,Tt.DEPTH_STENCIL,"depth stencil"),si),Rst=(Nc={},Qt(Nc,Tt.DONT_CARE,"dont care"),Qt(Nc,Tt.NICEST,"nice"),Qt(Nc,Tt.FASTEST,"fast"),Nc),RS=(ha={},Qt(ha,Tt.NEAREST,"nearest"),Qt(ha,Tt.LINEAR,"linear"),Qt(ha,Tt.LINEAR_MIPMAP_LINEAR,"mipmap"),Qt(ha,Tt.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),Qt(ha,Tt.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),Qt(ha,Tt.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),ha),FS=(Dc={},Qt(Dc,Tt.REPEAT,"repeat"),Qt(Dc,Tt.CLAMP_TO_EDGE,"clamp"),Qt(Dc,Tt.MIRRORED_REPEAT,"mirror"),Dc),Fst=(If={},Qt(If,Tt.NONE,"none"),Qt(If,Tt.BROWSER_DEFAULT_WEBGL,"browser"),If),Bst=(qi={},Qt(qi,Tt.NEVER,"never"),Qt(qi,Tt.ALWAYS,"always"),Qt(qi,Tt.LESS,"less"),Qt(qi,Tt.LEQUAL,"lequal"),Qt(qi,Tt.GREATER,"greater"),Qt(qi,Tt.GEQUAL,"gequal"),Qt(qi,Tt.EQUAL,"equal"),Qt(qi,Tt.NOTEQUAL,"notequal"),qi),BS=(is={},Qt(is,Tt.FUNC_ADD,"add"),Qt(is,Tt.MIN_EXT,"min"),Qt(is,Tt.MAX_EXT,"max"),Qt(is,Tt.FUNC_SUBTRACT,"subtract"),Qt(is,Tt.FUNC_REVERSE_SUBTRACT,"reverse subtract"),is),Of=(wr={},Qt(wr,Tt.ZERO,"zero"),Qt(wr,Tt.ONE,"one"),Qt(wr,Tt.SRC_COLOR,"src color"),Qt(wr,Tt.ONE_MINUS_SRC_COLOR,"one minus src color"),Qt(wr,Tt.SRC_ALPHA,"src alpha"),Qt(wr,Tt.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),Qt(wr,Tt.DST_COLOR,"dst color"),Qt(wr,Tt.ONE_MINUS_DST_COLOR,"one minus dst color"),Qt(wr,Tt.DST_ALPHA,"dst alpha"),Qt(wr,Tt.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),Qt(wr,Tt.CONSTANT_COLOR,"constant color"),Qt(wr,Tt.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),Qt(wr,Tt.CONSTANT_ALPHA,"constant alpha"),Qt(wr,Tt.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),Qt(wr,Tt.SRC_ALPHA_SATURATE,"src alpha saturate"),wr),zst=(Zi={},Qt(Zi,Tt.NEVER,"never"),Qt(Zi,Tt.ALWAYS,"always"),Qt(Zi,Tt.LESS,"less"),Qt(Zi,Tt.LEQUAL,"lequal"),Qt(Zi,Tt.GREATER,"greater"),Qt(Zi,Tt.GEQUAL,"gequal"),Qt(Zi,Tt.EQUAL,"equal"),Qt(Zi,Tt.NOTEQUAL,"notequal"),Zi),cu=(Ki={},Qt(Ki,Tt.ZERO,"zero"),Qt(Ki,Tt.KEEP,"keep"),Qt(Ki,Tt.REPLACE,"replace"),Qt(Ki,Tt.INVERT,"invert"),Qt(Ki,Tt.INCR,"increment"),Qt(Ki,Tt.DECR,"decrement"),Qt(Ki,Tt.INCR_WRAP,"increment wrap"),Qt(Ki,Tt.DECR_WRAP,"decrement wrap"),Ki),Gst=(Tf={},Qt(Tf,Tt.FRONT,"front"),Qt(Tf,Tt.BACK,"back"),Tf),Ust=function(){function t(n,e){zi(this,t),this.buffer=void 0;var r=e.data,i=e.usage,o=e.type;this.buffer=n.buffer({data:r,usage:xN[i||Tt.STATIC_DRAW],type:sb[o||Tt.UNSIGNED_BYTE]})}return Gi(t,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(n){var e=n.data,r=n.offset;this.buffer.subdata(e,r)}}]),t}();function Um(t,n){(n==null||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function Yst(t){if(Array.isArray(t))return Um(t)}function Vst(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Wst(t,n){if(t){if(typeof t=="string")return Um(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);if(e==="Object"&&t.constructor&&(e=t.constructor.name),e==="Map"||e==="Set")return Array.from(t);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Um(t,n)}}function Xst(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hst(t){return Yst(t)||Vst(t)||Wst(t)||Xst()}function zS(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,r)}return e}function GS(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?zS(Object(e),!0).forEach(function(r){Qt(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):zS(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}var qst=`attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`,US=0,Zst=function(){function t(n,e){var r=this;zi(this,t),this.reGl=n,this.context=e,this.entity=mN(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var i={};this.context.uniforms.forEach(function(c){var l=c.name,h=c.type,f=c.data,d=c.isReferer,p=c.storageClass;if(p===Ku.StorageBuffer){if(d)r.textureCache[l]={data:void 0},i["".concat(l,"Size")]=function(){return f.compiledBundle.context.output.textureSize};else{r.textureCache[l]=r.calcDataTexture(l,h,f);var g=r.textureCache[l],v=g.textureWidth,m=g.isOutput;i["".concat(l,"Size")]=[v,v],m&&(r.outputTextureName=l,r.context.needPingpong&&(r.outputTextureName="".concat(l,"Output"),r.textureCache[r.outputTextureName]=r.calcDataTexture(l,h,f)))}i[l]=function(){return r.textureCache[l].texture}}else if(p===Ku.Uniform){if(f&&(Array.isArray(f)||Jd(f))&&f.length>16)throw new Error("invalid data type ".concat(h));i[l]=function(){return c.data}}});var o=this.getOuputDataTexture(),a=o.textureWidth,s=o.texelCount;i.u_OutputTextureSize=[a,a],i.u_OutputTexelCount=s,this.context.output.textureSize=[a,a];var u={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),uniforms:i,vert:qst,primitive:"triangle strip",count:4};this.computeCommand=this.reGl(u)}return Gi(t,[{key:"run",value:function(){var n=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use(function(){n.computeCommand()})}},{key:"readData",value:function(){var n=Ma(Sr.mark(function r(){var i=this,o,a,s,u,c,l,h,f;return Sr.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(this.reGl({framebuffer:this.texFBO})(function(){o=i.reGl.read()}),!o){d.next=6;break}if(a=this.getOuputDataTexture(),s=a.originalDataLength,u=a.elementsPerTexel,c=a.typedArrayConstructor,l=c===void 0?Float32Array:c,h=[],u!==4)for(f=0;f<o.length;f+=4)u===1?h.push(o[f]):u===2?h.push(o[f],o[f+1]):h.push(o[f],o[f+1],o[f+2]);else h=o;return d.abrupt("return",new l(h.slice(0,s)));case 6:return d.abrupt("return",new Float32Array);case 7:case"end":return d.stop()}},r,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"confirmInput",value:function(n,e){var r;this.entity===n.entity?(this.dynamicPingpong=!0,r=this):r=n,this.textureCache[e].id=r.getOuputDataTexture().id,this.textureCache[e].texture=r.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(n,e){var r=this.context.uniforms.find(function(s){var u=s.name;return u===n});if(r){var i=this.calcDataTexture(n,r.type,e),o=i.texture,a=i.data;this.textureCache[n].data=a,this.textureCache[n].texture=o}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var n=this.context.output.name;this.textureCache[n].id=this.getOuputDataTexture().id,this.textureCache[n].texture=this.getOuputDataTexture().texture}var e=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=e}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var n=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=n}},{key:"cloneDataTexture",value:function(n){var e=n.data,r=n.textureWidth;return GS(GS({},n),{},{id:US++,texture:this.reGl.texture({width:r,height:r,data:e,type:"float"})})}},{key:"calcDataTexture",value:function(n,e,r){var i=1;e===Dl.Vector4FloatArray&&(i=4);for(var o=[],a=0;a<r.length;a+=i)i===1?o.push(r[a],0,0,0):i===2?o.push(r[a],r[a+1],0,0):i===3?o.push(r[a],r[a+1],r[a+2],0):i===4&&o.push(r[a],r[a+1],r[a+2],r[a+3]);var s=r.length,u=Math.ceil(s/i),c=Math.ceil(Math.sqrt(u)),l=c*c;u<l&&o.push.apply(o,Hst(new Array((l-u)*4).fill(0)));var h=this.reGl.texture({width:c,height:c,data:o,type:"float"});return{id:US++,data:o,originalDataLength:s,typedArrayConstructor:Jd(r)?r.constructor:void 0,textureWidth:c,texture:h,texelCount:u,elementsPerTexel:i,isOutput:n===this.context.output.name}}}]),t}(),Kst=function(){function t(n,e){zi(this,t),this.elements=void 0;var r=e.data,i=e.usage,o=e.type,a=e.count;this.elements=n.elements({data:r,usage:xN[i||Tt.STATIC_DRAW],type:sb[o||Tt.UNSIGNED_BYTE],count:a})}return Gi(t,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(n){var e=n.data;this.elements.subdata(e)}},{key:"destroy",value:function(){this.elements.destroy()}}]),t}(),Qst=function(){function t(n,e){zi(this,t),this.framebuffer=void 0;var r=e.width,i=e.height,o=e.color,a=e.colors;e.depth,e.stencil;var s={width:r,height:i};Array.isArray(a)&&(s.colors=a.map(function(u){return u.get()})),o&&typeof o!="boolean"&&(s.color=o.get()),this.framebuffer=n.framebuffer(s)}return Gi(t,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(n){var e=n.width,r=n.height;this.framebuffer.resize(e,r)}}]),t}();function Jst(t,n){return function(e){return t(n(e))}}var $st=Jst,tut=$st,eut=tut(Object.getPrototypeOf,Object),nut=eut,rut=ob,iut=nut,out=ab,aut="[object Object]",sut=Function.prototype,uut=Object.prototype,wN=sut.toString,cut=uut.hasOwnProperty,lut=wN.call(Object);function hut(t){if(!out(t)||rut(t)!=aut)return!1;var n=iut(t);if(n===null)return!0;var e=cut.call(n,"constructor")&&n.constructor;return typeof e=="function"&&e instanceof e&&wN.call(e)==lut}var fut=hut;const dut=bo(fut);function lv(t){var n={};return Object.keys(t).forEach(function(e){Ym(e,t[e],n,"")}),n}function Ym(t,n,e,r){if(n===null||typeof n=="number"||typeof n=="boolean"||Array.isArray(n)&&typeof n[0]=="number"||Jd(n)||n===""||n.resize!==void 0){e["".concat(r&&r+".").concat(t)]=n;return}dut(n)&&Object.keys(n).forEach(function(i){Ym(i,n[i],e,"".concat(r&&r+".").concat(t))}),Array.isArray(n)&&n.forEach(function(i,o){Object.keys(i).forEach(function(a){Ym(a,i[a],e,"".concat(r&&r+".").concat(t,"[").concat(o,"]"))})})}function YS(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),e.push.apply(e,r)}return e}function lu(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?YS(Object(e),!0).forEach(function(r){Qt(t,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):YS(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}return t}var put=function(){function t(n,e){zi(this,t),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=n;var r=e.vs,i=e.fs,o=e.defines,a=e.attributes,s=e.uniforms,u=e.primitive,c=e.count,l=e.elements,h=e.depth,f=e.blend,d=e.stencil,p=e.cull,g=e.instances,v=e.scissor,m=e.viewport,y={};s&&(this.uniforms=lv(s),Object.keys(s).forEach(function(E){y[E]=n.prop(E)}));var b={};Object.keys(a).forEach(function(E){b[E]=a[E].get()});var x=o&&this.generateDefines(o)||"",w={attributes:b,frag:`#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(x,`
`).concat(i),uniforms:y,vert:`
`.concat(x,`
`).concat(r),primitive:Lst[u===void 0?Tt.TRIANGLES:u]};g&&(w.instances=g),c&&(w.count=c),l&&(w.elements=l.get()),v&&(w.scissor=v),m&&(w.viewport=m),this.initDepthDrawParams({depth:h},w),this.initBlendDrawParams({blend:f},w),this.initStencilDrawParams({stencil:d},w),this.initCullDrawParams({cull:p},w),this.drawCommand=n(w)}return Gi(t,[{key:"addUniforms",value:function(n){this.uniforms=lu(lu({},this.uniforms),lv(n))}},{key:"draw",value:function(n){var e=lu(lu({},this.uniforms),lv(n.uniforms||{})),r={};Object.keys(e).forEach(function(i){var o=Zu(e[i]);o==="boolean"||o==="number"||Array.isArray(e[i])||e[i].BYTES_PER_ELEMENT?r[i]=e[i]:o==="string"||(r[i]=e[i].get())}),this.drawCommand(r)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(n,e){var r=n.depth;r&&(e.depth={enable:r.enable===void 0?!0:!!r.enable,mask:r.mask===void 0?!0:!!r.mask,func:Bst[r.func||Tt.LESS],range:r.range||[0,1]})}},{key:"initBlendDrawParams",value:function(n,e){var r=n.blend;if(r){var i=r.enable,o=r.func,a=r.equation,s=r.color,u=s===void 0?[0,0,0,0]:s;e.blend={enable:!!i,func:{srcRGB:Of[o&&o.srcRGB||Tt.SRC_ALPHA],srcAlpha:Of[o&&o.srcAlpha||Tt.SRC_ALPHA],dstRGB:Of[o&&o.dstRGB||Tt.ONE_MINUS_SRC_ALPHA],dstAlpha:Of[o&&o.dstAlpha||Tt.ONE_MINUS_SRC_ALPHA]},equation:{rgb:BS[a&&a.rgb||Tt.FUNC_ADD],alpha:BS[a&&a.alpha||Tt.FUNC_ADD]},color:u}}}},{key:"initStencilDrawParams",value:function(n,e){var r=n.stencil;if(r){var i=r.enable,o=r.mask,a=o===void 0?-1:o,s=r.func,u=s===void 0?{cmp:Tt.ALWAYS,ref:0,mask:-1}:s,c=r.opFront,l=c===void 0?{fail:Tt.KEEP,zfail:Tt.KEEP,zpass:Tt.KEEP}:c,h=r.opBack,f=h===void 0?{fail:Tt.KEEP,zfail:Tt.KEEP,zpass:Tt.KEEP}:h;e.stencil={enable:!!i,mask:a,func:lu(lu({},u),{},{cmp:zst[u.cmp]}),opFront:{fail:cu[l.fail],zfail:cu[l.zfail],zpass:cu[l.zpass]},opBack:{fail:cu[f.fail],zfail:cu[f.zfail],zpass:cu[f.zpass]}}}}},{key:"initCullDrawParams",value:function(n,e){var r=n.cull;if(r){var i=r.enable,o=r.face,a=o===void 0?Tt.BACK:o;e.cull={enable:!!i,face:Gst[a]}}}},{key:"generateDefines",value:function(n){return Object.keys(n).map(function(e){return"#define ".concat(e," ").concat(Number(n[e]))}).join(`
`)}}]),t}(),gut=function(){function t(n,e){zi(this,t),this.texture=void 0,this.width=void 0,this.height=void 0;var r=e.data,i=e.type,o=i===void 0?Tt.UNSIGNED_BYTE:i,a=e.width,s=e.height,u=e.flipY,c=u===void 0?!1:u,l=e.format,h=l===void 0?Tt.RGBA:l,f=e.mipmap,d=f===void 0?!1:f,p=e.wrapS,g=p===void 0?Tt.CLAMP_TO_EDGE:p,v=e.wrapT,m=v===void 0?Tt.CLAMP_TO_EDGE:v,y=e.aniso,b=y===void 0?0:y,x=e.alignment,w=x===void 0?1:x,E=e.premultiplyAlpha,M=E===void 0?!1:E,_=e.mag,k=_===void 0?Tt.NEAREST:_,S=e.min,A=S===void 0?Tt.NEAREST:S,C=e.colorSpace,I=C===void 0?Tt.BROWSER_DEFAULT_WEBGL:C;this.width=a,this.height=s;var N={width:a,height:s,type:sb[o],format:jst[h],wrapS:FS[g],wrapT:FS[m],mag:RS[k],min:RS[A],alignment:w,flipY:c,colorSpace:Fst[I],premultiplyAlpha:M,aniso:b};r&&(N.data=r),typeof d=="number"?N.mipmap=Rst[d]:typeof d=="boolean"&&(N.mipmap=d),this.texture=n.texture(N)}return Gi(t,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(n){var e=n.width,r=n.height;this.texture.resize(e,r),this.width=e,this.height=r}},{key:"destroy",value:function(){this.texture.destroy()}}]),t}(),vut=function(){function t(){var n=this;zi(this,t),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var e=Ma(Sr.mark(function r(i){return Sr.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!i.uniforms){o.next=3;break}return o.next=3,Promise.all(Object.keys(i.uniforms).map(function(){var a=Ma(Sr.mark(function s(u){var c;return Sr.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(i.uniforms[u]&&i.uniforms[u].load!==void 0)){l.next=5;break}return l.next=3,i.uniforms[u].load();case 3:c=l.sent,i.uniforms[u]=c;case 5:case"end":return l.stop()}},s)}));return function(s){return a.apply(this,arguments)}}()));case 3:return o.abrupt("return",new put(n.gl,i));case 4:case"end":return o.stop()}},r)}));return function(r){return e.apply(this,arguments)}}(),this.createAttribute=function(e){return new Pst(n.gl,e)},this.createBuffer=function(e){return new Ust(n.gl,e)},this.createElements=function(e){return new Kst(n.gl,e)},this.createTexture2D=function(e){return new gut(n.gl,e)},this.createFramebuffer=function(e){return new Qst(n.gl,e)},this.useFramebuffer=function(e,r){n.gl({framebuffer:e?e.get():null})(r)},this.createComputeModel=function(){var e=Ma(Sr.mark(function r(i){return Sr.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",new Zst(n.gl,i));case 1:case"end":return o.stop()}},r)}));return function(r){return e.apply(this,arguments)}}(),this.clear=function(e){var r=e.color,i=e.depth,o=e.stencil,a=e.framebuffer,s=a===void 0?null:a,u={color:r,depth:i,stencil:o};u.framebuffer=s===null?s:s.get(),n.gl.clear(u)},this.setScissor=function(e){n.gl&&n.gl._gl&&(e.enable&&e.box?(n.gl._gl.enable(Tt.SCISSOR_TEST),n.gl._gl.scissor(e.box.x,e.box.y,e.box.width,e.box.height)):n.gl._gl.disable(Tt.SCISSOR_TEST),n.gl._refresh())},this.viewport=function(e){var r=e.x,i=e.y,o=e.width,a=e.height;n.gl&&n.gl._gl&&(n.gl._gl.viewport(r,i,o,a),n.gl._refresh())},this.readPixels=function(e){var r=e.framebuffer,i=e.x,o=e.y,a=e.width,s=e.height,u={x:i,y:o,width:a,height:s};return r&&(u.framebuffer=r.get()),n.gl.read(u)},this.getCanvas=function(){return n.$canvas},this.getGLContext=function(){return n.gl._gl},this.destroy=function(){n.gl&&(n.gl.destroy(),n.inited=!1)}}return Gi(t,[{key:"init",value:function(){var n=Ma(Sr.mark(function r(i){return Sr.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.inited){o.next=2;break}return o.abrupt("return");case 2:return this.$canvas=i.canvas,o.next=5,new Promise(function(a,s){Dst({canvas:i.canvas,attributes:{alpha:!0,antialias:i.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(u,c){(u||!c)&&s(u),a(c)}})});case 5:this.gl=o.sent,this.inited=!0;case 7:case"end":return o.stop()}},r,this)}));function e(r){return n.apply(this,arguments)}return e}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),t}(),mut=function(){function t(){zi(this,t),this.engine=void 0,this.configService=new Ist}return Gi(t,[{key:"setConfig",value:function(n){this.configService.set(n)}},{key:"setEngine",value:function(n){this.engine=n}},{key:"createEntity",value:function(){return mN()}},{key:"createKernel",value:function(n){var e=new yN(this.engine,this.configService);return typeof n=="string"?e.setBundle(JSON.parse(n)):e.setBundle(n),e.init(),e}},{key:"destroy",value:function(){this.engine.destroy()}}],[{key:"create",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new t;return e.setConfig(n),e.setEngine(new vut),e}}]),t}();const yut=Object.freeze(Object.defineProperty({__proto__:null,Kernel:yN,World:mut},Symbol.toStringTag,{value:"Module"})),EN=xo(yut);var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.arrayToTextureData=Kr.attributesToTextureData=Kr.buildTextureDataWithTwoEdgeAttr=Kr.buildTextureData=Kr.proccessToFunc=void 0;var but=Ln(),$d=Op,xut=function(t,n){var e;return t?(0,but.isNumber)(t)?e=function(){return t}:e=t:e=function(){return n||1},e};Kr.proccessToFunc=xut;var wut=function(t,n){var e=[],r=[],i={},o=0;for(o=0;o<t.length;o++){var a=t[o];i[a.id]=o,e.push(a.x),e.push(a.y),e.push(0),e.push(0),r.push([])}for(o=0;o<n.length;o++){var s=n[o],u=(0,$d.getEdgeTerminal)(s,"source"),c=(0,$d.getEdgeTerminal)(s,"target");!isNaN(i[u])&&!isNaN(i[c])&&(r[i[u]].push(i[c]),r[i[c]].push(i[u]))}var l=0;for(o=0;o<t.length;o++){var h=e.length,f=r[o],d=f.length;e[o*4+2]=h,e[o*4+3]=d,l=Math.max(l,d);for(var p=0;p<d;++p){var g=f[p];e.push(+g)}}for(;e.length%4!==0;)e.push(0);return{maxEdgePerVetex:l,array:new Float32Array(e)}};Kr.buildTextureData=wut;var Eut=function(t,n,e,r){var i=[],o=[],a={},s=0;for(s=0;s<t.length;s++){var u=t[s];a[u.id]=s,i.push(u.x),i.push(u.y),i.push(0),i.push(0),o.push([])}for(s=0;s<n.length;s++){var c=n[s],l=(0,$d.getEdgeTerminal)(c,"source"),h=(0,$d.getEdgeTerminal)(c,"target");o[a[l]].push(a[h]),o[a[l]].push(e(c)),o[a[l]].push(r(c)),o[a[l]].push(0),o[a[h]].push(a[l]),o[a[h]].push(e(c)),o[a[h]].push(r(c)),o[a[h]].push(0)}var f=0;for(s=0;s<t.length;s++){var d=i.length,p=o[s],g=p.length;i[s*4+2]=d+1048576*g/4,i[s*4+3]=0,f=Math.max(f,g/4);for(var v=0;v<g;++v){var m=p[v];i.push(+m)}}for(;i.length%4!==0;)i.push(0);return{maxEdgePerVetex:f,array:new Float32Array(i)}};Kr.buildTextureDataWithTwoEdgeAttr=Eut;var Mut=function(t,n){var e=[],r=t.length,i={};return n.forEach(function(o){t.forEach(function(a,s){if(i[o[a]]===void 0&&(i[o[a]]=Object.keys(i).length),e.push(i[o[a]]),s===r-1)for(;e.length%4!==0;)e.push(0)})}),{array:new Float32Array(e),count:Object.keys(i).length}};Kr.attributesToTextureData=Mut;var Sut=function(t){for(var n=[],e=t.length,r=t[0].length,i=function(a){t.forEach(function(s,u){if(n.push(s[a]),u===e-1)for(;n.length%4!==0;)n.push(0)})},o=0;o<r;o++)i(o);return new Float32Array(n)};Kr.arrayToTextureData=Sut;var uo={};Object.defineProperty(uo,"__esModule",{value:!0});uo.clusterBundle=uo.clusterCode=uo.fruchtermanBundle=uo.fruchtermanCode=void 0;uo.fruchtermanCode=`
import { globalInvocationID } from 'g-webgpu';
const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class Fruchterman {
  @in @out
  u_Data: vec4[];
  @in
  u_K: float;
  @in
  u_K2: float;
  
  @in
  u_Center: vec2;
  @in
  u_Gravity: float;
  @in
  u_ClusterGravity: float;
  @in
  u_Speed: float;
  @in
  u_MaxDisplace: float;
  @in
  u_Clustering: float;
  @in
  u_AttributeArray: vec4[];
  @in
  u_ClusterCenters: vec4[];
  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const xDist = currentNode[0] - nextNode[0];
        const yDist = currentNode[1] - nextNode[1];
        const dist = (xDist * xDist + yDist * yDist) + 0.01;
        let param = this.u_K2 / dist;
        
        if (dist > 0.0) {
          dx += param * xDist;
          dy += param * yDist;
          if (xDist == 0 && yDist == 0) {
            const sign = i < j ? 1 : -1;
            dx += param * sign;
            dy += param * sign;
          }
        }
      }
    }
    return [dx, dy];
  }
  calcGravity(currentNode: vec4, nodeAttributes: vec4): vec2 { // 
    let dx = 0, dy = 0;
    const vx = currentNode[0] - this.u_Center[0];
    const vy = currentNode[1] - this.u_Center[1];
    const gf = 0.01 * this.u_K * this.u_Gravity;
    dx = gf * vx;
    dy = gf * vy;
    if (this.u_Clustering == 1) {
      const clusterIdx = int(nodeAttributes[0]);
      const center = this.u_ClusterCenters[clusterIdx];
      const cvx = currentNode[0] - center[0];
      const cvy = currentNode[1] - center[1];
      const dist = sqrt(cvx * cvx + cvy * cvy) + 0.01;
      const parma = this.u_K * this.u_ClusterGravity / dist;
      dx += parma * cvx;
      dy += parma * cvy;
    }
    return [dx, dy];
  }
  calcAttractive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    const arr_offset = int(floor(currentNode[2] + 0.5));
    const length = int(floor(currentNode[3] + 0.5));
    const node_buffer: vec4;
    for (let p = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + p;
      // when arr_idx % 4 == 0 update currentNodedx_buffer
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)];
      }
      const float_j = buf_offset == 0 ? node_buffer[0] :
                      buf_offset == 1 ? node_buffer[1] :
                      buf_offset == 2 ? node_buffer[2] :
                                        node_buffer[3];
      const nextNode = this.u_Data[int(float_j)];
      const xDist = currentNode[0] - nextNode[0];
      const yDist = currentNode[1] - nextNode[1];
      const dist = sqrt(xDist * xDist + yDist * yDist) + 0.01;
      let attractiveF = dist / this.u_K;
    
      if (dist > 0.0) {
        dx -= xDist * attractiveF;
        dy -= yDist * attractiveF;
        if (xDist == 0 && yDist == 0) {
          const sign = i < int(float_j) ? 1 : -1;
          dx -= sign * attractiveF;
          dy -= sign * attractiveF;
        }
      }
    }
    return [dx, dy];
  }
  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    let dx = 0, dy = 0;
    if (i >= VERTEX_COUNT) {
      this.u_Data[i] = currentNode;
      return;
    }

    // [gravity, fx, fy, 0]
    const nodeAttributes = this.u_AttributeArray[i];

    if (nodeAttributes[1] != 0 && nodeAttributes[2] != 0) {
      // the node is fixed
      this.u_Data[i] = [
        nodeAttributes[1],
        nodeAttributes[2],
        currentNode[2],
        currentNode[3]
      ];
      return;
    }

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    dx += repulsive[0];
    dy += repulsive[1];
    // attractive
    const attractive = this.calcAttractive(i, currentNode);
    dx += attractive[0];
    dy += attractive[1];
    // gravity
    const gravity = this.calcGravity(currentNode, nodeAttributes);
    dx -= gravity[0];
    dy -= gravity[1];
    // speed
    dx *= this.u_Speed;
    dy *= this.u_Speed;

    // move
    const distLength = sqrt(dx * dx + dy * dy);
    if (distLength > 0.0) {
      const limitedDist = min(this.u_MaxDisplace * this.u_Speed, distLength);
      this.u_Data[i] = [
        currentNode[0] + dx / distLength * limitedDist,
        currentNode[1] + dy / distLength * limitedDist,
        currentNode[2],
        currentNode[3]
      ];
    }
  }
}
`;uo.fruchtermanBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}';uo.clusterCode=`
import { globalInvocationID } from 'g-webgpu';
const VERTEX_COUNT;
const CLUSTER_COUNT;
@numthreads(1, 1, 1)
class CalcCenter {
  @in
  u_Data: vec4[];
  @in
  u_NodeAttributes: vec4[]; // [[clusterIdx, 0, 0, 0], ...]
  @in @out
  u_ClusterCenters: vec4[]; // [[cx, cy, nodeCount, clusterIdx], ...]
  @main
  compute() {
    const i = globalInvocationID.x;
    const center = this.u_ClusterCenters[i];
    let sumx = 0;
    let sumy = 0;
    let count = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      const attributes = this.u_NodeAttributes[j];
      const clusterIdx = int(attributes[0]);
      const vertex = this.u_Data[j];
      if (clusterIdx == i) {
        sumx += vertex.x;
        sumy += vertex.y;
        count += 1;
      }
    }
    this.u_ClusterCenters[i] = [
      sumx / count,
      sumy / count,
      count,
      i
    ];
  }
}
`;uo.clusterBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';var _ut=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Nf=bt&&bt.__awaiter||function(t,n,e,r){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(l){try{c(r.next(l))}catch(h){a(h)}}function u(l){try{c(r.throw(l))}catch(h){a(h)}}function c(l){l.done?o(l.value):i(l.value).then(s,u)}c((r=r.apply(t,n||[])).next())})},Df=bt&&bt.__generator||function(t,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(e=0)),e;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++,i=c[1],c=[0];continue;case 7:c=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){e=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){e.label=c[1];break}if(c[0]===6&&e.label<o[1]){e.label=o[1],o=c;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(c);break}o[2]&&e.ops.pop(),e.trys.pop();continue}c=n.call(t,e)}catch(l){c=[6,l],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(uh,"__esModule",{value:!0});uh.FruchtermanGPULayout=void 0;var kut=Yn,hu=Ln(),VS=EN,WS=Kr,XS=uo,Aut=Zo,Cut=function(t){_ut(n,t);function n(e){var r=t.call(this)||this;return r.maxIteration=1e3,r.gravity=10,r.speed=1,r.clustering=!1,r.clusterField="cluster",r.clusterGravity=10,r.workerEnabled=!1,r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{maxIteration:1e3,gravity:10,speed:1,clustering:!1,clusterGravity:10}},n.prototype.execute=function(){return Nf(this,void 0,void 0,function(){var e,r,i,o,a,s=this;return Df(this,function(u){switch(u.label){case 0:return e=this,r=e.nodes,!r||r.length===0?(e.onLayoutEnd&&e.onLayoutEnd(),[2]):(!e.width&&typeof window<"u"&&(e.width=window.innerWidth),!e.height&&typeof window<"u"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]),i=e.center,r.length===1?(r[0].x=i[0],r[0].y=i[1],e.onLayoutEnd&&e.onLayoutEnd(),[2]):(o={},a={},r.forEach(function(c,l){(0,hu.isNumber)(c.x)||(c.x=Math.random()*s.width),(0,hu.isNumber)(c.y)||(c.y=Math.random()*s.height),o[c.id]=c,a[c.id]=l}),e.nodeMap=o,e.nodeIdxMap=a,[4,e.run()]));case 1:return u.sent(),[2]}})})},n.prototype.executeWithWorker=function(e,r){return Nf(this,void 0,void 0,function(){var i,o,a,s,u,c=this;return Df(this,function(l){switch(l.label){case 0:return i=this,o=i.nodes,a=i.center,!o||o.length===0?[2]:o.length===1?(o[0].x=a[0],o[0].y=a[1],[2]):(s={},u={},o.forEach(function(h,f){(0,hu.isNumber)(h.x)||(h.x=Math.random()*c.width),(0,hu.isNumber)(h.y)||(h.y=Math.random()*c.height),s[h.id]=h,u[h.id]=f}),i.nodeMap=s,i.nodeIdxMap=u,[4,i.run(e,r)]);case 1:return l.sent(),[2]}})})},n.prototype.run=function(e,r){return Nf(this,void 0,void 0,function(){var i,o,a,s,u,c,l,h,f,d,p,g,v,m,y,b,x,w,E,M,_,k,S,A,C,I,N=this;return Df(this,function(D){switch(D.label){case 0:for(i=this,o=i.nodes,a=i.edges,s=i.maxIteration,u=i.center,c=i.height*i.width,l=Math.sqrt(c)/10,h=c/(o.length+1),f=Math.sqrt(h),d=i.speed,p=i.clustering,g=(0,WS.attributesToTextureData)([i.clusterField],o),v=g.array,m=g.count,o.forEach(function(P,j){var L=0,R=0;(0,hu.isNumber)(P.fx)&&(0,hu.isNumber)(P.fy)&&(L=P.fx||.001,R=P.fy||.001),v[4*j+1]=L,v[4*j+2]=R}),y=o.length,b=(0,WS.buildTextureData)(o,a),x=b.maxEdgePerVetex,w=b.array,E=i.workerEnabled,E?M=VS.World.create({canvas:e,engineOptions:{supportCompute:!0}}):M=VS.World.create({engineOptions:{supportCompute:!0}}),_=i.onLayoutEnd,k=[],S=0;S<m;S++)k.push(0,0,0,0);return A=M.createKernel(XS.fruchtermanBundle).setDispatch([y,1,1]).setBinding({u_Data:w,u_K:f,u_K2:h,u_Gravity:i.gravity,u_ClusterGravity:i.clusterGravity||i.gravity||1,u_Speed:d,u_MaxDisplace:l,u_Clustering:p?1:0,u_Center:u,u_AttributeArray:v,u_ClusterCenters:k,MAX_EDGE_PER_VERTEX:x,VERTEX_COUNT:y}),p&&(C=M.createKernel(XS.clusterBundle).setDispatch([m,1,1]).setBinding({u_Data:w,u_NodeAttributes:v,u_ClusterCenters:k,VERTEX_COUNT:y,CLUSTER_COUNT:m})),I=function(){return Nf(N,void 0,void 0,function(){var P,j;return Df(this,function(L){switch(L.label){case 0:P=0,L.label=1;case 1:return P<s?[4,A.execute()]:[3,6];case 2:return L.sent(),p?(C.setBinding({u_Data:A}),[4,C.execute()]):[3,4];case 3:L.sent(),A.setBinding({u_ClusterCenters:C}),L.label=4;case 4:A.setBinding({u_MaxDisplace:l*=.99}),L.label=5;case 5:return P++,[3,1];case 6:return[4,A.getOutput()];case 7:return j=L.sent(),e?r.postMessage({type:Aut.LAYOUT_MESSAGE.GPUEND,vertexEdgeData:j}):o.forEach(function(R,V){var tt=j[4*V],ut=j[4*V+1];R.x=tt,R.y=ut}),_&&_(),[2]}})})},[4,I()];case 1:return D.sent(),[2]}})})},n.prototype.getType=function(){return"fruchterman-gpu"},n}(kut.Base);uh.FruchtermanGPULayout=Cut;var ch={},co={};Object.defineProperty(co,"__esModule",{value:!0});co.aveMovementBundle=co.aveMovementCode=co.gForceBundle=co.gForceCode=void 0;co.gForceCode=`
import { globalInvocationID } from 'g-webgpu';

const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
const SHIFT_20 = 1048576;

@numthreads(1, 1, 1)
class GGForce {
  @in @out
  u_Data: vec4[];

  @in
  u_damping: float;
  
  @in
  u_maxSpeed: float;

  @in
  u_minMovement: float;

  @in
  u_AveMovement: vec4[];

  @in
  u_coulombDisScale: float;

  @in
  u_factor: float;

  @in
  u_NodeAttributeArray1: vec4[];

  @in
  u_NodeAttributeArray2: vec4[];

  @in
  u_interval: float;

  unpack_float(packedValue: float): ivec2 {
    const packedIntValue = int(packedValue);
    const v0 = packedIntValue / SHIFT_20;
    return [v0, packedIntValue - v0 * SHIFT_20];
  }

  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let ax = 0, ay = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const vx = currentNode[0] - nextNode[0];
        const vy = currentNode[1] - nextNode[1];
        const dist = sqrt(vx * vx + vy * vy) + 0.01;
        const n_dist = (dist + 0.1) * this.u_coulombDisScale;
        const direx = vx / dist;
        const direy = vy / dist;
        const attributesi = this.u_NodeAttributeArray1[i];
        const attributesj = this.u_NodeAttributeArray1[j];
        const massi = attributesi[0];
        const nodeStrengthi = attributesi[2];
        const nodeStrengthj = attributesj[2];
        const nodeStrength = (nodeStrengthi + nodeStrengthj) / 2;
        // const param = nodeStrength * this.u_factor / (n_dist * n_dist * massi);
        const param = nodeStrength * this.u_factor / (n_dist * n_dist);
        ax += direx * param;
        ay += direy * param;
      }
    }
    return [ax, ay];
  }

  calcGravity(i: int, currentNode: vec4, attributes2: vec4): vec2 {
    // note: attributes2 = [centerX, centerY, gravity, 0]

    const vx = currentNode[0] - attributes2[0];
    const vy = currentNode[1] - attributes2[1];
    
    const ax = vx * attributes2[2];
    const ay = vy * attributes2[2];
    
    return [ax, ay];
  }

  calcAttractive(i: int, currentNode: vec4, attributes1: vec4): vec2 {
    // note: attributes1 = [mass, degree, nodeSterngth, 0]

    const mass = attributes1[0];
    let ax = 0, ay = 0;
    // const arr_offset = int(floor(currentNode[2] + 0.5));
    // const length = int(floor(currentNode[3] + 0.5));

    const compressed = this.unpack_float(currentNode[2]);
    const length = compressed[0];
    const arr_offset = compressed[1];

    const node_buffer: vec4;
    for (let p: int = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + 4 * p; // i 节点的第 p 条边开始的小格子位置
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)]; // 大格子，大格子位置=小个子位置 / 4，
      }

      let float_j: float = node_buffer[0];

      const nextNode = this.u_Data[int(float_j)];
      const vx = nextNode[0] - currentNode[0];
      const vy = nextNode[1] - currentNode[1];
      const dist = sqrt(vx * vx + vy * vy) + 0.01;
      const direx = vx / dist;
      const direy = vy / dist;
      const edgeLength = node_buffer[1];
      const edgeStrength = node_buffer[2];
      const diff: float = edgeLength - dist;//edgeLength
      // const param = diff * this.u_stiffness / mass; //
      const param = diff * edgeStrength / mass; // 
      ax -= direx * param;
      ay -= direy * param;
    }
    return [ax, ay];
  }

  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    const movement = u_AveMovement[0];
    let ax = 0, ay = 0;

    if (i >= VERTEX_COUNT || movement.x < u_minMovement) {
      this.u_Data[i] = currentNode;
      return;
    }

    // 每个节点属性占两个数组中各一格
    // [mass, degree, nodeStrength, fx]
    const nodeAttributes1 = this.u_NodeAttributeArray1[i];
    // [centerX, centerY, centerGravity, fy]
    const nodeAttributes2 = this.u_NodeAttributeArray2[i];

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    ax += repulsive[0];
    ay += repulsive[1];

    // attractive
    const attractive = this.calcAttractive(i, currentNode, nodeAttributes1);
    ax += attractive[0];
    ay += attractive[1];

    // gravity
    const gravity = this.calcGravity(i, currentNode, nodeAttributes2);
    ax -= gravity[0];
    ay -= gravity[1];

    // speed
    const param = this.u_interval * this.u_damping;
    let vx = ax * param;
    let vy = ay * param;
    const vlength = sqrt(vx * vx + vy * vy) + 0.0001;
    if (vlength > this.u_maxSpeed) {
      const param2 = this.u_maxSpeed / vlength;
      vx = param2 * vx;
      vy = param2 * vy;
    }

    // move
    if (nodeAttributes1[3] != 0 && nodeAttributes2[3] != 0) {
      this.u_Data[i] = [
        nodeAttributes1[3],
        nodeAttributes2[3],
        currentNode[2],
        0
      ];
    } else {
      const distx = vx * this.u_interval;
      const disty = vy * this.u_interval;
      const distLength = sqrt(distx * distx + disty * disty);
      this.u_Data[i] = [
        currentNode[0] + distx,
        currentNode[1] + disty,
        currentNode[2],
        distLength
      ];
    }
    
    // the avarage move distance
    // need to share memory
    
  }
}
`;co.gForceBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {float distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\ngl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}';co.aveMovementCode=`
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class CalcAveMovement {
  @in
  u_Data: vec4[];
  @in
  u_iter: float;
  @in @out
  u_AveMovement: vec4[];
  @main
  compute() {
    let movement = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      const vertex = this.u_Data[j];
      movement += vertex[3];
    }
    movement = movement / float(VERTEX_COUNT);
    this.u_AveMovement[0] = [movement, 0, 0, 0];
  }
}
`;co.aveMovementBundle='{"shaders":{"WGSL":"","GLSL450":"","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';var Iut=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),hv=bt&&bt.__awaiter||function(t,n,e,r){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(l){try{c(r.next(l))}catch(h){a(h)}}function u(l){try{c(r.throw(l))}catch(h){a(h)}}function c(l){l.done?o(l.value):i(l.value).then(s,u)}c((r=r.apply(t,n||[])).next())})},fv=bt&&bt.__generator||function(t,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(e=0)),e;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++,i=c[1],c=[0];continue;case 7:c=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){e=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){e.label=c[1];break}if(c[0]===6&&e.label<o[1]){e.label=o[1],o=c;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(c);break}o[2]&&e.ops.pop(),e.trys.pop();continue}c=n.call(t,e)}catch(l){c=[6,l],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(ch,"__esModule",{value:!0});ch.GForceGPULayout=void 0;var Tut=Yn,jo=Ln(),HS=EN,Ro=Kr,Out=Op,qS=co,Nut=Zo,Dut=function(t){Iut(n,t);function n(e){var r=t.call(this)||this;return r.maxIteration=1e3,r.edgeStrength=200,r.nodeStrength=1e3,r.coulombDisScale=.005,r.damping=.9,r.maxSpeed=1e3,r.minMovement=.5,r.interval=.02,r.factor=1,r.linkDistance=1,r.gravity=10,r.workerEnabled=!1,r.nodes=[],r.edges=[],r.width=300,r.height=300,r.nodeMap={},r.nodeIdxMap={},r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{maxIteration:2e3,gravity:10,clustering:!1,clusterGravity:10}},n.prototype.execute=function(){return hv(this,void 0,void 0,function(){var e,r,i,o,a;return fv(this,function(s){switch(s.label){case 0:return e=this,r=e.nodes,!r||r.length===0?(e.onLayoutEnd&&e.onLayoutEnd(),[2]):(!e.width&&typeof window<"u"&&(e.width=window.innerWidth),!e.height&&typeof window<"u"&&(e.height=window.innerHeight),e.center||(e.center=[e.width/2,e.height/2]),i=e.center,r.length===1?(r[0].x=i[0],r[0].y=i[1],e.onLayoutEnd&&e.onLayoutEnd(),[2]):(o={},a={},r.forEach(function(u,c){(0,jo.isNumber)(u.x)||(u.x=Math.random()*e.width),(0,jo.isNumber)(u.y)||(u.y=Math.random()*e.height),o[u.id]=u,a[u.id]=c}),e.nodeMap=o,e.nodeIdxMap=a,e.nodeStrength=(0,Ro.proccessToFunc)(e.nodeStrength,1),e.edgeStrength=(0,Ro.proccessToFunc)(e.edgeStrength,1),[4,e.run()]));case 1:return s.sent(),[2]}})})},n.prototype.executeWithWorker=function(e,r){var i=this,o=i.nodes,a=i.center;if(!(!o||o.length===0)){if(o.length===1){o[0].x=a[0],o[0].y=a[1];return}var s={},u={};o.forEach(function(c,l){(0,jo.isNumber)(c.x)||(c.x=Math.random()*i.width),(0,jo.isNumber)(c.y)||(c.y=Math.random()*i.height),s[c.id]=c,u[c.id]=l}),i.nodeMap=s,i.nodeIdxMap=u,i.nodeStrength=(0,Ro.proccessToFunc)(i.nodeStrength,1),i.edgeStrength=(0,Ro.proccessToFunc)(i.edgeStrength,1),i.run(e,r)}},n.prototype.run=function(e,r){return hv(this,void 0,void 0,function(){var i,o,a,s,u,c,l,h,f,d,p,g,v,m,y,b,x,w,E,M,_,k,S,A,C,I,N,D=this;return fv(this,function(P){switch(P.label){case 0:for(i=this,o=i.nodes,a=i.edges,s=i.maxIteration,!i.width&&typeof window<"u"&&(i.width=window.innerWidth),!i.height&&typeof window<"u"&&(i.height=window.innerHeight),u=o.length,i.linkDistance=(0,Ro.proccessToFunc)(i.linkDistance),i.edgeStrength=(0,Ro.proccessToFunc)(i.edgeStrength),c=(0,Ro.buildTextureDataWithTwoEdgeAttr)(o,a,i.linkDistance,i.edgeStrength),l=c.maxEdgePerVetex,h=c.array,i.degrees=(0,Out.getDegree)(o.length,i.nodeIdxMap,a).map(function(j){return j.all}),f=[],d=[],p=[],g=[],v=[],m=[],y=[],i.getMass||(i.getMass=function(j){return i.degrees[i.nodeIdxMap[j.id]]||1}),b=i.gravity,x=i.center,o.forEach(function(j,L){f.push(i.getMass(j)),d.push(i.nodeStrength(j)),i.degrees[L]||(i.degrees[L]=0);var R=[x[0],x[1],b];if(i.getCenter){var V=i.getCenter(j,i.degrees[L]);V&&(0,jo.isNumber)(V[0])&&(0,jo.isNumber)(V[1])&&(0,jo.isNumber)(V[2])&&(R=V)}p.push(R[0]),g.push(R[1]),v.push(R[2]),(0,jo.isNumber)(j.fx)&&(0,jo.isNumber)(j.fy)?(m.push(j.fx||.001),y.push(j.fy||.001)):(m.push(0),y.push(0))}),w=(0,Ro.arrayToTextureData)([f,i.degrees,d,m]),E=(0,Ro.arrayToTextureData)([p,g,v,y]),M=i.workerEnabled,M?_=HS.World.create({canvas:e,engineOptions:{supportCompute:!0}}):_=HS.World.create({engineOptions:{supportCompute:!0}}),k=i.onLayoutEnd,S=[],h.forEach(function(j){S.push(j)}),A=0;A<4;A++)S.push(0);return C=_.createKernel(qS.gForceBundle).setDispatch([u,1,1]).setBinding({u_Data:h,u_damping:i.damping,u_maxSpeed:i.maxSpeed,u_minMovement:i.minMovement,u_coulombDisScale:i.coulombDisScale,u_factor:i.factor,u_NodeAttributeArray1:w,u_NodeAttributeArray2:E,MAX_EDGE_PER_VERTEX:l,VERTEX_COUNT:u,u_AveMovement:S,u_interval:i.interval}),I=_.createKernel(qS.aveMovementBundle).setDispatch([1,1,1]).setBinding({u_Data:h,VERTEX_COUNT:u,u_AveMovement:[0,0,0,0]}),N=function(){return hv(D,void 0,void 0,function(){var j,L,R;return fv(this,function(V){switch(V.label){case 0:j=0,V.label=1;case 1:return j<s?[4,C.execute()]:[3,5];case 2:return V.sent(),I.setBinding({u_Data:C}),[4,I.execute()];case 3:V.sent(),L=Math.max(.02,i.interval-j*.002),C.setBinding({u_interval:L,u_AveMovement:I}),V.label=4;case 4:return j++,[3,1];case 5:return[4,C.getOutput()];case 6:return R=V.sent(),e?r.postMessage({type:Nut.LAYOUT_MESSAGE.GPUEND,vertexEdgeData:R}):o.forEach(function(tt,ut){var dt=R[4*ut],J=R[4*ut+1];tt.x=dt,tt.y=J}),k&&k(),[2]}})})},[4,N()];case 1:return P.sent(),[2]}})})},n.prototype.getType=function(){return"gForce-gpu"},n}(Tut.Base);ch.GForceGPULayout=Dut;var lh={},Put=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(lh,"__esModule",{value:!0});lh.ComboForceLayout=void 0;var Lut=Yn,We=Ln(),jut=function(t){Put(n,t);function n(e){var r=t.call(this)||this;return r.center=[0,0],r.maxIteration=100,r.gravity=10,r.comboGravity=10,r.linkDistance=10,r.alpha=1,r.alphaMin=.001,r.alphaDecay=1-Math.pow(r.alphaMin,1/300),r.alphaTarget=0,r.velocityDecay=.6,r.edgeStrength=.6,r.nodeStrength=30,r.preventOverlap=!1,r.preventNodeOverlap=!1,r.preventComboOverlap=!1,r.collideStrength=void 0,r.nodeCollideStrength=.5,r.comboCollideStrength=.5,r.comboSpacing=20,r.comboPadding=10,r.optimizeRangeFactor=1,r.onTick=function(){},r.onLayoutEnd=function(){},r.depthAttractiveForceScale=1,r.depthRepulsiveForceScale=2,r.nodes=[],r.edges=[],r.combos=[],r.comboTrees=[],r.width=300,r.height=300,r.bias=[],r.nodeMap={},r.oriComboMap={},r.indexMap={},r.comboMap={},r.previousLayouted=!1,r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{maxIteration:100,center:[0,0],gravity:10,speed:1,comboGravity:30,preventOverlap:!1,preventComboOverlap:!0,preventNodeOverlap:!0,nodeSpacing:void 0,collideStrength:void 0,nodeCollideStrength:.5,comboCollideStrength:.5,comboSpacing:20,comboPadding:10,edgeStrength:.6,nodeStrength:30,linkDistance:10}},n.prototype.execute=function(){var e=this,r=e.nodes,i=e.center;if(e.comboTree={id:"comboTreeRoot",depth:-1,children:e.comboTrees},!r||r.length===0){e.onLayoutEnd&&e.onLayoutEnd();return}if(r.length===1){r[0].x=i[0],r[0].y=i[1],e.onLayoutEnd&&e.onLayoutEnd();return}e.initVals(),e.run(),e.onLayoutEnd&&e.onLayoutEnd()},n.prototype.run=function(){var e=this,r=e.nodes,i=e.previousLayouted?e.maxIteration/5:e.maxIteration;!e.width&&typeof window<"u"&&(e.width=window.innerWidth),!e.height&&typeof window<"u"&&(e.height=window.innerHeight);var o=e.center,a=e.velocityDecay,s=e.comboMap;e.previousLayouted||e.initPos(s);for(var u=function(f){var d=[];r.forEach(function(p,g){d[g]={x:0,y:0}}),e.applyCalculate(d),e.applyComboCenterForce(d),r.forEach(function(p,g){!(0,We.isNumber)(p.x)||!(0,We.isNumber)(p.y)||(p.x+=d[g].x*a,p.y+=d[g].y*a)}),e.alpha+=(e.alphaTarget-e.alpha)*e.alphaDecay,e.onTick()},c=0;c<i;c++)u();var l=[0,0];r.forEach(function(f){!(0,We.isNumber)(f.x)||!(0,We.isNumber)(f.y)||(l[0]+=f.x,l[1]+=f.y)}),l[0]/=r.length,l[1]/=r.length;var h=[o[0]-l[0],o[1]-l[1]];r.forEach(function(f,d){!(0,We.isNumber)(f.x)||!(0,We.isNumber)(f.y)||(f.x+=h[0],f.y+=h[1])}),e.combos.forEach(function(f){var d=s[f.id];d&&d.empty&&(f.x=d.cx||f.x,f.y=d.cy||f.y)}),e.previousLayouted=!0},n.prototype.initVals=function(){var e=this,r=e.edges,i=e.nodes,o=e.combos,a={},s={},u={};i.forEach(function(j,L){s[j.id]=j,u[j.id]=L}),e.nodeMap=s,e.indexMap=u;var c={};o.forEach(function(j){c[j.id]=j}),e.oriComboMap=c,e.comboMap=e.getComboMap();var l=e.preventOverlap;e.preventComboOverlap=e.preventComboOverlap||l,e.preventNodeOverlap=e.preventNodeOverlap||l;var h=e.collideStrength;h&&(e.comboCollideStrength=h,e.nodeCollideStrength=h),e.comboCollideStrength=e.comboCollideStrength?e.comboCollideStrength:0,e.nodeCollideStrength=e.nodeCollideStrength?e.nodeCollideStrength:0;for(var f=0;f<r.length;++f){var d=(0,We.getEdgeTerminal)(r[f],"source"),p=(0,We.getEdgeTerminal)(r[f],"target");a[d]?a[d]++:a[d]=1,a[p]?a[p]++:a[p]=1}for(var g=[],f=0;f<r.length;++f){var d=(0,We.getEdgeTerminal)(r[f],"source"),p=(0,We.getEdgeTerminal)(r[f],"target");g[f]=a[d]/(a[d]+a[p])}this.bias=g;var v=e.nodeSize,m=e.nodeSpacing,y,b;if((0,We.isNumber)(m)?b=function(){return m}:(0,We.isFunction)(m)?b=m:b=function(){return 0},this.nodeSpacing=b,!v)y=function(j){if(j.size){if((0,We.isArray)(j.size)){var L=j.size[0]>j.size[1]?j.size[0]:j.size[1];return L/2}if((0,We.isObject)(j.size)){var L=j.size.width>j.size.height?j.size.width:j.size.height;return L/2}return j.size/2}return 10};else if((0,We.isFunction)(v))y=function(j){return v(j)};else if((0,We.isArray)(v)){var x=v[0]>v[1]?v[0]:v[1],w=x/2;y=function(j){return w}}else{var E=v/2;y=function(j){return E}}this.nodeSize=y;var M=e.comboSpacing,_;(0,We.isNumber)(M)?_=function(){return M}:(0,We.isFunction)(M)?_=M:_=function(){return 0},this.comboSpacing=_;var k=e.comboPadding,S;(0,We.isNumber)(k)?S=function(){return k}:(0,We.isArray)(k)?S=function(){return Math.max.apply(null,k)}:(0,We.isFunction)(k)?S=k:S=function(){return 0},this.comboPadding=S;var A=this.linkDistance,C;A||(A=10),(0,We.isNumber)(A)?C=function(j){return A}:C=A,this.linkDistance=C;var I=this.edgeStrength,N;I||(I=1),(0,We.isNumber)(I)?N=function(j){return I}:N=I,this.edgeStrength=N;var D=this.nodeStrength,P;D||(D=30),(0,We.isNumber)(D)?P=function(j){return D}:P=D,this.nodeStrength=P},n.prototype.initPos=function(e){var r=this,i=r.nodes;i.forEach(function(o,a){var s=o.comboId,u=e[s];s&&u?(o.x=u.cx+100/(a+1),o.y=u.cy+100/(a+1)):(o.x=100/(a+1),o.y=100/(a+1))})},n.prototype.getComboMap=function(){var e=this,r=e.nodeMap,i=e.comboTrees,o=e.oriComboMap,a={};return(i||[]).forEach(function(s){var u=[];(0,We.traverseTreeUp)(s,function(c){if(c.itemType==="node"||!o[c.id])return!0;if(a[c.id]===void 0){var l={id:c.id,name:c.id,cx:0,cy:0,count:0,depth:e.oriComboMap[c.id].depth||0,children:[]};a[c.id]=l}var h=c.children;h&&h.forEach(function(p){if(!a[p.id]&&!r[p.id])return!0;u.push(p)});var f=a[c.id];if(f.cx=0,f.cy=0,u.length===0){f.empty=!0;var d=o[c.id];f.cx=d.x,f.cy=d.y}return u.forEach(function(p){if(f.count++,p.itemType!=="node"){var g=a[p.id];(0,We.isNumber)(g.cx)&&(f.cx+=g.cx),(0,We.isNumber)(g.cy)&&(f.cy+=g.cy);return}var v=r[p.id];v&&((0,We.isNumber)(v.x)&&(f.cx+=v.x),(0,We.isNumber)(v.y)&&(f.cy+=v.y))}),f.cx/=f.count||1,f.cy/=f.count||1,f.children=u,!0})}),a},n.prototype.applyComboCenterForce=function(e){var r=this,i=r.gravity,o=r.comboGravity||i,a=this.alpha,s=r.comboTrees,u=r.indexMap,c=r.nodeMap,l=r.comboMap;(s||[]).forEach(function(h){(0,We.traverseTreeUp)(h,function(f){if(f.itemType==="node")return!0;var d=l[f.id];if(!d)return!0;var p=l[f.id],g=(p.depth+1)/10*.5,v=p.cx,m=p.cy;return p.cx=0,p.cy=0,p.children.forEach(function(y){if(y.itemType!=="node"){var b=l[y.id];b&&(0,We.isNumber)(b.cx)&&(p.cx+=b.cx),b&&(0,We.isNumber)(b.cy)&&(p.cy+=b.cy);return}var x=c[y.id],w=x.x-v||.005,E=x.y-m||.005,M=Math.sqrt(w*w+E*E),_=u[x.id],k=o*a/M*g;e[_].x-=w*k,e[_].y-=E*k,(0,We.isNumber)(x.x)&&(p.cx+=x.x),(0,We.isNumber)(x.y)&&(p.cy+=x.y)}),p.cx/=p.count||1,p.cy/=p.count||1,!0})})},n.prototype.applyCalculate=function(e){var r=this,i=r.comboMap,o=r.nodes,a={};o.forEach(function(u,c){o.forEach(function(l,h){if(!(c<h)){var f=u.x-l.x||.005,d=u.y-l.y||.005,p=f*f+d*d,g=Math.sqrt(p);p<1&&(p=g),a["".concat(u.id,"-").concat(l.id)]={vx:f,vy:d,vl2:p,vl:g},a["".concat(l.id,"-").concat(u.id)]={vl2:p,vl:g,vx:-f,vy:-d}}})}),r.updateComboSizes(i),r.calRepulsive(e,a),r.calAttractive(e,a);var s=r.preventComboOverlap;s&&r.comboNonOverlapping(e,i)},n.prototype.updateComboSizes=function(e){var r=this,i=r.comboTrees,o=r.nodeMap,a=r.nodeSize,s=r.comboSpacing,u=r.comboPadding;(i||[]).forEach(function(c){var l=[];(0,We.traverseTreeUp)(c,function(h){if(h.itemType==="node")return!0;var f=e[h.id];if(!f)return!1;var d=h.children;d&&d.forEach(function(v){!e[v.id]&&!o[v.id]||l.push(v)}),f.minX=1/0,f.minY=1/0,f.maxX=-1/0,f.maxY=-1/0,l.forEach(function(v){if(v.itemType!=="node")return!0;var m=o[v.id];if(!m)return!0;var y=a(m),b=m.x-y,x=m.y-y,w=m.x+y,E=m.y+y;f.minX>b&&(f.minX=b),f.minY>x&&(f.minY=x),f.maxX<w&&(f.maxX=w),f.maxY<E&&(f.maxY=E)});var p=r.oriComboMap[h.id].size||10;(0,We.isArray)(p)&&(p=p[0]);var g=Math.max(f.maxX-f.minX,f.maxY-f.minY,p);return f.r=g/2+s(f)/2+u(f),!0})})},n.prototype.comboNonOverlapping=function(e,r){var i=this,o=i.comboTree,a=i.comboCollideStrength,s=i.indexMap,u=i.nodeMap;(0,We.traverseTreeUp)(o,function(c){if(!r[c.id]&&!u[c.id]&&c.id!=="comboTreeRoot")return!1;var l=c.children;return l&&l.length>1&&l.forEach(function(h,f){if(h.itemType==="node")return!1;var d=r[h.id];d&&l.forEach(function(p,g){if(f<=g||p.itemType==="node")return!1;var v=r[p.id];if(!v)return!1;var m=d.cx-v.cx||.005,y=d.cy-v.cy||.005,b=m*m+y*y,x=d.r||1,w=v.r||1,E=x+w,M=w*w,_=x*x;if(b<E*E){var k=h.children;if(!k||k.length===0)return!1;var S=p.children;if(!S||S.length===0)return!1;var A=Math.sqrt(b),C=(E-A)/A*a,I=m*C,N=y*C,D=M/(_+M),P=1-D;k.forEach(function(j){if(j.itemType!=="node")return!1;if(u[j.id]){var L=s[j.id];S.forEach(function(R){if(R.itemType!=="node"||!u[R.id])return!1;var V=s[R.id];e[L].x+=I*D,e[L].y+=N*D,e[V].x-=I*P,e[V].y-=N*P})}})}})}),!0})},n.prototype.calRepulsive=function(e,r){var i=this,o=i.nodes,a=i.width*i.optimizeRangeFactor,s=i.nodeStrength,u=i.alpha,c=i.nodeCollideStrength,l=i.preventNodeOverlap,h=i.nodeSize,f=i.nodeSpacing,d=i.depthRepulsiveForceScale,p=i.center;o.forEach(function(g,v){if(!(!g.x||!g.y)){if(p){var m=i.gravity,y=g.x-p[0]||.005,b=g.y-p[1]||.005,x=Math.sqrt(y*y+b*b);e[v].x-=y*m*u/x,e[v].y-=b*m*u/x}o.forEach(function(w,E){if(v!==E&&!(!w.x||!w.y)){var M=r["".concat(g.id,"-").concat(w.id)],_=M.vl2,k=M.vl;if(!(k>a)){var S=r["".concat(g.id,"-").concat(w.id)],A=S.vx,C=S.vy,I=Math.log(Math.abs(w.depth-g.depth)/10)+1||1;I=I<1?1:I,w.comboId!==g.comboId&&(I+=1);var N=I?Math.pow(d,I):1,D=s(w)*u/_*N;if(e[v].x+=A*D,e[v].y+=C*D,v<E&&l){var P=h(g)+f(g)||1,j=h(w)+f(w)||1,L=P+j;if(_<L*L){var R=(L-k)/k*c,V=j*j,tt=V/(P*P+V),ut=A*R,dt=C*R;e[v].x+=ut*tt,e[v].y+=dt*tt,tt=1-tt,e[E].x-=ut*tt,e[E].y-=dt*tt}}}}})}})},n.prototype.calAttractive=function(e,r){var i=this,o=i.edges,a=i.linkDistance,s=i.alpha,u=i.edgeStrength,c=i.bias,l=i.depthAttractiveForceScale;o.forEach(function(h,f){var d=(0,We.getEdgeTerminal)(h,"source"),p=(0,We.getEdgeTerminal)(h,"target");if(!(!d||!p||d===p)){var g=i.indexMap[d],v=i.indexMap[p],m=i.nodeMap[d],y=i.nodeMap[p];if(!(!m||!y)){var b=m.depth===y.depth?0:Math.log(Math.abs(m.depth-y.depth)/10);m.comboId===y.comboId&&(b=b/2);var x=b?Math.pow(l,b):1;if(m.comboId!==y.comboId&&x===1?x=l/2:m.comboId===y.comboId&&(x=2),!(!(0,We.isNumber)(y.x)||!(0,We.isNumber)(m.x)||!(0,We.isNumber)(y.y)||!(0,We.isNumber)(m.y))){var w=r["".concat(p,"-").concat(d)],E=w.vl,M=w.vx,_=w.vy,k=(E-a(h))/E*s*u(h)*x,S=M*k,A=_*k,C=c[f];e[v].x-=S*C,e[v].y-=A*C,e[g].x+=S*(1-C),e[g].y+=A*(1-C)}}}})},n.prototype.getType=function(){return"comboForce"},n}(Lut.Base);lh.ComboForceLayout=jut;var Pc={},ZS;function MN(){if(ZS)return Pc;ZS=1;var t=bt&&bt.__extends||function(){var s=function(u,c){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,h){l.__proto__=h}||function(l,h){for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(l[f]=h[f])},s(u,c)};return function(u,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");s(u,c);function l(){this.constructor=u}u.prototype=c===null?Object.create(c):(l.prototype=c.prototype,new l)}}(),n=bt&&bt.__assign||function(){return n=Object.assign||function(s){for(var u,c=1,l=arguments.length;c<l;c++){u=arguments[c];for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(s[h]=u[h])}return s},n.apply(this,arguments)};Object.defineProperty(Pc,"__esModule",{value:!0}),Pc.ComboCombinedLayout=void 0;var e=Zo,r=Yn,i=Ln(),o=ON(),a=function(s){t(u,s);function u(c){var l=s.call(this)||this;return l.center=[0,0],l.nodes=[],l.edges=[],l.combos=[],l.comboEdges=[],l.comboPadding=10,l.comboTrees=[],l.updateCfg(c),l}return u.prototype.getDefaultCfg=function(){return{}},u.prototype.execute=function(){var c=this,l=c.nodes,h=c.center;if(!l||l.length===0){c.onLayoutEnd&&c.onLayoutEnd();return}if(l.length===1){l[0].x=h[0],l[0].y=h[1],c.onLayoutEnd&&c.onLayoutEnd();return}c.initVals(),c.run(),c.onLayoutEnd&&c.onLayoutEnd()},u.prototype.run=function(){var c,l=this,h=l.nodes,f=l.edges,d=l.combos,p=l.comboEdges,g=l.center,v={};h.forEach(function(D){v[D.id]=D});var m={};d.forEach(function(D){m[D.id]=D});var y=l.getInnerGraphs(v),b=[],x=[],w={},E=!0;this.comboTrees.forEach(function(D){var P=y[D.id],j=n(n({},D),{x:P.x||m[D.id].x,y:P.y||m[D.id].y,fx:P.fx||m[D.id].fx,fy:P.fy||m[D.id].fy,mass:P.mass||m[D.id].mass,size:P.size});x.push(j),!isNaN(j.x)&&j.x!==0&&!isNaN(j.y)&&j.y!==0?E=!1:(j.x=Math.random()*100,j.y=Math.random()*100),b.push(D.id),(0,i.traverseTreeUp)(D,function(L){return L.id!==D.id&&(w[L.id]=D.id),!0})}),h.forEach(function(D){if(!(D.comboId&&m[D.comboId])){var P=n({},D);x.push(P),!isNaN(P.x)&&P.x!==0&&!isNaN(P.y)&&P.y!==0?E=!1:(P.x=Math.random()*100,P.y=Math.random()*100),b.push(D.id)}});var M=[];if(f.concat(p).forEach(function(D){var P=w[D.source]||D.source,j=w[D.target]||D.target;P!==j&&b.includes(P)&&b.includes(j)&&M.push({source:P,target:j})}),x!=null&&x.length){if(x.length===1)x[0].x=g[0],x[0].y=g[1];else{var _={nodes:x,edges:M},k=this.outerLayout||new o.GForceLayout({gravity:1,factor:4,linkDistance:function(D,P,j){var L,R,V=((((L=P.size)===null||L===void 0?void 0:L[0])||30)+(((R=j.size)===null||R===void 0?void 0:R[0])||30))/2;return Math.min(V*1.5,700)}}),S=(c=k.getType)===null||c===void 0?void 0:c.call(k);if(k.updateCfg({center:g,kg:5,preventOverlap:!0,animate:!1}),E&&e.FORCE_LAYOUT_TYPE_MAP[S]){var A=x.length<100?new o.MDSLayout:new o.GridLayout;A.layout(_)}k.layout(_)}x.forEach(function(D){var P=y[D.id];if(!P){var j=v[D.id];j&&(j.x=D.x,j.y=D.y);return}P.visited=!0,P.x=D.x,P.y=D.y,P.nodes.forEach(function(L){L.x+=D.x,L.y+=D.y})})}for(var C=Object.keys(y),I=function(D){var P=C[D],j=y[P];if(!j)return"continue";j.nodes.forEach(function(L){j.visited||(L.x+=j.x||0,L.y+=j.y||0),v[L.id]&&(v[L.id].x=L.x,v[L.id].y=L.y)}),m[P]&&(m[P].x=j.x,m[P].y=j.y)},N=C.length-1;N>=0;N--)I(N);return{nodes:h,edges:f,combos:d,comboEdges:p}},u.prototype.getInnerGraphs=function(c){var l=this,h=l.comboTrees,f=l.nodeSize,d=l.edges,p=l.comboPadding,g=l.spacing,v={},m=this.innerLayout||new o.ConcentricLayout({type:"concentric",sortBy:"id"});return m.center=[0,0],m.preventOverlap=!0,m.nodeSpacing=g,(h||[]).forEach(function(y){(0,i.traverseTreeUp)(y,function(b){var x,w=(p==null?void 0:p(b))||10;if((0,i.isArray)(w)&&(w=Math.max.apply(Math,w)),!((x=b.children)===null||x===void 0)&&x.length){var E=b.children.map(function(R){if(R.itemType==="combo")return v[R.id];var V=c[R.id]||{};return n(n({},V),R)}),M=E.map(function(R){return R.id}),_={nodes:E,edges:d.filter(function(R){return M.includes(R.source)&&M.includes(R.target)})},k=1/0;E.forEach(function(R){var V;R.size||(R.size=((V=v[R.id])===null||V===void 0?void 0:V.size)||(f==null?void 0:f(R))||[30,30]),(0,i.isNumber)(R.size)&&(R.size=[R.size,R.size]),k>R.size[0]&&(k=R.size[0]),k>R.size[1]&&(k=R.size[1])}),m.layout(_);var S=(0,i.getLayoutBBox)(E),A=S.minX,C=S.minY,I=S.maxX,N=S.maxY,D={x:(I+A)/2,y:(N+C)/2};_.nodes.forEach(function(R){R.x-=D.x,R.y-=D.y});var P=Math.max(I-A,k)+w*2,j=Math.max(N-C,k)+w*2;v[b.id]={id:b.id,nodes:E,size:[P,j]}}else if(b.itemType==="combo"){var L=w?[w*2,w*2]:[30,30];v[b.id]={id:b.id,nodes:[],size:L}}return!0})}),v},u.prototype.initVals=function(){var c=this,l=c.nodeSize,h=c.spacing,f,d;if((0,i.isNumber)(h)?d=function(){return h}:(0,i.isFunction)(h)?d=h:d=function(){return 0},this.spacing=d,!l)f=function(b){var x=d(b);if(b.size){if((0,i.isArray)(b.size)){var w=b.size[0]>b.size[1]?b.size[0]:b.size[1];return(w+x)/2}if((0,i.isObject)(b.size)){var w=b.size.width>b.size.height?b.size.width:b.size.height;return(w+x)/2}return(b.size+x)/2}return 10+x/2};else if((0,i.isFunction)(l))f=function(b){var x=l(b),w=d(b);if((0,i.isArray)(b.size)){var E=b.size[0]>b.size[1]?b.size[0]:b.size[1];return(E+w)/2}return((x||10)+w)/2};else if((0,i.isArray)(l)){var p=l[0]>l[1]?l[0]:l[1],g=p/2;f=function(b){return g+d(b)/2}}else{var v=l/2;f=function(b){return v+d(b)/2}}this.nodeSize=f;var m=c.comboPadding,y;(0,i.isNumber)(m)?y=function(){return m}:(0,i.isArray)(m)?y=function(){return Math.max.apply(null,m)}:(0,i.isFunction)(m)?y=m:y=function(){return 0},this.comboPadding=y},u.prototype.getType=function(){return"comboCombined"},u}(r.Base);return Pc.ComboCombinedLayout=a,Pc}var hh={},ub={};Object.defineProperty(ub,"__esModule",{value:!0});var Rut=function(){function t(n){this.id=n.id||0,this.rx=n.rx,this.ry=n.ry,this.fx=0,this.fy=0,this.mass=n.mass,this.degree=n.degree,this.g=n.g||0}return t.prototype.distanceTo=function(n){var e=this.rx-n.rx,r=this.ry-n.ry;return Math.hypot(e,r)},t.prototype.setPos=function(n,e){this.rx=n,this.ry=e},t.prototype.resetForce=function(){this.fx=0,this.fy=0},t.prototype.addForce=function(n){var e=n.rx-this.rx,r=n.ry-this.ry,i=Math.hypot(e,r);i=i<1e-4?1e-4:i;var o=this.g*(this.degree+1)*(n.degree+1)/i;this.fx+=o*e/i,this.fy+=o*r/i},t.prototype.in=function(n){return n.contains(this.rx,this.ry)},t.prototype.add=function(n){var e=this.mass+n.mass,r=(this.rx*this.mass+n.rx*n.mass)/e,i=(this.ry*this.mass+n.ry*n.mass)/e,o=this.degree+n.degree,a={rx:r,ry:i,mass:e,degree:o};return new t(a)},t}();ub.default=Rut;var cb={};Object.defineProperty(cb,"__esModule",{value:!0});var Fut=function(){function t(n){this.xmid=n.xmid,this.ymid=n.ymid,this.length=n.length,this.massCenter=n.massCenter||[0,0],this.mass=n.mass||1}return t.prototype.getLength=function(){return this.length},t.prototype.contains=function(n,e){var r=this.length/2;return n<=this.xmid+r&&n>=this.xmid-r&&e<=this.ymid+r&&e>=this.ymid-r},t.prototype.NW=function(){var n=this.xmid-this.length/4,e=this.ymid+this.length/4,r=this.length/2,i={xmid:n,ymid:e,length:r},o=new t(i);return o},t.prototype.NE=function(){var n=this.xmid+this.length/4,e=this.ymid+this.length/4,r=this.length/2,i={xmid:n,ymid:e,length:r},o=new t(i);return o},t.prototype.SW=function(){var n=this.xmid-this.length/4,e=this.ymid-this.length/4,r=this.length/2,i={xmid:n,ymid:e,length:r},o=new t(i);return o},t.prototype.SE=function(){var n=this.xmid+this.length/4,e=this.ymid-this.length/4,r=this.length/2,i={xmid:n,ymid:e,length:r},o=new t(i);return o},t}();cb.default=Fut;var lb={};Object.defineProperty(lb,"__esModule",{value:!0});var But=function(){function t(n){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,n!=null&&(this.quad=n)}return t.prototype.insert=function(n){if(this.body==null){this.body=n;return}this._isExternal()?(this.quad&&(this.NW=new t(this.quad.NW()),this.NE=new t(this.quad.NE()),this.SW=new t(this.quad.SW()),this.SE=new t(this.quad.SE())),this._putBody(this.body),this._putBody(n),this.body=this.body.add(n)):(this.body=this.body.add(n),this._putBody(n))},t.prototype._putBody=function(n){this.quad&&(n.in(this.quad.NW())&&this.NW?this.NW.insert(n):n.in(this.quad.NE())&&this.NE?this.NE.insert(n):n.in(this.quad.SW())&&this.SW?this.SW.insert(n):n.in(this.quad.SE())&&this.SE&&this.SE.insert(n))},t.prototype._isExternal=function(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null},t.prototype.updateForce=function(n){if(!(this.body==null||n===this.body))if(this._isExternal())n.addForce(this.body);else{var e=this.quad?this.quad.getLength():0,r=this.body.distanceTo(n);e/r<this.theta?n.addForce(this.body):(this.NW&&this.NW.updateForce(n),this.NE&&this.NE.updateForce(n),this.SW&&this.SW.updateForce(n),this.SE&&this.SE.updateForce(n))}},t}();lb.default=But;var zut=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),hb=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(hh,"__esModule",{value:!0});hh.ForceAtlas2Layout=void 0;var Gut=Yn,Fo=Ln(),Uut=hb(ub),Yut=hb(cb),Vut=hb(lb),Wut=function(t){zut(n,t);function n(e){var r=t.call(this)||this;return r.center=[0,0],r.width=300,r.height=300,r.nodes=[],r.edges=[],r.kr=5,r.kg=1,r.mode="normal",r.preventOverlap=!1,r.dissuadeHubs=!1,r.barnesHut=void 0,r.maxIteration=0,r.ks=.1,r.ksmax=10,r.tao=.1,r.onLayoutEnd=function(){},r.prune=void 0,r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{}},n.prototype.execute=function(){var e=this,r=e.nodes,i=e.onLayoutEnd,o=e.prune,a=e.maxIteration;!e.width&&typeof window<"u"&&(e.width=window.innerWidth),!e.height&&typeof window<"u"&&(e.height=window.innerHeight);for(var s=[],u=r.length,c=0;c<u;c+=1){var l=r[c],h=10,f=10;(0,Fo.isNumber)(l.size)&&(h=l.size,f=l.size),(0,Fo.isArray)(l.size)?(isNaN(l.size[0])||(h=l.size[0]),isNaN(l.size[1])||(f=l.size[1])):(0,Fo.isObject)(l.size)&&(h=l.size.width,f=l.size.height),e.getWidth&&!isNaN(e.getWidth(l))&&(f=e.getWidth(l)),e.getHeight&&!isNaN(e.getHeight(l))&&(h=e.getHeight(l));var d=Math.max(h,f);s.push(d)}e.barnesHut===void 0&&u>250&&(e.barnesHut=!0),e.prune===void 0&&u>100&&(e.prune=!0),this.maxIteration===0&&!e.prune?(a=250,u<=200&&u>100?a=1e3:u>200&&(a=1200),this.maxIteration=a):this.maxIteration===0&&o&&(a=100,u<=200&&u>100?a=500:u>200&&(a=950),this.maxIteration=a),e.kr||(e.kr=50,u>100&&u<=500?e.kr=20:u>500&&(e.kr=1)),e.kg||(e.kg=20,u>100&&u<=500?e.kg=10:u>500&&(e.kg=1)),this.nodes=e.updateNodesByForces(s),i()},n.prototype.updateNodesByForces=function(e){for(var r=this,i=r.edges,o=r.maxIteration,a=r.nodes,s=i.filter(function(M){var _=(0,Fo.getEdgeTerminal)(M,"source"),k=(0,Fo.getEdgeTerminal)(M,"target");return _!==k}),u=a.length,c=s.length,l=[],h={},f={},d=[],p=0;p<u;p+=1)h[a[p].id]=p,l[p]=0,(a[p].x===void 0||isNaN(a[p].x))&&(a[p].x=Math.random()*1e3),(a[p].y===void 0||isNaN(a[p].y))&&(a[p].y=Math.random()*1e3),d.push({x:a[p].x,y:a[p].y});for(var p=0;p<c;p+=1){for(var g=void 0,v=void 0,m=0,y=0,b=0;b<u;b+=1){var x=(0,Fo.getEdgeTerminal)(s[p],"source"),w=(0,Fo.getEdgeTerminal)(s[p],"target");a[b].id===x?(g=a[b],m=b):a[b].id===w&&(v=a[b],y=b),f[p]={sourceIdx:m,targetIdx:y}}g&&(l[h[g.id]]+=1),v&&(l[h[v.id]]+=1)}var E=o;if(a=this.iterate(E,h,f,c,l,e),r.prune){for(var b=0;b<c;b+=1)l[f[b].sourceIdx]<=1?(a[f[b].sourceIdx].x=a[f[b].targetIdx].x,a[f[b].sourceIdx].y=a[f[b].targetIdx].y):l[f[b].targetIdx]<=1&&(a[f[b].targetIdx].x=a[f[b].sourceIdx].x,a[f[b].targetIdx].y=a[f[b].sourceIdx].y);r.prune=!1,r.barnesHut=!1,E=100,a=this.iterate(E,h,f,c,l,e)}return a},n.prototype.iterate=function(e,r,i,o,a,s){for(var u=this,c=u.nodes,l=u.kr,h=u.preventOverlap,f=u.barnesHut,d=c.length,p=0,g=100,v=e,m=50,y=[],b=[],x=[],w=0;w<d;w+=1)if(y[2*w]=0,y[2*w+1]=0,f){var E={id:w,rx:c[w].x,ry:c[w].y,mass:1,g:l,degree:a[w]};x[w]=new Uut.default(E)}for(;v>0;){for(var w=0;w<d;w+=1)b[2*w]=y[2*w],b[2*w+1]=y[2*w+1],y[2*w]=0,y[2*w+1]=0;y=this.getAttrForces(v,m,o,r,i,a,s,y),f&&(h&&v>m||!h)?y=this.getOptRepGraForces(y,x,a):y=this.getRepGraForces(v,m,y,g,s,a);var M=this.updatePos(y,b,p,a);c=M.nodes,p=M.sg,v--,u.tick&&u.tick()}return c},n.prototype.getAttrForces=function(e,r,i,o,a,s,u,c){for(var l=this,h=l.nodes,f=l.preventOverlap,d=l.dissuadeHubs,p=l.mode,g=l.prune,v=0;v<i;v+=1){var m=h[a[v].sourceIdx],y=a[v].sourceIdx,b=h[a[v].targetIdx],x=a[v].targetIdx;if(!(g&&(s[y]<=1||s[x]<=1))){var w=[b.x-m.x,b.y-m.y],E=Math.hypot(w[0],w[1]);E=E<1e-4?1e-4:E,w[0]=w[0]/E,w[1]=w[1]/E,f&&e<r&&(E=E-u[y]-u[x]);var M=E,_=M;p==="linlog"&&(M=Math.log(1+E),_=M),d&&(M=E/s[y],_=E/s[x]),f&&e<r&&E<=0?(M=0,_=0):f&&e<r&&E>0&&(M=E,_=E),c[2*o[m.id]]+=M*w[0],c[2*o[b.id]]-=_*w[0],c[2*o[m.id]+1]+=M*w[1],c[2*o[b.id]+1]-=_*w[1]}}return c},n.prototype.getRepGraForces=function(e,r,i,o,a,s){for(var u=this,c=u.nodes,l=u.preventOverlap,h=u.kr,f=u.kg,d=u.center,p=u.prune,g=c.length,v=0;v<g;v+=1){for(var m=v+1;m<g;m+=1)if(!(p&&(s[v]<=1||s[m]<=1))){var y=[c[m].x-c[v].x,c[m].y-c[v].y],b=Math.hypot(y[0],y[1]);b=b<1e-4?1e-4:b,y[0]=y[0]/b,y[1]=y[1]/b,l&&e<r&&(b=b-a[v]-a[m]);var x=h*(s[v]+1)*(s[m]+1)/b;l&&e<r&&b<0?x=o*(s[v]+1)*(s[m]+1):l&&e<r&&b===0?x=0:l&&e<r&&b>0&&(x=h*(s[v]+1)*(s[m]+1)/b),i[2*v]-=x*y[0],i[2*m]+=x*y[0],i[2*v+1]-=x*y[1],i[2*m+1]+=x*y[1]}var w=[c[v].x-d[0],c[v].y-d[1]],E=Math.hypot(w[0],w[1]);w[0]=w[0]/E,w[1]=w[1]/E;var M=f*(s[v]+1);i[2*v]-=M*w[0],i[2*v+1]-=M*w[1]}return i},n.prototype.getOptRepGraForces=function(e,r,i){for(var o=this,a=o.nodes,s=o.kg,u=o.center,c=o.prune,l=a.length,h=9e10,f=-9e10,d=9e10,p=-9e10,g=0;g<l;g+=1)c&&i[g]<=1||(r[g].setPos(a[g].x,a[g].y),a[g].x>=f&&(f=a[g].x),a[g].x<=h&&(h=a[g].x),a[g].y>=p&&(p=a[g].y),a[g].y<=d&&(d=a[g].y));for(var v=Math.max(f-h,p-d),m={xmid:(f+h)/2,ymid:(p+d)/2,length:v,massCenter:u,mass:l},y=new Yut.default(m),b=new Vut.default(y),g=0;g<l;g+=1)c&&i[g]<=1||r[g].in(y)&&b.insert(r[g]);for(var g=0;g<l;g+=1)if(!(c&&i[g]<=1)){r[g].resetForce(),b.updateForce(r[g]),e[2*g]-=r[g].fx,e[2*g+1]-=r[g].fy;var x=[a[g].x-u[0],a[g].y-u[1]],w=Math.hypot(x[0],x[1]);w=w<1e-4?1e-4:w,x[0]=x[0]/w,x[1]=x[1]/w;var E=s*(i[g]+1);e[2*g]-=E*x[0],e[2*g+1]-=E*x[1]}return e},n.prototype.updatePos=function(e,r,i,o){for(var a=this,s=a.nodes,u=a.ks,c=a.tao,l=a.prune,h=a.ksmax,f=s.length,d=[],p=[],g=0,v=0,m=0;m<f;m+=1)if(!(l&&o[m]<=1)){var y=[e[2*m]-r[2*m],e[2*m+1]-r[2*m+1]],b=Math.hypot(y[0],y[1]),x=[e[2*m]+r[2*m],e[2*m+1]+r[2*m+1]],w=Math.hypot(x[0],x[1]);d[m]=b,p[m]=w/2,g+=(o[m]+1)*d[m],v+=(o[m]+1)*p[m]}var E=i;i=c*v/g,E!==0&&(i=i>1.5*E?1.5*E:i);for(var m=0;m<f;m+=1)if(!(l&&o[m]<=1)&&!((0,Fo.isNumber)(s[m].fx)&&(0,Fo.isNumber)(s[m].fy))){var M=u*i/(1+i*Math.sqrt(d[m])),_=Math.hypot(e[2*m],e[2*m+1]);_=_<1e-4?1e-4:_;var k=h/_;M=M>k?k:M;var S=M*e[2*m],A=M*e[2*m+1];s[m].x+=S,s[m].y+=A}return{nodes:s,sg:i}},n}(Gut.Base);hh.ForceAtlas2Layout=Wut;var fh={},fb={},db={},pb={},Mu=bt&&bt.__assign||function(){return Mu=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Mu.apply(this,arguments)};Object.defineProperty(pb,"__esModule",{value:!0});var Xut=function(){function t(){this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}return t.prototype.init=function(n,e,r){this.cells=[],this.CELL_W=r.CELL_W||t.DEFAULT_CELL_W,this.CELL_H=r.CELL_H||t.DEFAULT_CELL_H,this.columnNum=Math.ceil(n/this.CELL_W),this.rowNum=Math.ceil(e/this.CELL_H),t.MIN_DIST=Math.pow(n,2)+Math.pow(e,2);for(var i=0;i<this.columnNum;i++){for(var o=[],a=0;a<this.rowNum;a++){var s={dx:i,dy:a,x:i*this.CELL_W,y:a*this.CELL_H,occupied:!1};o.push(s)}this.cells.push(o)}},t.prototype.findGridByNodeId=function(n){for(var e,r,i=0;i<this.columnNum;i++)for(var o=0;o<this.rowNum;o++)if(this.cells[i][o].node&&((r=(e=this.cells[i][o])===null||e===void 0?void 0:e.node)===null||r===void 0?void 0:r.id)===n)return{column:i,row:o};return null},t.prototype.sqdist=function(n,e){return Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)},t.prototype.occupyNearest=function(n){for(var e=t.MIN_DIST,r,i=null,o=0;o<this.columnNum;o++)for(var a=0;a<this.rowNum;a++)!this.cells[o][a].occupied&&(r=this.sqdist(n,this.cells[o][a]))<e&&(e=r,i=this.cells[o][a]);return i&&(i.occupied=!0),i},t.prototype.insertColumn=function(n,e){if(!(e<=0)){for(var r=0;r<e;r++){this.cells[r+this.columnNum]=[];for(var i=0;i<this.rowNum;i++)this.cells[r+this.columnNum][i]={dx:r,dy:i,x:r*this.CELL_W,y:i*this.CELL_H,occupied:!1,node:null}}for(var r=this.columnNum-1;r>n;r--)for(var i=0;i<this.rowNum;i++)this.cells[r+e][i]=Mu(Mu({},this.cells[r][i]),{x:(r+e)*this.CELL_W,y:i*this.CELL_H}),this.cells[r][i]={x:r*this.CELL_W,y:i*this.CELL_H,occupied:!0,node:null};for(var i=0;i<this.additionColumn.length;i++)this.additionColumn[i]>=n&&(this.additionColumn[i]+=e);for(var r=0;r<e;r++)this.additionColumn.push(n+r+1);this.columnNum+=e}},t.prototype.insertRow=function(n,e){if(!(e<=0)){for(var r=0;r<e;r++)for(var i=0;i<this.columnNum;i++)this.cells[i][r+this.rowNum]={dx:i,dy:r,x:i*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null};for(var i=0;i<this.columnNum;i++)for(var r=this.rowNum-1;r>n;r--)this.cells[i][r+e]=Mu(Mu({},this.cells[i][r]),{dx:i,dy:r+e,x:i*this.CELL_W,y:(r+e)*this.CELL_H}),this.cells[i][r]={dx:i,dy:r,x:i*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null};for(var r=0;r<this.additionRow.length;r++)this.additionRow[r]>=n&&(this.additionRow[r]+=e);for(var i=0;i<e;i++)this.additionRow.push(n+i+1);this.rowNum+=e}},t.prototype.getNodes=function(){for(var n=[],e=0;e<this.columnNum;e++)for(var r=0;r<this.rowNum;r++)this.cells[e][r].node&&n.push(this.cells[e][r]);return n},t.MIN_DIST=50,t.DEFAULT_CELL_W=80,t.DEFAULT_CELL_H=80,t}();pb.default=Xut;var Hut=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(db,"__esModule",{value:!0});var qut=Hut(pb);function Zut(t,n){if(!t.nodes||t.nodes.length===0)return t;var e=n.width,r=n.height,i=n.nodeMinGap,o=1e4,a=1e4;t.nodes.forEach(function(y){var b=y.size[0]||50,x=y.size[1]||50;o=Math.min(b,o),a=Math.min(x,a)});var s=new qut.default;s.init(e,r,{CELL_H:a,CELL_W:o}),t.nodes.forEach(function(y){var b=s.occupyNearest(y);b&&(b.node={id:y.id,size:y.size},y.x=b.x,y.y=b.y,y.dx=b.dx,y.dy=b.dy)});for(var u=0;u<t.nodes.length;u++){var c=t.nodes[u],l=s.findGridByNodeId(c.id);if(!l)throw new Error("can not find node cell");var h=l.column,f=l.row;if(c.size[0]+i>o){for(var d=Math.ceil((c.size[0]+i)/o)-1,p=d,g=0;g<d;g++){var v=s.additionColumn.indexOf(h+g+1)>-1;if(v&&!s.cells[h+g+1][f].node)p--;else break}s.insertColumn(h,p)}if(c.size[1]+i>a){for(var d=Math.ceil((c.size[1]+i)/a)-1,p=d,g=0;g<d;g++){var v=s.additionRow.indexOf(f+g+1)>-1;if(v&&!s.cells[h][f+g+1].node)p--;else break}s.insertRow(f,p)}}for(var u=0;u<s.columnNum;u++)for(var m=function(x){var w=s.cells[u][x];if(w.node){var E=t.nodes.find(function(M){var _;return M.id===((_=w==null?void 0:w.node)===null||_===void 0?void 0:_.id)});E&&(E.x=w.x+E.size[0]/2,E.y=w.y+E.size[1]/2)}},g=0;g<s.rowNum;g++)m(g)}db.default=Zut;var gb={};Object.defineProperty(gb,"__esModule",{value:!0});var SN=1200,_N=800,Pf=1e7,Lc=10,kN=3.141592653589793,dv=1.5707963267948966,Kut=kN*.375,Qut=kN*.625,hd=new Map,Jut=10,$ut=10,pv=.8,KS=.1,tct=.5;function ect(t,n,e){var r=t.x-t.size[0]/2,i=t.y-t.size[1]/2,o=t.x+t.size[0]/2,a=t.y+t.size[1]/2,s=n.x-n.size[0]/2,u=n.y-n.size[1]/2,c=n.x+n.size[0]/2,l=n.y+n.size[1]/2,h=t.x,f=t.y,d=n.x,p=n.y,g=d-h,v=Math.atan2(g,p-f),m=0,y=0,b=0,x=0;v>dv?(y=i-l,m=s-o,b=parseFloat(y?(y/Math.cos(v)).toFixed(2):m.toFixed(2)),x=parseFloat(m?(m/Math.sin(v)).toFixed(2):y.toFixed(2))):0<v&&v<=dv?(y=u-a,m=s-o,y>m?b=x=parseFloat(y?(y/Math.cos(v)).toFixed(2):m.toFixed(2)):b=x=parseFloat(m?(m/Math.sin(v)).toFixed(2):y.toFixed(2))):v<-dv?(y=i-l,m=-(c-r),y>m?b=x=parseFloat(y?(y/Math.cos(v)).toFixed(2):m.toFixed(2)):b=x=parseFloat(m?(m/Math.sin(v)).toFixed(2):y.toFixed(2))):(y=u-a,Math.abs(g)>(o-r)/2?m=r-c:m=g,y>m?b=x=parseFloat(y?(y/Math.cos(v)).toFixed(2):m.toFixed(2)):b=x=parseFloat(m&&v!==0?(m/Math.sin(v)).toFixed(2):y.toFixed(2)));var w=parseFloat(v.toFixed(2)),E=e;return e&&(E=Kut<w&&w<Qut),{distance:Math.abs(b<x?b:x),isHoriz:E}}function AN(t,n){var e=hd.get(t.id)||[],r=e.find(function(P){return P.source===n.id||P.target===n.id}),i=t.size[0]*t.size[1],o=n.size[0]*n.size[1],a=i>o?n:t,s=i>o?t:n,u=a.x-a.size[0]/2,c=a.y-a.size[1]/2,l=a.x+a.size[0]/2,h=a.y+a.size[1]/2,f=s.x-s.size[0]/2,d=s.y-s.size[1]/2,p=s.x+s.size[0]/2,g=s.y+s.size[1]/2,v=a.x,m=a.y,y=s.x,b=s.y,x=l>=f&&p>=u&&h>=d&&g>=c,w=0,E=0;if(x){E=Math.sqrt(Math.pow(y-v,2)+Math.pow(b-m,2));var M=u>f?u:f,_=c>d?c:d,k=l<p?l:p,S=h<g?h:g,A=k-M,C=S-_,I=A*C;E===0&&(E=1e-7),w=Lc*1/E*100+I,w*=Pf}else{var N=!1,D=ect(a,s,N);E=D.distance,N=D.isHoriz,E<=Lc?E!==0?r?w+=Lc+Pf*1/E:w+=Lc+Pf*Lc/E:w+=Pf:(w+=E,r&&(w+=E*E))}return w}function CN(t){for(var n=0,e=0;e<t.length;e++){var r=t[e];(r.x<0||r.y<0||r.x>SN||r.y>_N)&&(n+=1e12);for(var i=e+1;i<t.length;i++)n+=AN(r,t[i])}return n}function nct(t,n,e,r){var i=new Map;e.forEach(function(v,m){i.set(v.id,v)});var o=r.filter(function(v){return v.source===t.id||v.target===t.id})||[],a=[];o.forEach(function(v){var m=v.source===t.id?v.target:v.source,y=i.get(m);y&&a.push(y)});for(var s=!0,u=0;u<a.length;u++){var c=a[u],l=Math.atan((t.y-c.y)/(c.x-t.y))*180,h=Math.atan((n.y-c.y)/(c.x-n.y))*180,f=l<30||l>150,d=h<30||h>150,p=l>70&&l<110,g=h>70&&h<110;if(f&&!d||l*h<0){s=!1;break}else if(p&&!g||l*h<0){s=!1;break}else if((c.x-t.x)*(c.x-n.x)<0){s=!1;break}else if((c.y-t.y)*(c.y-n.y)<0){s=!1;break}}return s}function rct(t,n){for(var e=!1,r=1,i=Jut*r,o=$ut*r,a=[i,-i,0,0],s=[0,0,o,-o],u=0;u<t.length;++u)for(var c=t[u],l=QS(c,t),h=0;h<a.length;h++){var f=nct(c,{x:c.x+a[h],y:c.y+s[h]},t,n);if(f){c.x+=a[h],c.y+=s[h];var d=QS(c,t),p=Math.random();d<l||p<pv&&p>KS?(l=d,e=!0):(c.x-=a[h],c.y-=s[h])}}return pv>KS&&(pv*=tct),e?CN(t):0}function QS(t,n){var e=0;(t.x<0||t.y<0||t.x+t.size[0]+20>SN||t.y+t.size[1]+20>_N)&&(e+=1e12);for(var r=0;r<n.length;++r)t.id!==n[r].id&&(e+=AN(t,n[r]));return e}function ict(t,n){if(t.length===0)return{nodes:t,edges:n};t.forEach(function(c){var l=n.filter(function(h){return h.source===c.id||h.target===c.id});hd.set(c,l)}),t.sort(function(c,l){var h,f;return((h=hd.get(c.id))===null||h===void 0?void 0:h.length)-((f=hd.get(l.id))===null||f===void 0?void 0:f.length)});for(var e=CN(t),r=20,i=1,o=0,a=50,s=0;r>0&&(s++,!(s>=a));){var u=rct(t,n);u!==0&&(o=u),i=o-e,e=o,i===0?--r:r=20}return t.forEach(function(c){c.x=c.x-c.size[0]/2,c.y=c.y-c.size[1]/2}),{nodes:t,edges:n}}gb.default=ict;var Vm=bt&&bt.__assign||function(){return Vm=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Vm.apply(this,arguments)},oct=bt&&bt.__createBinding||(Object.create?function(t,n,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,r,i)}:function(t,n,e,r){r===void 0&&(r=e),t[r]=n[e]}),act=bt&&bt.__setModuleDefault||(Object.create?function(t,n){Object.defineProperty(t,"default",{enumerable:!0,value:n})}:function(t,n){t.default=n}),sct=bt&&bt.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var e in t)e!=="default"&&Object.prototype.hasOwnProperty.call(t,e)&&oct(n,t,e);return act(n,t),n},IN=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fb,"__esModule",{value:!0});var fu=sct(o1),uct=IN(db),cct=IN(gb),lct=tc;function hct(t,n){var e=t.nodes,r=t.edges,i=n.width,o=n.height;if(!(e!=null&&e.length))return Promise.resolve();var a=[];e.forEach(function(p){var g=r.filter(function(m){return m.source===p.id||m.target===p.id});if(g.length>1){var v=Vm({},p);delete v.size,a.push(v)}});var s=[];r.forEach(function(p){var g=a.find(function(m){return m.id===p.source}),v=a.find(function(m){return m.id===p.target});g&&v&&s.push(p)});var u=new lct.DagreLayout({type:"dagre",ranksep:n.nodeMinGap,nodesep:n.nodeMinGap}),c=u.layout({nodes:a,edges:s}).nodes;e.forEach(function(p){var g=(c||[]).find(function(v){return v.id===p.id});p.x=(g==null?void 0:g.x)||i/2,p.y=(g==null?void 0:g.y)||o/2});var l=JSON.parse(JSON.stringify(e)),h=JSON.parse(JSON.stringify(r)),f=fu.forceSimulation().nodes(l).force("link",fu.forceLink(h).id(function(p){return p.id}).distance(function(p){var g=s.find(function(v){return v.source===p.source&&v.target===p.target});return g?30:20})).force("charge",fu.forceManyBody()).force("center",fu.forceCenter(i/2,o/2)).force("x",fu.forceX(i/2)).force("y",fu.forceY(o/2)).alpha(.3).alphaDecay(.08).alphaMin(.001),d=new Promise(function(p){f.on("end",function(){e.forEach(function(w){var E=l.find(function(M){return M.id===w.id});E&&(w.x=E.x,w.y=E.y)});var g=Math.min.apply(Math,e.map(function(w){return w.x})),v=Math.max.apply(Math,e.map(function(w){return w.x})),m=Math.min.apply(Math,e.map(function(w){return w.y})),y=Math.max.apply(Math,e.map(function(w){return w.y})),b=i/(v-g),x=o/(y-m);e.forEach(function(w){w.x!==void 0&&b<1&&(w.x=(w.x-g)*b),w.y!==void 0&&x<1&&(w.y=(w.y-m)*x)}),e.forEach(function(w){w.sizeTemp=w.size,w.size=[10,10]}),(0,cct.default)(e,r),e.forEach(function(w){w.size=w.sizeTemp||[],delete w.sizeTemp}),(0,uct.default)({nodes:e,edges:r},n),p()})});return d}fb.default=hct;var fct=bt&&bt.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),dct=bt&&bt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fh,"__esModule",{value:!0});fh.ERLayout=void 0;var pct=Yn,gct=dct(fb),vct=function(t){fct(n,t);function n(e){var r=t.call(this)||this;return r.width=300,r.height=300,r.nodeMinGap=50,r.onLayoutEnd=function(){},e&&r.updateCfg(e),r}return n.prototype.getDefaultCfg=function(){return{width:300,height:300,nodeMinGap:50}},n.prototype.execute=function(){var e=this,r=e.nodes,i=e.edges;return r==null||r.forEach(function(o){o.size||(o.size=[50,50])}),(0,gct.default)({nodes:r,edges:i},{width:this.width,height:this.height,nodeMinGap:this.nodeMinGap}).then(function(){e.onLayoutEnd&&e.onLayoutEnd()})},n.prototype.getType=function(){return"er"},n}(pct.Base);fh.ERLayout=vct;var os={},JS;function mct(){if(JS)return os;JS=1,Object.defineProperty(os,"__esModule",{value:!0}),os.Layouts=os.Layout=void 0;var t=Ho,n=Hl,e=ql,r=Kl,i=Zl,o=i1,a=Ql,s=tc,u=tb,c=oh,l=ah,h=sh,f=uh,d=ch,p=lh,g=MN(),v=hh,m=fh,y=th,b=Ln(),x=function(){function w(E){var M=(0,t.getLayoutByName)(E.type);this.layoutInstance=new M(E)}return w.prototype.layout=function(E){return this.layoutInstance.layout(E)},w.prototype.updateCfg=function(E){this.layoutInstance.updateCfg(E)},w.prototype.init=function(E){this.correctLayers(E.nodes),this.layoutInstance.init(E)},w.prototype.correctLayers=function(E){if(E!=null&&E.length){var M=1/0,_=[];if(E.forEach(function(S){(0,b.isString)(S.layer)&&(S.layer=parseInt(S.layer,10)),!(S.layer===void 0||isNaN(S.layer))&&(_.push(S),S.layer<M&&(M=S.layer))}),M<=0){var k=Math.abs(M)+1;_.forEach(function(S){return S.layer+=k})}}},w.prototype.execute=function(){this.layoutInstance.execute()},w.prototype.getDefaultCfg=function(){return this.layoutInstance.getDefaultCfg()},w.prototype.destroy=function(){return this.layoutInstance.destroy()},w}();return os.Layout=x,os.Layouts={force:o.ForceLayout,fruchterman:h.FruchtermanLayout,forceAtlas2:v.ForceAtlas2Layout,gForce:i.GForceLayout,force2:r.Force2Layout,dagre:s.DagreLayout,dagreCompound:y.DagreCompoundLayout,circular:a.CircularLayout,radial:u.RadialLayout,concentric:c.ConcentricLayout,grid:n.GridLayout,mds:l.MDSLayout,comboForce:p.ComboForceLayout,comboCombined:g.ComboCombinedLayout,random:e.RandomLayout,"gForce-gpu":d.GForceGPULayout,"fruchterman-gpu":f.FruchtermanGPULayout,er:m.ERLayout},os}var TN={};Object.defineProperty(TN,"__esModule",{value:!0});var $S;function ON(){return $S||($S=1,function(t){var n=bt&&bt.__createBinding||(Object.create?function(E,M,_,k){k===void 0&&(k=_);var S=Object.getOwnPropertyDescriptor(M,_);(!S||("get"in S?!M.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return M[_]}}),Object.defineProperty(E,k,S)}:function(E,M,_,k){k===void 0&&(k=_),E[k]=M[_]}),e=bt&&bt.__exportStar||function(E,M){for(var _ in E)_!=="default"&&!Object.prototype.hasOwnProperty.call(M,_)&&n(M,E,_)};Object.defineProperty(t,"__esModule",{value:!0}),t.ERLayout=t.ForceAtlas2Layout=t.ComboCombinedLayout=t.ComboForceLayout=t.GForceGPULayout=t.FruchtermanGPULayout=t.FruchtermanLayout=t.MDSLayout=t.ConcentricLayout=t.RadialLayout=t.DagreCompoundLayout=t.DagreLayout=t.CircularLayout=t.ForceLayout=t.Force2Layout=t.GForceLayout=t.RandomLayout=t.GridLayout=t.Layouts=t.Layout=void 0;var r=Hl;Object.defineProperty(t,"GridLayout",{enumerable:!0,get:function(){return r.GridLayout}});var i=ql;Object.defineProperty(t,"RandomLayout",{enumerable:!0,get:function(){return i.RandomLayout}});var o=Zl;Object.defineProperty(t,"GForceLayout",{enumerable:!0,get:function(){return o.GForceLayout}});var a=Kl;Object.defineProperty(t,"Force2Layout",{enumerable:!0,get:function(){return a.Force2Layout}});var s=i1;Object.defineProperty(t,"ForceLayout",{enumerable:!0,get:function(){return s.ForceLayout}});var u=Ql;Object.defineProperty(t,"CircularLayout",{enumerable:!0,get:function(){return u.CircularLayout}});var c=tc;Object.defineProperty(t,"DagreLayout",{enumerable:!0,get:function(){return c.DagreLayout}});var l=th;Object.defineProperty(t,"DagreCompoundLayout",{enumerable:!0,get:function(){return l.DagreCompoundLayout}});var h=tb;Object.defineProperty(t,"RadialLayout",{enumerable:!0,get:function(){return h.RadialLayout}});var f=oh;Object.defineProperty(t,"ConcentricLayout",{enumerable:!0,get:function(){return f.ConcentricLayout}});var d=ah;Object.defineProperty(t,"MDSLayout",{enumerable:!0,get:function(){return d.MDSLayout}});var p=sh;Object.defineProperty(t,"FruchtermanLayout",{enumerable:!0,get:function(){return p.FruchtermanLayout}});var g=uh;Object.defineProperty(t,"FruchtermanGPULayout",{enumerable:!0,get:function(){return g.FruchtermanGPULayout}});var v=ch;Object.defineProperty(t,"GForceGPULayout",{enumerable:!0,get:function(){return v.GForceGPULayout}});var m=lh;Object.defineProperty(t,"ComboForceLayout",{enumerable:!0,get:function(){return m.ComboForceLayout}});var y=MN();Object.defineProperty(t,"ComboCombinedLayout",{enumerable:!0,get:function(){return y.ComboCombinedLayout}});var b=hh;Object.defineProperty(t,"ForceAtlas2Layout",{enumerable:!0,get:function(){return b.ForceAtlas2Layout}});var x=fh;Object.defineProperty(t,"ERLayout",{enumerable:!0,get:function(){return x.ERLayout}});var w=mct();Object.defineProperty(t,"Layout",{enumerable:!0,get:function(){return w.Layout}}),Object.defineProperty(t,"Layouts",{enumerable:!0,get:function(){return w.Layouts}}),e(TN,t)}(LE)),LE}(function(t){var n=bt&&bt.__createBinding||(Object.create?function(i,o,a,s){s===void 0&&(s=a);var u=Object.getOwnPropertyDescriptor(o,a);(!u||("get"in u?!o.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return o[a]}}),Object.defineProperty(i,s,u)}:function(i,o,a,s){s===void 0&&(s=a),i[s]=o[a]}),e=bt&&bt.__exportStar||function(i,o){for(var a in i)a!=="default"&&!Object.prototype.hasOwnProperty.call(o,a)&&n(o,i,a)};Object.defineProperty(t,"__esModule",{value:!0}),t.getLayoutByName=t.unRegisterLayout=t.registerLayout=void 0;var r=Ho;Object.defineProperty(t,"registerLayout",{enumerable:!0,get:function(){return r.registerLayout}}),Object.defineProperty(t,"unRegisterLayout",{enumerable:!0,get:function(){return r.unRegisterLayout}}),Object.defineProperty(t,"getLayoutByName",{enumerable:!0,get:function(){return r.getLayoutByName}}),e(ON(),t)})($e);var NN={exports:{}};(function(t,n){(function(e,r){t.exports=r()})(typeof self<"u"?self:bt,function(){return function(e){var r={};function i(o){if(r[o])return r[o].exports;var a=r[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=r,i.d=function(o,a,s){i.o(o,a)||Object.defineProperty(o,a,{configurable:!1,enumerable:!0,get:s})},i.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(a,"a",a),a},i.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},i.p="",i(i.s=36)}([function(e,r,i){var o=i(3);r.a=function(a){return Array.isArray?Array.isArray(a):Object(o.a)(a,"Array")}},function(e,r,i){var o=function(a){return a!==null&&typeof a!="function"&&isFinite(a.length)};r.a=o},function(e,r,i){var o=i(3);r.a=function(a){return Object(o.a)(a,"Function")}},function(e,r,i){var o={}.toString,a=function(s,u){return o.call(s)==="[object "+u+"]"};r.a=a},function(e,r,i){var o=i(3);r.a=function(a){return Object(o.a)(a,"String")}},function(e,r,i){var o=i(3),a=function(s){return Object(o.a)(s,"Number")};r.a=a},function(e,r,i){var o=i(38),a=o.mix;function s(u,c,l,h){return h===void 0&&(h="height"),l==="center"?(u[h]+c[h])/2:u.height}e.exports={assign:a,getHeight:s}},function(e,r,i){var o=function(a){return a==null};r.a=o},function(e,r,i){var o=i(0),a=i(12);function s(u,c){if(u){var l;if(Object(o.a)(u))for(var h=0,f=u.length;h<f&&(l=c(u[h],h),l!==!1);h++);else if(Object(a.a)(u)){for(var d in u)if(u.hasOwnProperty(d)&&(l=c(u[d],d),l===!1))break}}}r.a=s},function(e,r,i){var o=i(7);r.a=function(a){return Object(o.a)(a)?"":a.toString()}},function(e,r,i){var o=i(14),a=i(3),s=function(u){if(!Object(o.a)(u)||!Object(a.a)(u,"Object"))return!1;if(Object.getPrototypeOf(u)===null)return!0;for(var c=u;Object.getPrototypeOf(c)!==null;)c=Object.getPrototypeOf(c);return Object.getPrototypeOf(u)===c};r.a=s},function(e,r,i){var o=i(18),a=function(){function s(c,l){l===void 0&&(l={});var h=this;h.options=l,h.rootNode=o(c,l)}var u=s.prototype;return u.execute=function(){throw new Error("please override this method")},s}();e.exports=a},function(e,r,i){r.a=function(o){var a=typeof o;return o!==null&&a==="object"||a==="function"}},function(e,r,i){var o=i(1),a=function(s,u){return Object(o.a)(s)?s.indexOf(u)>-1:!1};r.a=a},function(e,r,i){var o=function(a){return typeof a=="object"&&a!==null};r.a=o},function(e,r,i){var o=i(8),a=i(2),s=Object.values?function(u){return Object.values(u)}:function(u){var c=[];return Object(o.a)(u,function(l,h){Object(a.a)(u)&&h==="prototype"||c.push(l)}),c};r.a=s},function(e,r,i){r.a=a;function o(s,u){for(var c in u)u.hasOwnProperty(c)&&c!=="constructor"&&u[c]!==void 0&&(s[c]=u[c])}function a(s,u,c,l){return u&&o(s,u),c&&o(s,c),l&&o(s,l),s}},function(e,r,i){var o=i(35),a=["LR","RL","TB","BT","H","V"],s=["LR","RL","H"],u=function(l){return s.indexOf(l)>-1},c=a[0];e.exports=function(l,h,f){var d=h.direction||c;if(h.isHorizontal=u(d),d&&a.indexOf(d)===-1)throw new TypeError("Invalid direction: "+d);if(d===a[0])f(l,h);else if(d===a[1])f(l,h),l.right2left();else if(d===a[2])f(l,h);else if(d===a[3])f(l,h),l.bottom2top();else if(d===a[4]||d===a[5]){var p=o(l,h),g=p.left,v=p.right;f(g,h),f(v,h),h.isHorizontal?g.right2left():g.bottom2top(),v.translate(g.x-v.x,g.y-v.y),l.x=g.x,l.y=v.y;var m=l.getBoundingBox();h.isHorizontal?m.top<0&&l.translate(0,-m.top):m.left<0&&l.translate(-m.left,0)}var y=h.fixedRoot;return y===void 0&&(y=!0),y&&l.translate(-(l.x+l.width/2+l.hgap),-(l.y+l.height/2+l.vgap)),l}},function(e,r,i){var o=i(6),a=18,s=a*2,u=a,c={getId:function(f){return f.id||f.name},getPreH:function(f){return f.preH||0},getPreV:function(f){return f.preV||0},getHGap:function(f){return f.hgap||u},getVGap:function(f){return f.vgap||u},getChildren:function(f){return f.children},getHeight:function(f){return f.height||s},getWidth:function(f){var d=f.label||" ";return f.width||d.split("").length*a}};function l(f,d){var p=this;if(p.vgap=p.hgap=0,f instanceof l)return f;p.data=f;var g=d.getHGap(f),v=d.getVGap(f);return p.preH=d.getPreH(f),p.preV=d.getPreV(f),p.width=d.getWidth(f),p.height=d.getHeight(f),p.width+=p.preH,p.height+=p.preV,p.id=d.getId(f),p.x=p.y=0,p.depth=0,p.children||(p.children=[]),p.addGap(g,v),p}o.assign(l.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(f,d){var p=this;p.hgap+=f,p.vgap+=d,p.width+=2*f,p.height+=2*d},eachNode:function(f){for(var d=this,p=[d],g;g=p.shift();)f(g),p=g.children.concat(p)},DFTraverse:function(f){this.eachNode(f)},BFTraverse:function(f){for(var d=this,p=[d],g;g=p.shift();)f(g),p=p.concat(g.children)},getBoundingBox:function(){var f={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(d){f.left=Math.min(f.left,d.x),f.top=Math.min(f.top,d.y),f.width=Math.max(f.width,d.x+d.width),f.height=Math.max(f.height,d.y+d.height)}),f},translate:function(f,d){f===void 0&&(f=0),d===void 0&&(d=0),this.eachNode(function(p){p.x+=f,p.y+=d,p.x+=p.preH,p.y+=p.preV})},right2left:function(){var f=this,d=f.getBoundingBox();f.eachNode(function(p){p.x=p.x-(p.x-d.left)*2-p.width}),f.translate(d.width,0)},bottom2top:function(){var f=this,d=f.getBoundingBox();f.eachNode(function(p){p.y=p.y-(p.y-d.top)*2-p.height}),f.translate(0,d.height)}});function h(f,d,p){d===void 0&&(d={}),d=o.assign({},c,d);var g=new l(f,d),v=[g],m;if(!p&&!f.collapsed){for(;m=v.shift();)if(!m.data.collapsed){var y=d.getChildren(m.data),b=y?y.length:0;if(m.children=new Array(b),y&&b)for(var x=0;x<b;x++){var w=new l(y[x],d);m.children[x]=w,v.push(w),w.parent=m,w.depth=m.depth+1}}}return g}e.exports=h},function(e,r,i){var o=i(1),a=function(s,u){if(!Object(o.a)(s))return s;for(var c=[],l=0;l<s.length;l++){var h=s[l];u(h,l)&&c.push(h)}return c};r.a=a},function(e,r,i){var o=i(7),a=i(21);function s(u,c){var l=Object(a.a)(c),h=l.length;if(Object(o.a)(u))return!h;for(var f=0;f<h;f+=1){var d=l[f];if(c[d]!==u[d]||!(d in u))return!1}return!0}r.a=s},function(e,r,i){var o=i(8),a=i(2),s=Object.keys?function(u){return Object.keys(u)}:function(u){var c=[];return Object(o.a)(u,function(l,h){Object(a.a)(u)&&h==="prototype"||c.push(h)}),c};r.a=s},function(e,r,i){var o=i(0);r.a=function(a){if(Object(o.a)(a))return a.reduce(function(s,u){return Math.max(s,u)},a[0])}},function(e,r,i){var o=i(0);r.a=function(a){if(Object(o.a)(a))return a.reduce(function(s,u){return Math.min(s,u)},a[0])}},function(e,r,i){var o=i(1),a=Array.prototype.splice,s=function(u,c){if(!Object(o.a)(u))return[];for(var l=u?c.length:0,h=l-1;l--;){var f=void 0,d=c[l];(l===h||d!==f)&&(f=d,a.call(u,d,1))}return u};r.a=s},function(e,r,i){var o=i(8),a=i(0),s=i(10),u=function(c,l,h){if(!Object(a.a)(c)&&!Object(s.a)(c))return c;var f=h;return Object(o.a)(c,function(d,p){f=l(f,d,p)}),f};r.a=u},function(e,r,i){r.a=o;function o(a,s){s===void 0&&(s=new Map);var u=[];if(Array.isArray(a))for(var c=0,l=a.length;c<l;c++){var h=a[c];s.has(h)||(u.push(h),s.set(h,!0))}return u}},function(e,r,i){r.a=u;var o=i(0),a=i(2),s=i(28);function u(c,l){if(!l)return{0:c};if(!Object(a.a)(l)){var h=Object(o.a)(l)?l:l.replace(/\s+/g,"").split("*");l=function(f){for(var d="_",p=0,g=h.length;p<g;p++)d+=f[h[p]]&&f[h[p]].toString();return d}}return Object(s.a)(c,l)}},function(e,r,i){var o=i(0),a=i(2),s=Object.prototype.hasOwnProperty;function u(c,l){if(!l||!Object(o.a)(c))return{};for(var h={},f=Object(a.a)(l)?l:function(v){return v[l]},d,p=0;p<c.length;p++){var g=c[p];d=f(g),s.call(h,d)?h[d].push(g):h[d]=[g]}return h}r.a=u},function(e,r,i){r.a=function(o,a){return o.hasOwnProperty(a)}},function(e,r,i){var o={}.toString,a=function(s){return o.call(s).replace(/^\[object /,"").replace(/]$/,"")};r.a=a},function(e,r,i){var o=Object.prototype,a=function(s){var u=s&&s.constructor,c=typeof u=="function"&&u.prototype||o;return s===c};r.a=a},function(e,r,i){var o=i(2);r.a=function(a,s){if(!Object(o.a)(a))throw new TypeError("Expected a function");var u=function(){for(var c=[],l=0;l<arguments.length;l++)c[l]=arguments[l];var h=s?s.apply(this,c):c[0],f=u.cache;if(f.has(h))return f.get(h);var d=a.apply(this,c);return f.set(h,d),d};return u.cache=new Map,u}},function(e,r,i){var o=i(14),a=i(1),s=i(4),u=function(c,l){if(c===l)return!0;if(!c||!l||Object(s.a)(c)||Object(s.a)(l))return!1;if(Object(a.a)(c)||Object(a.a)(l)){if(c.length!==l.length)return!1;for(var h=!0,f=0;f<c.length&&(h=u(c[f],l[f]),!!h);f++);return h}if(Object(o.a)(c)||Object(o.a)(l)){var d=Object.keys(c),p=Object.keys(l);if(d.length!==p.length)return!1;for(var h=!0,f=0;f<d.length&&(h=u(c[d[f]],l[d[f]]),!!h);f++);return h}return!1};r.a=u},function(e,r,i){var o=i(116),a=i(15),s=i(32),u=i(4),c;r.a=Object(s.a)(function(l,h){h===void 0&&(h={});var f=h.fontSize,d=h.fontFamily,p=h.fontWeight,g=h.fontStyle,v=h.fontVariant;return c||(c=document.createElement("canvas").getContext("2d")),c.font=[g,v,p,f+"px",d].join(" "),c.measureText(Object(u.a)(l)?l:"").width},function(l,h){return h===void 0&&(h={}),Object(o.a)([l],Object(a.a)(h)).join("")})},function(e,r,i){var o=i(18);e.exports=function(a,s){for(var u=o(a.data,s,!0),c=o(a.data,s,!0),l=a.children.length,h=Math.round(l/2),f=s.getSide||function(v,m){return m<h?"right":"left"},d=0;d<l;d++){var p=a.children[d],g=f(p,d);g==="right"?c.children.push(p):u.children.push(p)}return u.eachNode(function(v){v.isRoot()||(v.side="left")}),c.eachNode(function(v){v.isRoot()||(v.side="right")}),{left:u,right:c}}},function(e,r,i){var o={compactBox:i(37),dendrogram:i(120),indented:i(122),mindmap:i(124)};e.exports=o},function(e,r,i){function o(p,g){p.prototype=Object.create(g.prototype),p.prototype.constructor=p,a(p,g)}function a(p,g){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,m){return v.__proto__=m,v},a(p,g)}var s=i(11),u=i(119),c=i(17),l=i(6),h=function(p){o(g,p);function g(){return p.apply(this,arguments)||this}var v=g.prototype;return v.execute=function(){var m=this;return c(m.rootNode,m.options,u)},g}(s),f={};function d(p,g){return g=l.assign({},f,g),new h(p,g).execute()}e.exports=d},function(e,r,i){Object.defineProperty(r,"__esModule",{value:!0});var o=i(13);i.d(r,"contains",function(){return o.a}),i.d(r,"includes",function(){return o.a});var a=i(39);i.d(r,"difference",function(){return a.a});var s=i(40);i.d(r,"find",function(){return s.a});var u=i(41);i.d(r,"findIndex",function(){return u.a});var c=i(42);i.d(r,"firstValue",function(){return c.a});var l=i(43);i.d(r,"flatten",function(){return l.a});var h=i(44);i.d(r,"flattenDeep",function(){return h.a});var f=i(45);i.d(r,"getRange",function(){return f.a});var d=i(46);i.d(r,"pull",function(){return d.a});var p=i(24);i.d(r,"pullAt",function(){return p.a});var g=i(25);i.d(r,"reduce",function(){return g.a});var v=i(47);i.d(r,"remove",function(){return v.a});var m=i(48);i.d(r,"sortBy",function(){return m.a});var y=i(49);i.d(r,"union",function(){return y.a});var b=i(26);i.d(r,"uniq",function(){return b.a});var x=i(50);i.d(r,"valuesOfKey",function(){return x.a});var w=i(51);i.d(r,"head",function(){return w.a});var E=i(52);i.d(r,"last",function(){return E.a});var M=i(53);i.d(r,"startsWith",function(){return M.a});var _=i(54);i.d(r,"endsWith",function(){return _.a});var k=i(19);i.d(r,"filter",function(){return k.a});var S=i(55);i.d(r,"every",function(){return S.a});var A=i(56);i.d(r,"some",function(){return A.a});var C=i(57);i.d(r,"group",function(){return C.a});var I=i(28);i.d(r,"groupBy",function(){return I.a});var N=i(27);i.d(r,"groupToMap",function(){return N.a});var D=i(58);i.d(r,"getWrapBehavior",function(){return D.a});var P=i(59);i.d(r,"wrapBehavior",function(){return P.a});var j=i(60);i.d(r,"number2color",function(){return j.a});var L=i(61);i.d(r,"parseRadius",function(){return L.a});var R=i(62);i.d(r,"clamp",function(){return R.a});var V=i(63);i.d(r,"fixedBase",function(){return V.a});var tt=i(64);i.d(r,"isDecimal",function(){return tt.a});var ut=i(65);i.d(r,"isEven",function(){return ut.a});var dt=i(66);i.d(r,"isInteger",function(){return dt.a});var J=i(67);i.d(r,"isNegative",function(){return J.a});var Et=i(68);i.d(r,"isNumberEqual",function(){return Et.a});var Bt=i(69);i.d(r,"isOdd",function(){return Bt.a});var Vt=i(70);i.d(r,"isPositive",function(){return Vt.a});var se=i(22);i.d(r,"max",function(){return se.a});var re=i(71);i.d(r,"maxBy",function(){return re.a});var ue=i(23);i.d(r,"min",function(){return ue.a});var de=i(72);i.d(r,"minBy",function(){return de.a});var Ze=i(73);i.d(r,"mod",function(){return Ze.a});var Ne=i(74);i.d(r,"toDegree",function(){return Ne.a});var Re=i(75);i.d(r,"toInteger",function(){return Re.a});var pn=i(76);i.d(r,"toRadian",function(){return pn.a});var en=i(77);i.d(r,"forIn",function(){return en.a});var fn=i(29);i.d(r,"has",function(){return fn.a});var De=i(78);i.d(r,"hasKey",function(){return De.a});var Vn=i(79);i.d(r,"hasValue",function(){return Vn.a});var Wt=i(21);i.d(r,"keys",function(){return Wt.a});var ee=i(20);i.d(r,"isMatch",function(){return ee.a});var ot=i(15);i.d(r,"values",function(){return ot.a});var O=i(80);i.d(r,"lowerCase",function(){return O.a});var ct=i(81);i.d(r,"lowerFirst",function(){return ct.a});var Xt=i(82);i.d(r,"substitute",function(){return Xt.a});var jt=i(83);i.d(r,"upperCase",function(){return jt.a});var te=i(84);i.d(r,"upperFirst",function(){return te.a});var _t=i(30);i.d(r,"getType",function(){return _t.a});var Zt=i(85);i.d(r,"isArguments",function(){return Zt.a});var me=i(0);i.d(r,"isArray",function(){return me.a});var Ce=i(1);i.d(r,"isArrayLike",function(){return Ce.a});var _e=i(86);i.d(r,"isBoolean",function(){return _e.a});var Qn=i(87);i.d(r,"isDate",function(){return Qn.a});var dn=i(88);i.d(r,"isError",function(){return dn.a});var He=i(2);i.d(r,"isFunction",function(){return He.a});var un=i(89);i.d(r,"isFinite",function(){return un.a});var yn=i(7);i.d(r,"isNil",function(){return yn.a});var hn=i(90);i.d(r,"isNull",function(){return hn.a});var bn=i(5);i.d(r,"isNumber",function(){return bn.a});var xr=i(12);i.d(r,"isObject",function(){return xr.a});var Wn=i(14);i.d(r,"isObjectLike",function(){return Wn.a});var _o=i(10);i.d(r,"isPlainObject",function(){return _o.a});var ea=i(31);i.d(r,"isPrototype",function(){return ea.a});var na=i(91);i.d(r,"isRegExp",function(){return na.a});var Ga=i(4);i.d(r,"isString",function(){return Ga.a});var xi=i(3);i.d(r,"isType",function(){return xi.a});var jn=i(92);i.d(r,"isUndefined",function(){return jn.a});var Ua=i(93);i.d(r,"isElement",function(){return Ua.a});var Ya=i(94);i.d(r,"requestAnimationFrame",function(){return Ya.a});var Va=i(95);i.d(r,"clearAnimationFrame",function(){return Va.a});var Ur=i(96);i.d(r,"augment",function(){return Ur.a});var On=i(97);i.d(r,"clone",function(){return On.a});var Yr=i(98);i.d(r,"debounce",function(){return Yr.a});var ke=i(32);i.d(r,"memoize",function(){return ke.a});var gn=i(99);i.d(r,"deepMix",function(){return gn.a});var Ue=i(8);i.d(r,"each",function(){return Ue.a});var wn=i(100);i.d(r,"extend",function(){return wn.a});var Ke=i(101);i.d(r,"indexOf",function(){return Ke.a});var ko=i(102);i.d(r,"isEmpty",function(){return ko.a});var Ao=i(33);i.d(r,"isEqual",function(){return Ao.a});var wi=i(103);i.d(r,"isEqualWith",function(){return wi.a});var Co=i(104);i.d(r,"map",function(){return Co.a});var Io=i(105);i.d(r,"mapValues",function(){return Io.a});var Ui=i(16);i.d(r,"mix",function(){return Ui.a}),i.d(r,"assign",function(){return Ui.a});var og=i(106);i.d(r,"get",function(){return og.a});var ag=i(107);i.d(r,"set",function(){return ag.a});var sg=i(108);i.d(r,"pick",function(){return sg.a});var ug=i(109);i.d(r,"omit",function(){return ug.a});var cg=i(110);i.d(r,"throttle",function(){return cg.a});var lg=i(111);i.d(r,"toArray",function(){return lg.a});var hg=i(9);i.d(r,"toString",function(){return hg.a});var fg=i(112);i.d(r,"uniqueId",function(){return fg.a});var dg=i(113);i.d(r,"noop",function(){return dg.a});var pg=i(114);i.d(r,"identity",function(){return pg.a});var gg=i(115);i.d(r,"size",function(){return gg.a});var vg=i(34);i.d(r,"measureTextWidth",function(){return vg.a});var mg=i(117);i.d(r,"getEllipsisText",function(){return mg.a});var yg=i(118);i.d(r,"Cache",function(){return yg.a})},function(e,r,i){var o=i(19),a=i(13),s=function(u,c){return c===void 0&&(c=[]),Object(o.a)(u,function(l){return!Object(a.a)(c,l)})};r.a=s},function(e,r,i){var o=i(2),a=i(20),s=i(0),u=i(10);function c(l,h){if(!Object(s.a)(l))return null;var f;if(Object(o.a)(h)&&(f=h),Object(u.a)(h)&&(f=function(p){return Object(a.a)(p,h)}),f){for(var d=0;d<l.length;d+=1)if(f(l[d]))return l[d]}return null}r.a=c},function(e,r,i){function o(a,s,u){u===void 0&&(u=0);for(var c=u;c<a.length;c++)if(s(a[c],c))return c;return-1}r.a=o},function(e,r,i){var o=i(7),a=i(0),s=function(u,c){for(var l=null,h=0;h<u.length;h++){var f=u[h],d=f[c];if(!Object(o.a)(d)){Object(a.a)(d)?l=d[0]:l=d;break}}return l};r.a=s},function(e,r,i){var o=i(0),a=function(s){if(!Object(o.a)(s))return[];for(var u=[],c=0;c<s.length;c++)u=u.concat(s[c]);return u};r.a=a},function(e,r,i){var o=i(0),a=function(s,u){if(u===void 0&&(u=[]),!Object(o.a)(s))u.push(s);else for(var c=0;c<s.length;c+=1)a(s[c],u);return u};r.a=a},function(e,r,i){var o=i(0),a=i(22),s=i(23),u=function(c){var l=c.filter(function(g){return!isNaN(g)});if(!l.length)return{min:0,max:0};if(Object(o.a)(c[0])){for(var h=[],f=0;f<c.length;f++)h=h.concat(c[f]);l=h}var d=Object(a.a)(l),p=Object(s.a)(l);return{min:p,max:d}};r.a=u},function(e,r,i){var o=Array.prototype,a=o.splice,s=o.indexOf,u=function(c){for(var l=[],h=1;h<arguments.length;h++)l[h-1]=arguments[h];for(var f=0;f<l.length;f++)for(var d=l[f],p=-1;(p=s.call(c,d))>-1;)a.call(c,p,1);return c};r.a=u},function(e,r,i){var o=i(1),a=i(24),s=function(u,c){var l=[];if(!Object(o.a)(u))return l;for(var h=-1,f=[],d=u.length;++h<d;){var p=u[h];c(p,h,u)&&(l.push(p),f.push(h))}return Object(a.a)(u,f),l};r.a=s},function(e,r,i){var o=i(0),a=i(4),s=i(2);function u(c,l){var h;if(Object(s.a)(l))h=function(d,p){return l(d)-l(p)};else{var f=[];Object(a.a)(l)?f.push(l):Object(o.a)(l)&&(f=l),h=function(d,p){for(var g=0;g<f.length;g+=1){var v=f[g];if(d[v]>p[v])return 1;if(d[v]<p[v])return-1}return 0}}return c.sort(h),c}r.a=u},function(e,r,i){var o=i(26),a=function(){for(var s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];return Object(o.a)([].concat.apply([],s))};r.a=a},function(e,r,i){var o=i(0),a=i(7);r.a=function(s,u){for(var c=[],l={},h=0;h<s.length;h++){var f=s[h],d=f[u];if(!Object(a.a)(d)){Object(o.a)(d)||(d=[d]);for(var p=0;p<d.length;p++){var g=d[p];l[g]||(c.push(g),l[g]=!0)}}}return c}},function(e,r,i){r.a=a;var o=i(1);function a(s){if(Object(o.a)(s))return s[0]}},function(e,r,i){r.a=a;var o=i(1);function a(s){if(Object(o.a)(s)){var u=s;return u[u.length-1]}}},function(e,r,i){var o=i(0),a=i(4);function s(u,c){return Object(o.a)(u)||Object(a.a)(u)?u[0]===c:!1}r.a=s},function(e,r,i){var o=i(0),a=i(4);function s(u,c){return Object(o.a)(u)||Object(a.a)(u)?u[u.length-1]===c:!1}r.a=s},function(e,r,i){var o=function(a,s){for(var u=0;u<a.length;u++)if(!s(a[u],u))return!1;return!0};r.a=o},function(e,r,i){var o=function(a,s){for(var u=0;u<a.length;u++)if(s(a[u],u))return!0;return!1};r.a=o},function(e,r,i){var o=i(27);r.a=function(a,s){if(!s)return[a];var u=Object(o.a)(a,s),c=[];for(var l in u)c.push(u[l]);return c}},function(e,r,i){function o(a,s){return a["_wrap_"+s]}r.a=o},function(e,r,i){function o(a,s){if(a["_wrap_"+s])return a["_wrap_"+s];var u=function(c){a[s](c)};return a["_wrap_"+s]=u,u}r.a=o},function(e,r,i){var o={};function a(s){var u=o[s];if(!u){for(var c=s.toString(16),l=c.length;l<6;l++)c="0"+c;u="#"+c,o[s]=u}return u}r.a=a},function(e,r,i){var o=i(0);function a(s){var u=0,c=0,l=0,h=0;return Object(o.a)(s)?s.length===1?u=c=l=h=s[0]:s.length===2?(u=l=s[0],c=h=s[1]):s.length===3?(u=s[0],c=h=s[1],l=s[2]):(u=s[0],c=s[1],l=s[2],h=s[3]):u=c=l=h=s,{r1:u,r2:c,r3:l,r4:h}}r.a=a},function(e,r,i){var o=function(a,s,u){return a<s?s:a>u?u:a};r.a=o},function(e,r,i){var o=function(a,s){var u=s.toString(),c=u.indexOf(".");if(c===-1)return Math.round(a);var l=u.substr(c+1).length;return l>20&&(l=20),parseFloat(a.toFixed(l))};r.a=o},function(e,r,i){var o=i(5),a=function(s){return Object(o.a)(s)&&s%1!==0};r.a=a},function(e,r,i){var o=i(5),a=function(s){return Object(o.a)(s)&&s%2===0};r.a=a},function(e,r,i){var o=i(5),a=Number.isInteger?Number.isInteger:function(s){return Object(o.a)(s)&&s%1===0};r.a=a},function(e,r,i){var o=i(5),a=function(s){return Object(o.a)(s)&&s<0};r.a=a},function(e,r,i){r.a=a;var o=1e-5;function a(s,u,c){return c===void 0&&(c=o),Math.abs(s-u)<c}},function(e,r,i){var o=i(5),a=function(s){return Object(o.a)(s)&&s%2!==0};r.a=a},function(e,r,i){var o=i(5),a=function(s){return Object(o.a)(s)&&s>0};r.a=a},function(e,r,i){var o=i(0),a=i(2);r.a=function(s,u){if(Object(o.a)(s)){for(var c,l=-1/0,h=0;h<s.length;h++){var f=s[h],d=Object(a.a)(u)?u(f):f[u];d>l&&(c=f,l=d)}return c}}},function(e,r,i){var o=i(0),a=i(2);r.a=function(s,u){if(Object(o.a)(s)){for(var c,l=1/0,h=0;h<s.length;h++){var f=s[h],d=Object(a.a)(u)?u(f):f[u];d<l&&(c=f,l=d)}return c}}},function(e,r,i){var o=function(a,s){return(a%s+s)%s};r.a=o},function(e,r,i){var o=180/Math.PI,a=function(s){return o*s};r.a=a},function(e,r,i){r.a=parseInt},function(e,r,i){var o=Math.PI/180,a=function(s){return o*s};r.a=a},function(e,r,i){var o=i(8);r.a=o.a},function(e,r,i){var o=i(29);r.a=o.a},function(e,r,i){var o=i(13),a=i(15);r.a=function(s,u){return Object(o.a)(Object(a.a)(s),u)}},function(e,r,i){var o=i(9),a=function(s){return Object(o.a)(s).toLowerCase()};r.a=a},function(e,r,i){var o=i(9),a=function(s){var u=Object(o.a)(s);return u.charAt(0).toLowerCase()+u.substring(1)};r.a=a},function(e,r,i){function o(a,s){return!a||!s?a:a.replace(/\\?\{([^{}]+)\}/g,function(u,c){return u.charAt(0)==="\\"?u.slice(1):s[c]===void 0?"":s[c]})}r.a=o},function(e,r,i){var o=i(9),a=function(s){return Object(o.a)(s).toUpperCase()};r.a=a},function(e,r,i){var o=i(9),a=function(s){var u=Object(o.a)(s);return u.charAt(0).toUpperCase()+u.substring(1)};r.a=a},function(e,r,i){var o=i(3),a=function(s){return Object(o.a)(s,"Arguments")};r.a=a},function(e,r,i){var o=i(3),a=function(s){return Object(o.a)(s,"Boolean")};r.a=a},function(e,r,i){var o=i(3),a=function(s){return Object(o.a)(s,"Date")};r.a=a},function(e,r,i){var o=i(3),a=function(s){return Object(o.a)(s,"Error")};r.a=a},function(e,r,i){var o=i(5);r.a=function(a){return Object(o.a)(a)&&isFinite(a)}},function(e,r,i){var o=function(a){return a===null};r.a=o},function(e,r,i){var o=i(3),a=function(s){return Object(o.a)(s,"RegExp")};r.a=a},function(e,r,i){var o=function(a){return a===void 0};r.a=o},function(e,r,i){var o=function(a){return a instanceof Element||a instanceof HTMLDocument};r.a=o},function(e,r,i){r.a=o;function o(a){var s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(u){return setTimeout(u,16)};return s(a)}},function(e,r,i){r.a=o;function o(a){var s=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;s(a)}},function(e,r,i){var o=i(16),a=i(2),s=function(){for(var u=[],c=0;c<arguments.length;c++)u[c]=arguments[c];for(var l=u[0],h=1;h<u.length;h++){var f=u[h];Object(a.a)(f)&&(f=f.prototype),Object(o.a)(l.prototype,f)}};r.a=s},function(e,r,i){var o=i(0),a=function(s){if(typeof s!="object"||s===null)return s;var u;if(Object(o.a)(s)){u=[];for(var c=0,l=s.length;c<l;c++)typeof s[c]=="object"&&s[c]!=null?u[c]=a(s[c]):u[c]=s[c]}else{u={};for(var h in s)typeof s[h]=="object"&&s[h]!=null?u[h]=a(s[h]):u[h]=s[h]}return u};r.a=a},function(e,r,i){function o(a,s,u){var c;return function(){var l=this,h=arguments,f=function(){c=null,u||a.apply(l,h)},d=u&&!c;clearTimeout(c),c=setTimeout(f,s),d&&a.apply(l,h)}}r.a=o},function(e,r,i){var o=i(0),a=i(10),s=5;function u(l,h,f,d){f=f||0,d=d||s;for(var p in h)if(h.hasOwnProperty(p)){var g=h[p];g!==null&&Object(a.a)(g)?(Object(a.a)(l[p])||(l[p]={}),f<d?u(l[p],g,f+1,d):l[p]=h[p]):Object(o.a)(g)?(l[p]=[],l[p]=l[p].concat(g)):g!==void 0&&(l[p]=g)}}var c=function(l){for(var h=[],f=1;f<arguments.length;f++)h[f-1]=arguments[f];for(var d=0;d<h.length;d+=1)u(l,h[d]);return l};r.a=c},function(e,r,i){var o=i(16),a=i(2),s=function(u,c,l,h){Object(a.a)(c)||(l=c,c=u,u=function(){});var f=Object.create?function(p,g){return Object.create(p,{constructor:{value:g}})}:function(p,g){function v(){}v.prototype=p;var m=new v;return m.constructor=g,m},d=f(c.prototype,u);return u.prototype=Object(o.a)(d,u.prototype),u.superclass=f(c.prototype,c),Object(o.a)(d,l),Object(o.a)(u,h),u};r.a=s},function(e,r,i){var o=i(1),a=function(s,u){if(!Object(o.a)(s))return-1;var c=Array.prototype.indexOf;if(c)return c.call(s,u);for(var l=-1,h=0;h<s.length;h++)if(s[h]===u){l=h;break}return l};r.a=a},function(e,r,i){var o=i(7),a=i(1),s=i(30),u=i(31),c=Object.prototype.hasOwnProperty;function l(h){if(Object(o.a)(h))return!0;if(Object(a.a)(h))return!h.length;var f=Object(s.a)(h);if(f==="Map"||f==="Set")return!h.size;if(Object(u.a)(h))return!Object.keys(h).length;for(var d in h)if(c.call(h,d))return!1;return!0}r.a=l},function(e,r,i){var o=i(2),a=i(33);r.a=function(s,u,c){return Object(o.a)(c)?!!c(s,u):Object(a.a)(s,u)}},function(e,r,i){var o=i(1),a=function(s,u){if(!Object(o.a)(s))return s;for(var c=[],l=0;l<s.length;l++){var h=s[l];c.push(u(h,l))}return c};r.a=a},function(e,r,i){var o=i(7),a=i(12),s=function(u){return u};r.a=function(u,c){c===void 0&&(c=s);var l={};return Object(a.a)(u)&&!Object(o.a)(u)&&Object.keys(u).forEach(function(h){l[h]=c(u[h],h)}),l}},function(e,r,i){var o=i(4);r.a=function(a,s,u){for(var c=0,l=Object(o.a)(s)?s.split("."):s;a&&c<l.length;)a=a[l[c++]];return a===void 0||c<l.length?u:a}},function(e,r,i){var o=i(12),a=i(4),s=i(5);r.a=function(u,c,l){var h=u,f=Object(a.a)(c)?c.split("."):c;return f.forEach(function(d,p){p<f.length-1?(Object(o.a)(h[d])||(h[d]=Object(s.a)(f[p+1])?[]:{}),h=h[d]):h[d]=l}),u}},function(e,r,i){var o=i(8),a=i(10),s=Object.prototype.hasOwnProperty;r.a=function(u,c){if(u===null||!Object(a.a)(u))return{};var l={};return Object(o.a)(c,function(h){s.call(u,h)&&(l[h]=u[h])}),l}},function(e,r,i){var o=i(25);r.a=function(a,s){return Object(o.a)(a,function(u,c,l){return s.includes(l)||(u[l]=c),u},{})}},function(e,r,i){r.a=function(o,a,s){var u,c,l,h,f=0;s||(s={});var d=function(){f=s.leading===!1?0:Date.now(),u=null,h=o.apply(c,l),u||(c=l=null)},p=function(){var g=Date.now();!f&&s.leading===!1&&(f=g);var v=a-(g-f);return c=this,l=arguments,v<=0||v>a?(u&&(clearTimeout(u),u=null),f=g,h=o.apply(c,l),u||(c=l=null)):!u&&s.trailing!==!1&&(u=setTimeout(d,v)),h};return p.cancel=function(){clearTimeout(u),f=0,u=c=l=null},p}},function(e,r,i){var o=i(1);r.a=function(a){return Object(o.a)(a)?Array.prototype.slice.call(a):[]}},function(e,r,i){var o={};r.a=function(a){return a=a||"g",o[a]?o[a]+=1:o[a]=1,a+o[a]}},function(e,r,i){r.a=function(){}},function(e,r,i){r.a=function(o){return o}},function(e,r,i){r.a=s;var o=i(7),a=i(1);function s(u){return Object(o.a)(u)?0:Object(a.a)(u)?u.length:Object.keys(u).length}},function(e,r,i){r.a=o;function o(){for(var a=0,s=0,u=arguments.length;s<u;s++)a+=arguments[s].length;for(var c=Array(a),l=0,s=0;s<u;s++)for(var h=arguments[s],f=0,d=h.length;f<d;f++,l++)c[l]=h[f];return c}},function(e,r,i){var o=i(4),a=i(9),s=i(34);r.a=function(u,c,l,h){h===void 0&&(h="...");var f=16,d=Object(s.a)(h,l),p=Object(o.a)(u)?u:Object(a.a)(u),g=c,v=[],m,y;if(Object(s.a)(u,l)<=c)return u;for(;m=p.substr(0,f),y=Object(s.a)(m,l),!(y+d>g&&y>g);)if(v.push(m),g-=y,p=p.substr(f),!p)return v.join("");for(;m=p.substr(0,1),y=Object(s.a)(m,l),!(y+d>g);)if(v.push(m),g-=y,p=p.substr(1),!p)return v.join("");return""+v.join("")+h}},function(e,r,i){var o=function(){function a(){this.map={}}return a.prototype.has=function(s){return this.map[s]!==void 0},a.prototype.get=function(s,u){var c=this.map[s];return c===void 0?u:c},a.prototype.set=function(s,u){this.map[s]=u},a.prototype.clear=function(){this.map={}},a.prototype.delete=function(s){delete this.map[s]},a.prototype.size=function(){return Object.keys(this.map).length},a}();r.a=o},function(e,r){function i(l,h,f,d){d===void 0&&(d=[]);var p=this;p.w=l||0,p.h=h||0,p.y=f||0,p.x=0,p.c=d||[],p.cs=d.length,p.prelim=0,p.mod=0,p.shift=0,p.change=0,p.tl=null,p.tr=null,p.el=null,p.er=null,p.msel=0,p.mser=0}i.fromNode=function(l,h){if(!l)return null;var f=[];return l.children.forEach(function(d){f.push(i.fromNode(d,h))}),h?new i(l.height,l.width,l.x,f):new i(l.width,l.height,l.y,f)};function o(l,h,f){f?l.y+=h:l.x+=h,l.children.forEach(function(d){o(d,h,f)})}function a(l,h){var f=h?l.y:l.x;return l.children.forEach(function(d){f=Math.min(a(d,h),f)}),f}function s(l,h){var f=a(l,h);o(l,-f,h)}function u(l,h,f){f?h.y=l.x:h.x=l.x,l.c.forEach(function(d,p){u(d,h.children[p],f)})}function c(l,h,f){f===void 0&&(f=0),h?(l.x=f,f+=l.width):(l.y=f,f+=l.height),l.children.forEach(function(d){c(d,h,f)})}e.exports=function(l,h){h===void 0&&(h={});var f=h.isHorizontal;function d(C){if(C.cs===0){p(C);return}d(C.c[0]);for(var I=S(b(C.c[0].el),0,null),N=1;N<C.cs;++N){d(C.c[N]);var D=b(C.c[N].er);g(C,N,I),I=S(D,N,I)}E(C),p(C)}function p(C){C.cs===0?(C.el=C,C.er=C,C.msel=C.mser=0):(C.el=C.c[0].el,C.msel=C.c[0].msel,C.er=C.c[C.cs-1].er,C.mser=C.c[C.cs-1].mser)}function g(C,I,N){for(var D=C.c[I-1],P=D.mod,j=C.c[I],L=j.mod;D!==null&&j!==null;){b(D)>N.low&&(N=N.nxt);var R=P+D.prelim+D.w-(L+j.prelim);R>0&&(L+=R,v(C,I,N.index,R));var V=b(D),tt=b(j);V<=tt&&(D=y(D),D!==null&&(P+=D.mod)),V>=tt&&(j=m(j),j!==null&&(L+=j.mod))}!D&&j?x(C,I,j,L):D&&!j&&w(C,I,D,P)}function v(C,I,N,D){C.c[I].mod+=D,C.c[I].msel+=D,C.c[I].mser+=D,_(C,I,N,D)}function m(C){return C.cs===0?C.tl:C.c[0]}function y(C){return C.cs===0?C.tr:C.c[C.cs-1]}function b(C){return C.y+C.h}function x(C,I,N,D){var P=C.c[0].el;P.tl=N;var j=D-N.mod-C.c[0].msel;P.mod+=j,P.prelim-=j,C.c[0].el=C.c[I].el,C.c[0].msel=C.c[I].msel}function w(C,I,N,D){var P=C.c[I].er;P.tr=N;var j=D-N.mod-C.c[I].mser;P.mod+=j,P.prelim-=j,C.c[I].er=C.c[I-1].er,C.c[I].mser=C.c[I-1].mser}function E(C){C.prelim=(C.c[0].prelim+C.c[0].mod+C.c[C.cs-1].mod+C.c[C.cs-1].prelim+C.c[C.cs-1].w)/2-C.w/2}function M(C,I){I+=C.mod,C.x=C.prelim+I,k(C);for(var N=0;N<C.cs;N++)M(C.c[N],I)}function _(C,I,N,D){if(N!==I-1){var P=I-N;C.c[N+1].shift+=D/P,C.c[I].shift-=D/P,C.c[I].change-=D-D/P}}function k(C){for(var I=0,N=0,D=0;D<C.cs;D++)I+=C.c[D].shift,N+=I+C.c[D].change,C.c[D].mod+=N}function S(C,I,N){for(;N!==null&&C>=N.low;)N=N.nxt;return{low:C,index:I,nxt:N}}c(l,f);var A=i.fromNode(l,f);return d(A),M(A,0),u(A,l,f),s(l,f),l}},function(e,r,i){function o(p,g){p.prototype=Object.create(g.prototype),p.prototype.constructor=p,a(p,g)}function a(p,g){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,m){return v.__proto__=m,v},a(p,g)}var s=i(11),u=i(121),c=i(17),l=i(6),h=function(p){o(g,p);function g(){return p.apply(this,arguments)||this}var v=g.prototype;return v.execute=function(){var m=this;return m.rootNode.width=0,c(m.rootNode,m.options,u)},g}(s),f={};function d(p,g){return g=l.assign({},f,g),new h(p,g).execute()}e.exports=d},function(e,r,i){var o=i(6);function a(c,l){l===void 0&&(l=[]);var h=this;h.x=h.y=0,h.leftChild=h.rightChild=null,h.height=0,h.children=l}var s={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function u(c,l,h){h?(l.x=c.x,l.y=c.y):(l.x=c.y,l.y=c.x),c.children.forEach(function(f,d){u(f,l.children[d],h)})}e.exports=function(c,l){l===void 0&&(l={}),l=o.assign({},s,l);var h=0;function f(m){if(!m)return null;m.width=0,m.depth&&m.depth>h&&(h=m.depth);var y=m.children,b=y.length,x=new a(m.height,[]);return y.forEach(function(w,E){var M=f(w);x.children.push(M),E===0&&(x.leftChild=M),E===b-1&&(x.rightChild=M)}),x.originNode=m,x.isLeaf=m.isLeaf(),x}function d(m){if(m.isLeaf||m.children.length===0)m.drawingDepth=h;else{var y=m.children.map(function(x){return d(x)}),b=Math.min.apply(null,y);m.drawingDepth=b-1}return m.drawingDepth}var p;function g(m){m.x=m.drawingDepth*l.rankSep,m.isLeaf?(m.y=0,p&&(m.y=p.y+p.height+l.nodeSep,m.originNode.parent!==p.originNode.parent&&(m.y+=l.subTreeSep)),p=m):(m.children.forEach(function(y){g(y)}),m.y=(m.leftChild.y+m.rightChild.y)/2)}var v=f(c);return d(v),g(v),u(v,c,l.isHorizontal),c}},function(e,r,i){function o(v,m){v.prototype=Object.create(m.prototype),v.prototype.constructor=v,a(v,m)}function a(v,m){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(y,b){return y.__proto__=b,y},a(v,m)}var s=i(11),u=i(123),c=i(35),l=i(6),h=["LR","RL","H"],f=h[0],d=function(v){o(m,v);function m(){return v.apply(this,arguments)||this}var y=m.prototype;return y.execute=function(){var b=this,x=b.options,w=b.rootNode;x.isHorizontal=!0;var E=x.indent,M=E===void 0?20:E,_=x.dropCap,k=_===void 0?!0:_,S=x.direction,A=S===void 0?f:S,C=x.align;if(A&&h.indexOf(A)===-1)throw new TypeError("Invalid direction: "+A);if(A===h[0])u(w,M,k,C);else if(A===h[1])u(w,M,k,C),w.right2left();else if(A===h[2]){var I=c(w,x),N=I.left,D=I.right;u(N,M,k,C),N.right2left(),u(D,M,k,C);var P=N.getBoundingBox();D.translate(P.width,0),w.x=D.x-w.width/2}return w},m}(s),p={};function g(v,m){return m=l.assign({},p,m),new d(v,m).execute()}e.exports=g},function(e,r,i){var o=i(6);function a(s,u,c,l,h){var f=typeof c=="function"?c(s):c*s.depth;if(!l)try{if(s.id===s.parent.children[0].id){s.x+=f,s.y=u?u.y:0;return}}catch{}if(s.x+=f,u){if(s.y=u.y+o.getHeight(u,s,h),u.parent&&s.parent.id!==u.parent.id){var d=u.parent,p=d.y+o.getHeight(d,s,h);s.y=p>s.y?p:s.y}}else s.y=0}e.exports=function(s,u,c,l){var h=null;s.eachNode(function(f){a(f,h,u,c,l),h=f})}},function(e,r,i){function o(p,g){p.prototype=Object.create(g.prototype),p.prototype.constructor=p,a(p,g)}function a(p,g){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,m){return v.__proto__=m,v},a(p,g)}var s=i(11),u=i(125),c=i(17),l=i(6),h=function(p){o(g,p);function g(){return p.apply(this,arguments)||this}var v=g.prototype;return v.execute=function(){var m=this;return c(m.rootNode,m.options,u)},g}(s),f={};function d(p,g){return g=l.assign({},f,g),new h(p,g).execute()}e.exports=d},function(e,r,i){var o=i(6);function a(c,l){var h=0;return c.children.length?c.children.forEach(function(f){h+=a(f,l)}):h=c.height,c._subTreeSep=l.getSubTreeSep(c.data),c.totalHeight=Math.max(c.height,h)+2*c._subTreeSep,c.totalHeight}function s(c){var l=c.children,h=l.length;if(h){l.forEach(function(m){s(m)});var f=l[0],d=l[h-1],p=d.y-f.y+d.height,g=0;if(l.forEach(function(m){g+=m.totalHeight}),p>c.height)c.y=f.y+p/2-c.height/2;else if(l.length!==1||c.height>g){var v=c.y+(c.height-p)/2-f.y;l.forEach(function(m){m.translate(0,v)})}else c.y=(f.y+f.height/2+d.y+d.height/2)/2-c.height/2}}var u={getSubTreeSep:function(){return 0}};e.exports=function(c,l){l===void 0&&(l={}),l=o.assign({},u,l),c.parent={x:0,width:0,height:0,y:0},c.BFTraverse(function(h){h.x=h.parent.x+h.parent.width}),c.parent=null,a(c,l),c.startY=0,c.y=c.totalHeight/2-c.height/2,c.eachNode(function(h){var f=h.children,d=f.length;if(d){var p=f[0];if(p.startY=h.startY+h._subTreeSep,d===1)p.y=h.y+h.height/2-p.height/2;else{p.y=p.startY+p.totalHeight/2-p.height/2;for(var g=1;g<d;g++){var v=f[g];v.startY=f[g-1].startY+f[g-1].totalHeight,v.y=v.startY+v.totalHeight/2-v.height/2}}}}),s(c)}}])})})(NN);var yct=NN.exports;const t_=bo(yct);var e_=Cr.traverseTree,bct=function(t,n){var e;return t?pe(t)?e=function(r){return t}:e=t:e=function(r){return n||1},e},xct=function(t,n){var e=[],r=[],i={},o=0;for(o=0;o<t.length;o++){var a=t[o];i[a.id]=o,e.push(a.x),e.push(a.y),e.push(0),e.push(0),r.push([])}for(o=0;o<n.length;o++){var s=n[o];r[i[s.source]].push(i[s.target]),r[i[s.target]].push(i[s.source])}var u=0;for(o=0;o<t.length;o++){var c=e.length,l=r[o],h=l.length;e[o*4+2]=c,e[o*4+3]=l.length,u=Math.max(u,l.length);for(var f=0;f<h;++f){var d=l[f];e.push(+d)}}for(;e.length%4!==0;)e.push(0);return{array:new Float32Array(e),maxEdgePerVetex:u}},wct=function(t,n,e){var r=[],i=[],o={},a=0;for(a=0;a<t.length;a++){var s=t[a];o[s.id]=a,r.push(s.x),r.push(s.y),r.push(0),r.push(0),i.push([])}for(a=0;a<n.length;a++){var u=n[a];i[o[u.source]].push(o[u.target]),i[o[u.source]].push(e(u)),i[o[u.target]].push(o[u.source]),i[o[u.target]].push(e(u))}var c=0;for(a=0;a<t.length;a++){var l=r.length,h=i[a],f=h.length;r[a*4+2]=l,r[a*4+3]=f/2,c=Math.max(c,f/2);for(var d=0;d<f;++d){var p=h[d];r.push(+p)}}for(;r.length%4!==0;)r.push(0);return{array:new Float32Array(r),maxEdgePerVetex:c}},Ect=function(t,n,e,r){var i=[],o=[],a={},s=0;for(s=0;s<t.length;s++){var u=t[s];a[u.id]=s,i.push(u.x),i.push(u.y),i.push(0),i.push(0),o.push([])}for(s=0;s<n.length;s++){var c=n[s];o[a[c.source]].push(a[c.target]),o[a[c.source]].push(e(c)),o[a[c.source]].push(r(c)),o[a[c.source]].push(0),o[a[c.target]].push(a[c.source]),o[a[c.target]].push(e(c)),o[a[c.target]].push(r(c)),o[a[c.target]].push(0)}var l=0;for(s=0;s<t.length;s++){var h=i.length,f=o[s],d=f.length;i[s*4+2]=h+1048576*d/4,i[s*4+3]=0,l=Math.max(l,d/4);for(var p=0;p<d;++p){var g=f[p];i.push(+g)}}for(;i.length%4!==0;)i.push(0);return{array:new Float32Array(i),maxEdgePerVetex:l}},Mct=function(t,n){var e=[],r=t.length,i={};return n.forEach(function(o){t.forEach(function(a,s){if(i[o[a]]===void 0&&(i[o[a]]=Object.keys(i).length),e.push(i[o[a]]),s===r-1)for(;e.length%4!==0;)e.push(0)})}),{array:new Float32Array(e),count:Object.keys(i).length}},Sct=function(t){for(var n=[],e=t.length,r=t[0].length,i=function(a){t.forEach(function(s,u){if(n.push(s[a]),u===e-1)for(;n.length%4!==0;)n.push(0)})},o=0;o<r;o++)i(o);return new Float32Array(n)},_ct=function(t,n){var e=["V","TB","BT"],r={x:1/0,y:1/0},i={x:-1/0,y:-1/0},o="x",a="y";n&&e.indexOf(n)>=0&&(a="x",o="y");var s=0;e_(t,function(l){return s++,l.x>i.x&&(i.x=l.x),l.x<r.x&&(r.x=l.x),l.y>i.y&&(i.y=l.y),l.y<r.y&&(r.y=l.y),!0});var u=Math.PI*2/s,c=i[a]-r[a];return c===0||e_(t,function(l){var h=(l[a]-r[a])/c*(Math.PI*2-u)+u,f=Math.abs(o==="x"?l.x-t.x:l.y-t.y);return l.x=f*Math.cos(h),l.y=f*Math.sin(h),!0}),t};const kct=Object.freeze(Object.defineProperty({__proto__:null,arrayToTextureData:Sct,attributesToTextureData:Mct,buildTextureData:xct,buildTextureDataWithOneEdgeAttr:wct,buildTextureDataWithTwoEdgeAttr:Ect,proccessToFunc:bct,radialLayout:_ct},Symbol.toStringTag,{value:"Module"}));var DN=function t(){return typeof window>"u"||typeof document>"u"?{}:{canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var n=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(n.getContext("webgl")||n.getContext("experimental-webgl")))}catch{return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var n=document.createElement("div");return n.id="webgl-error-message",n.style.fontFamily="monospace",n.style.fontSize="13px",n.style.fontWeight="normal",n.style.textAlign="center",n.style.background="#fff",n.style.color="#000",n.style.padding="1.5em",n.style.width="400px",n.style.margin="5em auto 0",this.webgl||(n.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`)),n},addGetWebGLMessage:function(n){n=n||{};var e=n.parent!==void 0?n.parent:document.body,r=n.id!==void 0?n.id:"oldie",i=t().getWebGLErrorMessage();i.id=r,e.appendChild(i)}}};const Act=Object.freeze(Object.defineProperty({__proto__:null,gpuDetector:DN},Symbol.toStringTag,{value:"Module"}));var PN=function(){var t=navigator.userAgent.toLowerCase();return t.indexOf("firefox")>-1?"firefox":t.indexOf("safari")>-1?"safari":t.indexOf("opr")>-1?"opera":t.indexOf("chrome")>-1?"chrome":t.indexOf("trident")>-1?"ie 11":t.indexOf("ie")>-1?"ie":"unknown"};const Cct=Object.freeze(Object.defineProperty({__proto__:null,getBrowserName:PN},Symbol.toStringTag,{value:"Module"}));var za=B(B(B(B(B({},Cr),lW),kct),Act),Cct);za.radialLayout;$e.registerLayout("grid",$e.GridLayout);$e.registerLayout("random",$e.RandomLayout);$e.registerLayout("force",$e.ForceLayout);$e.registerLayout("circular",$e.CircularLayout);$e.registerLayout("dagre",$e.DagreLayout);$e.registerLayout("dagreCompound",$e.DagreCompoundLayout);$e.registerLayout("radial",$e.RadialLayout);$e.registerLayout("concentric",$e.ConcentricLayout);$e.registerLayout("mds",$e.MDSLayout);$e.registerLayout("fruchterman",$e.FruchtermanLayout);$e.registerLayout("fruchterman-gpu",$e.FruchtermanGPULayout);$e.registerLayout("gForce",$e.GForceLayout);$e.registerLayout("force2",$e.Force2Layout);$e.registerLayout("gForce-gpu",$e.GForceGPULayout);$e.registerLayout("comboForce",$e.ComboForceLayout);$e.registerLayout("comboCombined",$e.ComboCombinedLayout);$e.registerLayout("forceAtlas2",$e.ForceAtlas2Layout);var Ict=function(){function t(n,e){var r=n.toString(),i=new Blob(["importScripts('".concat(e,"');(").concat(r,")()")],{type:"text/javascript"});return new Worker(URL.createObjectURL(i))}return t}(),Tct=function(t){t===void 0&&(t="https://unpkg.com/@antv/layout@0.3.23/dist/layout.min.js");function n(){var r={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};layout.registerLayout("grid",layout.GridLayout),layout.registerLayout("random",layout.RandomLayout),layout.registerLayout("force",layout.ForceLayout),layout.registerLayout("force2",layout.Force2Layout),layout.registerLayout("circular",layout.CircularLayout),layout.registerLayout("dagre",layout.DagreLayout),layout.registerLayout("dagreCompound",layout.DagreCompoundLayout),layout.registerLayout("radial",layout.RadialLayout),layout.registerLayout("concentric",layout.ConcentricLayout),layout.registerLayout("mds",layout.MDSLayout),layout.registerLayout("fruchterman",layout.FruchtermanLayout),layout.registerLayout("fruchterman-gpu",layout.FruchtermanGPULayout),layout.registerLayout("gForce",layout.GForceLayout),layout.registerLayout("gForce-gpu",layout.GForceGPULayout),layout.registerLayout("comboForce",layout.ComboForceLayout),layout.registerLayout("comboCombined",layout.ComboCombinedLayout),layout.registerLayout("forceAtlas2",layout.ForceAtlas2Layout);function i(a){var s=a.data.type;return s===r.RUN||s===r.GPURUN}function o(a){var s=this,u=a.data.type;switch(u){case r.RUN:{var c=a.data,l=c.nodes,h=c.edges,f=c.layoutCfg,d=f===void 0?{}:f,p=d.type,g=layout.getLayoutByName(p);if(!g){this.postMessage({type:r.ERROR,message:"layout ".concat(p," not found")});break}var v;d.onLayoutEnd=function(){s.postMessage({type:r.END,nodes:l}),v==null||v.destroy()},v=new g(d),v.init({nodes:l,edges:h}),v.execute();break}case r.GPURUN:{var m=a.data,y=m.nodes,h=m.edges,b=m.layoutCfg,d=b===void 0?{}:b,x=m.canvas,p=d.type,g=layout.getLayoutByName(p);if(!g){this.postMessage({type:r.ERROR,message:"layout ".concat(p," not found")});break}if(p.split("-")[1]!=="gpu"){this.postMessage({type:r.ERROR,message:"layout ".concat(p," does not support GPU")});break}var w=new g(d);w.init({nodes:y,edges:h}),w.executeWithWorker(x,this);break}}}onmessage=function(a){i(a)&&o(a)}}var e=new Ict(n,t);return e},du={RUN:"LAYOUT_RUN",END:"LAYOUT_END",ERROR:"LAYOUT_ERROR",TICK:"LAYOUT_TICK",GPURUN:"GPU_LAYOUT_RUN",GPUEND:"GPU_LAYOUT_END"};function Wm(t){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Wm(t)}var Oct=function(t){return setTimeout(t,16)},Nct=function(t){return clearTimeout(t)},Lf={requestAnimationFrame:function(t){var n=typeof window<"u"&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame)||Oct;return n(t)},cancelAnimationFrame:function(t){var n=typeof window<"u"&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame)||Nct;return n(t)}},Dct=["fruchterman","gForce"],Pct=["force","grid","circular"],Lct=function(t){Te(n,t);function n(e){var r=t.call(this,e)||this;return r.graph=e,r.layoutCfg=e.get("layout")||{},r.layoutType=r.getLayoutType(),r.worker=null,r.workerData={},r.initLayout(),r}return n.prototype.initLayout=function(){},n.prototype.getWorker=function(){return this.worker?this.worker:(typeof Worker>"u"?(console.warn("Web worker is not supported in current browser."),this.worker=null):this.worker=Tct(this.layoutCfg.workerScriptURL),this.worker)},n.prototype.stopWorker=function(){var e=this.workerData;this.worker&&(this.worker.terminate(),this.worker=null,e.requestId&&(Lf.cancelAnimationFrame(e.requestId),e.requestId=null),e.requestId2&&(Lf.cancelAnimationFrame(e.requestId2),e.requestId2=null))},n.prototype.execLayoutMethod=function(e,r){var i=this;return new Promise(function(o,a){return Hr(i,void 0,void 0,function(){var s,u,c,l,h,g,f,d,p,g,v;return qr(this,function(m){switch(m.label){case 0:if(s=this.graph,!s||s.get("destroyed"))return[2];u=e.type,e.onLayoutEnd=function(){s.emit("aftersublayout",{type:u}),o()},u&&this.isGPU&&(LN(u)?u="".concat(u,"-gpu"):console.warn("The '".concat(u,"' layout does not support GPU calculation for now, it will run in CPU."))),Cr.isForce(u)?(c=e.onTick,l=e.animate,h=l===void 0&&(u==="force"||u==="force2"),g=function(){c&&c(),(l||h)&&s.refreshPositions()},e.tick=g):(u==="comboForce"||u==="comboCombined")&&(e.comboTrees=s.get("comboTrees")),f=!1;try{d=new $e.Layouts[u](e),this.layoutMethods[r]&&this.layoutMethods[r].destroy(),this.layoutMethods[r]=d}catch{console.warn("The layout method: '".concat(u,"' does not exist! Please specify it first.")),a()}return f=d.enableTick,f&&(p=e.onTick,g=function(){p&&p(),s.refreshPositions()},d.tick=g),v=this.filterLayoutData(this.data,e),Fct(v,r),d.init(v),s.emit("beforesublayout",{type:u}),[4,d.execute()];case 1:return m.sent(),d.isCustomLayout&&e.onLayoutEnd&&e.onLayoutEnd(),[2]}})})})},n.prototype.updateLayoutMethod=function(e,r){var i=this;return new Promise(function(o,a){return Hr(i,void 0,void 0,function(){var s,u,c,l,h,f,d;return qr(this,function(p){switch(p.label){case 0:return s=this.graph,u=r==null?void 0:r.type,r.onLayoutEnd=function(){s.emit("aftersublayout",{type:u}),o()},Cr.isForce(u)&&(c=r.onTick,l=r.animate,h=l===void 0&&(u==="force"||u==="force2"),f=function(){c==null||c(),(l||h)&&s.refreshPositions()},r.tick=f),d=this.filterLayoutData(this.data,r),e.init(d),e.updateCfg(r),s.emit("beforesublayout",{type:u}),[4,e.execute()];case 1:return p.sent(),e.isCustomLayout&&r.onLayoutEnd&&r.onLayoutEnd(),[2]}})})})},n.prototype.layout=function(e){var r=this,i,o=this.graph;if(!(!o||o.get("destroyed"))){this.data=this.setDataFromGraph();var a=this.data,s=a.nodes,u=a.hiddenNodes;if(!s)return!1;var c=o.get("width"),l=o.get("height"),h={};Object.assign(h,{width:c,height:l,center:[c/2,l/2]},this.layoutCfg),this.layoutCfg=h;var f=h.type,d=!1;(i=this.layoutMethods)===null||i===void 0||i.forEach(function(w){var E;return d=!!(!((E=w.nodes)===null||E===void 0)&&E.length)||d});var p=this.destoryLayoutMethods();o.emit("beforelayout");var g=Promise.resolve();d&&f&&(p==null?void 0:p.length)===1&&p[0]===f?this.tweakInit():g=this.initPositions(h.center,s);var v=this.initPositions(h.center,u);v.then(),this.isGPU=n_(h,f);var m=h.onLayoutEnd,y=h.layoutEndFormatted,b=h.adjust;if(y||(h.layoutEndFormatted=!0,h.onAllLayoutEnd=function(){return Hr(r,void 0,void 0,function(){return qr(this,function(w){switch(w.label){case 0:return m&&m(s),this.refreshLayout(),b&&h.pipes?[4,this.adjustPipesBox(this.data,b)]:[3,2];case 1:w.sent(),this.refreshLayout(),w.label=2;case 2:return o.emit("afterlayout"),[2]}})})}),this.stopWorker(),h.workerEnabled&&this.layoutWithWorker(this.data,e))return!0;var x=!1;return h.type?(x=!0,g=g.then(function(){return Hr(r,void 0,void 0,function(){return qr(this,function(w){switch(w.label){case 0:return[4,this.execLayoutMethod(h,0)];case 1:return[2,w.sent()]}})})})):h.pipes&&(x=!0,h.pipes.forEach(function(w,E){g=g.then(function(){return Hr(r,void 0,void 0,function(){return qr(this,function(M){switch(M.label){case 0:return[4,this.execLayoutMethod(w,E)];case 1:return[2,M.sent()]}})})})})),x?g.then(function(){h.onAllLayoutEnd&&h.onAllLayoutEnd(),e&&e()}).catch(function(w){console.warn("graph layout failed,",w)}):(o.refreshPositions(),e==null||e()),!1}},n.prototype.tweakInit=function(){var e=this,r=e.data,i=e.graph,o=r.nodes,a=r.edges;if(o!=null&&o.length){var s={};o.forEach(function(l){var h=l.x,f=l.y;!isNaN(h)&&!isNaN(f)&&(s[l.id]={x:h,y:f},l.mass=l.mass||2)}),a.forEach(function(l){var h=l.source,f=l.target,d=s[h],p=s[f];!d&&p?s[h]={x:p.x+(Math.random()-.5)*80,y:p.y+(Math.random()-.5)*80}:!p&&d&&(s[f]={x:d.x+(Math.random()-.5)*80,y:d.y+(Math.random()-.5)*80})});var u=i.get("width"),c=i.get("height");o.forEach(function(l){var h=s[l.id]||{x:u/2+(Math.random()-.5)*20,y:c/2+(Math.random()-.5)*20};l.x=h.x,l.y=h.y})}},n.prototype.initWithPreset=function(e,r){var i=this;return new Promise(function(o,a){return Hr(i,void 0,void 0,function(){var s,u,c,l,h,f,d;return qr(this,function(p){switch(p.label){case 0:return s=this,u=s.layoutCfg,c=s.data,l=u.preset,!(l!=null&&l.type)||!$e.Layouts[l==null?void 0:l.type]?(r==null||r(),o(),[2,!1]):(h=n_(l,l.type),f=h?"".concat(l.type,"-gpu"):l.type,d=new $e.Layouts[f](l),delete u.preset,d.init(c),[4,d.execute()]);case 1:return p.sent(),e==null||e(),o(),[2,!0]}})})})},n.prototype.layoutWithWorker=function(e,r){var i=this,o=this,a=o.layoutCfg,s=o.graph,u=this.getWorker(),c=this.workerData;if(!u)return!1;c.requestId=null,c.requestId2=null,c.currentTick=null,c.currentTickData=null,s.emit("beforelayout");var l=Promise.resolve(),h=!1;if(a.type)h=!0,l=l.then(function(){return i.runWebworker(u,e,a)});else if(a.pipes){h=!0;for(var f=function(v){l=l.then(function(){return i.runWebworker(u,e,v)})},d=0,p=a.pipes;d<p.length;d++){var g=p[d];f(g)}}return h&&l.then(function(){a.onAllLayoutEnd&&a.onAllLayoutEnd(),r==null||r()}).catch(function(v){console.error("layout failed",v)}),!0},n.prototype.runWebworker=function(e,r,i){var o=this,a=this.isGPU,s=this.filterLayoutData(r,i),u=s.nodes,c=s.edges,l=document.createElement("canvas"),h=a&&typeof window<"u"&&window.navigator&&!navigator.gpu&&"OffscreenCanvas"in window&&"transferControlToOffscreen"in l,f=jct(i,function(p){return typeof p!="function"});if(!h)e.postMessage({type:du.RUN,nodes:u,edges:c,layoutCfg:f});else{var d=l.transferControlToOffscreen();f.type="".concat(f.type,"-gpu"),e.postMessage({type:du.GPURUN,nodes:u,edges:c,layoutCfg:f,canvas:d},[d])}return new Promise(function(p,g){e.onmessage=function(v){o.handleWorkerMessage(p,g,v,s,i)}})},n.prototype.handleWorkerMessage=function(e,r,i,o,a){var s=this,u=s.graph,c=s.workerData,l=i.data,h=l.type,f=function(){a.onTick&&a.onTick()};switch(h){case du.TICK:c.currentTick=l.currentTick,c.currentTickData=l,c.requestId||(c.requestId=Lf.requestAnimationFrame(function(){gv(o,l),u.refreshPositions(),f(),l.currentTick===l.totalTicks?e():c.currentTick===l.totalTicks&&(c.requestId2=Lf.requestAnimationFrame(function(){gv(o,c.currentTickData),u.refreshPositions(),c.requestId2=null,f(),e()})),c.requestId=null}));break;case du.END:c.currentTick==null&&(gv(o,l),e());break;case du.GPUEND:c.currentTick==null&&(Rct(o,l),e());break;case du.ERROR:console.warn("Web-Worker layout error!",l.message),r();break;default:r();break}},n.prototype.updateLayoutCfg=function(e){var r=this,i=this,o=i.graph,a=i.layoutMethods;if(!(!o||o.get("destroyed"))){var s=e.disableTriggerLayout,u=or(e,["disableTriggerLayout"]),c=ye({},this.layoutCfg,u);if(this.layoutCfg=c,!s){if(!(a!=null&&a.length)){this.layout();return}if(this.data=this.setDataFromGraph(),this.stopWorker(),!(u.workerEnabled&&this.layoutWithWorker(this.data,null))){o.emit("beforelayout");var l=Promise.resolve(),h=!1;(a==null?void 0:a.length)===1?(h=!0,l=l.then(function(){return Hr(r,void 0,void 0,function(){return qr(this,function(f){switch(f.label){case 0:return[4,this.updateLayoutMethod(a[0],c)];case 1:return[2,f.sent()]}})})})):a!=null&&a.length&&(h=!0,a.forEach(function(f,d){var p=c.pipes[d];l=l.then(function(){return Hr(r,void 0,void 0,function(){return qr(this,function(g){switch(g.label){case 0:return[4,this.updateLayoutMethod(f,p)];case 1:return[2,g.sent()]}})})})})),h&&l.then(function(){c.onAllLayoutEnd&&c.onAllLayoutEnd()}).catch(function(f){console.warn("layout failed",f)})}}}},n.prototype.adjustPipesBox=function(e,r){var i=this;return new Promise(function(o){var a=e.nodes;a!=null&&a.length||o(),Pct.includes(r)||(console.warn("The adjust type ".concat(r," is not supported yet, please assign it with 'force', 'grid', or 'circular'.")),o());var s={center:i.layoutCfg.center,nodeSize:function(d){return Math.max(d.height,d.width)},preventOverlap:!0,onLayoutEnd:function(){}},u=i.getLayoutBBox(a),c=u.groupNodes,l=u.layoutNodes,h=Xe(l);s.onLayoutEnd=function(){l==null||l.forEach(function(d,p){var g,v,m,y=d.x-((g=h[p])===null||g===void 0?void 0:g.x),b=d.y-((v=h[p])===null||v===void 0?void 0:v.y);(m=c[p])===null||m===void 0||m.forEach(function(x){x.x+=y,x.y+=b})}),o()};var f=new $e.Layouts[r](s);f.layout({nodes:l})})},n.prototype.destroy=function(){this.destoryLayoutMethods();var e=this.worker;e&&(e.terminate(),this.worker=null),this.destroyed=!0,this.graph.set("layout",void 0),this.layoutCfg=void 0,this.layoutType=void 0,this.layoutMethods=void 0,this.graph=null},n}(TG);function gv(t,n){for(var e=t.nodes,r=n.nodes,i=e.length,o=0;o<i;o++){var a=e[o];a.x=r[o].x,a.y=r[o].y}}function jct(t,n){var e={};return t&&Wm(t)==="object"?(Object.keys(t).forEach(function(r){t.hasOwnProperty(r)&&n(t[r])&&(e[r]=t[r])}),e):t}function Rct(t,n){for(var e=t.nodes,r=n.vertexEdgeData,i=e.length,o=0;o<i;o++){var a=e[o],s=r[4*o],u=r[4*o+1];a.x=s,a.y=u}}function Fct(t,n){var e;if(!((e=t==null?void 0:t.nodes)===null||e===void 0)&&e.length){var r=t.nodes;r.forEach(function(i){i.layoutOrder=n})}}function LN(t){return Dct.includes(t)}function n_(t,n){var e=n;n&&n.split("-")[1]==="gpu"&&(e=n.split("-")[0],t.gpuEnabled=!0);var r=!1;return t.gpuEnabled&&(r=!0,DN().webgl||(console.warn("Your browser does not support webGL or GPGPU. The layout will run in CPU."),r=!1)),r&&!LN(e)&&(console.warn("The '".concat(e,"' layout does not support GPU calculation for now, it will run in CPU.")),r=!1),r}var Bct=function(t){var n=t.clone();return zct(t,n),n},zct=function t(n,e){var r;n.isGroup()&&e.isGroup()&&((r=n.get("children"))===null||r===void 0||r.forEach(function(s,u){var c=e.get("children")[u];t(s,c)}));var i=n.get("type"),o=e.get("type");if(!(i!=="image"||o!=="image")){var a=n.get("clipShape");a&&e.setClip({type:a.get("type"),attrs:a.attr()})}},r_=yi,Gct="svg",Uct=function(t){Te(n,t);function n(e){var r=t.call(this,e)||this,i=r.get("defaultNode");return i||r.set("defaultNode",{type:"circle"}),i.type||(i.type="circle",r.set("defaultNode",i)),r.destroyed=!1,r}return n.prototype.initLayoutController=function(){var e=new Lct(this);this.set({layoutController:e})},n.prototype.initEventController=function(){var e=new vW(this);this.set({eventController:e})},n.prototype.initCanvas=function(){var e=this.get("container");if(typeof e=="string"&&(e=document.getElementById(e),this.set("container",e)),!e)throw new Error("invalid container");var r=e.clientWidth,i=e.clientHeight,o=this.get("width")||r,a=this.get("height")||i;!this.get("width")&&!this.get("height")&&(this.set("width",r),this.set("height",i));var s=this.get("renderer"),u;if(s===Gct)u=new $c({container:e,width:o,height:a});else{var c={container:e,width:o,height:a},l=this.get("pixelRatio");l&&(c.pixelRatio=l,window.devicePixelRatio=l),u=new Uo(c)}this.set("canvas",u)},n.prototype.initPlugins=function(){var e=this;mt(e.get("plugins"),function(r){!r.destroyed&&r.initPlugin&&r.initPlugin(e)})},n.prototype.downloadImageWatermark=function(e,r,i,o){return Hr(this,void 0,void 0,function(){var a,s,u;return qr(this,function(c){switch(c.label){case 0:return a=e.style.backgroundImage,s=a.slice(5,a.length-2),u=new Image,u.src=s,[4,new Promise(function(l){u.onload=function(){var h=r.createPattern(u,"repeat");r.rect(0,0,i,o),r.fillStyle=h,r.fill(),l("")}})];case 1:return c.sent(),[2]}})})},n.prototype.asyncToDataUrl=function(e,r,i,o,a,s){var u=this,c=document.querySelector(".g6-graph-watermarker"),l=this.get("canvas"),h=l.getRenderer(),f=s||l.get("el"),d="";e||(e="image/png"),setTimeout(function(){return Hr(u,void 0,void 0,function(){var p,g,v,m,y,b,x,w,E,M;return qr(this,function(_){switch(_.label){case 0:return h!=="svg"?[3,1]:(p=f.cloneNode(!0),g=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),v=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",g),v.replaceChild(p,v.documentElement),m=new XMLSerializer().serializeToString(v),d="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(m)),[3,4]);case 1:return y=void 0,b=f.getContext("2d"),x=o||this.get("width"),w=a||this.get("height"),E=void 0,c?[4,this.downloadImageWatermark(c,b,x,w)]:[3,3];case 2:_.sent(),_.label=3;case 3:if(r){M=typeof window<"u"?window.devicePixelRatio:1;try{y=b.getImageData(0,0,x*M,w*M),E=b.globalCompositeOperation,b.globalCompositeOperation="destination-over",b.fillStyle=r,b.fillRect(0,0,x,w)}catch{console.error("Download image failed. Out of memory at ImageData creation")}}d=f.toDataURL(e),r&&(b.clearRect(0,0,x,w),b.putImageData(y,0,0),b.globalCompositeOperation=E),_.label=4;case 4:return i&&i(d),[2]}})})},16)},n.prototype.toDataURL=function(e,r){var i=this.get("canvas"),o=i.getRenderer(),a=i.get("el");e||(e="image/png");var s="";if(o==="svg"){var u=a.cloneNode(!0),c=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),l=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",c);l.replaceChild(u,l.documentElement);var h=new XMLSerializer().serializeToString(l);s="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(h))}else{var f=void 0,d=a.getContext("2d"),p=Math.max(this.get("width"),500),g=Math.max(this.get("height"),500),v=void 0;if(r){var m=typeof window<"u"&&window.devicePixelRatio||1;try{f=d.getImageData(0,0,p*m,g*m),v=d.globalCompositeOperation,d.globalCompositeOperation="destination-over",d.fillStyle=r,d.fillRect(0,0,p,g)}catch{console.error("Download image failed. Out of memory at ImageData creation")}}s=a.toDataURL(e),r&&(d.clearRect(0,0,p,g),d.putImageData(f,0,0),d.globalCompositeOperation=v)}return s},n.prototype.toFullDataURL=function(e,r,i){var o=this.get("group").getCanvasBBox(),a=o.height,s=o.width,u=this.get("renderer"),c=Mn('<div id="virtual-image"></div>'),l=i?i.backgroundColor:void 0,h=i?i.padding:void 0;h?pe(h)&&(h=[h,h,h,h]):h=[0,0,0,0];var f=a+h[0]+h[2],d=s+h[1]+h[3],p={container:c,height:f,width:d,quickHit:!0},g=u==="svg"?new $c(p):new Uo(p),v=this.get("group"),m=v.clone(),y=Xe(m.getMatrix());y||(y=[1,0,0,0,1,0,0,0,1]);var b=(o.maxX+o.minX)/2,x=(o.maxY+o.minY)/2;y=r_(y,[["t",-b,-x],["t",s/2+h[3],a/2+h[0]]]),m.resetMatrix(),m.setMatrix(y),g.add(m);var w=g.get("el"),E="";r||(r="image/png"),setTimeout(function(){if(u==="svg"){var M=w.cloneNode(!0),_=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),k=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",_);k.replaceChild(M,k.documentElement);var S=new XMLSerializer().serializeToString(k);E="data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(S))}else{var A=void 0,C=w.getContext("2d"),I=void 0;if(l){var N=typeof window<"u"?window.devicePixelRatio:1;try{A=C.getImageData(0,0,d*N,f*N),I=C.globalCompositeOperation,C.globalCompositeOperation="destination-over",C.fillStyle=l,C.fillRect(0,0,d,f)}catch{console.error("Download image failed. Out of memory at ImageData creation")}}E=w.toDataURL(r),l&&(C.clearRect(0,0,d,f),C.putImageData(A,0,0),C.globalCompositeOperation=I)}e&&e(E)},16)},n.prototype.downloadFullImage=function(e,r,i){var o=this,a=this.get("group").getCanvasBBox(),s=a.height,u=a.width,c=this.get("renderer"),l=Mn('<div id="virtual-image"></div>'),h=document.querySelector(".g6-graph-watermarker"),f=i?i.backgroundColor:void 0,d=i?i.padding:void 0;d?pe(d)&&(d=[d,d,d,d]):d=[0,0,0,0];var p=s+d[0]+d[2],g=u+d[1]+d[3];if(h){var v=this.get("graphWaterMarker").cfg||{},m=v.width,y=v.height;p=Math.ceil(p/y)*y,g=Math.ceil(g/m)*m}var b={container:l,height:p,width:g},x=c==="svg"?new $c(b):new Uo(b),w=this.get("group"),E=Bct(w),M=Xe(E.getMatrix());M||(M=[1,0,0,0,1,0,0,0,1]);var _=(a.maxX+a.minX)/2,k=(a.maxY+a.minY)/2;M=r_(M,[["t",-_,-k],["t",u/2+d[3],s/2+d[0]]]),E.resetMatrix(),E.setMatrix(M),x.add(E);var S=x.get("el");r||(r="image/png"),this.asyncToDataUrl(r,f,function(A){var C=document.createElement("a"),I=(e||"graph")+(c==="svg"?".svg":".".concat(r.split("/")[1]));o.dataURLToImage(A,c,C,I);var N=document.createEvent("MouseEvents");N.initEvent("click",!1,!1),C.dispatchEvent(N)},g,p,S)},n.prototype.downloadImage=function(e,r,i){var o=this,a=this;a.stopAnimate();var s=a.get("canvas"),u=s.getRenderer();r||(r="image/png");var c=(e||"graph")+(u==="svg"?".svg":r.split("/")[1]),l=document.createElement("a");a.asyncToDataUrl(r,i,function(h){o.dataURLToImage(h,u,l,c);var f=document.createEvent("MouseEvents");f.initEvent("click",!1,!1),l.dispatchEvent(f)})},n.prototype.dataURLToImage=function(e,r,i,o){if(!e||e==="data:"){console.error("Download image failed. The graph is too large or there is invalid attribute values in graph items");return}if(typeof window<"u")if(window.Blob&&window.URL&&r!=="svg"){var a=e.split(","),s="";if(a&&a.length>0){var u=a[0].match(/:(.*?);/);u&&u.length>=2&&(s=u[1])}for(var c=atob(a[1]),l=c.length,h=new Uint8Array(l);l--;)h[l]=c.charCodeAt(l);var f=new Blob([h],{type:s});window.navigator.msSaveBlob?window.navigator.msSaveBlob(f,o):i.addEventListener("click",function(){i.download=o,i.href=window.URL.createObjectURL(f)})}else i.addEventListener("click",function(){i.download=o,i.href=e})},n.prototype.addPlugin=function(e){var r=this;e.destroyed||(r.get("plugins").push(e),e.initPlugin(r))},n.prototype.removePlugin=function(e){var r=this.get("plugins"),i=r.indexOf(e);i>=0&&(e.destroyPlugin(),r.splice(i,1))},n.prototype.setImageWaterMarker=function(e,r){e===void 0&&(e=nl.waterMarkerImage);var i=this.get("container");Dt(i)&&(i=document.getElementById(i)),i.style.position||(i.style.position="relative");var o=this.get("graphWaterMarker"),a=mn({},nl.imageWaterMarkerConfig,r),s=a.width,u=a.height,c=a.compatible,l=a.image;if(!e){var h=c?i:document.querySelector(".g6-graph-watermarker");h&&(h.style.cssText=void 0),o&&o.clear();return}if(o)o.clear();else{var f={container:i,width:s,height:u,capture:!1},d=this.get("pixelRatio");d&&(f.pixelRatio=d,window.devicePixelRatio=d),o=new Uo(f),this.set("graphWaterMarker",o)}o.get("el").style.display="none";var p=o.get("context"),g=l.rotate,v=l.x,m=l.y;p.rotate(-g*Math.PI/180);var y=new Image;y.crossOrigin="anonymous",y.src=e,y.onload=function(){if(p.drawImage(y,v,m,l.width,l.height),p.rotate(g*Math.PI/180),c)i.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var b=document.querySelector(".g6-graph-watermarker");b||(b=document.createElement("div"),b.className="g6-graph-watermarker"),b.className="g6-graph-watermarker",o.destroyed||(b.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;"),i.appendChild(b))}}},n.prototype.setTextWaterMarker=function(e,r){var i=this.get("container");Dt(i)&&(i=document.getElementById(i)),i.style.position||(i.style.position="relative");var o=this.get("graphWaterMarker"),a=mn({},nl.textWaterMarkerConfig,r),s=a.width,u=a.height,c=a.compatible,l=a.text;if(!(e!=null&&e.length)){var h=c?i:document.querySelector(".g6-graph-watermarker");h&&(h.style.cssText=void 0),o&&o.clear();return}if(o)o.clear();else{var f={container:i,width:s,height:u,capture:!1},d=this.get("pixelRatio");d&&(f.pixelRatio=d,window.devicePixelRatio=d),o=new Uo(f),this.set("graphWaterMarker",o)}o.get("el").style.display="none";var p=o.get("context"),g=l.rotate,v=l.fill,m=l.fontFamily,y=l.fontSize,b=l.baseline,x=l.x,w=l.y,E=l.lineHeight;p.rotate(-g*Math.PI/180),p.font="".concat(y,"px ").concat(m),p.fillStyle=v,p.textBaseline=b;for(var M=Dt(e)?[e]:e,_=M.length-1;_>=0;_--)p.fillText(M[_],x,w+_*E);if(p.rotate(g*Math.PI/180),c)i.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;");else{var k=document.querySelector(".g6-graph-watermarker");k||(k=document.createElement("div"),k.className="g6-graph-watermarker"),k.style.cssText="background-image: url(".concat(o.get("el").toDataURL("image/png"),");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;"),i.appendChild(k)}},n.prototype.destroy=function(){var e,r,i,o;mt(this.get("plugins"),function(l){l.destroyPlugin()});var a=this.get("tooltips");if(a)for(var s=0;s<a.length;s++){var u=a[s];if(u){var c=u.parentElement;c&&c.removeChild(u)}}(e=this.get("eventController"))===null||e===void 0||e.destroy(),(r=this.get("layoutController"))===null||r===void 0||r.destroy(),(i=this.get("graphWaterMarker"))===null||i===void 0||i.destroy(),(o=document.querySelector(".g6-graph-watermarker"))===null||o===void 0||o.remove(),t.prototype.destroy.call(this)},n}(mG),Yct=za.radialLayout,vv=za.traverseTree,Vct=function(t){Te(n,t);function n(e){var r=t.call(this,e)||this;return r.layoutAnimating=!1,r.set("removeList",[]),r.set("layoutMethod",r.getLayout()),r}return n.prototype.getLayout=function(){var e=this.get("layout");return e?typeof e=="function"?e:(e.type||(e.type="dendrogram"),e.direction||(e.direction=e.type==="indented"?"LR":"TB"),e.radial?function(r){var i=t_[e.type](r,e);return Yct(i),i}:function(r){return t_[e.type](r,e)}):null},n.indexOfChild=function(e,r){var i=-1;return mt(e,function(o,a){if(r===o.id)return i=a,!1}),i},n.prototype.getDefaultCfg=function(){var e=t.prototype.getDefaultCfg.call(this);return e.animate=!0,e},n.prototype.innerAddChild=function(e,r,i){var o=this,a=e.data;a&&(a.x=e.x,a.y=e.y,a.depth=e.depth);var s=o.addItem("node",a,!1);if(r){if(s.set("parent",r),i){var u=r.get("originAttrs");if(u)s.set("originAttrs",u);else{var c=r.getModel();s.set("originAttrs",{x:c.x,y:c.y})}}var l=r.get("children");l?l.push(s):r.set("children",[s]),o.addItem("edge",{source:r.get("id"),target:s.get("id"),id:"".concat(r.get("id"),":").concat(s.get("id"))},!1)}return mt(e.children||[],function(h){o.innerAddChild(h,s,i)}),o.emit("afteraddchild",{item:s,parent:r}),s},n.prototype.innerUpdateChild=function(e,r,i){var o=this,a=o.findById(e.id);if(!a){o.innerAddChild(e,r,i);return}mt(e.children||[],function(p){o.innerUpdateChild(p,a,i)});var s=a.get("children");if(s){var u=s.length;if(u>0)for(var c=s.length-1;c>=0;c--){var l=s[c].getModel();n.indexOfChild(e.children||[],l.id)===-1&&(o.innerRemoveChild(l.id,{x:e.x,y:e.y},i),s.splice(c,1))}}var h,f;a.get("originAttrs")&&(h=a.get("originAttrs").x,f=a.get("originAttrs").y);var d=a.getModel();i&&a.set("originAttrs",{x:d.x,y:d.y}),a.set("model",Object.assign(d,e.data)),(h!==e.x||f!==e.y)&&a.updatePosition({x:e.x,y:e.y})},n.prototype.innerRemoveChild=function(e,r,i){var o=this,a=o.findById(e);if(a)if(mt(a.get("children"),function(u){o.innerRemoveChild(u.getModel().id,r,i)}),i){var s=a.getModel();a.set("to",r),a.set("originAttrs",{x:s.x,y:s.y}),o.get("removeList").push(a)}else o.removeItem(a,!1)},n.prototype.changeData=function(e,r){r===void 0&&(r=!0);var i=this;this.getNodes().map(function(o){return i.clearItemStates(o)}),this.getEdges().map(function(o){return i.clearItemStates(o)}),r&&this.get("enabledStack")&&this.pushStack("changedata",{before:i.get("originData"),after:e||i.get("data")}),e?(i.data(e),i.render(!1)):i.layout(this.get("fitView"))},n.prototype.changeLayout=function(e){console.warn("Please call updateLayout instead of changeLayout. changeLayout will be discarded soon");var r=this;r.updateLayout(e)},n.prototype.updateLayout=function(e,r,i,o){o===void 0&&(o=!0);var a=this;if(!e){console.warn("layout cannot be null");return}if(o&&this.get("enabledStack")&&this.pushStack("layout",{before:a.get("layout"),after:e}),a.set("layout",e),a.set("layoutMethod",a.getLayout()),a.layout(),r){var s=i;s||(r==="begin"?s={x:0,y:0}:s={x:this.getWidth()/2,y:this.getHeight()/2}),s=this.getPointByCanvas(s.x,s.y);var u=this.getGroup().getMatrix()||[1,0,0,0,1,0,0,0,1];s.x=s.x*u[0]+u[6],s.y=s.y*u[0]+u[7];var c=this.getGroup().getCanvasBBox(),l=c.minX,h=c.maxX,f=c.minY,d=c.maxY,p={x:(l+h)/2,y:(f+d)/2};r==="begin"&&(p.x=l,p.y=f),this.translate(s.x-p.x,s.y-p.y)}},n.prototype.refreshLayout=function(e){console.warn("Please call layout instead of refreshLayout. refreshLayout will be discarded soon");var r=this;r.layout(e)},n.prototype.layout=function(e){var r=this,i=this,o=i.get("data"),a=i.get("layoutMethod"),s=i.get("layout"),u=o;if(s!=null&&s.excludeInvisibles){o=Xe(i.get("data"));var c={};vv(o,function(f){var d=f.children;if(!(d!=null&&d.length))return!0;for(var p=d.length-1;p>=0;p--){var g=r.findById(d[p].id),v=g?!g.isVisible():d[p].visible===!1;v&&(c[f.id]=c[f.id]||[],c[f.id].push({idx:p,child:d.splice(p,1)[0]}))}}),u=a?a(o,i.get("layout")):o,vv(u,function(f){var d=c[f.id];if(d!=null&&d.length)for(var p=d.length-1;p>=0;p--){var g=d[p],v=g.idx,m=g.child;f.children.splice(v,0,m)}})}else u=a?a(o,i.get("layout")):o;var l=i.get("animate");if(i.emit("beforerefreshlayout",{data:o,layoutData:u}),i.emit("beforelayout"),i.innerUpdateChild(u,void 0,l),e){var h=i.get("viewController");h.fitView()}l?i.layoutAnimate(u):(i.refresh(),i.paint()),i.emit("afterrefreshlayout",{data:o,layoutData:u}),i.emit("afterlayout")},n.prototype.addChild=function(e,r,i){i===void 0&&(i=!0);var o=this;o.emit("beforeaddchild",{model:e,parent:r}),Dt(r)||(r=r.get("id"));var a=o.findDataById(r);if(a){a.children||(a.children=[]),a.children.push(e);var s=o.findById(r);s.refresh(),o.changeData(void 0,i)}},n.prototype.updateChildren=function(e,r,i){i===void 0&&(i=!0);var o=this,a=o.findById(r);if(!r||!a){console.warn("Update children failed! There is no node with id '".concat(r,"'"));return}var s=o.findDataById(r);s.children=e,a.refresh(),o.changeData(void 0,i)},n.prototype.updateChild=function(e,r,i){i===void 0&&(i=!0);var o=this;if(!r||!o.findById(r)){o.changeData(e,i);return}var a=o.findDataById(r),s=o.findById(e.id);if(a.children||(a.children=[]),!s)a.children.push(e);else{var u=n.indexOfChild(a.children,e.id);u>-1&&(a.children[u]=e)}var c=o.findById(r);c==null||c.refresh(),o.changeData(void 0,i)},n.prototype.removeChild=function(e,r){r===void 0&&(r=!0);var i=this,o=i.findById(e),a;if(o?a=o==null?void 0:o.get("parent"):a=i.getNodes().find(function(h){var f=h.getModel().children||[];return!!f.find(function(d){return d.id===e})}),a&&!a.destroyed){var s=a.get("id"),u=i.findDataById(s),c=u&&u.children||[],l=n.indexOfChild(c,e);c.splice(l,1),a.refresh()}i.changeData(void 0,r)},n.prototype.findDataById=function(e,r){var i=this;if(r||(r=i.get("data")),e===r.id)return r;var o=null;return mt(r.children||[],function(a){if(a.id===e)return o=a,!1;if(o=i.findDataById(e,a),o)return!1}),o},n.prototype.layoutAnimate=function(e,r){var i=this,o=this.get("animateCfg");i.emit("beforeanimate",{data:e}),i.getEdges().forEach(function(a){var s=a.get("model");s.sourceAnchor||(s.sourceAnchor=a.get("sourceAnchorIndex"))}),this.get("canvas").animate(function(a){vv(e,function(s){var u=i.findById(s.id);if(u){var c=u.get("originAttrs"),l=u.get("model");if(c||(c={x:l.x,y:l.y},u.set("originAttrs",c)),r){var h=r(u,a,c,e);u.set("model",Object.assign(l,h))}else l.x=c.x+(s.x-c.x)*a,l.y=c.y+(s.y-c.y)*a}return!0}),mt(i.get("removeList"),function(s){var u=s.getModel(),c=s.get("originAttrs"),l=s.get("to");u.x=c.x+(l.x-c.x)*a,u.y=c.y+(l.y-c.y)*a}),i.refreshPositions()},{duration:o.duration,easing:o.ease,callback:function(){mt(i.getNodes(),function(a){a.set("originAttrs",null)}),mt(i.get("removeList"),function(a){i.removeItem(a,!1)}),i.set("removeList",[]),o.callback&&o.callback(),i.emit("afteranimate",{data:e})},delay:o.delay})},n.prototype.stopLayoutAnimate=function(){this.get("canvas").stopAnimate(),this.emit("layoutanimateend",{data:this.get("data")}),this.layoutAnimating=!1},n.prototype.isLayoutAnimating=function(){return this.layoutAnimating},n.prototype.render=function(e){e===void 0&&(e=!0);var r=this,i=r.get("data");if(!i||!yr(i)||!Object.keys(i).length)throw new Error("data must be defined first");r.clear(),e&&this.get("enabledStack")&&this.clearStack(),r.emit("beforerender"),r.layout(this.get("fitView")),r.emit("afterrender")},n.prototype.save=function(){return this.get("data")},n.prototype.data=function(e){t.prototype.data.call(this,e),this.set("originData",JSON.parse(JSON.stringify(e)))},n}(Uct),Wct=function(){function t(n){this._cfgs=mn(this.getDefaultCfgs(),n),this._events={},this.destroyed=!1}return t.prototype.getDefaultCfgs=function(){return{}},t.prototype.initPlugin=function(n){var e=this;e.set("graph",n);var r=e.getEvents(),i={};mt(r,function(o,a){var s=fs(e,o);i[a]=s,n.on(a,s)}),this._events=i,this.init()},t.prototype.getEvents=function(){return{}},t.prototype.get=function(n){var e;return(e=this._cfgs)===null||e===void 0?void 0:e[n]},t.prototype.set=function(n,e){this._cfgs[n]=e},t.prototype.destroy=function(){},t.prototype.destroyPlugin=function(){this.destroy();var n=this.get("graph"),e=this._events;mt(e,function(r,i){n.off(i,r)}),this._events=null,this._cfgs=null,this.destroyed=!0},t}();const ni=Wct;var Xct=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),i_="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=)";(function(t){Xct(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{img:i_,follow:!0}},n.prototype.init=function(){var e=this.get("graph"),r=e.get("container"),i=e.get("canvas").get("el"),o=this.get("img")||i_;o.includes("url(")||(o='url("'.concat(o,'")'));var a=Mn(`<div class='g6-grid-container' style="position:absolute;overflow:hidden;z-index: -1;"></div>`),s=Mn(`<div
        class='g6-grid'
        style='position:absolute;
        background-image: `.concat(o,`;
        user-select: none
        '></div>`));this.set("container",a),this.set("gridContainer",s),this.positionInit(),a.appendChild(s),r.insertBefore(a,i)},n.prototype.positionInit=function(){var e=this.get("graph"),r=e.get("minZoom"),i=e.get("width"),o=e.get("height");Ve(this.get("container"),{width:"".concat(i,"px"),height:"".concat(o,"px")});var a=i*80/r,s=o*80/r;Ve(this.get("gridContainer"),{width:"".concat(a,"px"),height:"".concat(s,"px"),left:"-".concat(a/2,"px"),top:"-".concat(s/2,"px")})},n.prototype.getEvents=function(){return{viewportchange:"updateGrid"}},n.prototype.updateGrid=function(e){var r=this.get("gridContainer"),i=e.matrix;i||(i=[1,0,0,0,1,0,0,0,1]);var o=this.get("follow"),a="matrix(".concat(i[0],", ").concat(i[1],", ").concat(i[3],", ").concat(i[4],", ").concat(o?i[6]:"0",", ").concat(o?i[7]:"0",")");Ve(r,{transform:a})},n.prototype.getContainer=function(){return this.get("container")},n.prototype.destroy=function(){var e=this.get("graph"),r=e.get("container"),i=this.get("container");r.removeChild(i)},n})(ni);var vb={exports:{}},o_=[],jc=[],Hct="insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";function jN(t,n){if(n=n||{},t===void 0)throw new Error(Hct);var e=n.prepend===!0?"prepend":"append",r=n.container!==void 0?n.container:document.querySelector("head"),i=o_.indexOf(r);i===-1&&(i=o_.push(r)-1,jc[i]={});var o;return jc[i]!==void 0&&jc[i][e]!==void 0?o=jc[i][e]:(o=jc[i][e]=qct(),e==="prepend"?r.insertBefore(o,r.childNodes[0]):r.appendChild(o)),t.charCodeAt(0)===65279&&(t=t.substr(1,t.length)),o.styleSheet?o.styleSheet.cssText+=t:o.textContent+=t,o}function qct(){var t=document.createElement("style");return t.setAttribute("type","text/css"),t}vb.exports=jN;vb.exports.insertCss=jN;var Zct=vb.exports;const rg=bo(Zct);var Kct=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();typeof document<"u"&&rg(`
  .g6-component-contextmenu {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .g6-contextmenu-ul {
    padding: 0;
    margin: 0;
    list-style: none;
  }

`);(function(t){Kct(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,handleMenuClick:void 0,getContent:function(e){return`
          <ul class='g6-contextmenu-ul'>
            <li>菜单项1</li>
            <li>菜单项2</li>
          </ul>
        `},shouldBegin:function(e){return!0},onHide:function(){return!0},itemTypes:["node","edge","combo"],trigger:"contextmenu"}},n.prototype.getEvents=function(){return this.get("trigger")==="click"?{click:"onMenuShow",touchend:"onMenuShow"}:{contextmenu:"onMenuShow"}},n.prototype.init=function(){var e=this.get("className"),r=Mn("<div class=".concat(e||"g6-component-contextmenu","></div>"));Ve(r,{top:"0px",position:"absolute",visibility:"hidden"});var i=this.get("container");i||(i=this.get("graph").get("container")),Dt(i)&&(i=document.getElementById(i)),i.appendChild(r),this.set("menu",r)},n.prototype.onMenuShow=function(e){var r=this;e.preventDefault();var i=this.get("itemTypes");if(e.item){if(e.item&&e.item.getType&&i.indexOf(e.item.getType())===-1){r.onMenuHide();return}}else if(i.indexOf("canvas")===-1){r.onMenuHide();return}var o=this.get("shouldBegin");if(o(e)){var a=this.get("menu"),s=this.get("getContent"),u=this.get("graph"),c=s(e,u);Dt(c)?a.innerHTML=c:a.innerHTML=c.outerHTML,this.removeMenuEventListener();var l=this.get("handleMenuClick");if(l){var h=function(M){l(M.target,e.item,u)};this.set("handleMenuClickWrapper",h),a.addEventListener("click",h)}var f=u.get("width"),d=u.get("height"),p=a.getBoundingClientRect(),g=this.get("offsetX")||0,v=this.get("offsetY")||0,m=u.getContainer().offsetTop,y=u.getContainer().offsetLeft,b=e.canvasX+y+g,x=e.canvasY+m+v;b+p.width>f&&(b=e.canvasX-p.width-g+y),x+p.height>d&&(x=e.canvasY-p.height-v+m),Ve(a,{top:"".concat(x,"px"),left:"".concat(b,"px"),visibility:"visible"});var w=this.get("trigger")==="click",E=function(M){if(w){w=!1;return}r.onMenuHide()};document.body.addEventListener("click",E),this.set("handler",E)}},n.prototype.removeMenuEventListener=function(){var e=this.get("handleMenuClickWrapper"),r=this.get("handler");if(e){var i=this.get("menu");i.removeEventListener("click",e),this.set("handleMenuClickWrapper",null)}r&&document.body.removeEventListener("click",r)},n.prototype.onMenuHide=function(){var e=this.get("menu");e&&Ve(e,{visibility:"hidden"}),this.removeMenuEventListener()},n.prototype.destroy=function(){var e=this.get("menu");if(this.removeMenuEventListener(),e){var r=this.get("container");r||(r=this.get("graph").get("container")),Dt(r)&&(r=document.getElementById(r)),r.removeChild(e)}},n})(ni);var Qct=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Xm=globalThis&&globalThis.__assign||function(){return Xm=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Xm.apply(this,arguments)},a_=Math.max,Jct=yi,$ct="default",tlt="keyShape",elt="delegate",s_="svg";(function(t){Qct(n,t);function n(e){var r=t.call(this,e)||this;return r.handleUpdateCanvas=Fl(function(i){var o=r;o.destroyed||o.updateCanvas()},100,!1),r}return n.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",type:"default",padding:50,size:[200,120],delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0,hideEdge:!1}},n.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},n.prototype.disableRefresh=function(){this.set("refresh",!1)},n.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},n.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},n.prototype.initViewport=function(){var e=this,r=this._cfgs,i=r.size,o=r.graph;if(!this.destroyed){var a=this.get("canvas"),s=a.get("container"),u=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,c=navigator.userAgent.toLowerCase().indexOf("safari")>-1,l=Mn(`
      <div
        class=`.concat(r.viewportClassName,`
        style='position:absolute;
          left:0;
          top:0;
          box-sizing:border-box;
          outline: 2px solid #1980ff;
          cursor:move'
        draggable=`).concat(!(c||u),`
      </div>`)),h=0,f=0,d=!1,p=0,g=0,v=0,m=0,y=0,b=0,x=c||u?"mousedown":"dragstart";l.addEventListener(x,function(_){var k,S;if(_.dataTransfer){var A=new Image;A.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' %3E%3Cpath /%3E%3C/svg%3E",(S=(k=_.dataTransfer).setDragImage)===null||S===void 0||S.call(k,A,0,0);try{_.dataTransfer.setData("text/html","view-port-minimap")}catch{_.dataTransfer.setData("text","view-port-minimap")}}if(r.refresh=!1,_.target===l){var C=l.style;p=parseInt(C.left,10),g=parseInt(C.top,10),v=parseInt(C.width,10),m=parseInt(C.height,10),!(v>i[0]||m>i[1])&&(b=o.getZoom(),y=e.get("ratio"),d=!0,h=_.clientX,f=_.clientY)}},!1);var w=function(_){if(!(!d||fe(_.clientX)||fe(_.clientY))){var k=h-_.clientX,S=f-_.clientY;(p-k<0||p-k+v>=i[0])&&(k=0),(g-S<0||g-S+m>=i[1])&&(S=0),p-=k,g-=S,Ve(l,{left:"".concat(p,"px"),top:"".concat(g,"px")}),o.translate(k*b/y,S*b/y),h=_.clientX,f=_.clientY}};!c&&!u&&l.addEventListener("drag",w,!1);var E=function(){d=!1,r.refresh=!0},M=c||u?"mouseup":"dragend";l.addEventListener(M,E,!1),s.addEventListener("mouseleave",E),s.addEventListener("mouseup",E),(c||u)&&s.addEventListener("mousemove",w,!1),this.set("viewport",l),s.appendChild(l)}},n.prototype.updateViewport=function(){if(!this.destroyed){var e=this.get("ratio"),r=this.get("totaldx"),i=this.get("totaldy"),o=this.get("graph"),a=this.get("size"),s=o.get("canvas").get("el"),u=o.get("width")||s.scrollWidth||500,c=o.get("height")||s.scrollHeight||500,l=o.getPointByCanvas(0,0),h=o.getPointByCanvas(u,c),f=this.get("viewport");f||this.initViewport();var d=(h.x-l.x)*e,p=(h.y-l.y)*e,g=l.x*e+r,v=l.y*e+i,m=g+d,y=v+p;g<0&&(d+=g,g=0),m>a[0]&&(d=d-(m-a[0])),v<0&&(p+=v,v=0),y>a[1]&&(p=p-(y-a[1])),this.set("ratio",e);var b="".concat(g,"px"),x="".concat(v,"px");Ve(f,{left:b,top:x,width:"".concat(d,"px"),height:"".concat(p,"px")})}},n.prototype.updateGraphShapes=function(){var e=this._cfgs.graph,r=this.get("canvas"),i=e.get("group");if(!i.destroyed){r.clear();var o;this.get("hideEdge")?(o=r.addGroup(),i.get("children").forEach(function(s){s.get("id").includes("-edge")||o.add(s.clone())})):(o=i.clone(),o.resetMatrix(),r.add(o));var a=e.get("renderer");a===s_&&this.updateVisible(o)}},n.prototype.updateVisible=function(e){var r=this;if(!e.isGroup()&&!e.get("visible"))e.hide();else{var i=e.get("children");if(!i||!i.length)return;i.forEach(function(o){o.get("visible")||o.hide(),r.updateVisible(o)})}},n.prototype.updateKeyShapes=function(){var e=this,r=this._cfgs.graph,i=this.get("canvas"),o=i.get("children")[0]||i.addGroup();this.get("hideEdge")||mt(r.getEdges(),function(u){e.updateOneEdgeKeyShape(u,o)}),mt(r.getNodes(),function(u){e.updateOneNodeKeyShape(u,o)});var a=r.getCombos();if(a&&a.length){var s=o.find(function(u){return u.get("name")==="comboGroup"})||o.addGroup({name:"comboGroup"});setTimeout(function(){e.destroyed||(mt(a,function(u){e.updateOneComboKeyShape(u,s)}),s==null||s.sort(),s==null||s.toBack(),e.updateCanvas())},250)}this.clearDestroyedShapes()},n.prototype.updateOneComboKeyShape=function(e,r){if(!this.destroyed){var i=this.get("itemMap")||{},o=i[e.get("id")],a=e.getBBox(),s=e.get("keyShape").clone(),u=s.attr(),c={x:a.centerX,y:a.centerY};o?c=Object.assign(u,c):(o=s,r.add(o));var l=o.get("type");(l==="rect"||l==="image")&&(c.x=a.minX,c.y=a.minY),o.attr(c),e.isVisible()?o.show():o.hide(),o.exist=!0;var h=e.getModel().depth;isNaN(h)||o.set("zIndex",h),i[e.get("id")]=o,this.set("itemMap",i)}},n.prototype.updateOneNodeKeyShape=function(e,r){var i=this.get("itemMap")||{},o=i[e.get("id")],a=e.getBBox(),s=e.get("keyShape").clone(),u=s.attr(),c={x:a.centerX,y:a.centerY};o?(c=Object.assign(u,c),o.toFront()):(o=s,r.add(o));var l=o.get("type");(l==="rect"||l==="image")&&(c.x=a.minX,c.y=a.minY),o.attr(c),e.isVisible()?o.show():o.hide(),o.exist=!0;var h=e.getModel().depth;isNaN(h)||o.set("zIndex",h),i[e.get("id")]=o,this.set("itemMap",i)},n.prototype.updateDelegateShapes=function(){var e=this,r=this._cfgs.graph,i=this.get("canvas"),o=i.get("children")[0]||i.addGroup();this.get("hideEdge")||mt(r.getEdges(),function(u){e.updateOneEdgeKeyShape(u,o)}),mt(r.getNodes(),function(u){e.updateOneNodeDelegateShape(u,o)});var a=r.getCombos();if(a&&a.length){var s=o.find(function(u){return u.get("name")==="comboGroup"})||o.addGroup({name:"comboGroup"});setTimeout(function(){e.destroyed||(mt(a,function(u){e.updateOneComboKeyShape(u,s)}),s==null||s.sort(),s==null||s.toBack(),e.updateCanvas())},250)}this.clearDestroyedShapes()},n.prototype.clearDestroyedShapes=function(){var e=this.get("itemMap")||{},r=Object.keys(e);if(!(!r||r.length===0))for(var i=r.length-1;i>=0;i--){var o=e[r[i]],a=o.exist;o.exist=!1,a||(o.remove(),delete e[r[i]])}},n.prototype.updateOneEdgeKeyShape=function(e,r){var i=this.get("itemMap")||{},o=i[e.get("id")];if(o){var a=e.get("keyShape").attr("path");o.attr("path",a)}else o=e.get("keyShape").clone(),r.add(o);e.isVisible()?o.show():o.hide(),o.exist=!0,i[e.get("id")]=o,this.set("itemMap",i)},n.prototype.updateOneNodeDelegateShape=function(e,r){var i=this.get("delegateStyle"),o=this.get("itemMap")||{},a=o[e.get("id")],s=e.getBBox();if(a){var u={x:s.minX,y:s.minY,width:s.width,height:s.height};a.attr(u),a.toFront()}else a=r.addShape("rect",{attrs:Xm({x:s.minX,y:s.minY,width:s.width,height:s.height},i),name:"minimap-node-shape"});e.isVisible()?a.show():a.hide(),a.exist=!0,o[e.get("id")]=a,this.set("itemMap",o)},n.prototype.init=function(){this.initContainer(),this.get("graph").on("afterupdateitem",this.handleUpdateCanvas),this.get("graph").on("afteritemstatechange",this.handleUpdateCanvas),this.get("graph").on("afteradditem",this.handleUpdateCanvas),this.get("graph").on("afterremoveitem",this.handleUpdateCanvas),this.get("graph").on("afterrender",this.handleUpdateCanvas),this.get("graph").on("afterlayout",this.handleUpdateCanvas)},n.prototype.initContainer=function(){var e=this,r=e.get("graph"),i=e.get("size"),o=e.get("className"),a=e.get("container"),s=Mn("<div class='".concat(o,"' style='width: ").concat(i[0],"px; height: ").concat(i[1],"px; overflow: hidden'></div>"));Dt(a)&&(a=document.getElementById(a)),a?a.appendChild(s):r.get("container").appendChild(s),e.set("container",s);var u=Mn('<div class="g6-minimap-container" style="position: relative;"></div>');s.appendChild(u),u.addEventListener("dragenter",function(h){h.preventDefault()}),u.addEventListener("dragover",function(h){h.preventDefault()});var c,l=r.get("renderer");l===s_?c=new $c({container:u,width:i[0],height:i[1]}):c=new Uo({container:u,width:i[0],height:i[1]}),e.set("canvas",c),e.updateCanvas()},n.prototype.updateCanvas=function(){if(!this.destroyed){var e=this.get("refresh");if(e){var r=this.get("graph");if(!r.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var i=this.get("size"),o=this.get("canvas"),a=this.get("type"),s=this.get("padding");if(!o.destroyed){switch(a){case $ct:this.updateGraphShapes();break;case tlt:this.updateKeyShapes();break;case elt:this.updateDelegateShapes();break}var u=o.get("children")[0];if(u){u.resetMatrix();var c=u.getCanvasBBox(),l=r.get("canvas").getCanvasBBox(),h=r.getZoom()||1,f=l.width/h,d=l.height/h;Number.isFinite(c.width)&&(f=a_(c.width,f),d=a_(c.height,d)),f+=2*s,d+=2*s;var p=Math.min(i[0]/f,i[1]/d),g=[1,0,0,0,1,0,0,0,1],v=0,m=0;Number.isFinite(c.minX)&&(v=-c.minX),Number.isFinite(c.minY)&&(m=-c.minY);var y=(i[0]-(f-2*s)*p)/2,b=(i[1]-(d-2*s)*p)/2;g=Jct(g,[["t",v,m],["s",p,p],["t",y,b]]),u.setMatrix(g),this.set("ratio",p),this.set("totaldx",y+v*p),this.set("totaldy",b+m*p),this.set("dx",y),this.set("dy",b),this.updateViewport()}}}}}},n.prototype.getCanvas=function(){return this.get("canvas")},n.prototype.getViewport=function(){return this.get("viewport")},n.prototype.getContainer=function(){return this.get("container")},n.prototype.destroy=function(){var e;(e=this.get("canvas"))===null||e===void 0||e.destroy();var r=this.get("container");r!=null&&r.parentNode&&r.parentNode.removeChild(r)},n})(ni);var nlt=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();function Qi(t,n,e){var r=t.x-n.x,i=t.y-n.y;return!e||Math.abs(r)>e||Math.abs(i)>e?Math.sqrt(r*r+i*i):e}function rlt(t,n){return t.x*n.x+t.y*n.y}function u_(t,n){var e=(n.source.y-n.target.y)/(n.source.x-n.target.x),r=(e*e*n.source.x+e*(t.y-n.source.y)+t.x)/(e*e+1),i=e*(r-n.source.x)+n.source.y;return{x:r,y:i}}(function(t){nlt(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{edgeBundles:[],edgePoints:[],K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:.6666667,bundleThreshold:.6,eps:1e-6,onLayoutEnd:function(){},onTick:function(){}}},n.prototype.init=function(){var e=this.get("graph"),r=this.get("onTick"),i=function(){r&&r(),e.refreshPositions()};this.set("tick",i)},n.prototype.bundling=function(e){var r=this;if(r.set("data",e),!r.isTicking()){var i=e.edges||[],o=e.nodes||[],a={},s=!1;if(o.forEach(function(x){(x.x===null||!x.y===null||x.x===void 0||!x.y===void 0)&&(s=!0),a[x.id]=x}),s)throw new Error("please layout the graph or assign x and y for nodes first");r.set("nodeIdMap",a);var u=r.get("divisions"),c=r.get("divRate"),l=r.divideEdges(u);r.set("edgePoints",l);var h=r.getEdgeBundles();r.set("edgeBundles",h);for(var f=r.get("cycles"),d=r.get("iterations"),p=r.get("iterRate"),g=r.get("lambda"),v=0;v<f;v++){for(var m=function(x){var w=[];i.forEach(function(E,M){if(E.source!==E.target){var _=a[E.source],k=a[E.target];w[M]=r.getEdgeForces({source:_,target:k},M,u,g);for(var S=0;S<u+1;S++)l[M][S].x+=w[M][S].x,l[M][S].y+=w[M][S].y}})},y=0;y<d;y++)m(y);g=g/2,u*=c,d*=p,l=r.divideEdges(u),r.set("edgePoints",l)}i.forEach(function(x,w){x.source!==x.target&&(x.type="polyline",x.controlPoints=l[w].slice(1,l[w].length-1))});var b=r.get("graph");b.refresh()}},n.prototype.updateBundling=function(e){var r=this,i=e.data;if(i&&r.set("data",i),r.get("ticking")&&r.set("ticking",!1),Object.keys(e).forEach(function(a){r.set(a,e[a])}),e.onTick){var o=this.get("graph");r.set("tick",function(){e.onTick(),o.refresh()})}r.bundling(i)},n.prototype.divideEdges=function(e){var r=this,i=r.get("data").edges,o=r.get("nodeIdMap"),a=r.get("edgePoints");return(!a||a===void 0)&&(a=[]),i.forEach(function(s,u){var c;(!a[u]||a[u]===void 0)&&(a[u]=[]);var l=o[s.source],h=o[s.target];if(e===1)a[u].push({x:l.x,y:l.y}),a[u].push({x:.5*(l.x+h.x),y:.5*(l.y+h.y)}),a[u].push({x:h.x,y:h.y});else{var f=0;!((c=a[u])===null||c===void 0)&&c.length?f=r.getEdgeLength(a[u]):f=Qi({x:l.x,y:l.y},{x:h.x,y:h.y});var d=f/(e+1),p=d,g=[{x:l.x,y:l.y}];a[u].forEach(function(v,m){if(m!==0){for(var y=Qi(v,a[u][m-1]);y>p;){var b=p/y,x={x:a[u][m-1].x,y:a[u][m-1].y};x.x+=b*(v.x-a[u][m-1].x),x.y+=b*(v.y-a[u][m-1].y),g.push(x),y-=p,p=d}p-=y}}),g.push({x:h.x,y:h.y}),a[u]=g}}),a},n.prototype.getEdgeLength=function(e){var r=0;return e.forEach(function(i,o){o!==0&&(r+=Qi(i,e[o-1]))}),r},n.prototype.getEdgeBundles=function(){var e=this,r=e.get("data"),i=r.edges||[],o=e.get("bundleThreshold"),a=e.get("nodeIdMap"),s=e.get("edgeBundles");return s||(s=[]),i.forEach(function(u,c){(!s[c]||s[c]===void 0)&&(s[c]=[])}),i.forEach(function(u,c){var l=a[u.source],h=a[u.target];i.forEach(function(f,d){if(!(d<=c)){var p=a[f.source],g=a[f.target],v=e.getBundleScore({source:l,target:h},{source:p,target:g});v>=o&&(s[c].push(d),s[d].push(c))}})}),s},n.prototype.getBundleScore=function(e,r){var i=this;e.vx=e.target.x-e.source.x,e.vy=e.target.y-e.source.y,r.vx=r.target.x-r.source.x,r.vy=r.target.y-r.source.y,e.length=Qi({x:e.source.x,y:e.source.y},{x:e.target.x,y:e.target.y}),r.length=Qi({x:r.source.x,y:r.source.y},{x:r.target.x,y:r.target.y});var o=i.getAngleScore(e,r),a=i.getScaleScore(e,r),s=i.getPositionScore(e,r),u=i.getVisibilityScore(e,r);return o*a*s*u},n.prototype.getAngleScore=function(e,r){var i=rlt({x:e.vx,y:e.vy},{x:r.vx,y:r.vy});return i/(e.length*r.length)},n.prototype.getScaleScore=function(e,r){var i=(e.length+r.length)/2,o=2/(i/Math.min(e.length,r.length)+Math.max(e.length,r.length)/i);return o},n.prototype.getPositionScore=function(e,r){var i=(e.length+r.length)/2,o={x:(e.source.x+e.target.x)/2,y:(e.source.y+e.target.y)/2},a={x:(r.source.x+r.target.x)/2,y:(r.source.y+r.target.y)/2},s=Qi(o,a);return i/(i+s)},n.prototype.getVisibilityScore=function(e,r){var i=this.getEdgeVisibility(e,r),o=this.getEdgeVisibility(r,e);return i<o?i:o},n.prototype.getEdgeVisibility=function(e,r){var i=u_(r.source,e),o=u_(r.target,e),a={x:(i.x+o.x)/2,y:(i.y+o.y)/2},s={x:(e.source.x+e.target.x)/2,y:(e.source.y+e.target.y)/2};return Math.max(0,1-2*Qi(a,s)/Qi(i,o))},n.prototype.getEdgeForces=function(e,r,i,o){for(var a=this,s=a.get("edgePoints"),u=a.get("K"),c=u/(Qi(e.source,e.target)*(i+1)),l=[{x:0,y:0}],h=1;h<i;h++){var f={x:0,y:0},d=a.getSpringForce({pre:s[r][h-1],cur:s[r][h],next:s[r][h+1]},c),p=a.getElectrostaticForce(h,r);f.x=o*(d.x+p.x),f.y=o*(d.y+p.y),l.push(f)}return l.push({x:0,y:0}),l},n.prototype.getSpringForce=function(e,r){var i=e.pre.x+e.next.x-2*e.cur.x,o=e.pre.y+e.next.y-2*e.cur.y;return i*=r,o*=r,{x:i,y:o}},n.prototype.getElectrostaticForce=function(e,r){var i=this,o=i.get("eps"),a=i.get("edgeBundles"),s=i.get("edgePoints"),u=a[r],c={x:0,y:0};return u.forEach(function(l){var h={x:s[l][e].x-s[r][e].x,y:s[l][e].y-s[r][e].y};if(Math.abs(h.x)>o||Math.abs(h.y)>o){var f=Qi(s[l][e],s[r][e]),d=1/f;c.x+=h.x*d,c.y+=h.y*d}}),c},n.prototype.isTicking=function(){return this.get("ticking")},n.prototype.getSimulation=function(){return this.get("forceSimulation")},n.prototype.destroy=function(){this.get("ticking")&&this.getSimulation().stop(),t.prototype.destroy.call(this)},n})(ni);var ilt=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Hm=globalThis&&globalThis.__assign||function(){return Hm=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Hm.apply(this,arguments)},jf=.05,c_={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:.1,fill:"#ccc"};(function(t){ilt(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{trigger:"mousemove",d:1.5,r:300,delegateStyle:Xe(c_),showLabel:!1,maxD:5,minD:0,scaleRBy:"unset",scaleDBy:"unset",showDPercent:!0}},n.prototype.getEvents=function(){var e;switch(this.get("trigger")){case"click":e={click:"magnify"};break;case"drag":e={click:"createDelegate"};break;default:e={mousemove:"magnify"};break}return e},n.prototype.init=function(){var e=this,r=e.get("r");e.set("cachedMagnifiedModels",[]),e.set("cachedOriginPositions",{}),e.set("r2",r*r);var i=e.get("d");e.set("molecularParam",(i+1)*r)},n.prototype.createDelegate=function(e){var r=this,i=this,o=i.get("delegate");(!o||o.destroyed)&&(i.magnify(e),o=i.get("delegate"),o.on("dragstart",function(a){i.set("delegateCenterDiff",{x:o.attr("x")-a.x,y:o.attr("y")-a.y})}),o.on("drag",function(a){i.magnify(a)}),this.get("scaleDBy")==="wheel"&&o.on("mousewheel",function(a){r.scaleDByWheel(a)}),this.get("scaleRBy")==="wheel"&&o.on("mousewheel",function(a){i.scaleRByWheel(a)}))},n.prototype.scaleRByWheel=function(e){var r=this;if(!(!e||!e.originalEvent)){e.preventDefault&&e.preventDefault();var i=r.get("graph"),o,a=r.get("delegate"),s=a?{x:a.attr("x"),y:a.attr("y")}:void 0,u=s||i.getPointByClient(e.clientX,e.clientY);e.originalEvent.wheelDelta<0?o=1-jf:o=1/(1-jf);var c=r.get("maxR"),l=r.get("minR"),h=r.get("r");(h>(c||i.get("height"))&&o>1||h<(l||i.get("height")*.05)&&o<1)&&(o=1),h*=o,r.set("r",h),r.set("r2",h*h);var f=r.get("d");r.set("molecularParam",(f+1)*h),r.set("delegateCenterDiff",void 0),r.magnify(e,u)}},n.prototype.scaleRByDrag=function(e){var r=this;if(e){var i=r.get("dragPrePos"),o=r.get("graph"),a,s=o.getPointByClient(e.clientX,e.clientY);e.x-i.x<0?a=1-jf:a=1/(1-jf);var u=r.get("maxR"),c=r.get("minR"),l=r.get("r");(l>(u||o.get("height"))&&a>1||l<(c||o.get("height")*.05)&&a<1)&&(a=1),l*=a,r.set("r",l),r.set("r2",l*l);var h=r.get("d");r.set("molecularParam",(h+1)*l),r.magnify(e,s),r.set("dragPrePos",{x:e.x,y:e.y})}},n.prototype.scaleDByWheel=function(e){var r=this;if(!(!e&&!e.originalEvent)){e.preventDefault&&e.preventDefault();var i=0;e.originalEvent.wheelDelta<0?i=-.1:i=.1;var o=r.get("d"),a=o+i,s=r.get("maxD"),u=r.get("minD");if(a<s&&a>u){r.set("d",a);var c=r.get("r");r.set("molecularParam",(a+1)*c);var l=r.get("delegate"),h=l?{x:l.attr("x"),y:l.attr("y")}:void 0;r.set("delegateCenterDiff",void 0),r.magnify(e,h)}}},n.prototype.scaleDByDrag=function(e){var r=this,i=r.get("dragPrePos"),o=e.x-i.x>0?.1:-.1,a=r.get("d"),s=a+o,u=r.get("maxD"),c=r.get("minD");if(s<u&&s>c){r.set("d",s);var l=r.get("r");r.set("molecularParam",(s+1)*l),r.magnify(e)}r.set("dragPrePos",{x:e.x,y:e.y})},n.prototype.magnify=function(e,r){var i=this;i.restoreCache();var o=i.get("graph"),a=i.get("cachedMagnifiedModels"),s=i.get("cachedOriginPositions"),u=i.get("showLabel"),c=i.get("r"),l=i.get("r2"),h=i.get("d"),f=i.get("molecularParam"),d=o.getNodes(),p=d.length,g=r?{x:r.x,y:r.y}:{x:e.x,y:e.y};i.get("dragging")&&(i.get("trigger")==="mousemove"||i.get("trigger")==="click")&&(g=i.get("cacheCenter"));var v=i.get("delegateCenterDiff");v&&(g.x+=v.x,g.y+=v.y),i.updateDelegate(g,c);for(var m=0;m<p;m++){var y=d[m].getModel(),b=y.x,x=y.y;if(!(isNaN(b)||isNaN(x))){var w=(b-g.x)*(b-g.x)+(x-g.y)*(x-g.y);if(!isNaN(w)&&w<l&&w!==0){var E=Math.sqrt(w),M=f*E/(h*E+c),_=(b-g.x)/E,k=(x-g.y)/E;if(y.x=_*M+g.x,y.y=k*M+g.y,s[y.id]||(s[y.id]={x:b,y:x,texts:[]}),a.push(y),u&&2*E<c)for(var S=d[m],A=S.getContainer(),C=A.getChildren(),I=C.length,N=0;N<I;N++){var D=C[N];D.get("type")==="text"&&(s[y.id].texts.push({visible:D.get("visible"),shape:D}),D.set("visible",!0))}}}}o.refreshPositions()},n.prototype.restoreCache=function(){for(var e=this,r=e.get("cachedMagnifiedModels"),i=e.get("cachedOriginPositions"),o=r.length,a=0;a<o;a++){var s=r[a],u=s.id,c=i[u];s.x=c.x,s.y=c.y;for(var l=c.texts.length,h=0;h<l;h++){var f=c.texts[h];f.shape.set("visible",f.visible)}}e.set("cachedMagnifiedModels",[]),e.set("cachedOriginPositions",{})},n.prototype.updateParams=function(e){var r=this,i=e.r,o=e.d,a=e.trigger,s=e.minD,u=e.maxD,c=e.minR,l=e.maxR,h=e.scaleDBy,f=e.scaleRBy;isNaN(e.r)||(r.set("r",i),r.set("r2",i*i)),isNaN(o)||r.set("d",o),isNaN(u)||r.set("maxD",u),isNaN(s)||r.set("minD",s),isNaN(l)||r.set("maxR",l),isNaN(c)||r.set("minR",c);var d=r.get("d"),p=r.get("r");if(r.set("molecularParam",(d+1)*p),(a==="mousemove"||a==="click"||a==="drag")&&r.set("trigger",a),h==="drag"||h==="wheel"||h==="unset"){r.set("scaleDBy",h),r.get("delegate").remove(),r.get("delegate").destroy();var g=r.get("dPercentText");g&&(g.remove(),g.destroy())}if(f==="drag"||f==="wheel"||f==="unset"){r.set("scaleRBy",f),r.get("delegate").remove(),r.get("delegate").destroy();var g=r.get("dPercentText");g&&(g.remove(),g.destroy())}},n.prototype.updateDelegate=function(e,r){var i=this,o=this,a=o.get("graph"),s=o.get("delegate");if(!s||s.destroyed){var u=a.get("group"),c=o.get("delegateStyle")||c_;s=u.addShape("circle",{attrs:Hm({r:r/1.5,x:e.x,y:e.y},c),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&(this.get("scaleRBy")==="wheel"?s.on("mousewheel",function(p){o.scaleRByWheel(p)}):this.get("scaleRBy")==="drag"&&(s.on("dragstart",function(p){o.set("dragging",!0),o.set("cacheCenter",{x:p.x,y:p.y}),o.set("dragPrePos",{x:p.x,y:p.y})}),s.on("drag",function(p){o.scaleRByDrag(p)}),s.on("dragend",function(p){o.set("dragging",!1)})),this.get("scaleDBy")==="wheel"?s.on("mousewheel",function(p){i.scaleDByWheel(p)}):this.get("scaleDBy")==="drag"&&(s.on("dragstart",function(p){o.set("dragging",!0),o.set("cacheCenter",{x:p.x,y:p.y}),o.set("dragPrePos",{x:p.x,y:p.y})}),s.on("drag",function(p){i.scaleDByDrag(p)}),s.on("dragend",function(p){o.set("dragging",!1)})))}else s.attr({x:e.x,y:e.y,r:r/1.5});if(o.get("showDPercent")){var l=Math.round((o.get("d")-o.get("minD"))/(o.get("maxD")-o.get("minD"))*100),h=o.get("dPercentText"),f=e.y+r/1.5+16;if(!h||h.destroyed){var d=a.get("group");h=d.addShape("text",{attrs:{text:"".concat(l,"%"),x:e.x,y:f,fill:"#aaa",stroke:"#fff",lineWidth:1,fontSize:12}}),o.set("dPercentText",h)}else h.attr({text:"".concat(l,"%"),x:e.x,y:f})}o.set("delegate",s)},n.prototype.clear=function(){var e=this.get("graph");this.restoreCache(),e.refreshPositions();var r=this.get("delegate");r&&!r.destroyed&&(r.remove(),r.destroy());var i=this.get("dPercentText");i&&!i.destroyed&&(i.remove(),i.destroy())},n.prototype.destroy=function(){this.clear()},n})(ni);var olt=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),l_=.05;typeof document<"u"&&rg(`
  .g6-component-toolbar {
    position: absolute;
    list-style-type: none;
    padding: 6px;
    left: 0px;
    top: 0px;
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    margin: 0;
  }
  .g6-component-toolbar li {
    float: left;
    text-align: center;
    width: 35px;
    height: 24px;
    cursor: pointer;
		list-style-type:none;
    list-style: none;
    margin-left: 0px;
  }
  .g6-component-toolbar li .icon {
    opacity: 0.7;
  }
  .g6-component-toolbar li .icon:hover {
    opacity: 1;
  }
`);var alt=function(t){if(!t)return[];if(t.composedPath)return t.composedPath();for(var n=[],e=t.target;e;){if(n.push(e),e.tagName==="HTML")return n.push(document,window),n;e=e.parentElement}return n};(function(t){olt(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{handleClick:void 0,getContent:function(e){return`
          <ul class='g6-component-toolbar'>
            <li code='redo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M256 682.666667c0-102.741333 66.730667-213.333333 213.333333-213.333334 107.008 0 190.762667 56.576 230.570667 125.354667L611.968 682.666667H853.333333v-241.365334l-91.562666 91.562667C704.768 448.469333 601.130667 384 469.333333 384c-196.096 0-298.666667 150.229333-298.666666 298.666667h85.333333z" fill="" p-id="2041"></path>
              </svg>
            </li>
            <li code='undo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M170.666667 682.666667h241.365333l-87.936-87.978667C363.904 525.909333 447.658667 469.333333 554.666667 469.333333c146.602667 0 213.333333 110.592 213.333333 213.333334h85.333333c0-148.437333-102.570667-298.666667-298.666666-298.666667-131.797333 0-235.392 64.469333-292.48 148.821333L170.666667 441.301333V682.666667z" fill="" p-id="2764"></path>
              </svg>
            </li>
            <li  code='zoomOut'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M658.432 428.736a33.216 33.216 0 0 1-33.152 33.152H525.824v99.456a33.216 33.216 0 0 1-66.304 0V461.888H360.064a33.152 33.152 0 0 1 0-66.304H459.52V296.128a33.152 33.152 0 0 1 66.304 0V395.52H625.28c18.24 0 33.152 14.848 33.152 33.152z m299.776 521.792a43.328 43.328 0 0 1-60.864-6.912l-189.248-220.992a362.368 362.368 0 0 1-215.36 70.848 364.8 364.8 0 1 1 364.8-364.736 363.072 363.072 0 0 1-86.912 235.968l192.384 224.64a43.392 43.392 0 0 1-4.8 61.184z m-465.536-223.36a298.816 298.816 0 0 0 298.432-298.432 298.816 298.816 0 0 0-298.432-298.432A298.816 298.816 0 0 0 194.24 428.8a298.816 298.816 0 0 0 298.432 298.432z"></path>
              </svg>
            </li>
            <li code='zoomIn'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M639.936 416a32 32 0 0 1-32 32h-256a32 32 0 0 1 0-64h256a32 32 0 0 1 32 32z m289.28 503.552a41.792 41.792 0 0 1-58.752-6.656l-182.656-213.248A349.76 349.76 0 0 1 480 768 352 352 0 1 1 832 416a350.4 350.4 0 0 1-83.84 227.712l185.664 216.768a41.856 41.856 0 0 1-4.608 59.072zM479.936 704c158.784 0 288-129.216 288-288S638.72 128 479.936 128a288.32 288.32 0 0 0-288 288c0 158.784 129.216 288 288 288z" p-id="3853"></path>
              </svg>
            </li>
            <li code='realZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M384 320v384H320V320h64z m256 0v384H576V320h64zM512 576v64H448V576h64z m0-192v64H448V384h64z m355.968 576H92.032A28.16 28.16 0 0 1 64 931.968V28.032C64 12.608 76.608 0 95.168 0h610.368L896 192v739.968a28.16 28.16 0 0 1-28.032 28.032zM704 64v128h128l-128-128z m128 192h-190.464V64H128v832h704V256z"></path>
              </svg>
            </li>
            <li code='autoZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M684.288 305.28l0.128-0.64-0.128-0.64V99.712c0-19.84 15.552-35.904 34.496-35.712a35.072 35.072 0 0 1 34.56 35.776v171.008h170.944c19.648 0 35.84 15.488 35.712 34.432a35.072 35.072 0 0 1-35.84 34.496h-204.16l-0.64-0.128a32.768 32.768 0 0 1-20.864-7.552c-1.344-1.024-2.816-1.664-3.968-2.816-0.384-0.32-0.512-0.768-0.832-1.088a33.472 33.472 0 0 1-9.408-22.848zM305.28 64a35.072 35.072 0 0 0-34.56 35.776v171.008H99.776A35.072 35.072 0 0 0 64 305.216c0 18.944 15.872 34.496 35.84 34.496h204.16l0.64-0.128a32.896 32.896 0 0 0 20.864-7.552c1.344-1.024 2.816-1.664 3.904-2.816 0.384-0.32 0.512-0.768 0.768-1.088a33.024 33.024 0 0 0 9.536-22.848l-0.128-0.64 0.128-0.704V99.712A35.008 35.008 0 0 0 305.216 64z m618.944 620.288h-204.16l-0.64 0.128-0.512-0.128c-7.808 0-14.72 3.2-20.48 7.68-1.28 1.024-2.752 1.664-3.84 2.752-0.384 0.32-0.512 0.768-0.832 1.088a33.664 33.664 0 0 0-9.408 22.912l0.128 0.64-0.128 0.704v204.288c0 19.712 15.552 35.904 34.496 35.712a35.072 35.072 0 0 0 34.56-35.776V753.28h170.944c19.648 0 35.84-15.488 35.712-34.432a35.072 35.072 0 0 0-35.84-34.496z m-593.92 11.52c-0.256-0.32-0.384-0.768-0.768-1.088-1.088-1.088-2.56-1.728-3.84-2.688a33.088 33.088 0 0 0-20.48-7.68l-0.512 0.064-0.64-0.128H99.84a35.072 35.072 0 0 0-35.84 34.496 35.072 35.072 0 0 0 35.712 34.432H270.72v171.008c0 19.84 15.552 35.84 34.56 35.776a35.008 35.008 0 0 0 34.432-35.712V720l-0.128-0.64 0.128-0.704a33.344 33.344 0 0 0-9.472-22.848zM512 374.144a137.92 137.92 0 1 0 0.128 275.84A137.92 137.92 0 0 0 512 374.08z"></path>
              </svg>
            </li>
          </ul>
        `},zoomSensitivity:2}},n.prototype.init=function(){var e=this,r=this.get("graph"),i=this.get("getContent"),o=i(r),a=o;Dt(o)&&(a=Mn(o));var s=this.get("className");a.setAttribute("class",s||"g6-component-toolbar");var u=this.get("container");u||(u=this.get("graph").get("container")),Dt(u)&&(u=document.getElementById(u)),u.appendChild(a),this.set("toolBar",a);var c=this.get("handleClick");a.addEventListener("click",function(h){var f=alt(h).filter(function(p){return p.nodeName==="LI"});if(f.length!==0){var d=f[0].getAttribute("code");d&&(c?c(d,r):e.handleDefaultOperator(d))}});var l=this.get("position");l&&Ve(a,{top:"".concat(l.y,"px"),left:"".concat(l.x,"px")}),this.bindUndoRedo()},n.prototype.bindUndoRedo=function(){var e=this.get("graph"),r=document.querySelector('.g6-component-toolbar li[code="undo"]'),i=document.querySelector('.g6-component-toolbar li[code="undo"] svg'),o=document.querySelector('.g6-component-toolbar li[code="redo"]'),a=document.querySelector('.g6-component-toolbar li[code="redo"] svg');!r||!i||!o||!a||(r.setAttribute("style","cursor: not-allowed"),i.setAttribute("style","opacity: 0.4"),o.setAttribute("style","cursor: not-allowed"),a.setAttribute("style","opacity: 0.4"),e.on("stackchange",function(s){var u=s.undoStack,c=s.redoStack,l=u.length,h=c.length;l===0?(r.setAttribute("style","cursor: not-allowed"),i.setAttribute("style","opacity: 0.4")):(r.removeAttribute("style"),i.removeAttribute("style")),h===0?(o.setAttribute("style","cursor: not-allowed"),a.setAttribute("style","opacity: 0.4")):(o.removeAttribute("style"),a.removeAttribute("style"))}))},n.prototype.undo=function(){var e=this.get("graph"),r=e.getUndoStack();if(!(!r||r.length===0)){var i=r.pop();if(i){var o=i.action;e.pushStack(o,Xe(i.data),"redo");var a=i.data.before;if(o==="add"&&(a=i.data.after),!a)return;switch(o){case"visible":{Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){var p=e.findById(d.id);d.visible?e.showItem(p,!1):e.hideItem(p,!1)})});break}case"render":case"update":Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){var p=e.findById(d.id);delete d.id,e.updateItem(p,d,!1),p.getType()==="combo"&&e.updateCombo(p)})});break;case"changedata":e.changeData(a,!1);break;case"delete":{Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){var p=d.itemType;delete d.itemType,e.addItem(p,d,!1)})});break}case"add":Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){e.removeItem(d.id,!1)})});break;case"updateComboTree":Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){e.updateComboTree(d.id,d.parentId,!1)})});break;case"createCombo":var s=i.data.after.combos,u=s[s.length-1];Object.keys(a).forEach(function(h){var f=a[h];f&&f.forEach(function(d){e.updateComboTree(d.id,d.parentId,!1)})}),e.removeItem(u.id,!1);break;case"uncombo":var c=a.combos[a.combos.length-1],l=a.nodes.concat(a.combos).map(function(h){return h.id}).filter(function(h){return h!==c.id});e.createCombo(c,l,!1);break;case"layout":e.updateLayout(a,void 0,void 0,!1);break}}}},n.prototype.redo=function(){var e=this.get("graph"),r=e.getRedoStack();if(!(!r||r.length===0)){var i=r.pop();if(i){var o=i.action,a=i.data.after;if(e.pushStack(o,Xe(i.data)),o==="delete"&&(a=i.data.before),!a)return;switch(o){case"visible":{Object.keys(a).forEach(function(l){var h=a[l];h&&h.forEach(function(f){var d=e.findById(f.id);f.visible?e.showItem(d,!1):e.hideItem(d,!1)})});break}case"render":case"update":Object.keys(a).forEach(function(l){var h=a[l];h&&h.forEach(function(f){var d=e.findById(f.id);delete f.id,e.updateItem(d,f,!1),d.getType()==="combo"&&e.updateCombo(d)})});break;case"changedata":e.changeData(a,!1);break;case"delete":a.edges&&a.edges.forEach(function(l){e.removeItem(l.id,!1)}),a.nodes&&a.nodes.forEach(function(l){e.removeItem(l.id,!1)}),a.combos&&a.combos.forEach(function(l){e.removeItem(l.id,!1)});break;case"add":{Object.keys(a).forEach(function(l){var h=a[l];h&&h.forEach(function(f){var d=f.itemType;delete f.itemType,e.addItem(d,f,!1)})});break}case"updateComboTree":Object.keys(a).forEach(function(l){var h=a[l];h&&h.forEach(function(f){e.updateComboTree(f.id,f.parentId,!1)})});break;case"createCombo":var s=a.combos[a.combos.length-1];e.createCombo(s,s.children.map(function(l){return l.id}),!1);break;case"uncombo":var u=i.data.before.combos,c=u[u.length-1];e.uncombo(c.id,!1);break;case"layout":e.updateLayout(a,void 0,void 0,!1);break}}}},n.prototype.zoomOut=function(){var e=this.get("graph"),r=e.getZoom(),i=1/(1-l_*this.get("zoomSensitivity")),o=this.get("maxZoom")||e.get("maxZoom");i*r>o||e.zoomTo(r*i)},n.prototype.zoomIn=function(){var e=this.get("graph"),r=e.getZoom(),i=1-l_*this.get("zoomSensitivity"),o=this.get("minZoom")||e.get("minZoom");i*r<o||e.zoomTo(r*i)},n.prototype.realZoom=function(){var e=this.get("graph");e.zoomTo(1)},n.prototype.autoZoom=function(){var e=this.get("graph");e.fitView([20,20])},n.prototype.handleDefaultOperator=function(e){switch(e){case"redo":this.redo();break;case"undo":this.undo();break;case"zoomOut":this.zoomOut();break;case"zoomIn":this.zoomIn();break;case"realZoom":this.realZoom();break;case"autoZoom":this.autoZoom();break}},n.prototype.destroy=function(){var e=this.get("toolBar");if(e){var r=this.get("container");r||(r=this.get("graph").get("container")),Dt(r)&&(r=document.getElementById(r)),r.removeChild(e)}var i=this.get("handleClick");i&&e.removeEventListener("click",i)},n})(ni);var slt=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();typeof document<"u"&&rg(`
  .g6-component-tooltip {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .tooltip-type {
    padding: 0;
    margin: 0;
  }
  .tooltip-id {
    color: #531dab;
  }
`);(function(t){slt(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{offsetX:6,offsetY:6,getContent:function(e){return`
          <h4 class='tooltip-type'>类型：`.concat(e.item.getType(),`</h4>
          <span class='tooltip-id'>ID：`).concat(e.item.getID(),`</span>
        `)},shouldBegin:function(e){return!0},itemTypes:["node","edge","combo"],trigger:"mouseenter",fixToNode:void 0}},n.prototype.getEvents=function(){return this.get("trigger")==="click"?{"node:click":"onClick","edge:click":"onClick","combo:click":"onClick","canvas:click":"onMouseLeave",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave",drag:"onMouseLeave"}:{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove","edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove","combo:mouseenter":"onMouseEnter","combo:mouseleave":"onMouseLeave","combo:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave",contextmenu:"onMouseLeave","node:drag":"onMouseLeave"}},n.prototype.init=function(){var e=this,r=e.get("className")||"g6-component-tooltip",i=Mn("<div class='".concat(r,"'></div>")),o=e.get("container");o||(o=e.get("graph").get("container")),Dt(o)&&(o=document.getElementById(o)),Ve(i,{position:"absolute",visibility:"hidden",display:"none"}),o.appendChild(i),e.get("trigger")!=="click"&&(i.addEventListener("mouseenter",function(a){Ve(i,{visibility:"visible",display:"unset"})}),i.addEventListener("mouseleave",function(a){e.hideTooltip()})),e.set("tooltip",i)},n.prototype.onClick=function(e){var r=this.get("itemTypes");if(!(e.item&&e.item.getType&&r.indexOf(e.item.getType())===-1)){var i=e.item,o=this.get("graph");this.currentTarget===i?(this.currentTarget=null,this.hideTooltip(),o.emit("tooltipchange",{item:e.item,action:"hide"})):(this.currentTarget=i,this.showTooltip(e),o.emit("tooltipchange",{item:e.item,action:"show"}))}},n.prototype.onMouseEnter=function(e){var r=this.get("itemTypes");if(!(e.item&&e.item.getType&&r.indexOf(e.item.getType())===-1)){var i=e.item,o=this.get("graph");this.currentTarget=i,this.showTooltip(e),o.emit("tooltipchange",{item:e.item,action:"show"})}},n.prototype.onMouseMove=function(e){var r=this.get("itemTypes");e.item&&e.item.getType&&r.indexOf(e.item.getType())===-1||!this.currentTarget||e.item!==this.currentTarget||this.showTooltip(e)},n.prototype.onMouseLeave=function(){this.hideTooltip();var e=this.get("graph");e.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null},n.prototype.clearContainer=function(){var e=this.get("tooltip");e&&(e.innerHTML="")},n.prototype.showTooltip=function(e){if(e.item){var r=this.get("itemTypes");if(!(e.item.getType&&r.indexOf(e.item.getType())===-1)){var i=this.get("tooltip"),o=this.get("getContent"),a=o(e);Dt(a)?i.innerHTML=a:(this.clearContainer(),i.appendChild(a)),this.updatePosition(e)}}},n.prototype.hideTooltip=function(){var e=this.get("tooltip");e&&Ve(e,{visibility:"hidden",display:"none"})},n.prototype.updatePosition=function(e){var r=this.get("shouldBegin"),i=this.get("tooltip");if(!r(e)){Ve(i,{visibility:"hidden",display:"none"});return}var o=this.get("graph"),a=o.get("width"),s=o.get("height"),u=this.get("offsetX")||0,c=this.get("offsetY")||0,l=o.getPointByClient(e.clientX,e.clientY),h=this.get("fixToNode"),f=e.item;if(f.getType&&f.getType()==="node"&&h&&ve(h)&&h.length>=2){var d=f.getBBox();l={x:d.minX+d.width*h[0],y:d.minY+d.height*h[1]}}var p=o.getCanvasByPoint(l.x,l.y),g=p.x,v=p.y,m=o.getContainer(),y={x:g+m.offsetLeft+u,y:v+m.offsetTop+c};Ve(i,{visibility:"visible",display:"unset"});var b=i.getBoundingClientRect();g+b.width+u>a&&(y.x-=b.width+u),v+b.height+c>s&&(y.y-=b.height+c,y.y<0&&(y.y=0)),Ve(i,{left:"".concat(y.x,"px"),top:"".concat(y.y,"px")})},n.prototype.hide=function(){this.onMouseLeave()},n.prototype.destroy=function(){var e=this.get("tooltip");if(e){var r=this.get("container");r||(r=this.get("graph").get("container")),Dt(r)&&(r=document.getElementById(r)),r.removeChild(e)}},n})(ni);var RN="timebarstartplay",FN="timebarendplay",no="valuechange",xs="timebarConfigChanged",Sa="playPauseBtn",Pl="nextStepBtn",Ll="preStepBtn",ult=function(){function t(n){var e=n.x,r=e===void 0?0:e,i=n.y,o=i===void 0?0:i,a=n.container,s=n.text,u=n.padding,c=u===void 0?[4,4,4,4]:u,l=n.className,h=l===void 0?"g6-component-timebar-tooltip":l,f=n.backgroundColor,d=f===void 0?"#000":f,p=n.textColor,g=p===void 0?"#fff":p,v=n.opacity,m=v===void 0?.8:v,y=n.fontSize,b=y===void 0?12:y;this.container=a,this.className=h,this.backgroundColor=d,this.textColor=g,this.x=r,this.y=o,this.text=s,this.padding=c,this.opacity=m,this.fontSize=b,this.render()}return t.prototype.render=function(){var n=this,e=n.className;n.x,n.y;var r=n.backgroundColor,i=n.textColor,o=n.text,a=n.padding,s=n.opacity,u=n.fontSize,c=n.container,l=Mn("<div class='".concat(e,`' style="position: absolute; width: fit-content; height: fit-content; opacity: `).concat(s,'"></div>'));Dt(c)&&(c=document.getElementById(c)),c.appendChild(l),n.parentHeight=c.offsetHeight,n.parentWidth=c.offsetWidth,Ve(l,{visibility:"hidden",top:0,left:0});var h=Mn(`
      <div style='position: absolute; white-space:nowrap; background-color: `.concat(r,"; font-size: ").concat(u,"px; border-radius: 4px; width: fit-content; height: fit-content; color: ").concat(i,"; padding: ").concat(a[0],"px ").concat(a[1],"px ").concat(a[2],"px ").concat(a[3],"px'></div>"));h.innerHTML=o,l.appendChild(h),n.backgroundDOM=h;var f=Mn("<div style='position: absolute; width: 0px; height: 0px; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid ".concat(r,"'></div>"));l.appendChild(f),n.arrowDOM=f,n.container=l},t.prototype.show=function(n){var e=this,r=n.text,i=n.x;n.y,n.clientX,n.clientY,e.backgroundDOM.innerHTML=r;var o=e.backgroundDOM.offsetWidth,a=e.backgroundDOM.offsetHeight,s=e.arrowDOM.offsetWidth,u=e.arrowDOM.offsetHeight;Ve(e.container,{top:"".concat(-a-u,"px"),left:"".concat(i,"px"),visibility:"visible"}),Ve(e.backgroundDOM,{marginLeft:"".concat(-o/2,"px")}),Ve(e.arrowDOM,{marginLeft:"".concat(-s/2,"px"),top:"".concat(a,"px")});var c=i-o/2,l=i+o/2;c<0?Ve(e.backgroundDOM,{marginLeft:"".concat(-o/2-c,"px")}):l>e.parentWidth&&Ve(e.backgroundDOM,{marginLeft:"".concat(-o/2-l+e.parentWidth+12,"px")})},t.prototype.hide=function(){Ve(this.container,{top:0,left:0,visibility:"hidden"})},t}();const clt=ult;var qm=globalThis&&globalThis.__assign||function(){return qm=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},qm.apply(this,arguments)},llt=function(){function t(n){this.config=mn({},n),this.init()}return t.prototype.update=function(n){this.config=mn({},this.config,n),this.updateElement(),this.renderMarker()},t.prototype.init=function(){this.initElement(),this.renderMarker()},t.prototype.initElement=function(){var n=this.config,e=n.group,r=n.style,i=r.scale,o=i===void 0?1:i,a=r.offsetX,s=a===void 0?0:a,u=r.offsetY,c=u===void 0?0:u,l=this.config.x+s,h=this.config.y+c,f=e.addGroup({name:Sa});this.startMarkerGroup=f.addGroup({name:Sa}),this.circle=e.addShape("circle",{attrs:qm({x:l,y:h,r:this.config.r*o},r),name:Sa}),this.startMarker=this.startMarkerGroup.addShape("path",{attrs:{path:this.getStartMarkerPath(l,h,o),fill:r.stroke||"#aaa"},name:"start-marker"}),this.pauseMarkerGroup=f.addGroup({name:Sa});var d=.25*this.config.r*o,p=.5*this.config.r*Math.sqrt(3)*o;this.pauseLeftMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:l-.375*this.config.r*o,y:h-p/2,width:d,height:p,fill:r.stroke||"#aaa",lineWidth:0}}),this.pauseRightMarker=this.pauseMarkerGroup.addShape("rect",{attrs:{x:l+1/8*this.config.r*o,y:h-p/2,width:d,height:p,fill:r.stroke||"#aaa",lineWidth:0}})},t.prototype.updateElement=function(){var n=this.config.style,e=n.scale,r=e===void 0?1:e,i=n.offsetX,o=i===void 0?0:i,a=n.offsetY,s=a===void 0?0:a,u=this.config.x+o,c=this.config.y+s;this.circle.attr("x",u),this.circle.attr("y",c),this.circle.attr("r",this.config.r*r),this.startMarker.attr("path",this.getStartMarkerPath(u,c,r));var l=.25*this.config.r*r,h=.5*this.config.r*Math.sqrt(3)*r;this.pauseLeftMarker.attr("x",u-(1/4+1/8)*this.config.r*r),this.pauseLeftMarker.attr("y",c-h/2),this.pauseLeftMarker.attr("width",l),this.pauseLeftMarker.attr("height",h),this.pauseRightMarker.attr("x",u+1/8*this.config.r*r),this.pauseRightMarker.attr("y",c-h/2),this.pauseRightMarker.attr("width",l),this.pauseRightMarker.attr("height",h)},t.prototype.renderMarker=function(){this.config.isPlay?(this.startMarkerGroup.hide(),this.pauseMarkerGroup.show()):(this.startMarkerGroup.show(),this.pauseMarkerGroup.hide())},t.prototype.getStartMarkerPath=function(n,e,r){var i=.5*this.config.r*Math.sqrt(3)*r;return[["M",n-i/Math.sqrt(3)/2,e-i/2],["L",n+i/Math.sqrt(3),e],["L",n-i/Math.sqrt(3)/2,e+i/2]]},t}();const hlt=llt;var Zn=globalThis&&globalThis.__assign||function(){return Zn=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Zn.apply(this,arguments)},Rc=yi,flt="#aaa",dlt="green",plt={fill:"#aaa",fillOpacity:.35,stroke:"#aaa"},glt={fill:"#fff"},vlt={fill:"green"},BN={pointer:{fill:"#aaa",lineWidth:0},scroller:{stroke:"#aaa",fill:"#aaa",lineWidth:1,lineAppendWidth:5,cursor:"pointer"},text:{fill:"#aaa",textBaseline:"top"}},zN={check:{stroke:"green",lineWidth:3},box:{fill:"#fff",stroke:"#aaa",lineWidth:2,radius:3,width:12,height:12},text:{fill:"#aaa",fontSize:12,textBaseline:"top"}},mlt={speed:1,loop:!1,fill:"#fff",stroke:"#fff",hideTimeTypeController:!1,preBtnStyle:{fill:"#aaa",stroke:"#aaa"},nextBtnStyle:{fill:"#aaa",stroke:"#aaa"},playBtnStyle:{fill:"#aaa",stroke:"#aaa",fillOpacity:.05},speedControllerStyle:BN,timeTypeControllerStyle:zN},mv=110,fa=50,to={SINGLE:"single",RANGE:"range"},ylt=function(){function t(n){this.controllerCfg=mn({},mlt,n),this.group=n.group,this.controllerGroup=this.group.addGroup({name:"controller-group"}),this.speedAxisY=[],this.currentSpeed=this.controllerCfg.speed,this.currentType=this.controllerCfg.defaultTimeType||to.RANGE,this.fontFamily=n.fontFamily||"Arial, sans-serif",this.init()}return t.prototype.init=function(){this.renderPlayButton()},t.prototype.getNextMarkerPath=function(n,e,r){return[["M",n,e-r],["L",n+r,e],["L",n,e+r],["Z",n,e-r],["M",n,e],["L",n-r,e-r],["L",n-r,e+r],["Z"]]},t.prototype.getPreMarkerPath=function(n,e,r){return[["M",n,e-r],["L",n-r,e],["L",n,e+r],["L",n,e-r],["M",n,e],["L",n+r,e-r],["L",n+r,e+r],["Z"]]},t.prototype.renderPlayButton=function(){var n=this.controllerCfg,e=n.width,r=n.height,i=n.x,o=n.y,a=n.hideTimeTypeController,s=n.fill,u=s===void 0?flt:s,c=n.stroke,l=c===void 0?dlt:c,h=n.containerStyle,f=h===void 0?{}:h,d=Zn(Zn({},plt),n.playBtnStyle||{}),p=Zn(Zn({},glt),n.preBtnStyle||{}),g=Zn(Zn({},vlt),n.nextBtnStyle||{}),v=r/2-5,m=o+10,y=this.controllerGroup.addShape("rect",{attrs:Zn({x:i,y:m,width:e,height:r,stroke:l,fill:u},f),name:"container-rect"});this.playButton?this.playButton.update({x:e/2,y:m,r:v}):this.playButton=new hlt({group:this.controllerGroup,x:e/2,y:m+v+5,r:v,isPlay:this.isPlay,style:d});var b=p.offsetX||0,x=p.offsetY||0,w=(p.scale||1)*v;this.controllerGroup.addShape("path",{attrs:Zn({path:this.getPreMarkerPath(e/2-5*v+b,m+v+5+x,w*.5)},p),name:Ll});var E=g.offsetX||0,M=g.offsetY||0,_=(g.scale||1)*v;this.controllerGroup.addShape("path",{attrs:Zn({path:this.getNextMarkerPath(e/2+5*v+E,m+v+5+M,_*.5)},g),name:Pl}),y.toBack(),this.renderSpeedBtn(),a||this.renderToggleTime(),this.bindEvent();var k=this.controllerCfg.scale,S=k===void 0?1:k,A=this.controllerGroup.getCanvasBBox(),C=(A.maxX+A.minX)/2,I=(A.maxY+A.minY)/2,N=Rc([1,0,0,0,1,0,0,0,1],[["t",-C,-I],["s",S,S],["t",C,I]]);this.controllerGroup.setMatrix(N)},t.prototype.renderSpeedBtn=function(){var n=this.controllerCfg,e=n.y,r=n.width,i=n.hideTimeTypeController,o=Zn(Zn({},BN),this.controllerCfg.speedControllerStyle||{}),a=o.scroller,s=a===void 0?{}:a,u=o.text,c=u===void 0?{}:u,l=o.pointer,h=l===void 0?{}:l,f=o.scale,d=f===void 0?1:f,p=o.offsetX,g=p===void 0?0:p,v=o.offsetY,m=v===void 0?0:v,y=this.controllerGroup.addGroup({name:"speed-group"});this.speedGroup=y;var b=5;this.speedAxisY=[19,22,26,32,39];for(var x=0;x<5;x++){var w=e+this.speedAxisY[x],E=r-(i?fa:mv);y.addShape("line",{attrs:Zn({x1:E,x2:E+15,y1:w,y2:w},s),speed:b,name:"speed-rect"}),this.speedAxisY[x]=w,b=b-1}this.speedText=y.addShape("text",{attrs:Zn({x:r-(i?fa:mv)+20,y:this.speedAxisY[0]+4,text:"1.0X",fontFamily:this.fontFamily||"Arial, sans-serif"},c),name:"speed-text"}),this.speedPoint=y.addShape("path",{attrs:Zn({path:this.getPointerPath(r-(i?fa:mv),0),matrix:[1,0,0,0,1,0,0,this.speedAxisY[4],1]},h),name:"speed-pointer"});var M=this.speedGroup.getCanvasBBox(),_=(M.maxX+M.minX)/2,k=(M.maxY+M.minY)/2,S=this.speedGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];S=Rc(S,[["t",-_,-k],["s",d,d],["t",_+g*d,k+m*d]]),this.speedGroup.setMatrix(S)},t.prototype.getPointerPath=function(n,e){return[["M",n,e],["L",n-10,e-4],["L",n-10,e+4],["Z"]]},t.prototype.renderToggleTime=function(){var n,e,r=this.controllerCfg,i=r.width,o=r.defaultTimeType,a=Zn(Zn({},zN),this.controllerCfg.timeTypeControllerStyle||{}),s=a.scale,u=s===void 0?1:s,c=a.offsetX,l=c===void 0?0:c,h=a.offsetY,f=h===void 0?0:h,d=a.box,p=d===void 0?{}:d,g=a.check,v=g===void 0?{}:g,m=a.text,y=m===void 0?{}:m;this.toggleGroup=this.controllerGroup.addGroup({name:"toggle-group"});var b=o===to.SINGLE;this.toggleGroup.addShape("rect",{attrs:Zn({x:i-fa,y:this.speedAxisY[0]+3.5},p),isChecked:b,name:"toggle-model"}),this.checkedIcon=this.toggleGroup.addShape("path",{attrs:Zn({path:[["M",i-fa+3,this.speedAxisY[1]+6],["L",i-fa+7,this.speedAxisY[1]+10],["L",i-fa+12,this.speedAxisY[1]+4]]},v),capture:!1,name:"check-icon"}),b||this.checkedIcon.hide(),this.checkedText=this.toggleGroup.addShape("text",{attrs:Zn({text:b?((n=this.controllerCfg)===null||n===void 0?void 0:n.timeRangeControllerText)||"时间范围":((e=this.controllerCfg)===null||e===void 0?void 0:e.timePointControllerText)||"单一时间",x:i-fa+15,y:this.speedAxisY[0]+4,fontFamily:typeof window<"u"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif"},y),name:"checked-text"});var x=this.toggleGroup.getCanvasBBox(),w=(x.maxX+x.minX)/2,E=(x.maxY+x.minY)/2,M=this.toggleGroup.getMatrix()||[1,0,0,0,1,0,0,0,1];M=Rc(M,[["t",-w,-E],["s",u,u],["t",w+l*u,E+f*u]]),this.toggleGroup.setMatrix(M)},t.prototype.bindEvent=function(){var n=this;this.speedGroup.on("speed-rect:click",function(e){var r=e.target.attr("y1"),i=n.speedPoint.attr("matrix"),o=n.speedAxisY.indexOf(i[7]||0),a=n.speedAxisY.indexOf(r),s=n.speedAxisY[a]-n.speedAxisY[o];i=Rc(i,[["t",0,s]]),n.speedPoint.setMatrix(i),n.currentSpeed=n.speedAxisY.length-a,n.speedText.attr("text","".concat(n.currentSpeed,".0X")),n.group.emit(xs,{speed:n.currentSpeed,type:n.currentType})}),this.speedGroup.on("mousewheel",function(e){e.preventDefault();var r=n.speedPoint.attr("matrix")||[1,0,0,0,1,0,0,0,1],i=r[7],o=n.speedAxisY.indexOf(i);if(o===-1){var a=1/0;n.speedAxisY.forEach(function(u,c){var l=Math.abs(u-i);a>l&&(a=l,o=c)})}e.originalEvent.deltaY>0?o=Math.max(0,o-1):o=Math.min(n.speedAxisY.length-1,o+1);var s=n.speedAxisY[o]-i;r=Rc(r,[["t",0,s]]),n.speedPoint.setMatrix(r),n.currentSpeed=n.speedAxisY.length-o,n.speedText.attr("text","".concat(n.currentSpeed,".0X")),n.group.emit(xs,{speed:n.currentSpeed,type:n.currentType})}),this.toggleGroup&&this.toggleGroup.on("toggle-model:click",function(e){var r,i,o=e.target.get("isChecked");o?(n.checkedIcon.hide(),n.checkedText.attr("text",((i=n.controllerCfg)===null||i===void 0?void 0:i.timePointControllerText)||"单一时间"),n.currentType=to.RANGE):(n.checkedIcon.show(),n.checkedText.attr("text",((r=n.controllerCfg)===null||r===void 0?void 0:r.timeRangeControllerText)||"时间范围"),n.currentType=to.SINGLE),e.target.set("isChecked",!o),n.group.emit(xs,{type:n.currentType,speed:n.currentSpeed})})},t.prototype.destroy=function(){this.speedGroup.off("speed-rect:click"),this.toggleGroup&&(this.toggleGroup.off("toggle-model:click"),this.toggleGroup.destroy()),this.speedGroup.destroy()},t}();const GN=ylt;var al=globalThis&&globalThis.__assign||function(){return al=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},al.apply(this,arguments)},blt=yi,xlt={fill:"#5B8FF9"},wlt={fill:"#e6e8e9"},Elt=function(){function t(n){this.frameCount=0,this.fontFamily="Arial, sans-serif";var e=n.graph,r=n.canvas,i=n.group,o=n.width,a=n.height,s=n.padding,u=n.data,c=n.start,l=n.end,h=n.x,f=h===void 0?0:h,d=n.y,p=d===void 0?0:d,g=n.tickLabelFormatter,v=n.selectedTickStyle,m=v===void 0?xlt:v,y=n.unselectedTickStyle,b=y===void 0?wlt:y,x=n.tooltipBackgroundColor,w=n.tooltipFomatter,E=n.tickLabelStyle,M=n.controllerCfg,_=M===void 0?{speed:1}:M;this.graph=e,this.group=i,this.sliceGroup=i.addGroup({name:"slice-group"}),this.canvas=r,this.width=o,this.height=a,this.padding=s,this.data=u,this.start=c,this.end=l,this.tickLabelFormatter=g,this.tickLabelStyle=E||{},this.selectedTickStyle=m,this.unselectedTickStyle=b,this.controllerCfg=_,this.currentSpeed=_.speed||1,this.x=f,this.y=p,this.tooltipBackgroundColor=x,this.tooltipFomatter=w,this.fontFamily=typeof window<"u"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlices(),this.initEvent()}return t.prototype.renderSlices=function(){var n=this,e=this,r=e.width,i=e.height,o=e.padding,a=e.data,s=e.start,u=e.end,c=e.tickLabelFormatter,l=e.selectedTickStyle,h=e.unselectedTickStyle,f=e.tickLabelStyle,d=r-2*o,p=10,g=4,v=3*o+g+p,m=i-v-2*o,y=2,b=a.length,x=(d-y*(b-1))/b;this.tickWidth=x;var w=this.sliceGroup,E=[],M=[],_=Math.round(b*s),k=Math.round(b*u);this.startTickRectId=_,this.endTickRectId=k;var S=f.rotate;delete f.rotate,a.forEach(function(C,I){var N=I>=_&&I<=k,D=N?l:h,P=w.addShape("rect",{attrs:al({x:o+I*(x+y),y:o,width:x,height:m},D),draggable:!0,name:"tick-rect-".concat(I)}),j=w.addShape("rect",{attrs:{x:o+I*x+y*(2*I-1)/2,y:o,width:I===0||I===b-1?x+y/2:x+y,height:m,fill:"#fff",opacity:0},draggable:!0,name:"pick-rect-".concat(I)});j.toFront();var L=P.getBBox(),R=(L.minX+L.maxX)/2;E.push({rect:P,pickRect:j,value:C.date,x:R,y:L.minY});var V;if(c?(V=c(C),!Dt(V)&&V&&(V=C.date)):I%Math.round(b/10)===0&&(V=C.date),V){M.push(V);var tt=L.maxY+o*2;w.addShape("line",{attrs:{stroke:"#BFBFBF",x1:R,y1:tt,x2:R,y2:tt+g},name:"tick-line"});var ut=tt+g+o,dt=w.addShape("text",{attrs:al({fill:"#8c8c8c",stroke:"#fff",lineWidth:1,x:R,y:ut,textAlign:"center",text:V,textBaseline:"top",fontSize:10,fontFamily:n.fontFamily||"Arial, sans-serif"},f),capture:!1,name:"tick-label"}),J=dt.getBBox();if(J.maxX>r?dt.attr("textAlign","right"):J.minX<0&&dt.attr("textAlign","left"),pe(S)&&M.length!==10){var Et=blt([1,0,0,0,1,0,0,0,1],[["t",-R,-ut],["r",S],["t",R-5,ut+2]]);dt.attr({textAlign:"left",matrix:Et})}M.length===1?dt.attr({textAlign:"left"}):M.length===10&&dt.attr({textAlign:"right"})}}),this.tickRects=E;var A=this.group;this.currentSpeed=1,this.controllerBtnGroup=new GN(al({group:A,x:this.x,y:this.y+i+5,width:r,height:40,hideTimeTypeController:!0,speed:this.currentSpeed,fontFamily:this.fontFamily||"Arial, sans-serif"},this.controllerCfg))},t.prototype.initEvent=function(){var n=this,e=this.sliceGroup;e.on("click",function(l){var h=l.target;if(!(h.get("type")!=="rect"||!h.get("name"))){var f=parseInt(h.get("name").split("-")[2],10);if(!isNaN(f)){var d=n.tickRects,p=n.unselectedTickStyle;d.forEach(function(y){y.rect.attr(p)});var g=n.selectedTickStyle;d[f].rect.attr(g),n.startTickRectId=f,n.endTickRectId=f;var v=d.length,m=f/v;n.graph.emit(no,{value:[m,m]})}}}),e.on("dragstart",function(l){var h=n.tickRects,f=n.unselectedTickStyle;h.forEach(function(y){y.rect.attr(f)});var d=l.target,p=parseInt(d.get("name").split("-")[2],10),g=n.selectedTickStyle;h[p].rect.attr(g),n.startTickRectId=p;var v=h.length,m=p/v;n.graph.emit(no,{value:[m,m]}),n.dragging=!0}),e.on("dragover",function(l){if(n.dragging&&l.target.get("type")==="rect"){for(var h=parseInt(l.target.get("name").split("-")[2],10),f=n.startTickRectId,d=n.tickRects,p=n.selectedTickStyle,g=n.unselectedTickStyle,v=0;v<d.length;v++){var m=v>=f&&v<=h?p:g;d[v].rect.attr(m)}var y=d.length;n.endTickRectId=h;var b=f/y,x=h/y;n.graph.emit(no,{value:[b,x]})}}),e.on("drop",function(l){if(n.dragging&&(n.dragging=!1,l.target.get("type")==="rect")){var h=n.startTickRectId,f=parseInt(l.target.get("name").split("-")[2],10);if(!(f<h)){var d=n.selectedTickStyle,p=n.tickRects;p[f].rect.attr(d),n.endTickRectId=f;var g=p.length,v=h/g,m=f/g;n.graph.emit(no,{value:[v,m]})}}});var r=this,i=r.tooltipBackgroundColor,o=r.tooltipFomatter,a=r.canvas,s=new clt({container:a.get("container"),backgroundColor:i}),u=this.tickRects;u.forEach(function(l){var h=l.pickRect;h.on("mouseenter",function(f){var d=f.target;if(d.get("type")==="rect"){var p=parseInt(d.get("name").split("-")[2],10),g=a.getClientByPoint(u[p].x,u[p].y);s.show({x:u[p].x,y:u[p].y,clientX:g.x,clientY:g.y,text:o?o(u[p].value):u[p].value})}}),h.on("mouseleave",function(f){s.hide()})});var c=this.group;c.on("".concat(Sa,":click"),function(){n.isPlay=!n.isPlay,n.changePlayStatus()}),c.on("".concat(Pl,":click"),function(){n.updateStartEnd(1)}),c.on("".concat(Ll,":click"),function(){n.updateStartEnd(-1)}),c.on(xs,function(l){l.type;var h=l.speed;n.currentSpeed=h})},t.prototype.changePlayStatus=function(n){n===void 0&&(n=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(RN,null)):this.playHandler&&(typeof window<"u"&&window.cancelAnimationFrame(this.playHandler),n&&this.graph.emit(FN,null))},t.prototype.startPlay=function(){var n=this;return typeof window<"u"?window.requestAnimationFrame(function(){var e=n.currentSpeed;n.frameCount%(60/e)===0&&(n.frameCount=0,n.updateStartEnd(1)),n.frameCount++,n.isPlay&&(n.playHandler=n.startPlay())}):void 0},t.prototype.updateStartEnd=function(n){var e=this,r=this.tickRects,i=r.length,o=this.unselectedTickStyle,a=this.selectedTickStyle,s=e.endTickRectId;if(n>0?e.endTickRectId++:(r[e.endTickRectId].rect.attr(o),e.endTickRectId--),s!==e.startTickRectId)e.endTickRectId<e.startTickRectId&&(e.startTickRectId=e.endTickRectId);else{for(var u=e.startTickRectId;u<=e.endTickRectId-1;u++)r[u].rect.attr(o);e.startTickRectId=e.endTickRectId}if(r[e.endTickRectId]){r[e.endTickRectId].rect.attr(a);var c=e.startTickRectId/i,l=e.endTickRectId/i;this.graph.emit(no,{value:[c,l]})}},t.prototype.destory=function(){var n=this.sliceGroup;n.off("click"),n.off("dragstart"),n.off("dragover"),n.off("drop"),this.tickRects.forEach(function(e){var r=e.pickRect;r.off("mouseenter"),r.off("mouseleave")}),this.tickRects.length=0,n.off("".concat(Sa,":click")),n.off("".concat(Pl,":click")),n.off("".concat(Ll,":click")),n.off(xs),this.sliceGroup.destroy()},t}();const Mlt=Elt;var UN={};function Slt(t){return UN[t]}function Mo(t,n){UN[t]=n}var mb=function(){function t(n){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=n,this.initCfg(),this.init()}return t.prototype.translate=function(n){return n},t.prototype.change=function(n){ye(this.__cfg__,n),this.init()},t.prototype.clone=function(){return this.constructor(this.__cfg__)},t.prototype.getTicks=function(){var n=this;return Ms(this.ticks,function(e,r){return yr(e)?e:{text:n.getText(e,r),tickValue:e,value:n.scale(e)}})},t.prototype.getText=function(n,e){var r=this.formatter,i=r?r(n,e):n;return fe(i)||!An(i.toString)?"":i.toString()},t.prototype.getConfig=function(n){return this.__cfg__[n]},t.prototype.init=function(){ye(this,this.__cfg__),this.setDomain(),Ak(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},t.prototype.initCfg=function(){},t.prototype.setDomain=function(){},t.prototype.calculateTicks=function(){var n=this.tickMethod,e=[];if(Dt(n)){var r=Slt(n);if(!r)throw new Error("There is no method to to calculate ticks!");e=r(this)}else An(n)&&(e=n(this));return e},t.prototype.rangeMin=function(){return this.range[0]},t.prototype.rangeMax=function(){return this.range[1]},t.prototype.calcPercent=function(n,e,r){return pe(n)?(n-e)/(r-e):NaN},t.prototype.calcValue=function(n,e,r){return e+n*(r-e)},t}(),dh=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="cat",e.isCategory=!0,e}return n.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var e=0;e<this.values.length;e++)this.translateIndexMap.set(this.values[e],e)}},n.prototype.translate=function(e){this.buildIndexMap();var r=this.translateIndexMap.get(e);return r===void 0&&(r=pe(e)?e:NaN),r},n.prototype.scale=function(e){var r=this.translate(e),i=this.calcPercent(r,this.min,this.max);return this.calcValue(i,this.rangeMin(),this.rangeMax())},n.prototype.invert=function(e){var r=this.max-this.min,i=this.calcPercent(e,this.rangeMin(),this.rangeMax()),o=Math.round(r*i)+this.min;return o<this.min||o>this.max?NaN:this.values[o]},n.prototype.getText=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=e;return pe(e)&&!this.values.includes(e)&&(o=this.values[o]),t.prototype.getText.apply(this,ap([o],r))},n.prototype.initCfg=function(){this.tickMethod="cat"},n.prototype.setDomain=function(){if(fe(this.getConfig("min"))&&(this.min=0),fe(this.getConfig("max"))){var e=this.values.length;this.max=e>1?e-1:e}this.translateIndexMap&&(this.translateIndexMap=void 0)},n}(mb),YN=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,va="\\d\\d?",da="\\d\\d",_lt="\\d{3}",klt="\\d{4}",sl="[^\\s]+",VN=/\[([^]*?)\]/gm;function WN(t,n){for(var e=[],r=0,i=t.length;r<i;r++)e.push(t[r].substr(0,n));return e}var h_=function(t){return function(n,e){var r=e[t].map(function(o){return o.toLowerCase()}),i=r.indexOf(n.toLowerCase());return i>-1?i:null}};function Pa(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(var r=0,i=n;r<i.length;r++){var o=i[r];for(var a in o)t[a]=o[a]}return t}var XN=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],HN=["January","February","March","April","May","June","July","August","September","October","November","December"],Alt=WN(HN,3),Clt=WN(XN,3),yb={dayNamesShort:Clt,dayNames:XN,monthNamesShort:Alt,monthNames:HN,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!==10?1:0)*t%10]}},tp=Pa({},yb),qN=function(t){return tp=Pa(tp,t)},f_=function(t){return t.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},Lr=function(t,n){for(n===void 0&&(n=2),t=String(t);t.length<n;)t="0"+t;return t},Ilt={D:function(t){return String(t.getDate())},DD:function(t){return Lr(t.getDate())},Do:function(t,n){return n.DoFn(t.getDate())},d:function(t){return String(t.getDay())},dd:function(t){return Lr(t.getDay())},ddd:function(t,n){return n.dayNamesShort[t.getDay()]},dddd:function(t,n){return n.dayNames[t.getDay()]},M:function(t){return String(t.getMonth()+1)},MM:function(t){return Lr(t.getMonth()+1)},MMM:function(t,n){return n.monthNamesShort[t.getMonth()]},MMMM:function(t,n){return n.monthNames[t.getMonth()]},YY:function(t){return Lr(String(t.getFullYear()),4).substr(2)},YYYY:function(t){return Lr(t.getFullYear(),4)},h:function(t){return String(t.getHours()%12||12)},hh:function(t){return Lr(t.getHours()%12||12)},H:function(t){return String(t.getHours())},HH:function(t){return Lr(t.getHours())},m:function(t){return String(t.getMinutes())},mm:function(t){return Lr(t.getMinutes())},s:function(t){return String(t.getSeconds())},ss:function(t){return Lr(t.getSeconds())},S:function(t){return String(Math.round(t.getMilliseconds()/100))},SS:function(t){return Lr(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return Lr(t.getMilliseconds(),3)},a:function(t,n){return t.getHours()<12?n.amPm[0]:n.amPm[1]},A:function(t,n){return t.getHours()<12?n.amPm[0].toUpperCase():n.amPm[1].toUpperCase()},ZZ:function(t){var n=t.getTimezoneOffset();return(n>0?"-":"+")+Lr(Math.floor(Math.abs(n)/60)*100+Math.abs(n)%60,4)},Z:function(t){var n=t.getTimezoneOffset();return(n>0?"-":"+")+Lr(Math.floor(Math.abs(n)/60),2)+":"+Lr(Math.abs(n)%60,2)}},d_=function(t){return+t-1},p_=[null,va],g_=[null,sl],v_=["isPm",sl,function(t,n){var e=t.toLowerCase();return e===n.amPm[0]?0:e===n.amPm[1]?1:null}],m_=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(t){var n=(t+"").match(/([+-]|\d\d)/gi);if(n){var e=+n[1]*60+parseInt(n[2],10);return n[0]==="+"?e:-e}return 0}],Tlt={D:["day",va],DD:["day",da],Do:["day",va+sl,function(t){return parseInt(t,10)}],M:["month",va,d_],MM:["month",da,d_],YY:["year",da,function(t){var n=new Date,e=+(""+n.getFullYear()).substr(0,2);return+(""+(+t>68?e-1:e)+t)}],h:["hour",va,void 0,"isPm"],hh:["hour",da,void 0,"isPm"],H:["hour",va],HH:["hour",da],m:["minute",va],mm:["minute",da],s:["second",va],ss:["second",da],YYYY:["year",klt],S:["millisecond","\\d",function(t){return+t*100}],SS:["millisecond",da,function(t){return+t*10}],SSS:["millisecond",_lt],d:p_,dd:p_,ddd:g_,dddd:g_,MMM:["month",sl,h_("monthNamesShort")],MMMM:["month",sl,h_("monthNames")],a:v_,A:v_,ZZ:m_,Z:m_},ep={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},ZN=function(t){return Pa(ep,t)},KN=function(t,n,e){if(n===void 0&&(n=ep.default),e===void 0&&(e={}),typeof t=="number"&&(t=new Date(t)),Object.prototype.toString.call(t)!=="[object Date]"||isNaN(t.getTime()))throw new Error("Invalid Date pass to format");n=ep[n]||n;var r=[];n=n.replace(VN,function(o,a){return r.push(a),"@@@"});var i=Pa(Pa({},tp),e);return n=n.replace(YN,function(o){return Ilt[o](t,i)}),n.replace(/@@@/g,function(){return r.shift()})};function QN(t,n,e){if(e===void 0&&(e={}),typeof n!="string")throw new Error("Invalid format in fecha parse");if(n=ep[n]||n,t.length>1e3)return null;var r=new Date,i={year:r.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},o=[],a=[],s=n.replace(VN,function(x,w){return a.push(f_(w)),"@@@"}),u={},c={};s=f_(s).replace(YN,function(x){var w=Tlt[x],E=w[0],M=w[1],_=w[3];if(u[E])throw new Error("Invalid format. "+E+" specified twice in format");return u[E]=!0,_&&(c[_]=!0),o.push(w),"("+M+")"}),Object.keys(c).forEach(function(x){if(!u[x])throw new Error("Invalid format. "+x+" is required in specified format")}),s=s.replace(/@@@/g,function(){return a.shift()});var l=t.match(new RegExp(s,"i"));if(!l)return null;for(var h=Pa(Pa({},tp),e),f=1;f<l.length;f++){var d=o[f-1],p=d[0],g=d[2],v=g?g(l[f],h):+l[f];if(v==null)return null;i[p]=v}i.isPm===1&&i.hour!=null&&+i.hour!=12?i.hour=+i.hour+12:i.isPm===0&&+i.hour==12&&(i.hour=0);var m;if(i.timezoneOffset==null){m=new Date(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond);for(var y=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],f=0,b=y.length;f<b;f++)if(u[y[f][0]]&&i[y[f][0]]!==m[y[f][1]]())return null}else if(m=new Date(Date.UTC(i.year,i.month,i.day,i.hour,i.minute-i.timezoneOffset,i.second,i.millisecond)),i.month>11||i.month<0||i.day>31||i.day<1||i.hour>23||i.hour<0||i.minute>59||i.minute<0||i.second>59||i.second<0)return null;return m}var JN={format:KN,parse:QN,defaultI18n:yb,setGlobalDateI18n:qN,setGlobalDateMasks:ZN};const Olt=Object.freeze(Object.defineProperty({__proto__:null,assign:Pa,default:JN,defaultI18n:yb,format:KN,parse:QN,setGlobalDateI18n:qN,setGlobalDateMasks:ZN},Symbol.toStringTag,{value:"Module"}));function Nlt(t){return function(n,e,r,i){for(var o=fe(r)?0:r,a=fe(i)?n.length:i;o<a;){var s=o+a>>>1;t(n[s])>e?a=s:o=s+1}return o}}var y_="format";function $N(t,n){var e=Olt[y_]||JN[y_];return e(t,n)}function np(t){return Dt(t)&&(t.indexOf("T")>0?t=new Date(t).getTime():t=new Date(t.replace(/-/gi,"/")).getTime()),sy(t)&&(t=t.getTime()),t}var Ci=1e3,ws=60*Ci,Es=60*ws,Vo=24*Es,ul=Vo*31,b_=Vo*365,Fc=[["HH:mm:ss",Ci],["HH:mm:ss",Ci*10],["HH:mm:ss",Ci*30],["HH:mm",ws],["HH:mm",ws*10],["HH:mm",ws*30],["HH",Es],["HH",Es*6],["HH",Es*12],["YYYY-MM-DD",Vo],["YYYY-MM-DD",Vo*4],["YYYY-WW",Vo*7],["YYYY-MM",ul],["YYYY-MM",ul*4],["YYYY-MM",ul*6],["YYYY",Vo*380]];function Dlt(t,n,e){var r=(n-t)/e,i=Nlt(function(a){return a[1]})(Fc,r)-1,o=Fc[i];return i<0?o=Fc[0]:i>=Fc.length&&(o=gi(Fc)),o}var Plt=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="timeCat",e}return n.prototype.translate=function(e){e=np(e);var r=this.values.indexOf(e);return r===-1&&(pe(e)&&e<this.values.length?r=e:r=NaN),r},n.prototype.getText=function(e,r){var i=this.translate(e);if(i>-1){var o=this.values[i],a=this.formatter;return o=a?a(o,r):$N(o,this.mask),o}return e},n.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},n.prototype.setDomain=function(){var e=this.values;mt(e,function(r,i){e[i]=np(r)}),e.sort(function(r,i){return r-i}),t.prototype.setDomain.call(this)},n}(dh),ig=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.isContinuous=!0,e}return n.prototype.scale=function(e){if(fe(e))return NaN;var r=this.rangeMin(),i=this.rangeMax(),o=this.max,a=this.min;if(o===a)return r;var s=this.getScalePercent(e);return r+s*(i-r)},n.prototype.init=function(){t.prototype.init.call(this);var e=this.ticks,r=lo(e),i=gi(e);r<this.min&&(this.min=r),i>this.max&&(this.max=i),fe(this.minLimit)||(this.min=r),fe(this.maxLimit)||(this.max=i)},n.prototype.setDomain=function(){var e=gk(this.values),r=e.min,i=e.max;fe(this.min)&&(this.min=r),fe(this.max)&&(this.max=i),this.min>this.max&&(this.min=r,this.max=i)},n.prototype.calculateTicks=function(){var e=this,r=t.prototype.calculateTicks.call(this);return this.nice||(r=sp(r,function(i){return i>=e.min&&i<=e.max})),r},n.prototype.getScalePercent=function(e){var r=this.max,i=this.min;return(e-i)/(r-i)},n.prototype.getInvertPercent=function(e){return(e-this.rangeMin())/(this.rangeMax()-this.rangeMin())},n}(mb),Llt=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="linear",e.isLinear=!0,e}return n.prototype.invert=function(e){var r=this.getInvertPercent(e);return this.min+r*(this.max-this.min)},n.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},n}(ig);const ph=Llt;function ba(t,n){var e=Math.E,r;return n>=0?r=Math.pow(e,Math.log(n)/t):r=Math.pow(e,Math.log(-n)/t)*-1,r}function fi(t,n){return t===1?1:Math.log(n)/Math.log(t)}function t5(t,n,e){fe(e)&&(e=Math.max.apply(null,t));var r=e;return mt(t,function(i){i>0&&i<r&&(r=i)}),r===e&&(r=e/n),r>1&&(r=1),r}var jlt=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="log",e}return n.prototype.invert=function(e){var r=this.base,i=fi(r,this.max),o=this.rangeMin(),a=this.rangeMax()-o,s,u=this.positiveMin;if(u){if(e===0)return 0;s=fi(r,u/r);var c=1/(i-s)*a;if(e<c)return e/c*u}else s=fi(r,this.min);var l=(e-o)/a,h=l*(i-s)+s;return Math.pow(r,h)},n.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},n.prototype.setDomain=function(){t.prototype.setDomain.call(this);var e=this.min;if(e<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");e===0&&(this.positiveMin=t5(this.values,this.base,this.max))},n.prototype.getScalePercent=function(e){var r=this.max,i=this.min;if(r===i||e<=0)return 0;var o=this.base,a=this.positiveMin;a&&(i=a*1/o);var s;return e<a?s=e/a/(fi(o,r)-fi(o,i)):s=(fi(o,e)-fi(o,i))/(fi(o,r)-fi(o,i)),s},n}(ig),Rlt=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="pow",e}return n.prototype.invert=function(e){var r=this.getInvertPercent(e),i=this.exponent,o=ba(i,this.max),a=ba(i,this.min),s=r*(o-a)+a,u=s>=0?1:-1;return Math.pow(s,i)*u},n.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},n.prototype.getScalePercent=function(e){var r=this.max,i=this.min;if(r===i)return 0;var o=this.exponent,a=(ba(o,e)-ba(o,i))/(ba(o,r)-ba(o,i));return a},n}(ig),Flt=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="time",e}return n.prototype.getText=function(e,r){var i=this.translate(e),o=this.formatter;return o?o(i,r):$N(i,this.mask)},n.prototype.scale=function(e){var r=e;return(Dt(r)||sy(r))&&(r=this.translate(r)),t.prototype.scale.call(this,r)},n.prototype.translate=function(e){return np(e)},n.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},n.prototype.setDomain=function(){var e=this.values,r=this.getConfig("min"),i=this.getConfig("max");if((!fe(r)||!pe(r))&&(this.min=this.translate(this.min)),(!fe(i)||!pe(i))&&(this.max=this.translate(this.max)),e&&e.length){var o=[],a=1/0,s=a,u=0;mt(e,function(c){var l=np(c);if(isNaN(l))throw new TypeError("Invalid Time: "+c+" in time scale!");a>l?(s=a,a=l):s>l&&(s=l),u<l&&(u=l),o.push(l)}),e.length>1&&(this.minTickInterval=s-a),fe(r)&&(this.min=a),fe(i)&&(this.max=u)}},n}(ph),e5=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="quantize",e}return n.prototype.invert=function(e){var r=this.ticks,i=r.length,o=this.getInvertPercent(e),a=Math.floor(o*(i-1));if(a>=i-1)return gi(r);if(a<0)return lo(r);var s=r[a],u=r[a+1],c=a/(i-1),l=(a+1)/(i-1);return s+(o-c)/(l-c)*(u-s)},n.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},n.prototype.calculateTicks=function(){var e=t.prototype.calculateTicks.call(this);return this.nice||(gi(e)!==this.max&&e.push(this.max),lo(e)!==this.min&&e.unshift(this.min)),e},n.prototype.getScalePercent=function(e){var r=this.ticks;if(e<lo(r))return 0;if(e>gi(r))return 1;var i=0;return mt(r,function(o,a){if(e>=o)i=a;else return!1}),i/(r.length-1)},n}(ig),Blt=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="quantile",e}return n.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},n}(e5),n5={};function zlt(t){return n5[t]}function So(t,n){if(zlt(t))throw new Error("type '"+t+"' existed.");n5[t]=n}var Glt=function(t){Te(n,t);function n(){var e=t!==null&&t.apply(this,arguments)||this;return e.type="identity",e.isIdentity=!0,e}return n.prototype.calculateTicks=function(){return this.values},n.prototype.scale=function(e){return this.values[0]!==e&&pe(e)?e:this.range[0]},n.prototype.invert=function(e){var r=this.range;return e<r[0]||e>r[1]?NaN:this.values[0]},n}(mb);function r5(t){var n=t.values,e=t.tickInterval,r=t.tickCount,i=t.showLast;if(pe(e)){var o=sp(n,function(p,g){return g%e===0}),a=gi(n);return i&&gi(o)!==a&&o.push(a),o}var s=n.length,u=t.min,c=t.max;if(fe(u)&&(u=0),fe(c)&&(c=n.length-1),!pe(r)||r>=s)return n.slice(u,c+1);if(r<=0||c<=0)return[];for(var l=r===1?s:Math.floor(s/(r-1)),h=[],f=u,d=0;d<r&&!(f>=c);d++)f=Math.min(u+d*l,c),d===r-1&&i?h.push(n[c]):h.push(n[f]);return h}function Ult(t){var n=t.min,e=t.max,r=t.nice,i=t.tickCount,o=new Ylt;return o.domain([n,e]),r&&o.nice(i),o.ticks(i)}var yv=5,x_=Math.sqrt(50),w_=Math.sqrt(10),E_=Math.sqrt(2),Ylt=function(){function t(){this._domain=[0,1]}return t.prototype.domain=function(n){return n?(this._domain=Array.from(n,Number),this):this._domain.slice()},t.prototype.nice=function(n){var e,r;n===void 0&&(n=yv);var i=this._domain.slice(),o=0,a=this._domain.length-1,s=this._domain[o],u=this._domain[a],c;return u<s&&(e=[u,s],s=e[0],u=e[1],r=[a,o],o=r[0],a=r[1]),c=fd(s,u,n),c>0?(s=Math.floor(s/c)*c,u=Math.ceil(u/c)*c,c=fd(s,u,n)):c<0&&(s=Math.ceil(s*c)/c,u=Math.floor(u*c)/c,c=fd(s,u,n)),c>0?(i[o]=Math.floor(s/c)*c,i[a]=Math.ceil(u/c)*c,this.domain(i)):c<0&&(i[o]=Math.ceil(s*c)/c,i[a]=Math.floor(u*c)/c,this.domain(i)),this},t.prototype.ticks=function(n){return n===void 0&&(n=yv),Vlt(this._domain[0],this._domain[this._domain.length-1],n||yv)},t}();function Vlt(t,n,e){var r,i=-1,o,a,s;if(n=+n,t=+t,e=+e,t===n&&e>0)return[t];if((r=n<t)&&(o=t,t=n,n=o),(s=fd(t,n,e))===0||!isFinite(s))return[];if(s>0)for(t=Math.ceil(t/s),n=Math.floor(n/s),a=new Array(o=Math.ceil(n-t+1));++i<o;)a[i]=(t+i)*s;else for(t=Math.floor(t*s),n=Math.ceil(n*s),a=new Array(o=Math.ceil(t-n+1));++i<o;)a[i]=(t-i)/s;return r&&a.reverse(),a}function fd(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=x_?10:o>=w_?5:o>=E_?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=x_?10:o>=w_?5:o>=E_?2:1)}function M_(t,n,e){var r;return e==="ceil"?r=Math.ceil(t/n):e==="floor"?r=Math.floor(t/n):r=Math.round(t/n),r*n}function bb(t,n,e){var r=M_(t,e,"floor"),i=M_(n,e,"ceil");r=Uf(r,e),i=Uf(i,e);for(var o=[],a=Math.max((i-r)/(Math.pow(2,12)-1),e),s=r;s<=i;s=s+a){var u=Uf(s,a);o.push(u)}return{min:r,max:i,ticks:o}}function xb(t,n,e){var r,i=t.minLimit,o=t.maxLimit,a=t.min,s=t.max,u=t.tickCount,c=u===void 0?5:u,l=fe(i)?fe(n)?a:n:i,h=fe(o)?fe(e)?s:e:o;if(l>h&&(r=[l,h],h=r[0],l=r[1]),c<=2)return[l,h];for(var f=(h-l)/(c-1),d=[],p=0;p<c;p++)d.push(l+f*p);return d}function Wlt(t){var n=t.min,e=t.max,r=t.tickInterval,i=t.minLimit,o=t.maxLimit,a=Ult(t);return!fe(i)||!fe(o)?xb(t,lo(a),gi(a)):r?bb(n,e,r).ticks:a}function hs(t){return Math.abs(t)<1e-15?t:parseFloat(t.toFixed(15))}var Xlt=[1,5,2,2.5,4,3],S_=Number.EPSILON*100;function Hlt(t,n){return(t%n+n)%n}function qlt(t){return Math.round(t*1e12)/1e12}function Zlt(t,n,e,r,i,o){var a=lp(n),s=uy(n,t),u=0,c=Hlt(r,o);return(c<S_||o-c<S_)&&r<=0&&i>=0&&(u=1),1-s/(a-1)-e+u}function Klt(t,n,e){var r=lp(n),i=uy(n,t),o=1;return 1-i/(r-1)-e+o}function Qlt(t,n,e,r,i,o){var a=(t-1)/(o-i),s=(n-1)/(Math.max(o,r)-Math.min(e,i));return 2-Math.max(a/s,s/a)}function Jlt(t,n){return t>=n?2-(t-1)/(n-1):1}function $lt(t,n,e,r){var i=n-t;return 1-.5*(Math.pow(n-r,2)+Math.pow(t-e,2))/Math.pow(.1*i,2)}function tht(t,n,e){var r=n-t;if(e>r){var i=(e-r)/2;return 1-Math.pow(i,2)/Math.pow(.1*r,2)}return 1}function eht(){return 1}function nht(t,n,e,r,i,o){e===void 0&&(e=5),r===void 0&&(r=!0),i===void 0&&(i=Xlt),o===void 0&&(o=[.25,.2,.5,.05]);var a=e<0?0:Math.round(e);if(Number.isNaN(t)||Number.isNaN(n)||typeof t!="number"||typeof n!="number"||!a)return{min:0,max:0,ticks:[]};if(n-t<1e-15||a===1)return{min:t,max:n,ticks:[t]};if(n-t>1e148){var s=e||5,u=(n-t)/s;return{min:t,max:n,ticks:Array(s).fill(null).map(function(tt,ut){return hs(t+u*ut)})}}for(var c={score:-2,lmin:0,lmax:0,lstep:0},l=1;l<1/0;){for(var h=0;h<i.length;h+=1){var f=i[h],d=Klt(f,i,l);if(o[0]*d+o[1]+o[2]+o[3]<c.score){l=1/0;break}for(var p=2;p<1/0;){var g=Jlt(p,a);if(o[0]*d+o[1]+o[2]*g+o[3]<c.score)break;for(var v=(n-t)/(p+1)/l/f,m=Math.ceil(Math.log10(v));m<1/0;){var y=l*f*Math.pow(10,m),b=tht(t,n,y*(p-1));if(o[0]*d+o[1]*b+o[2]*g+o[3]<c.score)break;var x=Math.floor(n/y)*l-(p-1)*l,w=Math.ceil(t/y)*l;if(x<=w)for(var s=w-x,E=0;E<=s;E+=1){var M=x+E,_=M*(y/l),k=_+y*(p-1),S=y,A=Zlt(f,i,l,_,k,S),C=$lt(t,n,_,k),I=Qlt(p,a,t,n,_,k),N=eht(),D=o[0]*A+o[1]*C+o[2]*I+o[3]*N;D>c.score&&(!r||_<=t&&k>=n)&&(c.lmin=_,c.lmax=k,c.lstep=S,c.score=D)}m+=1}p+=1}}l+=1}var P=hs(c.lmax),j=hs(c.lmin),L=hs(c.lstep),R=Math.floor(qlt((P-j)/L))+1,V=new Array(R);V[0]=hs(j);for(var h=1;h<R;h++)V[h]=hs(V[h-1]+L);return{min:Math.min(t,lo(V)),max:Math.max(n,gi(V)),ticks:V}}function rht(t){var n=t.min,e=t.max,r=t.tickCount,i=t.nice,o=t.tickInterval,a=t.minLimit,s=t.maxLimit,u=nht(n,e,r,i).ticks;return!fe(a)||!fe(s)?xb(t,lo(u),gi(u)):o?bb(n,e,o).ticks:u}function iht(t){var n=t.base,e=t.tickCount,r=t.min,i=t.max,o=t.values,a,s=fi(n,i);if(r>0)a=Math.floor(fi(n,r));else{var u=t5(o,n,i);a=Math.floor(fi(n,u))}for(var c=s-a,l=Math.ceil(c/e),h=[],f=a;f<s+l;f=f+l)h.push(Math.pow(n,f));return r<=0&&h.unshift(0),h}function i5(t,n,e){if(e===void 0&&(e=5),t===n)return{max:n,min:t,ticks:[t]};var r=e<0?0:Math.round(e);if(r===0)return{max:n,min:t,ticks:[]};var i=1.5,o=.5+1.5*i,a=n-t,s=a/r,u=Math.pow(10,Math.floor(Math.log10(s))),c=u;2*u-s<i*(s-c)&&(c=2*u,5*u-s<o*(s-c)&&(c=5*u,10*u-s<i*(s-c)&&(c=10*u)));for(var l=Math.ceil(n/c),h=Math.floor(t/c),f=Math.max(l*c,n),d=Math.min(h*c,t),p=Math.floor((f-d)/c)+1,g=new Array(p),v=0;v<p;v++)g[v]=hs(d+v*c);return{min:d,max:f,ticks:g}}function oht(t){var n=t.exponent,e=t.tickCount,r=Math.ceil(ba(n,t.max)),i=Math.floor(ba(n,t.min)),o=i5(i,r,e).ticks;return o.map(function(a){var s=a>=0?1:-1;return Math.pow(a,n)*s})}function aht(t,n){var e=t.length*n;return n===1?t[t.length-1]:n===0?t[0]:e%1!==0?t[Math.ceil(e)-1]:t.length%2===0?(t[e-1]+t[e])/2:t[e]}function sht(t){var n=t.tickCount,e=t.values;if(!e||!e.length)return[];for(var r=e.slice().sort(function(s,u){return s-u}),i=[],o=0;o<n;o++){var a=o/(n-1);i.push(aht(r,a))}return i}function uht(t){var n=t.min,e=t.max,r=t.tickCount,i=t.tickInterval,o=t.minLimit,a=t.maxLimit,s=i5(n,e,r).ticks;return!fe(o)||!fe(a)?xb(t,lo(s),gi(s)):i?bb(n,e,i).ticks:s}function cht(t){var n=t.min,e=t.max,r=t.minTickInterval,i=t.tickInterval,o=t.tickCount;if(i)o=Math.ceil((e-n)/i);else{i=Dlt(n,e,o)[1];var a=(e-n)/i,s=a/o;s>1&&(i=i*Math.ceil(s)),r&&i<r&&(i=r)}i=Math.max(Math.floor((e-n)/(Math.pow(2,12)-1)),i);for(var u=[],c=n;c<e+i;c+=i)u.push(c);return u}function lht(t){var n=r5(B({showLast:!0},t));return n}function rp(t){return new Date(t).getFullYear()}function hht(t){return new Date(t,0,1).getTime()}function Zm(t){return new Date(t).getMonth()}function fht(t,n){var e=rp(t),r=rp(n),i=Zm(t),o=Zm(n);return(r-e)*12+(o-i)%12}function dht(t,n){return new Date(t,n,1).getTime()}function pht(t,n){return Math.ceil((n-t)/Vo)}function ght(t,n){return Math.ceil((n-t)/Es)}function vht(t,n){return Math.ceil((n-t)/(60*1e3))}function mht(t){var n=t.min,e=t.max,r=t.minTickInterval,i=t.tickCount,o=t.tickInterval,a=[];o||(o=(e-n)/i,r&&o<r&&(o=r)),o=Math.max(Math.floor((e-n)/(Math.pow(2,12)-1)),o);var s=rp(n);if(o>b_)for(var u=rp(e),c=Math.ceil(o/b_),l=s;l<=u+c;l=l+c)a.push(hht(l));else if(o>ul)for(var h=Math.ceil(o/ul),f=Zm(n),d=fht(n,e),l=0;l<=d+h;l=l+h)a.push(dht(s,l+f));else if(o>Vo)for(var p=new Date(n),g=p.getFullYear(),v=p.getMonth(),m=p.getDate(),y=Math.ceil(o/Vo),b=pht(n,e),l=0;l<b+y;l=l+y)a.push(new Date(g,v,m+l).getTime());else if(o>Es)for(var p=new Date(n),g=p.getFullYear(),v=p.getMonth(),y=p.getDate(),x=p.getHours(),w=Math.ceil(o/Es),E=ght(n,e),l=0;l<=E+w;l=l+w)a.push(new Date(g,v,y,x+l).getTime());else if(o>ws)for(var M=vht(n,e),_=Math.ceil(o/ws),l=0;l<=M+_;l=l+_)a.push(n+l*ws);else{var k=o;k<Ci&&(k=Ci);for(var S=Math.floor(n/Ci)*Ci,A=Math.ceil((e-n)/Ci),C=Math.ceil(k/Ci),l=0;l<A+C;l=l+C)a.push(S+l*Ci)}return a.length>=512&&console.warn("Notice: current ticks length("+a.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+o+") is too small, increase the value to solve the problem!"),a}Mo("cat",r5);Mo("time-cat",lht);Mo("wilkinson-extended",rht);Mo("r-pretty",uht);Mo("time",cht);Mo("time-pretty",mht);Mo("log",iht);Mo("pow",oht);Mo("quantile",sht);Mo("d3-linear",Wlt);So("cat",dh);So("category",dh);So("identity",Glt);So("linear",ph);So("log",jlt);So("pow",Rlt);So("time",Flt);So("timeCat",Plt);So("quantize",e5);So("quantile",Blt);var yht=globalThis&&globalThis.__spreadArray||function(t,n,e){if(e||arguments.length===2)for(var r=0,i=n.length,o;r<i;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))};function bht(t){return Ms(t,function(n,e){var r=e===0?"M":"L",i=n[0],o=n[1];return[r,i,o]})}function o5(t){return bht(t)}function xht(t){if(t.length<=2)return o5(t);var n=[];mt(t,function(a){Aa(a,n.slice(n.length-2))||n.push(a[0],a[1])});var e=vI(n,!1),r=lo(t),i=r[0],o=r[1];return e.unshift(["M",i,o]),e}function wht(t,n,e,r){r===void 0&&(r=!0);var i=new ph({values:t}),o=new dh({values:Ms(t,function(s,u){return u})}),a=Ms(t,function(s,u){return[o.scale(u)*n,e-i.scale(s)*e]});return r?xht(a):o5(a)}function Eht(t,n,e,r){r===void 0&&(r=5);for(var i=new ph({values:t}),o=new dh({values:Ms(t,function(f,d){return d})}),a=Ms(t,function(f,d){return[o.scale(d)*n,e-i.scale(f)*e]}),s=[],u=0;u<a.length;u++){var c=a[u],l={x:c[0],y:c[1],y0:e,size:r},h=_ht(l);s.push.apply(s,h)}return kht(s)}function Mht(t,n){var e=new ph({values:t}),r=Math.max(0,e.min);return n-e.scale(r)*n}function Sht(t,n,e,r){var i=yht([],t,!0),o=Mht(r,e);return i.push(["L",n,o]),i.push(["L",0,o]),i.push(["Z"]),i}function _ht(t){var n=t.x,e=t.y,r=t.y0,i=t.size,o,a;ve(e)?(o=e[0],a=e[1]):(o=r,a=e);var s,u;ve(n)?(s=n[0],u=n[1]):(s=n-i/2,u=n+i/2);var c=[{x:s,y:o},{x:s,y:a}];return c.push({x:u,y:a},{x:u,y:o}),c}function kht(t,n){n===void 0&&(n=!0);var e=[],r=t[0];e.push(["M",r.x,r.y]);for(var i=1,o=t.length;i<o;i++)e.push(["L",t[i].x,t[i].y]);return n&&(e.push(["L",r.x,r.y]),e.push(["z"])),e}var cl=globalThis&&globalThis.__assign||function(){return cl=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},cl.apply(this,arguments)},Aht={stroke:"#C5C5C5",strokeOpacity:.85},Cht={fill:"#CACED4",opacity:.85},Iht=function(){function t(n){var e=n.x,r=e===void 0?0:e,i=n.y,o=i===void 0?0:i,a=n.width,s=a===void 0?200:a,u=n.height,c=u===void 0?26:u,l=n.smooth,h=l===void 0?!0:l,f=n.isArea,d=f===void 0?!1:f,p=n.data,g=p===void 0?[]:p,v=n.lineStyle,m=n.areaStyle,y=n.group,b=n.interval,x=b===void 0?null:b;this.group=y,this.x=r,this.y=o,this.width=s,this.height=c,this.data=g,this.smooth=h,this.isArea=d,this.lineStyle=Object.assign({},Aht,v),this.areaStyle=Object.assign({},Cht,m),this.intervalConfig=x,this.renderLine()}return t.prototype.renderLine=function(){var n=this,e=n.x,r=n.y,i=n.width,o=n.height;n.barWidth;var a=n.data,s=n.smooth,u=n.isArea,c=n.lineStyle,l=n.areaStyle,h=this.group.addGroup({name:"trend-group"});if(a){var f=wht(a,i,o,s);if(h.addShape("path",{attrs:cl({path:f},c),name:"trend-line"}),u){var d=Sht(f,i,o,a);h.addShape("path",{attrs:cl({path:d},l),name:"trend-area"})}}this.intervalConfig&&h.addShape("path",{attrs:cl({path:Eht(this.intervalConfig.data,i,o,this.intervalConfig.style.barWidth)},this.intervalConfig.style),name:"trend-interval"}),h.move(e,r)},t.prototype.destory=function(){this.group.destroy()},t}();const Tht=Iht;var Su=globalThis&&globalThis.__assign||function(){return Su=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Su.apply(this,arguments)},Oht={fill:"#1890ff",stroke:"#1890ff",type:"trend",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#0050b3"},Nht={fill:"#fff",stroke:"#1890ff",radius:2,opacity:1,cursor:"ew-resize"},Dht=function(){function t(n){var e=n.group,r=n.name,i=n.type,o=n.x,a=o===void 0?0:o,s=n.y,u=s===void 0?0:s,c=n.width,l=c===void 0?2:c,h=n.height,f=h===void 0?24:h,d=n.style,p=d===void 0?{}:d;this.group=e,this.name=r,this.handleType=i,this.x=a,this.y=u,this.width=l,this.height=f,i==="trend"?this.style=Su(Su({},Oht),p):i==="simple"&&(this.style=Su(Su({},Nht),p)),this.renderHandle()}return t.prototype.setX=function(n){this.setXY(n,void 0)},t.prototype.setY=function(n){this.setXY(void 0,n)},t.prototype.setXY=function(n,e){pe(n)&&(this.x=n),pe(e)&&(this.y=e),this.updateXY()},t.prototype.renderHandle=function(){var n=this,e=n.width,r=n.height,i=n.style,o=n.name,a=i.fill,s=i.stroke,u=i.radius,c=i.opacity,l=i.cursor;this.handleGroup=this.group.addGroup(),this.handleType==="trend"?(this.verticalLine=this.handleGroup.addShape("rect",{attrs:{x:0,y:0,width:e,height:r,fill:a,stroke:s,radius:u,opacity:c,cursor:l},name:"".concat(o,"-handler")}),this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:e/2,y:0,r:2*e,fill:a,stroke:s,radius:u,opacity:c,cursor:l,lineAppendWidth:12},name:"".concat(o,"-handler")}),this.bottomCircle=this.handleGroup.addShape("circle",{attrs:{x:e/2,y:r,r:2*e,fill:a,stroke:s,radius:u,opacity:c,cursor:l},name:"".concat(o,"-handler")})):this.handleType==="simple"&&(this.topCircle=this.handleGroup.addShape("circle",{attrs:{x:e/2,y:r/2,r:2*e,fill:a,stroke:s,radius:u,opacity:c,cursor:l,lineWidth:2},name:"".concat(o,"-handler")})),this.updateXY(),this.handleType==="trend"?this.bindTrendEvents():this.handleType==="simple"&&this.bindSimpleEvents()},t.prototype.bindSimpleEvents=function(){var n=this,e=this.name;this.handleGroup.on("".concat(e,"-handler:mouseenter"),function(){var r=n.style.highLightFill;n.topCircle.attr("fill",r)}),this.handleGroup.on("".concat(e,"-handler:mouseleave"),function(){var r=n.style.fill;n.topCircle.attr("fill",r)})},t.prototype.bindTrendEvents=function(){var n=this,e=this.name;this.handleGroup.on("".concat(e,"-handler:mouseenter"),function(){var r=n.style.highLightFill;n.verticalLine.attr("fill",r),n.topCircle.attr("fill",r),n.bottomCircle.attr("fill",r)}),this.handleGroup.on("".concat(e,"-handler:mouseleave"),function(){var r=n.style.fill;n.verticalLine.attr("fill",r),n.topCircle.attr("fill",r),n.bottomCircle.attr("fill",r)})},t.prototype.show=function(){this.handleGroup.show()},t.prototype.hide=function(){this.handleGroup.hide()},t.prototype.updateXY=function(){this.handleGroup.setMatrix([1,0,0,0,1,0,this.x,this.y,1])},t}();const __=Dht;var xn=globalThis&&globalThis.__assign||function(){return xn=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},xn.apply(this,arguments)},Pht=yi,Lht={fill:"#416180",opacity:.05},jht={fill:"#416180",opacity:.15,radius:5},Rht={fill:"#5B8FF9",opacity:.3,cursor:"grab"},Km=2,Fht={width:Km,height:24},Bht={textBaseline:"middle",fill:"#000",opacity:.45},zht={textAlign:"center",textBaseline:"top",fill:"#607889",opacity:.35},Ght={lineWidth:1,stroke:"#ccc"},Uht=function(){function t(n){var e=this;this.prevX=0,this.onMouseDown=function(tt){return function(ut){e.currentHandler=tt;var dt=ut.originalEvent;dt.stopPropagation(),dt.preventDefault(),e.prevX=Bo(dt,"touches.0.pageX",dt.pageX);var J=e.canvas.get("container");J.addEventListener("mousemove",e.onMouseMove),J.addEventListener("mouseup",e.onMouseUp),J.addEventListener("mouseleave",e.onMouseUp),J.addEventListener("touchmove",e.onMouseMove),J.addEventListener("touchend",e.onMouseUp),J.addEventListener("touchcancel",e.onMouseUp)}},this.onMouseMove=function(tt){tt.stopPropagation(),tt.preventDefault();var ut=Bo(tt,"touches.0.pageX",tt.pageX),dt=ut-e.prevX,J=e.adjustOffsetRange(dt/e.width);e.updateStartEnd(J),e.updateUI(),e.prevX=ut},this.onMouseUp=function(){e.currentHandler&&(e.currentHandler=void 0);var tt=e.canvas.get("container");tt&&(tt.removeEventListener("mousemove",e.onMouseMove),tt.removeEventListener("mouseup",e.onMouseUp),tt.removeEventListener("mouseleave",e.onMouseUp),tt.removeEventListener("touchmove",e.onMouseMove),tt.removeEventListener("touchend",e.onMouseUp),tt.removeEventListener("touchcancel",e.onMouseUp))};var r=n.x,i=r===void 0?0:r,o=n.y,a=o===void 0?0:o,s=n.width,u=s===void 0?100:s,c=n.height,l=n.padding,h=l===void 0?10:l,f=n.trendCfg,d=n.controllerCfg,p=d===void 0?{speed:1}:d,g=n.backgroundStyle,v=g===void 0?{}:g,m=n.foregroundStyle,y=m===void 0?{}:m,b=n.handlerStyle,x=b===void 0?{}:b,w=n.textStyle,E=w===void 0?{}:w,M=n.start,_=M===void 0?0:M,k=n.end,S=k===void 0?1:k,A=n.minText,C=A===void 0?"":A,I=n.maxText,N=I===void 0?"":I,D=n.group,P=n.graph,j=n.canvas,L=n.tick,R=L===void 0?{tickLabelStyle:{},tickLineStyle:{},tickLabelFormatter:function(tt){return tt},ticks:[]}:L,V=n.type;this.graph=P,this.canvas=j,this.group=D,this.timeBarType=V,this.x=i,this.y=a,this.width=u,this.height=c,this.padding=h,this.ticks=R.ticks,this.trendCfg=f,this.controllerCfg=p,this.currentSpeed=p.speed||1,this.tickLabelFormatter=R.tickLabelFormatter,V==="trend"?this.backgroundStyle=xn(xn({},Lht),v):V==="simple"&&(this.backgroundStyle=xn(xn({},jht),v)),this.foregroundStyle=xn(xn({},Rht),y),this.handlerStyle=xn(xn({},Fht),x),this.textStyle=xn(xn({},Bht),E),this.tickLabelStyle=xn(xn({},zht),R.tickLabelStyle),this.tickLineStyle=xn(xn({},Ght),R.tickLineStyle),this.currentMode=p.defaultTimeType||to.RANGE,this.start=_,this.end=S,this.minText=C,this.maxText=N,this.fontFamily=typeof window<"u"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif",this.renderSlider()}return t.prototype.update=function(n){var e=n.x,r=n.y,i=n.width,o=n.height,a=n.minText,s=n.maxText,u=n.start,c=n.end;this.start=Math.min(1,Math.max(u,0)),this.end=Math.min(1,Math.max(c,0)),ye(this,{x:e,y:r,width:i,height:o,minText:a,maxText:s}),this.updateUI()},t.prototype.setText=function(n,e){this.minTextShape.attr("text",n),this.maxTextShape.attr("text",e)},t.prototype.renderSlider=function(){var n=this,e=this,r=e.width,i=e.height,o=e.timeBarType;if(o==="trend"&&lp(Bo(this.trendCfg,"data"))){var a=new Tht(xn(xn({x:this.x,y:this.y,width:r,height:i},this.trendCfg),{group:this.group}));this.trendComponent=a}var s=this.group.addGroup({name:"slider-group"});s.addShape("rect",{attrs:xn({x:0,y:0,width:r,height:i},this.backgroundStyle),name:"background"});var u=this.group.addGroup();o==="trend"?(this.minTextShape=u.addShape("text",{attrs:xn({x:0,y:i/2+this.y,textAlign:"right",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=u.addShape("text",{attrs:xn({y:i/2+this.y,textAlign:"left",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})):(this.minTextShape=u.addShape("text",{attrs:xn({x:0,y:this.y-10,textAlign:"center",text:this.minText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"min-text-shape"}),this.maxTextShape=u.addShape("text",{attrs:xn({y:this.y-10,textAlign:"center",text:this.maxText,silent:!1,fontFamily:this.fontFamily||"Arial, sans-serif",stroke:"#fff",lineWidth:5},this.textStyle),capture:!1,name:"max-text-shape"})),this.foregroundShape=this.group.addGroup().addShape("rect",{attrs:xn({x:0,y:this.y,height:i},this.foregroundStyle),name:"foreground-shape"}),this.foregroundShape.on("mousedown",function(m){m.target.attr("cursor","grabbing")}),this.foregroundShape.on("mouseup",function(m){m.target.attr("cursor",n.foregroundStyle.cursor||"grab")});var c=Bo(this.handlerStyle,"width",2),l=Bo(this.handlerStyle,"height",24),h=this.group.addGroup({name:"minHandlerShape"});this.minHandlerShape=new __({name:"minHandlerShape",group:h,type:o,x:this.x,y:this.y,width:c,height:l,style:this.handlerStyle});var f=this.group.addGroup({name:"maxHandlerShape"});this.maxHandlerShape=new __({name:"maxHandlerShape",group:f,type:o,x:this.x,y:this.y,width:c,height:l,style:this.handlerStyle});var d=this.ticks,p=r/(d.length-1);this.tickPosList=[],this.textList&&this.textList.length&&this.textList.forEach(function(m){m.destroy()});var g=-1/0,v=this.tickLabelStyle.rotate;delete this.tickLabelStyle.rotate,this.textList=d.map(function(m,y){n.tickPosList.push(n.x+y*p);var b;n.tickLabelFormatter?(b=n.tickLabelFormatter(m),!Dt(b)&&b&&(b=m.date)):b=m.date;var x=n.x+y*p,w=n.y+i+5,E=n.group.addShape("text",{attrs:xn({x,y:w,text:b,fontFamily:n.fontFamily||"Arial, sans-serif"},n.tickLabelStyle),name:"tick-label"});if(pe(v)&&y!==d.length-1){var M=Pht([1,0,0,0,1,0,0,0,1],[["t",-x,-w],["r",v],["t",x-5,w+2]]);E.attr({textAlign:"left",matrix:M})}y===0?E.attr({textAlign:"left"}):y!==d.length-1&&E.attr({textAlign:"right"});var _=n.group.addShape("line",{attrs:xn({x1:n.x+y*p,y1:n.y+i+2,x2:n.x+y*p,y2:n.y+i+6},n.tickLineStyle),name:"tick-line"});_.toBack();var k=E.getBBox();return k.minX>g?(E.show(),_.show(),g=k.minX+k.width+10):(E.hide(),_.hide()),E}),this.controllerBtnGroup=new GN(xn({group:this.group,x:this.x,y:this.y+i+25,width:r,height:35},this.controllerCfg)),this.updateStartEnd(0),this.updateUI(),s.move(this.x,this.y),this.bindEvents(),this.currentMode===to.SINGLE&&(this.minHandlerShape.hide(),this.foregroundShape.hide(),this.minTextShape.hide())},t.prototype.bindEvents=function(){var n=this,e=this.group.find(function(i){return i.get("name")==="minHandlerShape"});e&&(e.on("minHandlerShape-handler:mousedown",this.onMouseDown(this.minHandlerShape)),e.on("minHandlerShape-handler:touchstart",this.onMouseDown(this.minHandlerShape)));var r=this.group.find(function(i){return i.get("name")==="maxHandlerShape"});r&&(r.on("maxHandlerShape-handler:mousedown",this.onMouseDown(this.maxHandlerShape)),r.on("maxHandlerShape-handler:touchstart",this.onMouseDown(this.maxHandlerShape))),this.foregroundShape.on("mousedown",this.onMouseDown(this.foregroundShape)),this.foregroundShape.on("touchstart",this.onMouseDown(this.foregroundShape)),this.group.on("".concat(Sa,":click"),function(){n.isPlay=!n.isPlay,n.currentHandler=n.maxHandlerShape,n.changePlayStatus()}),this.group.on("".concat(Pl,":click"),function(){n.currentHandler=n.maxHandlerShape,n.updateStartEnd(.01),n.updateUI()}),this.group.on("".concat(Ll,":click"),function(){n.currentHandler=n.maxHandlerShape,n.updateStartEnd(-.01),n.updateUI()}),this.group.on(xs,function(i){var o=i.type,a=i.speed;n.currentSpeed=a,n.currentMode=o,o===to.SINGLE?(n.minHandlerShape.hide(),n.foregroundShape.hide(),n.minTextShape.hide()):o===to.RANGE&&(n.minHandlerShape.show(),n.foregroundShape.show(),n.minTextShape.show())})},t.prototype.adjustTickIndex=function(n){for(var e=0;e<this.tickPosList.length-1;e++)if(this.tickPosList[e]<=n&&n<=this.tickPosList[e+1])return Math.abs(this.tickPosList[e]-n)<Math.abs(n-this.tickPosList[e+1])?e:e+1;return 0},t.prototype.adjustOffsetRange=function(n){switch(this.currentHandler){case this.minHandlerShape:{var e=0-this.start,r=1-this.start;return Math.min(r,Math.max(e,n))}case this.maxHandlerShape:{var e=0-this.end,r=1-this.end;return Math.min(r,Math.max(e,n))}case this.foregroundShape:{var e=0-this.start,r=1-this.end;return Math.min(r,Math.max(e,n))}default:return 0}},t.prototype.updateStartEnd=function(n){var e=this.ticks[this.adjustTickIndex(this.start*this.width)],r=this.ticks[this.adjustTickIndex(this.end*this.width)];if(!this.currentHandler){this.minText=this.tickLabelFormatter?this.tickLabelFormatter(e):e==null?void 0:e.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(r):r==null?void 0:r.date;return}switch(this.currentHandler){case this.minHandlerShape:this.maxText=this.maxTextShape.attr("text"),this.start+=n,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(e):e.date;break;case this.maxHandlerShape:this.minText=this.minTextShape.attr("text"),this.end+=n,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(r):r.date;break;case this.foregroundShape:this.start+=n,this.end+=n,this.minText=this.tickLabelFormatter?this.tickLabelFormatter(e):e.date,this.maxText=this.tickLabelFormatter?this.tickLabelFormatter(r):r.date;break}},t.prototype.updateUI=function(){var n=this;this.start<0&&(this.start=0),this.start>1&&(this.start=1),this.end>1&&(this.end=1),this.end<0&&(this.end=0);var e=this.x+this.start*this.width,r=this.x+this.end*this.width;this.foregroundShape.attr("x",e),this.foregroundShape.attr("width",r-e);var i=Bo(this.handlerStyle,"width",Km);this.setText(this.minText,this.maxText);var o=this.dodgeText([e,r]),a=o[0],s=o[1];this.minHandlerShape.setX(e-i/2),mt(a,function(u,c){return n.minTextShape.attr(c,u)}),this.maxHandlerShape.setX(r-i/2),mt(s,function(u,c){return n.maxTextShape.attr(c,u)}),this.currentMode===to.RANGE?this.graph.emit(no,{value:[this.start,this.end].sort()}):this.currentMode===to.SINGLE&&this.graph.emit(no,{value:[this.end,this.end]})},t.prototype.dodgeText=function(n){var e,r,i=2,o=Bo(this.handlerStyle,"width",Km),a=this.minTextShape,s=this.maxTextShape,u=n[0],c=n[1],l=!1;u>c&&(e=[c,u],u=e[0],c=e[1],r=[s,a],a=r[0],s=r[1],l=!0);var h=a.getBBox(),f=s.getBBox(),d=null,p=null;return this.timeBarType==="trend"?(d=u-h.width<this.x+i?{x:u+o/2+i,textAlign:"left"}:{x:u-o/2-i,textAlign:"right"},p=c+f.width>this.x+this.width?{x:c-o/2-i,textAlign:"right"}:{x:c+o/2+i,textAlign:"left"}):this.timeBarType==="simple"&&(d=a.attr("x")>h.width?{x:u,textAlign:"center"}:{x:u,textAlign:"left"},p=s.attr("x")>this.width-f.width?{x:c,textAlign:"right"}:{x:c,textAlign:"center"}),l?[p,d]:[d,p]},t.prototype.startPlay=function(){var n=this;return typeof window<"u"?window.requestAnimationFrame(function(){var e=n,r=e.ticks,i=e.width,o=n.currentSpeed,a=i/r.length,s=a/((10-o)*1e3/60),u=n.adjustOffsetRange(s/n.width);n.updateStartEnd(u),n.updateUI(),n.isPlay&&(n.playHandler=n.startPlay())}):void 0},t.prototype.changePlayStatus=function(n){n===void 0&&(n=!0),this.controllerBtnGroup.playButton.update({isPlay:this.isPlay}),this.isPlay?(this.playHandler=this.startPlay(),this.graph.emit(RN,null)):this.playHandler&&(typeof window<"u"&&window.cancelAnimationFrame(this.playHandler),n&&this.graph.emit(FN,null))},t.prototype.destory=function(){this.graph.off(no,function(){});var n=this.group,e=n.find(function(i){return i.get("name")==="minHandlerShape"});e&&(e.off("minHandlerShape-handler:mousedown"),e.off("minHandlerShape-handler:touchstart"),e.destroy());var r=n.find(function(i){return i.get("name")==="maxHandlerShape"});r&&(r.off("maxHandlerShape-handler:mousedown"),r.off("maxHandlerShape-handler:touchstart"),r.destroy()),this.foregroundShape.off("mousedown"),this.foregroundShape.off("touchstart"),this.foregroundShape.destroy(),n.off("".concat(Sa,":click")),n.off("".concat(Pl,":click")),n.off("".concat(Ll,":click")),n.off(xs),n.destroy(),this.trendComponent&&this.trendComponent.destory()},t}();const Yht=Uht;var Vht=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),zo=globalThis&&globalThis.__assign||function(){return zo=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},zo.apply(this,arguments)},Wht=globalThis&&globalThis.__rest||function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]]);return e},Xht=4,Hht=26;(function(t){Vht(n,t);function n(e){var r=t.call(this,e)||this;return r.afterrenderListener=function(i){return r.filterData({})},r.valueChangeListener=fl(function(i){return r.filterData(i)},200,{trailing:!0,leading:!0}),r.changeData=function(i){var o=r.get("graph");r.cacheGraphData=o.get("data"),r.filterData({})},r}return n.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-component-timebar",padding:10,type:"trend",trend:{data:[],isArea:!1,smooth:!0},controllerCfg:{speed:1,loop:!1},slider:{start:.1,end:.9,minText:"min",maxText:"max"},tick:{start:.1,end:.9,data:[]},textStyle:{},filterEdge:!1,filterItemTypes:["node"],containerCSS:{},putInGraphContainer:!0}},n.prototype.initContainer=function(){var e=this.get("graph"),r=this._cfgs,i=r.width,o=r.height,a=r.putInGraphContainer,s=this.get("className")||"g6-component-timebar",u=this.get("container"),c;if(u?(Dt(u)&&(u=document.getElementById(u)),c=u):(c=Mn("<div class='".concat(s,"'></div>")),Ve(c,{position:"relative"})),a){var l=this.get("graph").get("container");l.appendChild(c)}this.set("timeBarContainer",c);var h,f=e.get("renderer");f==="SVG"?h=new $c({container:c,width:i,height:o}):h=new Uo({container:c,width:i,height:o}),this.get("containerCSS")&&Ve(c,this.get("containerCSS")),this.set("canvas",h)},n.prototype.init=function(){this.initContainer();var e=this.get("canvas"),r=e.addGroup({name:"timebar-group"});this.set("timeBarGroup",r),this.renderTrend(),this.initEvent();var i=typeof window<"u"&&window.getComputedStyle(document.body,null).getPropertyValue("font-family")||"Arial, sans-serif";this.set("fontFamily",i)},n.prototype.play=function(){this.togglePlay(!0)},n.prototype.pause=function(){this.togglePlay(!1)},n.prototype.togglePlay=function(e){var r=this.get("timebar");r&&(r.isPlay=!!e,r.changePlayStatus())},n.prototype.renderTrend=function(){var e=this,r=this._cfgs,i=r.width,o=r.x,a=r.y,s=r.padding,u=r.type,c=r.trend,l=r.slider,h=r.controllerCfg,f=r.textStyle,d=r.tick,p=r.backgroundStyle,g=r.foregroundStyle,v=c.data,m=Wht(c,["data"]),y=i-2*s,b=u==="trend"?Hht:Xht,x=this.get("graph"),w=this.get("timeBarGroup"),E=this.get("canvas"),M=null;if(u==="trend"||u==="simple"){var _=this.get("getValue");M=new Yht(zo(zo({graph:x,canvas:E,group:w,type:u,x:o+s,y:u==="trend"?a+s:a+s+15,width:y,height:b,padding:s,backgroundStyle:p,foregroundStyle:g,trendCfg:zo(zo({},m),{data:v.map(function(S){return(_==null?void 0:_(S))||S.value})})},l),{tick:{ticks:v,tickLabelFormatter:d.tickLabelFormatter,tickLabelStyle:d.tickLabelStyle,tickLineStyle:d.tickLineStyle},handlerStyle:zo(zo({},l.handlerStyle),{height:l.height||b}),controllerCfg:h,textStyle:f}))}else u==="tick"&&(M=new Mlt(zo({graph:x,canvas:E,group:w,x:o+s,y:a+s,width:i,height:42,padding:2,controllerCfg:h},d)));var k=function S(){var A=e.get("timebar");A.draggingHandler=!1,A.isPlay&&(A.isPlay=!1,A.currentHandler=A.maxHandlerShape,A.changePlayStatus()),document.removeEventListener("mouseup",S)};E.on("mousedown",function(S){(S.target.get("name")==="maxHandlerShape-handler"||S.target.get("name")==="minHandlerShape-handler"||S.target===M.foregroundShape)&&document.addEventListener("mouseup",k)}),this.set("timebar",M)},n.prototype.filterData=function(e){var r,i=e.value;if(!i){i=[];var o=this._cfgs.type;!o||o==="trend"||o==="simple"?(i[0]=this._cfgs.slider.start,i[1]=this._cfgs.slider.end):o==="tick"&&(i[0]=this._cfgs.tick.start,i[1]=this._cfgs.tick.end)}var a=null,s=this._cfgs.type;if(s==="trend"||s==="simple"?a=this._cfgs.trend.data:s==="tick"&&(a=this._cfgs.tick.data),!a||a.length===0){console.warn("请配置 TimeBar 组件的数据");return}var u=this.get("rangeChange"),c=this.get("graph"),l=Math.round(a.length*i[0]),h=Math.round(a.length*i[1]);h=h>=a.length?a.length-1:h,l=l>=a.length?a.length-1:l;var f=(r=this._cfgs.tick)===null||r===void 0?void 0:r.tickLabelFormatter,d=f?f(a[l]):a[l].date,p=f?f(a[h]):a[h].date;if(s!=="tick"){var g=this.get("timebar");g.setText(d,p)}if(u)u(c,d,p);else{(!this.cacheGraphData||this.cacheGraphData.nodes&&this.cacheGraphData.nodes.length===0)&&(this.cacheGraphData=c.get("data"));var v=this.get("filterItemTypes"),m=this.get("changeData"),y=this.get("getDate"),b=this.get("shouldIgnore"),x=a[l].date,w=a[h].date;if(m||m===void 0){var E=this.cacheGraphData.nodes,M=this.cacheGraphData.edges,_={},k={};c.getNodes().forEach(function(S){return _[S.getID()]=!0}),c.getEdges().forEach(function(S){return k[S.getID()]=!0}),v.includes("node")&&(E==null||E.forEach(function(S){var A=+((y==null?void 0:y(S))||S.date),C=A>=x&&A<=w||(b==null?void 0:b("node",S,{min:x,max:w})),I=_[S.id];I&&!C?(c.removeItem(S.id),_[S.id]=!1):!I&&C&&(c.addItem("node",S),_[S.id]=!0)}),M==null||M.forEach(function(S){var A=_[S.source]&&_[S.target]||(b==null?void 0:b("edge",S,{min:x,max:w})),C=!!c.findById(S.id);C&&!A?(c.removeItem(S.id),k[S.id]=!1):!C&&A?(c.addItem("edge",S),k[S.id]=!0):C||(k[S.id]=!1)})),(this.get("filterEdge")||v.includes("edge"))&&(M==null||M.filter(function(S){var A=+((y==null?void 0:y(S))||S.date),C=A>=x&&A<=w||(b==null?void 0:b("edge",S,{min:x,max:w})),I=_[S.source]&&_[S.target],N=C&&I,D=k[S.id];D&&!N?(k[S.id]=!1,c.removeItem(S.id)):!D&&N&&(k[S.id]=!0,c.addItem("edge",S))}))}else v.includes("node")&&c.getNodes().forEach(function(S){var A=S.getModel();if(!(b!=null&&b("node",A,{min:x,max:w}))){var C=+((y==null?void 0:y(A))||A.date);C<x||C>w?c.hideItem(S):c.showItem(S)}}),(this.get("filterEdge")||v.includes("edge"))&&c.getEdges().forEach(function(S){var A=S.getModel();if(!(b!=null&&b("edge",A,{min:a[l].date,max:a[h].date}))){var C=+((y==null?void 0:y(A))||A.date);if(C<a[l].date||C>a[h].date)c.hideItem(S);else{var I=S.getSource().isVisible(),N=S.getTarget().isVisible();I&&N&&c.showItem(S)}}})}},n.prototype.initEvent=function(){var e=this.get("graph");e.on("afterchangedata",this.changeData),e.on("afterrender",this.afterrenderListener),e.on(no,this.valueChangeListener)},n.prototype.destroy=function(){var e=this.get("graph");e.off("afterchangedata",this.changeData),e.off("afterrender",this.afterrenderListener),e.off(no,this.valueChangeListener);var r=this.get("timebar");r&&r.destory&&r.destory(),t.prototype.destroy.call(this);var i=this.get("timeBarContainer");if(i){var o=this.get("container");o||(o=this.get("graph").get("container")),Dt(o)&&(o=document.getElementById(o)),o===i&&(o=o.parentElement),o.removeChild(i)}},n})(ni);var qht=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zht=Cr.applyMatrix;function Kht(t,n){var e,r;if(t.naturalWidth)e=t.naturalWidth,r=t.naturalHeight;else{var i=new Image;i.src=t.src,i.onload=function(){n&&n(i.width,i.height)}}return[e,r]}(function(t){qht(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{container:null,className:"g6-minimap",viewportClassName:"g6-minimap-viewport",width:200,delegateStyle:{fill:"#40a9ff",stroke:"#096dd9"},refresh:!0}},n.prototype.getEvents=function(){return{beforepaint:"updateViewport",beforeanimate:"disableRefresh",afteranimate:"enableRefresh",viewportchange:"disableOneRefresh"}},n.prototype.disableRefresh=function(){this.set("refresh",!1)},n.prototype.enableRefresh=function(){this.set("refresh",!0),this.updateCanvas()},n.prototype.disableOneRefresh=function(){this.set("viewportChange",!0)},n.prototype.initViewport=function(){var e=this,r=this._cfgs,i=r.graph;if(!this.destroyed){var o=this.get("container");Dt(o)&&(o=document.getElementById(o));var a=Mn("<div class=".concat(r.viewportClassName,`
      style='position:absolute;
        left:0;
        top:0;
        box-sizing:border-box;
        border: 2px solid #1980ff;
        cursor:move'
      </div>`)),s=0,u=0,c=!1,l=0,h=0,f=0,d=0,p=0,g=0;o.addEventListener("mousedown",function(v){if(r.refresh=!1,v.target===a){var m=a.style;f=parseInt(m.width,10),d=parseInt(m.height,10);var y=e.get("width"),b=e.get("height");f>y||d>b||(g=i.getZoom(),p=e.get("ratio"),c=!0,s=v.clientX,u=v.clientY)}},!1),o.addEventListener("mousemove",function(v){if(!(!c||fe(v.clientX)||fe(v.clientY))){var m=e.get("width"),y=e.get("height"),b=a.style;l=parseInt(b.left,10),h=parseInt(b.top,10),f=parseInt(b.width,10),d=parseInt(b.height,10);var x=s-v.clientX,w=u-v.clientY;l-x<0?x=l:l-x+f>=m&&(x=0),h-w<0?w=h:h-w+d>=y&&(w=0),l-=x,h-=w,Ve(a,{left:"".concat(l,"px"),top:"".concat(h,"px")}),i.translate(x*g/p,w*g/p),s=v.clientX,u=v.clientY}},!1),o.addEventListener("mouseleave",function(){c=!1,r.refresh=!0},!1),o.addEventListener("mouseup",function(){c=!1,r.refresh=!0},!1),this.set("viewport",a),o.appendChild(a)}},n.prototype.updateViewport=function(){if(!this.destroyed){var e=this.get("ratio"),r=this.get("width"),i=this.get("height"),o=this.get("graph"),a=o.get("width"),s=o.get("height"),u=a/s,c=o.getGroup(),l=c.getCanvasBBox(),h=[(l.minX+l.maxX)/2,(l.minY+l.maxY)/2],f=[l.maxX-l.minX,l.maxY-l.minY],d={centerX:h[0],centerY:h[1],width:0,height:0,minX:0,minY:0};l[0]/l[1]>u?(d.width=f[0],d.height=d.width/u):(d.height=f[1],d.width=d.height*u),d.minX=h[0]-d.width/2,d.minY=h[1]-d.height/2;var p=c.getMatrix();p||(p=[1,0,0,0,1,0,0,0,1]);var g=cy([1,0,0,0,1,0,0,0,1],p),v=Zht({x:d.minX,y:d.minY},g),m=o.getCanvasByPoint(v.x,v.y),y=this.get("viewport");y||this.initViewport();var b=a/d.width,x=b*r,w=b*i,E=r*-m.x/d.width,M=i*-m.y/d.height,_=E+x,k=M+w;E<0&&(x+=E,E=0),_>r&&(x=x-(_-r)),M<0&&(w+=M,M=0),k>i&&(w=w-(k-i)),this.set("ratio",e);var S="".concat(E,"px"),A="".concat(M,"px");Ve(y,{left:S,top:A,width:"".concat(x,"px"),height:"".concat(w,"px")})}},n.prototype.init=function(){this.initContainer()},n.prototype.initContainer=function(){var e=this,r=e.get("graph"),i=r.get("width"),o=r.get("height"),a=o/i,s=e.get("className"),u=e.get("container"),c=e.get("width"),l=e.get("height");!c&&!l&&(c=200),c?(l=a*c,e.set("height",l)):(c=1/a*l,e.set("width",c));var h=Mn("<div class='".concat(s,"' style='width: ").concat(c,"px; height: ").concat(l,"px; overflow: hidden; position: relative;'></div>"));Dt(u)&&(u=document.getElementById(u)),u?u.appendChild(h):r.get("container").appendChild(h),e.set("container",h);var f=Mn('<div class="g6-minimap-container" style="position: relative; width: 100%; height: 100%; text-align: center; display: table;"></div>');h.appendChild(f);var d=Mn('<span style="display: table-cell; vertical-align: middle; "></span>');f.appendChild(d),e.set("containerDOM",f),e.set("containerSpan",d);var p=Mn('<img alt="" src="'.concat(this.get("graphImg"),'" style="display: inline-block; user-select: none;" draggable="false" />'));e.set("imgDOM",p),e.updateImgSize(),d.appendChild(p),e.updateCanvas()},n.prototype.updateImgSize=function(){var e=this,r=e.get("imgDOM"),i=e.get("width"),o=e.get("height");r.onload=function(){var a=Kht(r);a[0]>a[1]?r.width=i:r.height=o}},n.prototype.updateCanvas=function(){var e=this.get("refresh");if(e){var r=this.get("graph");if(!r.get("destroyed")){this.get("viewportChange")&&(this.set("viewportChange",!1),this.updateViewport());var i=this.get("width"),o=r.get("canvas").getCanvasBBox(),a=o.width,s=i/a;this.set("ratio",s),this.updateViewport()}}},n.prototype.getViewport=function(){return this.get("viewport")},n.prototype.getContainer=function(){return this.get("container")},n.prototype.updateGraphImg=function(e){var r=this,i=r.get("imgDOM");i.remove(),r.set("graphImg",e);var o=Mn('<img alt="" src="'.concat(e,'" style="display: inline-block;" ondragstart="return false;" onselectstart="return false;"/>'));r.set("imgDOM",o),o.src=e,r.updateImgSize();var a=r.get("containerSpan");a.appendChild(o),r.updateCanvas()},n.prototype.destroy=function(){var e=this.get("container");e.parentNode.removeChild(e)},n})(ni);var Qht=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),Qm=globalThis&&globalThis.__assign||function(){return Qm=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Qm.apply(this,arguments)},Jht=Cr.distance,k_=.05,A_={stroke:"#000",strokeOpacity:.8,lineWidth:2,fillOpacity:1,fill:"#fff"};(function(t){Qht(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{type:"both",trigger:"mousemove",r:60,delegateStyle:Xe(A_),showLabel:"edge",scaleRBy:"wheel"}},n.prototype.getEvents=function(){var e;switch(this.get("trigger")){case"click":e={click:"filter"};break;case"drag":e={click:"createDelegate"};break;default:e={mousemove:"filter"};break}return e},n.prototype.init=function(){var e=this,r=e.get("showLabel"),i=r==="node"||r==="both",o=r==="edge"||r==="both";e.set("showNodeLabel",i),e.set("showEdgeLabel",o);var a=e.get("shouldShow");a||e.set("shouldShow",function(){return!0})},n.prototype.createDelegate=function(e){var r=this,i=r.get("delegate");(!i||i.destroyed)&&(r.filter(e),i=r.get("delegate"),i.on("dragstart",function(o){}),i.on("drag",function(o){r.filter(o)}),this.get("scaleRBy")==="wheel"&&i.on("mousewheel",function(o){r.scaleRByWheel(o)}))},n.prototype.scaleRByWheel=function(e){var r=this;if(!(!e||!e.originalEvent)){e.preventDefault&&e.preventDefault();var i=r.get("graph"),o,a=r.get("delegate"),s=a?{x:a.attr("x"),y:a.attr("y")}:void 0;s||i.getPointByClient(e.clientX,e.clientY),e.originalEvent.wheelDelta<0?o=1-k_:o=1/(1-k_);var u=r.get("maxR"),c=r.get("minR"),l=r.get("r");(l>(u||i.get("height"))&&o>1||l<(c||i.get("height")*.05)&&o<1)&&(o=1),l*=o,r.set("r",l),r.filter(e)}},n.prototype.filter=function(e){var r=this,i=r.get("graph"),o=i.getNodes(),a={},s=r.get("r"),u=r.get("type"),c={x:e.x,y:e.y};r.updateDelegate(c,s);var l=r.get("shouldShow"),h=r.get("vShapes");h&&h.forEach(function(m){m.remove(),m.destroy()}),h=[],o.forEach(function(m){var y=m.getModel(),b=y.x,x=y.y;Jht({x:b,y:x},c)<s&&(a[y.id]=m)});var f=i.getEdges(),d=[];f.forEach(function(m){var y=m.getModel(),b=y.source,x=y.target;l(y)&&(u==="only-source"||u==="one"?a[b]&&!a[x]&&d.push(m):u==="only-target"||u==="one"?a[x]&&!a[b]&&d.push(m):u==="both"&&a[b]&&a[x]&&d.push(m))});var p=r.get("showNodeLabel"),g=r.get("showEdgelabel"),v=i.get("group");d.forEach(function(m){var y=m.get("group").get("children");y.forEach(function(b){var x=b.get("type"),w=v.addShape(x,{attrs:b.attr()});h.push(w),p&&x==="text"&&w.set("visible",!0)})}),Object.keys(a).forEach(function(m){var y=a[m],b=y.get("group").clone();if(v.add(b),h.push(b),g)for(var x=b.get("children"),w=0;w<x.length;w++){var E=x[w];E.get("type")==="text"&&E.set("visible",!0)}}),r.set("vShapes",h)},n.prototype.updateParams=function(e){var r=this,i=e.r,o=e.trigger,a=e.minR,s=e.maxR,u=e.scaleRBy,c=e.showLabel,l=e.shouldShow;if(isNaN(e.r)||r.set("r",i),isNaN(s)||r.set("maxR",s),isNaN(a)||r.set("minR",a),(o==="mousemove"||o==="click")&&r.set("trigger",o),u==="wheel"||u==="unset"){r.set("scaleRBy",u),r.get("delegate").remove(),r.get("delegate").destroy();var h=r.get("dPercentText");h&&(h.remove(),h.destroy())}(c==="node"||c==="both")&&r.set("showNodeLabel",!0),(c==="edge"||c==="both")&&r.set("showEdgeLabel",!0),l&&r.set("shouldShow",l)},n.prototype.updateDelegate=function(e,r){var i=this,o=i.get("graph"),a=i.get("delegate");if(!a||a.destroyed){var s=o.get("group"),u=i.get("delegateStyle")||A_;a=s.addShape("circle",{attrs:Qm({r,x:e.x,y:e.y},u),name:"lens-shape",draggable:!0}),this.get("trigger")!=="drag"&&this.get("scaleRBy")==="wheel"&&a.on("mousewheel",function(c){i.scaleRByWheel(c)})}else a.attr({x:e.x,y:e.y,r});i.set("delegate",a)},n.prototype.clear=function(){var e=this,r=e.get("vShapes");r&&r.forEach(function(o){o.remove(),o.destroy()}),r=[],e.set("vShapes",r);var i=e.get("delegate");i&&!i.destroyed&&(i.remove(),i.destroy())},n.prototype.destroy=function(){this.clear()},n})(ni);var $ht=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),tft=Cr.pointLineDistance,eft={stroke:"#FA8C16",lineWidth:1};(function(t){$ht(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{line:eft,itemAlignType:"center",tolerance:5,horizontalLines:{},verticalLines:{},alignLines:[]}},n.prototype.init=function(){},n.prototype.getEvents=function(){return{"node:dragstart":"onDragStart","node:drag":"onDrag","node:dragend":"onDragEnd"}},n.prototype.onDragStart=function(){this.initBoxLine()},n.prototype.onDrag=function(e){var r=e.item,i=r.get("delegateShape")||r,o=i.getBBox(),a=r.getModel(),s=a.x-o.x,u=a.y-o.y;this.show({x:o.minX+s,y:o.minY+u},{width:o.width,height:o.height})},n.prototype.onDragEnd=function(){this.destory()},n.prototype.initBoxLine=function(){var e=this._cfgs,r=e.horizontalLines,i=e.verticalLines,o=e.itemAlignType,a=this.get("graph"),s=a.getNodes();s.forEach(function(u){var c=u.getBBox(),l=u.get("id");o===!0||o==="horizontal"?(r["".concat(l,"tltr")]=[c.minX,c.minY,c.maxX,c.minY,u],r["".concat(l,"lcrc")]=[c.minX,c.centerY,c.maxX,c.centerY,u],r["".concat(l,"blbr")]=[c.minX,c.maxY,c.maxX,c.maxY,u]):o==="center"&&(r["".concat(l,"lcrc")]=[c.minX,c.centerY,c.maxX,c.centerY,u]),o===!0||o==="vertical"?(i["".concat(l,"tlbl")]=[c.minX,c.minY,c.minX,c.maxY,u],i["".concat(l,"tcbc")]=[c.centerX,c.minY,c.centerX,c.maxY,u],i["".concat(l,"trbr")]=[c.maxX,c.minY,c.maxX,c.maxY,u]):o==="center"&&(i["".concat(l,"tcbc")]=[c.centerX,c.minY,c.centerX,c.maxY,u])})},n.prototype.show=function(e,r){var i=ye({},e);return this.itemAlign(e,r,i),e},n.prototype.itemAlign=function(e,r,i){var o=this,a=this._cfgs,s=a.horizontalLines,u=a.verticalLines,c=a.tolerance,l={x:i.x+r.width/2,y:i.y},h={x:i.x+r.width/2,y:i.y+r.height/2},f={x:i.x+r.width/2,y:i.y+r.height},d={x:i.x,y:i.y+r.height/2},p={x:i.x+r.width,y:i.y+r.height/2},g=[],v=[],m=null;if(this.clearAlignLine(),mt(s,function(b){b[4].isVisible&&(g.push(o.getLineDisObject(b,l)),g.push(o.getLineDisObject(b,h)),g.push(o.getLineDisObject(b,f)))}),mt(u,function(b){b[4].isVisible&&(v.push(o.getLineDisObject(b,d)),v.push(o.getLineDisObject(b,h)),v.push(o.getLineDisObject(b,p)))}),g.sort(function(b,x){return b.dis-x.dis}),v.sort(function(b,x){return b.dis-x.dis}),g.length!==0&&g[0].dis<c){e.y=g[0].line[1]-g[0].point.y+i.y,m={type:"item",horizontals:[g[0]]};for(var y=1;y<3;y++)g[0].dis===g[y].dis&&m.horizontals.push(g[y])}if(v.length!==0&&v[0].dis<c){e.x=v[0].line[0]-v[0].point.x+i.x,m?m.verticals=[v[0]]:m={type:"item",verticals:[v[0]]};for(var y=1;y<3;y++)v[0].dis===v[y].dis&&m.verticals.push(v[y])}m&&(m.bbox=r,this.addAlignLine(m))},n.prototype.addAlignLine=function(e){var r=e.bbox,i=e.type,o=e.horizontals,a=e.verticals,s=this._cfgs,u=s.line,c=s.alignLines,l=this.get("graph"),h=l.get("group");i==="item"&&(o&&mt(o,function(f){var d=f.line,p=f.point,g=(d[0]+d[2])/2,v,m;p.x<g?(v=p.x-r.width/2,m=Math.max(d[0],d[2])):(v=p.x+r.width/2,m=Math.min(d[0],d[2]));var y=ye({x1:v,y1:d[1],x2:m,y2:d[1]},u),b=h.addShape("line",{attrs:y,capture:!1});c.push(b)}),a&&mt(a,function(f){var d=f.line,p=f.point,g=(d[1]+d[3])/2,v,m;p.y<g?(v=p.y-r.height/2,m=Math.max(d[1],d[3])):(v=p.y+r.height/2,m=Math.min(d[1],d[3]));var y=ye({x1:d[0],y1:v,x2:d[0],y2:m},u),b=h.addShape("line",{attrs:y,capture:!1});c.push(b)}))},n.prototype.getLineDisObject=function(e,r){return{line:e,point:r,dis:tft(e,r)}},n.prototype.getContainer=function(){return this.get("container")},n.prototype.clearAlignLine=function(){var e=this._cfgs.alignLines;mt(e,function(r){r.remove()}),e.length=0},n.prototype.destory=function(){var e=this._cfgs,r=e.horizontalLines,i=e.verticalLines,o=this.get("graph"),a=o.getNodes();a.forEach(function(s){var u=s.get("id");delete r["".concat(u,"tltr")],delete r["".concat(u,"lcrc")],delete r["".concat(u,"blbr")],delete i["".concat(u,"tlbl")],delete i["".concat(u,"tcbc")],delete i["".concat(u,"trbr")]}),this.clearAlignLine()},n})(ni);var nft=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),In=globalThis&&globalThis.__assign||function(){return In=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},In.apply(this,arguments)},rft=["click","mouseenter"];(function(t){nft(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{data:{},position:"top",padding:8,margin:8,offsetX:0,offsetY:0,layout:"horizontal",flipPage:!1,containerStyle:{},align:void 0,horiSep:8,vertiSep:8,filter:{enable:!1,trigger:"click"}}},n.prototype.init=function(){this.formatArray("padding"),this.formatArray("margin");var e=this.get("filter")||{},r=e.multiple;r&&e.trigger==="mouseenter"&&this.set("multiple",!1);var i=this.get("align");if(!i){var o=this.get("position").split("-");o.includes("left")&&(i="left"),o.includes("right")?i="right":i="center",this.set("align",i)}var a=this.get("graph"),s=a.get("container"),u=Mn(`<div class='g6-legend-container' style="position: absolute;"></div>`);s.appendChild(u),this.set("container",u);var c=this.render();Ve(u,this.getContainerPos(c)),this.bindEvents()},n.prototype.getContainerPos=function(e){e===void 0&&(e=[0,0]);var r=this,i=r.get("graph"),o=this.get("offsetX"),a=this.get("offsetY"),s=this.get("margin"),u=this.get("position").split("-"),c={top:0,right:1,bottom:2,left:3},l=0,h=0,f={left:(i.getWidth()-e[0])/2+l,top:(i.getHeight()-e[1])/2+h};return u.forEach(function(d){var p=s[c[d]],g=d;switch(d){case"top":p+=h;break;case"left":p+=l;break;case"bottom":p=i.getHeight()-e[1]-p+h,g="top";break;default:p=i.getWidth()-e[0]-p+l,g="left";break}f[g]=p}),f.top+=a+i.getContainer().offsetTop,f.left+=o+i.getContainer().offsetLeft,Object.keys(f).forEach(function(d){f[d]="".concat(f[d],"px")}),f},n.prototype.bindEvents=function(){var e=this,r=e.get("filter");if(!(!r||!r.enable)){var i=r.trigger||"click";rft.includes(i)||(console.warn("Trigger for legend filterling must be 'click' or 'mouseenter', 'click' will take effect by default."),i="click");var o=e.get("legendCanvas");i==="mouseenter"?(o.on("node-container:mouseenter",function(a){return e.filterData(a)}),o.on("node-container:mouseleave",function(a){e.clearFilter(),e.clearActiveLegend()})):(o.on("node-container:click",function(a){return e.filterData(a)}),o.on("click",function(a){a.target&&a.target.isCanvas&&a.target.isCanvas()&&(e.clearFilter(),e.clearActiveLegend())}))}},n.prototype.changeData=function(e){this.set("data",e);var r=this.render();Ve(this.get("container"),this.getContainerPos(r))},n.prototype.activateLegend=function(e){var r=this.get("filter"),i=r==null?void 0:r.multiple;i||this.clearActiveLegend();var o=e.get("parent");o.get("active")?(o.set("active",!1),this.findLegendItemsByState("active").length&&o.set("inactive",!0)):(o.set("inactive",!1),o.set("active",!0)),this.findLegendItemsByState("active").length?this.findLegendItemsByState("active","all",!1).forEach(function(h){h.set("inactive",!0)}):this.clearActiveLegend();var a=(r==null?void 0:r.legendStateStyles)||{},s=(a==null?void 0:a.inactive)||{opacity:.5,"text-shape":{opacity:.5}},u=s["text-shape"]||{};this.findLegendItemsByState("inactive").forEach(function(h){var f=h.get("children"),d=f[0],p=f[1];d.attr(In(In({},d.get("oriAttrs")),s)),p.attr(In(In({},p.get("oriAttrs")),u))});var c=(a==null?void 0:a.active)||{stroke:"#000",lineWidth:2,"text-shape":{fontWeight:"bold"}},l=c["text-shape"]||{};this.findLegendItemsByState("active").forEach(function(h){var f=h.get("children"),d=f[0],p=f[1];d.attr(In(In({},d.get("oriAttrs")),c)),p.attr(In(In({},p.get("oriAttrs")),l))})},n.prototype.findLegendItemsByState=function(e,r,i){r===void 0&&(r="all"),i===void 0&&(i=!0);var o=this.get("legendCanvas").find(function(u){return u.get("name")==="root"}),a=o.find(function(u){return u.get("name")==="node-group"}),s=o.find(function(u){return u.get("name")==="edge-group"});return r==="node"?a.get("children").filter(function(u){return!!u.get(e)===i}):r==="edge"?s.get("children").filter(function(u){return!!u.get(e)===i}):a.get("children").filter(function(u){return!!u.get(e)===i}).concat(s.get("children").filter(function(u){return!!u.get(e)===i}))},n.prototype.clearActiveLegend=function(){var e=this.get("legendCanvas"),r=e.find(function(o){return o.get("name")==="root"}),i=[r.find(function(o){return o.get("name")==="node-group"}),r.find(function(o){return o.get("name")==="edge-group"})];i.forEach(function(o){o.get("children").forEach(function(a){a.set("active",!1),a.set("inactive",!1);var s=a.get("children"),u=s[0],c=s[1];u.attr(u.get("oriAttrs")),c.attr(c.get("oriAttrs"))})})},n.prototype.filterData=function(e){var r=this.get("filter"),i=r==null?void 0:r.filterFunctions;if(!(!r||!i)){var o=this.get("legendCanvas"),a=this.get("graph"),s=r.graphActiveState||"active",u=r.graphInactiveState||"inactive",c=r.multiple;this.clearFilter(),c||this.clearActiveLegend(),this.activateLegend(e.target);var l=o.find(function(m){return m.get("name")==="root"}),h=l.find(function(m){return m.get("name")==="node-group"}),f=l.find(function(m){return m.get("name")==="edge-group"}),d=h.get("children").filter(function(m){return m.get("active")}),p=f.get("children").filter(function(m){return m.get("active")}),g=0,v=["getNodes","getEdges"];v.forEach(function(m){a[m]().forEach(function(y){var b=!1,x=m==="getNodes"?d:p;x.forEach(function(w){var E=i[w.get("id")];b=b||E(y.getModel())}),b?(a.setItemState(y,u,!1),a.setItemState(y,s,!0),g++):(a.setItemState(y,s,!1),a.setItemState(y,u,!0))})}),g||v.forEach(function(m){a[m]().forEach(function(y){a.clearItemStates(y,[u])})})}},n.prototype.clearFilter=function(){var e=this.get("graph"),r=this.get("filter");if(r){var i=r.graphActiveState||"active",o=r.graphInactiveState||"inactive";e.getNodes().forEach(function(a){e.clearItemStates(a,[i,o])}),e.getEdges().forEach(function(a){e.clearItemStates(a,[i,o])})}},n.prototype.render=function(){var e=this;this.processData();var r=this.get("legendCanvas");r?r.clear():r=new Uo({container:this.get("container"),width:200,height:200});var i=r.addGroup({name:"root"}),o=i.addGroup({name:"node-group"}),a=i.addGroup({name:"edge-group"});this.set("legendCanvas",r);var s=this.get("itemsData"),u=["nodes","edges"],c=[o,a];u.forEach(function(P,j){s[P].forEach(function(L){var R,V=c[j].addGroup({id:L.id,name:"node-container"}),tt,ut=L.type,dt=e.getShapeSize(L),J=dt.width,Et=dt.height,Bt=dt.r,Vt=e.getStyle(P.substr(0,4),L);switch(L.type){case"circle":tt={r:Bt,x:0,y:0};break;case"rect":tt={width:J,height:Et,x:-J/2,y:-Et/2};break;case"ellipse":tt={rx:J,ry:Et,x:0,y:0},ut="ellipse";break;case"line":tt={x1:-J/2,y1:0,x2:J/2,y2:0},ut="line";break;case"quadratic":tt={path:[["M",-J/2,0],["Q",0,J/2,J/2,0]]},ut="path";break;case"cubic":tt={path:[["M",-J/2,0],["C",-J/6,J/2,J/6,-J/2,J/2,0]]},ut="path";break;case"diamond":tt={path:[["M",0,-Et],["L",J,0],["L",0,Et],["L",-J,0],["Z"]]},ut="path";break;case"triangle":tt={path:[["M",-J,Et],["L",0,-Et],["L",J,Et],["Z"]]},ut="path";break;case"star":tt={path:Cr.getStarPath(Bt*3,Bt*1.2)},ut="path";break;default:tt={r:Bt,x:0,y:0};break}var se=V.addShape(ut,{attrs:In(In({},tt),Vt),name:"".concat(L.type,"-node-keyShape"),oriAttrs:In({opacity:1},Vt)});if(L.label){var re=se.getBBox(),ue=((R=L.labelCfg)===null||R===void 0?void 0:R.style)||{},de=In({textAlign:"begin",fontSize:12,textBaseline:"middle",fill:"#000",opacity:1,fontWeight:"normal"},ue);V.addShape("text",{attrs:In({x:re.maxX+4,y:0,text:L.label},de),className:"legend-label",name:"".concat(L.type,"-node-text"),oriAttrs:de})}})});var l=this.get("padding"),h,f=i.find(function(P){return P.get("name")==="title-container"}),d={height:0,maxY:0,width:0};if(this.get("title")){f||(f=i.addGroup({name:"title-container"}));var p={fontSize:20,fontFamily:"Arial",fontWeight:300,textBaseline:"top",textAlign:"center",fill:"#000",x:0,y:l[0]},g=this.get("titleConfig")||{},v=Object.assign(p,g.style||{});h=f.addShape("text",{attrs:In({text:this.get("title")},v)}),d=f.getCanvasBBox(),f.setMatrix([1,0,0,0,1,0,g.offsetX,g.offsetY,1])}this.layoutItems();var m=i.getCanvasBBox(),y=o.getCanvasBBox(),b=y.minX<0?Math.abs(y.minX)+l[3]:l[3],x=d.maxY<y.minY?Math.abs(d.maxY-y.minY)+l[0]:d.maxY+l[0],w=[1,0,0,0,1,0,b,x,1];o.setMatrix(w),m=i.getCanvasBBox();var E=[m.minX+m.width+l[1],m.minY+m.height+l[2]];if(h){var g=In({position:"center",offsetX:0,offsetY:0},this.get("titleConfig"));d=f.getCanvasBBox();var M=f.getMatrix()||[1,0,0,0,1,0,0,0,1];g.position==="center"?M[6]=E[0]/2+g.offsetX:g.position==="right"?(M[6]=E[0]-l[3]+g.offsetX,h.attr({textAlign:"right"})):(M[6]=l[3]+g.offsetX,h.attr({textAlign:"left"})),f.setMatrix(M),d=f.getCanvasBBox(),b=y.minX<0?Math.abs(y.minX)+l[3]:l[3],x=y.minY<d.maxY?Math.abs(d.maxY-y.minY)+l[0]:d.maxY+l[0],w=[1,0,0,0,1,0,b,x,1],o.setMatrix(w);var _=[1,0,0,0,1,0,b,x,1];this.get("layout")==="vertical"?_[6]+=y.maxX+this.get("horiSep"):_[7]+=y.maxY+this.get("vertiSep"),a.setMatrix(_)}else{y=o.getCanvasBBox();var k=[1,0,0,0,1,0,0,0,1];this.get("layout")==="vertical"?k[6]+=w[6]+y.maxX+this.get("horiSep"):k[7]+=w[7]+y.maxY+this.get("vertiSep"),a.setMatrix(k)}m=i.getCanvasBBox(),y=o.getCanvasBBox(),w=o.getMatrix()||[1,0,0,0,1,0,0,0,1];var S=a.getMatrix()||[1,0,0,0,1,0,0,0,1],A=a.getCanvasBBox();E=[Math.max(y.width+w[6],A.width+S[6])+l[1],Math.max(y.height+w[7],A.height+S[7])+l[2]],r.changeSize(E[0],E[1]);var C=this.get("containerStyle"),I=i.getMatrix()||[1,0,0,0,1,0,0,0,1],N=Cr.invertMatrix({x:0,y:0},I),D=i.addShape("rect",{attrs:In({x:N.x+(C.lineWidth||1),y:N.y+(C.lineWidth||1),width:E[0]-2*(C.lineWidth||1),height:E[1]-2*(C.lineWidth||1),fill:"#f00",stroke:"#000",lineWidth:1,opacity:.5},C),name:"legend-back-rect",capture:!1});return D.toBack(),E},n.prototype.layoutItems=function(){var e=this.get("legendCanvas"),r=this.get("horiSep"),i=this.get("vertiSep"),o=this.get("layout"),a=this.get("align"),s=[0,0],u=e.find(function(b){return b.get("name")==="root"}),c=u.find(function(b){return b.get("name")==="node-group"}),l=u.find(function(b){return b.get("name")==="edge-group"}),h={min:0,max:-1/0};c.get("children").forEach(function(b,x){x===0&&(h.min=s[0]);var w=b.get("children")[0],E=b.getCanvasBBox(),M=w.getBBox(),_=M.width,k=M.height,S=0,A=0;o==="vertical"?(S=s[1],A=s[0]+_/2,s[0]=A+E.height+i,E.maxX+S+_/2):(S=s[0]+_/2,A=s[1],s[0]=S+E.width+r,E.maxY+A+k/2),s[0]>h.max&&(h.max=s[0]),b.setMatrix([1,0,0,0,1,0,S,A,1])});var f=h.max-h.min,d={min:0,max:-1/0},p=c.getCanvasBBox();s[0]=0,s[1]=o==="vertical"?p.maxX+r:p.maxY+i,l.get("children").forEach(function(b,x){x===0&&(d.min=s[0]);var w=b.get("children")[0],E=b.getCanvasBBox(),M=w.getBBox(),_=M.width,k=M.height,S=0,A=0;o==="vertical"?(S=s[1],A=s[0],s[0]=A+E.height+i,b.setMatrix([1,0,0,0,1,0,0,A+k/2,1])):(S=s[0],A=s[1],s[0]=S+E.width+r,b.setMatrix([1,0,0,0,1,0,S+_/2,0,1])),s[0]>d.max&&(d.max=s[0])});var g=d.max-d.min;if(a&&a!==""&&a!=="left"){var v=f-g,m=a==="center"?Math.abs(v)/2:Math.abs(v),y=v<0?c:l;y.get("children").forEach(function(b){var x=b.getMatrix()||[1,0,0,0,1,0,0,0,1];o==="vertical"?x[7]+=m:x[6]+=m,b.setMatrix(x)})}},n.prototype.processData=function(){var e=this.get("data"),r={nodes:[],edges:[]};e.nodes&&(e.nodes.sort(function(i,o){return i.order-o.order}),e.nodes.forEach(function(i){var o,a,s,u,c,l=i.size||[((o=i.style)===null||o===void 0?void 0:o.width)||((a=i.style)===null||a===void 0?void 0:a.r)||8,((s=i.style)===null||s===void 0?void 0:s.height)||((u=i.style)===null||u===void 0?void 0:u.r)||8],h=((c=i.labelCfg)===null||c===void 0?void 0:c.style)||{};r.nodes.push({id:i.id||vo(),type:i.type||"circle",style:In({},i.style),order:i.order,label:i.label,itemType:"node",size:l,labelCfg:{position:"right",style:In({fontFamily:"Arial"},h)}})})),e.edges&&(e.edges.sort(function(i,o){return i.order-o.order}),e.edges.forEach(function(i){var o,a,s=i.type||"line";i.type==="cubic-horizontal"&&(s="cubic");var u=((o=i.labelCfg)===null||o===void 0?void 0:o.style)||{},c=i.size||[((a=i.style)===null||a===void 0?void 0:a.width)||8,1];r.edges.push({id:i.id||vo(),type:s,size:c,style:In({lineWidth:ve(c)?c[1]:1},i.style),order:i.order,label:i.label,itemType:"edge",labelCfg:{position:"right",style:In({fontFamily:"Arial"},u)}})})),this.set("itemsData",r)},n.prototype.getContainer=function(){return this.get("container")},n.prototype.formatArray=function(e){var r=this.get(e);if(pe(r))this.set(e,[r,r,r,r]);else if(ve(r))switch(r.length){case 0:this.set(e,[0,0,0,0]);break;case 1:this.set(e,[r[0],r[0],r[0],r[0]]);break;case 2:this.set(e,[r[0],r[1],r[0],r[1]]);break;case 3:this.set(e,[r[0],r[1],r[2],r[1]]);break}return this.get(e)},n.prototype.getShapeSize=function(e){var r,i,o;return e.size&&(ve(e.size)?(r=e.size[0],i=e.size[1]||e.size[0],o=e.size[0]/2):pe(e.size)&&(r=e.size,i=e.size,o=e.size/2)),e.style&&(e.style.width&&(r=e.style.width),e.style.height&&(i=e.style.height),e.style.r&&(o=e.style.r)),o||(o=5),r||(r=o),i||(i=o),{width:r,height:i,r:o}},n.prototype.getStyle=function(e,r){var i=e==="node"?{fill:"#ccc",lineWidth:0}:{stroke:"#000",lineWidth:1};return In(In({},i),r.style||{})},n.prototype.destroy=function(){var e=this.get("legendCanvas");e==null||e.destroy();var r=this.get("graph"),i=r.get("container"),o=this.get("container");i.removeChild(o)},n})(ni);var ift=globalThis&&globalThis.__extends||function(){var t=function(n,e){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])},t(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");t(n,e);function r(){this.constructor=n}n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ci=globalThis&&globalThis.__assign||function(){return ci=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ci.apply(this,arguments)},C_=globalThis&&globalThis.__rest||function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(e[r[i]]=t[r[i]]);return e};typeof document<"u"&&rg(`
  .g6-annotation-container {
    background-color: rgba(255, 255, 255, 0.3);
    padding: 8px;
  }
  .g6-annotation-wrapper {
    background-color: #fff;
    box-shadow: 0 0 8px rgba(0, 0, 0, 0.85);
  }
  .g6-annotation-header-wapper {
    height: fit-content;
    width: 100%;
    background-color: #5B8FF9;
    display: inline-flex;
    cursor: move;
  }
  .g6-annotation-title {
    margin: 4px 40px 4px 8px;
    cursor: text;
    min-width: 32px;
  }
  .g6-annotation-collapse {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-expand {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-close {
    margin: 4px 8px 4px 0;
    cursor: pointer;
  }
  .g6-annotation-content {
    padding: 8px;
    width: fit-content;
    cursor: text;
    word-break: break-all;
    min-width: 32px;
  }
  .g6-annotation-title-input-wrapper {
    margin: 4px 40px 4px 8px;
  }
  .g6-annotation-content-input {
    height: 100%;
    word-break: break-all;
  }
  .g6-annotation-content-input-wrapper {
    margin: 8px;
    height: 100%;
  }
`);var I_="canvas-annotation";(function(t){ift(n,t);function n(e){return t.call(this,e)||this}return n.prototype.getDefaultCfgs=function(){return{trigger:"click",editable:!0,itemHighlightState:"highlight",linkHighlightStyle:{shadowColor:"#5B8FF9",shadowBlur:10},cardCfg:{minHeight:60,width:"fit-content",height:"fit-content",collapseType:"minimize",closeType:"hide",borderRadius:5,maxTitleLength:20}}},n.prototype.getEvents=function(){var e={viewportchange:"updateLinks",afterlayout:"updateLinks",aftergraphrefreshposition:"updateLinks",afterupdateitem:"updateLink",afterchangedata:"onGraphDataChange",afteritemvisibilitychange:"onGraphItemVisibilityChange"};switch(this.get("trigger")){case"click":e=ci(ci({},e),{"node:click":"showAnnotation","edge:click":"showAnnotation"})}return e},n.prototype.getDOMContent=function(e){if(!this.destroyed){var r=e.collapsed,i=e.maxWidth,o=e.title,a=o===void 0?"":o,s=e.content,u=s===void 0?"":s,c=e.borderRadius,l=c===void 0?5:c,h=r?"<p class='g6-annotation-expand'>+</p>":"<p class='g6-annotation-collapse'>-</p>",f=r?"":" <p class='g6-annotation-content'>".concat(u,"</p>"),d="<p class='g6-annotation-close'>x</p>",p=r?"".concat(l,"px"):"".concat(l,"px ").concat(l,"px 0 0");return'<div class="g6-annotation-wrapper" style="border-radius: '.concat(l,"px; max-width: ").concat(i,`px">
        <div
          class="g6-annotation-header-wapper"
          style="border-radius: `).concat(p,`;"
        >
          <h4 class='g6-annotation-title'>`).concat(a,`</h4>
          `).concat(h,`
          `).concat(d,`
        </div>
        `).concat(f,`
      </div>`)}},n.prototype.init=function(){var e=this;if(!e.destroyed){var r=e.get("graph"),i=r.getContainer(),o=e.get("container"),a=this.get("containerCfg");a?(o=this.createContainer(),i.appendChild(o)):o=i,this.set("container",o);var s=i.getBoundingClientRect(),u=new Uo({container:i,width:s.right-s.left,height:s.bottom-s.top});Ve(u.get("el"),{position:"absolute",top:0,left:0,pointerEvents:"none"}),window.addEventListener("resize",Fl(function(){return e.resizeCanvas(e)},100));var c=u.addGroup({id:"annotation-link-group"});e.set("linkGroup",c),e.set("canvas",u),e.get("getTitle")||e.set("getTitle",function(h){var f,d=((f=h==null?void 0:h.getModel)===null||f===void 0?void 0:f.call(h))||{},p=d.label,g=d.id;return p||g||"-"}),e.get("getContent")||e.set("getContent",function(h){var f,d;if(!h)return"-";var p=((f=h.getModel)===null||f===void 0?void 0:f.call(h))||{},g=p.label,v=p.id,m=(d=h.getType)===null||d===void 0?void 0:d.call(h),y=m?"".concat(m,": "):"";return"".concat(y).concat(g||v||"")});var l=e.get("defaultData");l&&this.readData(l)}},n.prototype.createContainer=function(){var e=this;if(!this.destroyed){var r=this.get("containerCfg"),i=this.get("graph"),o=i.getContainer(),a=o.getBoundingClientRect(),s=a.left,u=a.right,c=a.top,l=a.bottom,h=l-c,f=u-s,d=r.position,p=d===void 0?"top":d,g=r.offsetX,v=g===void 0?0:g,m=r.offsetY,y=m===void 0?0:m,b=C_(r,["position","offsetX","offsetY"]),x=r.height,w=x===void 0?"fit-content":x,E=r.width,M=E===void 0?i.getWidth():E;w==="100%"&&(w=h),M==="100%"&&(M=f);var _="unset",k="unset",S={};switch(p){case"right":_="".concat(h,"px"),S={top:0,right:0},S.right+=s+v,S.top+=c+y;break;case"bottom":k="".concat(f,"px"),S={bottom:0,left:0},S.left+=s+v,S.bottom+=c+y;break;case"top":k="".concat(f,"px");case"left":_="".concat(h,"px");default:S={top:0,left:0},S.left+=s+v,S.top+=c+y;break}Object.keys(S).forEach(function(C){S[C]="".concat(S[C],"px")});var A=Mn("<div class='".concat(r.className," g6-annotation-container'></div>"));return Ve(A,ci(ci({position:"absolute",display:p==="top"||p==="bottom"?"inline-flex":"unset",width:pe(M)?"".concat(M,"px"):M,height:pe(w)?"".concat(w,"px"):w,maxHeight:_,maxWidth:k,overflow:"scroll"},S),b)),o.appendChild(A),A.addEventListener("scroll",function(C){e.updateLinks()}),A}},n.prototype.resizeCanvas=function(e){clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){if(!(!e||e.destroyed)){var r=e.get("container").getBoundingClientRect(),i=r.right-r.left,o=r.bottom-r.top;e.get("canvas").changeSize(i,o),e.updateOutsideCards(e)}},250)},n.prototype.updateOutsideCards=function(e){var r=e||this,i=r.get("cardInfoMap")||{},o=r.get("graph"),a=o.getPointByCanvas(0,0),s=o.getPointByCanvas(o.getWidth(),o.getHeight()),u=o.getClientByPoint(a.x,a.y),c=u.x,l=u.y,h=o.getClientByPoint(s.x,s.y),f=h.x,d=h.y;Object.values(i).forEach(function(p){var g=p.card;if(g){var v=g.style,m=as(v.left),y=as(v.top),b=g.getBoundingClientRect(),x=b.width,w=b.height,E=m,M=y;m+x>f-c&&(E=f-c-x),m<0&&(E=0),y+w>d-l&&(M=d-l-w),y<0&&(M=0),Ve(g,{left:"".concat(E,"px"),top:"".concat(M,"px")})}}),r.updateLinks()},n.prototype.showAnnotation=function(e){if(!this.destroyed){var r=e.item;this.toggleAnnotation(r)}},n.prototype.hideCards=function(){var e=this;if(!e.destroyed){var r=e.get("cardInfoMap")||{};Object.keys(r).forEach(function(i){e.hideCard(i)})}},n.prototype.toggleAnnotation=function(e,r){var i,o;r===void 0&&(r={});var a=this;if(!a.destroyed){var s=a.get("cardInfoMap")||{},u=a.get("graph"),c=a.get("container"),l=a.get("containerCfg"),h=Object.assign({},a.get("cardCfg")||{},r),f=h.minHeight,d=h.minWidth,p=h.width,g=h.height,v=h.collapsed,m=v===void 0?!1:v,y=h.x,b=h.y,x=h.title,w=h.content,E=h.maxTitleLength,M=h.defaultBegin,_=C_(h,["minHeight","minWidth","width","height","collapsed","x","y","title","content","maxTitleLength","defaultBegin"]),k=a.get("linkGroup"),S=this.get("rows")||[[]],A=(i=e.isCanvas)===null||i===void 0?void 0:i.call(e),C=A?I_:e.getID(),I=s[C]||{},N=I.card,D=I.link,P=I.x,j=I.y,L=I.title,R=I.content,V=this.get("getTitle"),tt=this.get("getContent"),ut=this.get("getContentPlaceholder")||function(){return""},dt=this.get("getTitlePlaceHolder")||function(){return""},J=ut(e),Et=dt(e),Bt=Mn(this.getDOMContent(ci({itemId:C,collapsed:m,title:((o=L||x||(V==null?void 0:V(e)))===null||o===void 0?void 0:o.substr(0,E))||Et,content:R||w||(tt==null?void 0:tt(e))||J},_))),Vt=pe(f)?"".concat(f,"px"):f;Ve(Bt,{minHeight:m?"unset":Vt,minWidth:pe(d)?"".concat(d,"px"):d,height:g,width:p});var se=!!N;se?(D==null||D.remove(!0),c.replaceChild(Bt,N)):c.appendChild(Bt);var re;if(!l){if(re=c.getBoundingClientRect()||{},y!==void 0&&b!==void 0)P=y,j=b;else if(!se&&!A){var ue=re.top,de=M||{},Ze=de.left,Ne=de.right,Re=Ne===void 0?16:Ne,pn=de.top,en=pn===void 0?8:pn,fn=de.bottom,De=Re,Vn=en;isNaN(Ze)||(De=c.scrollWidth-Ze),isNaN(fn)||(Vn=c.scrollHeight-fn);var Wt=pe(d)?d:100;P=c.scrollWidth-Bt.scrollWidth-(S.length-1)*Wt-De;var ee=S[S.length-1],ot=(ee[ee.length-1]||{}).bbox;j=(ot==null?void 0:ot.bottom)-ue||Vn}Ve(Bt,{position:"absolute",left:"".concat(P,"px"),top:"".concat(j,"px"),cusor:l?"unset":"move"})}this.bindListener(Bt,C);var O=Bt.getBoundingClientRect();if(!A){var ct=bv(e,O,u,this.get("canvas")),Xt=this.get("linkStyle");D=k.addShape("path",{attrs:ci({lineWidth:1,lineDash:[5,5],stroke:"#ccc",path:ct},Xt)})}if(s[C]=ci(ci({},s[C]||{}),{id:C,collapsed:m,card:Bt,link:D,x:P,y:j,cardBBox:O,content:R||w,title:L||x,contentPlaceholder:J,titlePlaceholder:Et,isCanvas:A}),a.set("cardInfoMap",s),l)this.updateCardPositionsInConatainer(),this.updateLinks();else{var jt=!isNaN(y)&&!isNaN(b);if(!se&&!A&&!jt){var te=re.bottom,_t=te===void 0?0:te,ue=re.top;S[S.length-1].push({id:C,bbox:O}),O.top>_t-ue-O.height-16&&S.push([]),this.set("rows",S)}}this.updateCardSize(C);var Zt=this.get("onAnnotationChange");Zt==null||Zt(s[C],se?"update":"create")}},n.prototype.updateCardPositionsInConatainer=function(){if(!this.destroyed){var e=this.get("cardInfoMap");if(e){var r=this.get("container"),i=this.get("containerCfg").position,o=r.getBoundingClientRect().width,a=getComputedStyle(r),s=as(a.paddingLeft)+as(a.paddingRight);o-=s,Object.values(e).forEach(function(u){var c=u.card,l=c.getBoundingClientRect().width;switch(i){case"right":Ve(c,{marginLeft:o?"".concat(o-l,"px"):"0px"});break;case"top":case"bottom":Ve(c,{marginLeft:"8px"})}})}}},n.prototype.handleExpandCollapseCard=function(e){if(!this.destroyed){var r=this.get("graph"),i=this.get("cardInfoMap");if(i){var o=i[e].collapsed,a=r.findById(e);if(a){var s=this.get("cardCfg").collapseType;s==="hide"&&!o?this.hideCard(e):this.toggleAnnotation(a,{collapsed:!o}),i[e]=ci(ci({},i[e]),{collapsed:!o})}}}},n.prototype.hideCard=function(e){if(!this.destroyed){var r=this.get("cardInfoMap");if(!(!r||!r[e])){var i=r[e],o=i.card,a=i.link;Ve(o,{display:"none"}),a==null||a.hide();var s=this.get("onAnnotationChange");s(r[e],"hide")}}},n.prototype.removeCard=function(e){if(!this.destroyed){var r=this.get("cardInfoMap");if(r){var i=r[e],o=i.card,a=i.link,s=this.get("container");s.removeChild(o),a==null||a.remove(!0),delete r[e];var u=this.get("onAnnotationChange");u(i,"remove")}}},n.prototype.bindListener=function(e,r){var i=this;if(!this.destroyed){e.addEventListener("mousemove",function(u){var c;if(u.target.className==="g6-annotation-collapse"?c="collapse":u.target.className==="g6-annotation-expand"?c="expand":u.target.className==="g6-annotation-close"&&(c="close"),c){var l=i.get("cardCfg").onMouseEnterIcon,h=l===void 0?function(){}:l;h(u,r,c)}}),e.addEventListener("mouseout",function(u){var c;if(u.target.className==="g6-annotation-collapse"?c="collapse":u.target.className==="g6-annotation-expand"?c="expand":u.target.className==="g6-annotation-close"&&(c="close"),c){var l=i.get("cardCfg").onMouseLeaveIcon,h=l===void 0?function(){}:l;h(u,r,c)}}),e.addEventListener("mouseenter",function(u){var c=i.get("cardInfoMap");if(c){var l=i.get("graph"),h=l.findById(r);if(h){var f=i.get("itemHighlightState");l.setItemState(h,f,!0)}var d=c[r].link;if(d){var p=i.get("linkHighlightStyle")||{};d.attr(p)}}}),e.addEventListener("mouseleave",function(u){var c=i.get("cardInfoMap");if(c){var l=i.get("graph"),h=l.findById(r);if(h){var f=i.get("itemHighlightState");l.setItemState(h,f,!1)}var d=c[r].link;if(d){var p=i.get("linkHighlightStyle")||{};Object.keys(p).forEach(function(v){d.attr(v,void 0),d.attr(v,void 0)});var g=i.get("linkStyle");d.attr(g)}}}),e.addEventListener("click",function(u){var c=(i.get("cardCfg")||{}).onClickIcon;if(u.target.className==="g6-annotation-collapse"||u.target.className==="g6-annotation-expand"){var l=i.get("cardCfg").collapseType;l==="hide"?i.hideCard(r):i.handleExpandCollapseCard(r),c==null||c(u,r,u.target.className==="g6-annotation-collapse"?"collapse":"expand")}else if(u.target.className==="g6-annotation-close"){var h=i.get("cardCfg").closeType;h==="remove"?i.removeCard(r):i.hideCard(r),c==null||c(u,r,"close")}});var o=this.get("editable");o&&e.addEventListener("dblclick",function(u){var c=i.get("cardInfoMap"),l=(i.get("cardCfg")||{}).maxTitleLength,h=l===void 0?20:l;if(c){var f=u.target,d=f.className;if(!(d!=="g6-annotation-title"&&d!=="g6-annotation-content")){var p=d==="g6-annotation-title"?f.getBoundingClientRect():f.parentNode.getBoundingClientRect(),g=p.width,v=p.height,m=getComputedStyle(f),y=d==="g6-annotation-title"?"input":"textarea",b=Mn("<".concat(y,' class="').concat(d,'-input" type="textarea" style="width:').concat(g,"px; height: ").concat(v,'px; min-width: 16px;"/>')),x=Mn('<div class="'.concat(d,'-input-wrapper" style="width: ').concat(g,"px; height: ").concat(v,"px; min-width: 16px; margin-right: ").concat(m.marginRight,'" />'));x.appendChild(b),f.parentNode.replaceChild(x,f);var w=c[r],E=w.contentPlaceholder,M=w.titlePlaceholder,_=w.content,k=w.title,S=_;d==="g6-annotation-title"?(b.name="title",b.maxLength=h,S=k):b.name="content",S?(b.innerHTML=f.innerHTML,b.value=f.innerHTML):b.placeholder=d==="g6-annotation-title"?M:E,b.focus(),b.addEventListener("blur",function(A){b.value&&(f.innerHTML=b.value,w[b.name||"title"]=b.value),x.parentNode.replaceChild(f,x),i.updateCardSize(r);var C=i.get("onAnnotationChange");C==null||C(w,"update")})}}});var a=["g6-annotation-title","g6-annotation-content","g6-annotation-title-input","g6-annotation-content-input"];e.draggable=!0,e.addEventListener("dragstart",function(u){var c=u.target.className;if(!a.includes(c)){var l=e.style;i.set("dragging",{card:e,x:u.clientX,y:u.clientY,left:as(l.left),top:as(l.top)})}}),e.addEventListener("drag",function(u){u.preventDefault();var c=i.get("cardInfoMap");if(c){var l=u.clientX,h=u.clientY,f=i.get("dragging");if(!(isNaN(l)||isNaN(h)||!f)){var d=f.x,p=f.y,g=f.left,v=f.top,m=f.card,y=l-d,b=h-p;g+=y,v+=b;var x=i.get("graph"),w=x.getPointByCanvas(0,0),E=x.getPointByCanvas(x.getWidth(),x.getHeight()),M=x.getClientByPoint(w.x,w.y),_=M.x,k=M.y,S=x.getClientByPoint(E.x,E.y),A=S.x,C=S.y,I=m.getBoundingClientRect(),N=I.right-I.left,D=I.bottom-I.top;(g>A-_-N&&y>0||g<0&&y<0)&&(g-=y),(v>C-k-D&&b>0||v<0&&b<0)&&(v-=b),Ve(m,{left:"".concat(g,"px"),top:"".concat(v,"px"),visibility:"hidden"}),d=l,p=h;var P=(c[r]||{}).link;if(P){var j=x.findById(r);P.attr("path",bv(j,I,x,i.get("canvas")))}i.set("dragging",{x:d,y:p,left:g,top:v,card:m})}}});var s=function(u){var c=i.get("cardInfoMap");if(c){var l=i.get("dragging");if(l){var h=l.left,f=l.top,d=l.card;c[r].x=h,c[r].y=f,Ve(d,{visibility:"visible"}),i.set("dragging",!1);var p=i.get("rows");p==null||p.forEach(function(v){for(var m=v.length-1;m>=0;m--)v[m].id===r&&v.splice(m,1)});var g=i.get("onAnnotationChange");g==null||g(c[r],"update")}}};e.addEventListener("dragend",s)}},n.prototype.updateCardSize=function(e){var r=this.get("cardInfoMap");if(r){var i=r[e].card,o=i.getBoundingClientRect().width,a=i.getElementsByClassName("g6-annotation-title")[0];if(a){var s=getComputedStyle(a),u=as(s.marginLeft),c=a.getBoundingClientRect().width;Ve(a,{marginRight:"".concat(o-u-24-16-c,"px")})}}},n.prototype.updateLink=function(e){var r=e.item;if(r){var i=this.get("cardInfoMap");if(i){var o=this.get("canvas"),a=this.get("graph"),s=r.getID(),u=i[s]||{},c=u.link,l=u.card;if(c){var h=bv(r,l.getBoundingClientRect(),a,o);c.attr("path",h)}}}},n.prototype.updateLinks=function(){var e=this;if(!this.destroyed){var r=this.get("cardInfoMap");if(r){var i=this.get("graph");Object.values(r).forEach(function(o){var a=o.id,s=i.findById(a);e.updateLink({item:s})})}}},n.prototype.onGraphDataChange=function(){var e=this,r=this.get("cardInfoMap");if(r){var i=this.get("graph");Object.values(r).forEach(function(o){var a=o.id,s=o.card,u=o.isCanvas;if(!(!s||u||s.style.display==="none")){var c=i.findById(a);c&&c.isVisible()?e.toggleAnnotation(c):e.hideCard(a)}})}},n.prototype.onGraphItemVisibilityChange=function(e){var r=e.item,i=e.visible;if(!(!r||r.destroyed)){var o=this.get("cardInfoMap");if(o){var a=r.getID();o[a]&&(i||this.hideCard(a))}}},n.prototype.saveData=function(e){e===void 0&&(e=!1);var r=this.get("cardInfoMap");if(r){var i=this.get("graph"),o=this.get("getTitle"),a=this.get("getContent"),s=[];return Object.values(r).forEach(function(u){var c=u.title,l=u.content,h=u.x,f=u.y,d=u.id,p=u.collapsed,g=u.card;if(!(g&&g.style.display==="none"&&!e)){var v=i.findById(d)||i.get("canvas");s.push({id:d,x:h,y:f,collapsed:p,title:c||(o==null?void 0:o(v)),content:l||(a==null?void 0:a(v)),visible:g&&g.style.display!=="none"})}}),s}},n.prototype.readData=function(e){var r=this,i=this.get("graph");e.forEach(function(o){var a=o.id,s=o.x,u=o.y,c=o.title,l=o.content,h=o.collapsed,f=o.visible,d=i.findById(a);if(!d&&a===I_&&(d=i.get("canvas")),!d){var p=r.get("cardInfoMap")||{};p[a]=o,r.set("cardInfoMap",p);return}r.toggleAnnotation(d,{x:s,y:u,title:c,content:l,collapsed:h}),f||r.hideCard(a)})},n.prototype.clear=function(){var e=this.get("cardInfoMap");if(e){var r=this.get("container");Object.values(e).forEach(function(i){var o=i.card,a=i.link;r.removeChild(o),a==null||a.remove(!0)}),this.set("cardInfoMap",{})}},n.prototype.destroy=function(){var e;this.clear(),(e=this.get("canvas"))===null||e===void 0||e.destroy();var r=this.get("graph");!r||r.destroyed||(this.get("containerCfg")&&r.getContainer().removeChild(this.get("container")),this.destroyed=!0)},n})(ni);var oft=function(t,n){var e,r,i=1/0;Object.keys(t).forEach(function(s){var u=t[s];Object.keys(n).forEach(function(c){var l=n[c],h=u.x-l.x,f=u.y-l.y,d=h*h+f*f;i>d&&(i=d,e=u,r=l)})});var o=20,a=Cr.getControlPoint(e,r,.5,o);return[["M",e.x,e.y],["Q",a.x,a.y,r.x,r.y]]},bv=function(t,n,e,r){var i,o,a=t.getType();if(a==="edge")o=[t.getKeyShape().getPoint(.5)];else{var s=(i=t.getKeyShape)===null||i===void 0?void 0:i.call(t).getBBox(),u=s.minX,c=s.minY,l=s.maxX,h=s.maxY,f=t.getModel(),d=f.x,p=f.y;u+=d,c+=p,l+=d,h+=p,o={left:{x:u,y:(c+h)/2},right:{x:l,y:(c+h)/2},top:{x:(u+l)/2,y:c},bottom:{x:(u+l)/2,y:h}}}Object.keys(o).forEach(function(_){var k=o[_],S=k.x,A=k.y,C=e.getClientByPoint(S,A);o[_]=r.getPointByClient(C.x,C.y)});var g=n.top,v=g===void 0?0:g,m=n.left,y=m===void 0?0:m,b=n.right,x=b===void 0?0:b,w=n.bottom,E=w===void 0?0:w,M={left:r.getPointByClient(y,(v+E)/2),right:r.getPointByClient(x,(v+E)/2),top:r.getPointByClient((y+x)/2,v),bottom:r.getPointByClient((y+x)/2,E)};return oft(o,M)},as=function(t){return Number(t.replace(/\s+|px/gi,""))||0};ja("circle",{options:{size:Jt.defaultNode.size,style:{x:0,y:0,stroke:Jt.defaultNode.style.stroke,fill:Jt.defaultNode.style.fill,lineWidth:Jt.defaultNode.style.lineWidth},labelCfg:{style:{fill:Jt.nodeLabel.style.fill,fontSize:Jt.nodeLabel.style.fontSize,fontFamily:Jt.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Jt.defaultNode.linkPoints.size,lineWidth:Jt.defaultNode.linkPoints.lineWidth,fill:Jt.defaultNode.linkPoints.fill,stroke:Jt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:B({},Jt.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).icon,r=e===void 0?{}:e,i=this.getShapeStyle(t),o=mn({},r,t.icon),a="".concat(this.type,"-keyShape"),s=n.addShape("circle",{attrs:i,className:a,name:a,draggable:!0});n.shapeMap[a]=s;var u=o.width,c=o.height,l=o.show,h=o.text;if(l){var f="".concat(this.type,"-icon");h?n.shapeMap[f]=n.addShape("text",{attrs:B({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},o),className:f,name:f,draggable:!0}):n.shapeMap[f]=n.addShape("image",{attrs:B({x:-u/2,y:-c/2},o),className:f,name:f,draggable:!0})}return this.drawLinkPoints(t,n),s},drawLinkPoints:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).linkPoints;if(e){var r=e||{},i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=or(r,["top","left","right","bottom","size","r"]),h=this.getSize(t),f=h[0]/2;if(o){var d="link-point-left";n.shapeMap[d]=n.addShape("circle",{attrs:B(B({},l),{x:-f,y:0,r:u/2||c||5}),className:d,name:d,isAnchorPoint:!0})}if(a){var p="link-point-right";n.shapeMap[p]=n.addShape("circle",{attrs:B(B({},l),{x:f,y:0,r:u/2||c||5}),className:p,name:p,isAnchorPoint:!0})}if(i){var g="link-point-top";n.shapeMap[g]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:-f,r:u/2||c||5}),className:g,name:g,isAnchorPoint:!0})}if(s){var v="link-point-bottom";n.shapeMap[v]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:f,r:u/2||c||5}),className:v,name:v,isAnchorPoint:!0})}}},getShapeStyle:function(t){var n=(this.mergeStyle||this.getOptions(t)).style,e={stroke:t.color},r=mn({},n,e),i=this.getSize(t),o=i[0]/2,a=B({x:0,y:0,r:o},r);return a},update:function(t,n,e){var r=n.getContainer(),i=this.getSize(t),o=B({},t.style);t.style.stroke===void 0&&t.color&&(o.stroke=t.color),t.style.r===void 0&&!isNaN(i[0])&&(o.r=i[0]/2),this.updateShape(t,n,o,!0,e),this.updateLinkPoints(t,r)}},"single-node");ja("rect",{options:{size:[100,30],style:{radius:0,stroke:Jt.defaultNode.style.stroke,fill:Jt.defaultNode.style.fill,lineWidth:Jt.defaultNode.style.lineWidth},labelCfg:{style:{fill:Jt.nodeLabel.style.fill,fontSize:Jt.nodeLabel.style.fontSize,fontFamily:Jt.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Jt.defaultNode.linkPoints.size,lineWidth:Jt.defaultNode.linkPoints.lineWidth,fill:Jt.defaultNode.linkPoints.fill,stroke:Jt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},anchorPoints:[[0,.5],[1,.5]],stateStyles:B({},Jt.nodeStateStyles)},shapeType:"rect",labelPosition:"center",drawShape:function(t,n){var e=this.getShapeStyle(t),r=n.addShape("rect",{attrs:e,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});return n.shapeMap["".concat(this.type,"-keyShape")]=r,this.drawLinkPoints(t,n),r},drawLinkPoints:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).linkPoints,r=e===void 0?{}:e,i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=or(r,["top","left","right","bottom","size","r"]),h=this.getSize(t),f=h[0],d=h[1];o&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:B(B({},l),{x:-f/2,y:0,r:u/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),a&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:B(B({},l),{x:f/2,y:0,r:u/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),i&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:-d/2,r:u/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),s&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:d/2,r:u/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(t){var n=(this.mergeStyle||this.getOptions(t)).style,e={stroke:t.color},r=ye({},n,e),i=this.getSize(t),o=r.width||i[0],a=r.height||i[1],s=B({x:-o/2,y:-a/2,width:o,height:a},r);return s},update:function(t,n,e){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getSize(t),a=n.get("keyShape");t.size||(o[0]=a.attr("width")||i.width,o[1]=a.attr("height")||i.height);var s={stroke:t.color,x:-o[0]/2,y:-o[1]/2,width:o[0],height:o[1]},u=ye({},i,a.attr(),s);u=ye(u,t.style),this.updateShape(t,n,u,!1,e),this.updateLinkPoints(t,r)}},"single-node");ja("ellipse",{options:{size:[80,40],style:{x:0,y:0,stroke:Jt.defaultNode.style.stroke,fill:Jt.defaultNode.style.fill,lineWidth:Jt.defaultNode.style.lineWidth},labelCfg:{style:{fill:Jt.nodeLabel.style.fill,fontSize:Jt.nodeLabel.style.fontSize,fontFamily:Jt.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Jt.defaultNode.linkPoints.size,lineWidth:Jt.defaultNode.linkPoints.lineWidth,fill:Jt.defaultNode.linkPoints.fill,stroke:Jt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:B({},Jt.nodeStateStyles)},shapeType:"ellipse",labelPosition:"center",drawShape:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).icon,r=e===void 0?{}:e,i=this.getShapeStyle(t),o=n.addShape("ellipse",{attrs:i,className:"ellipse-keyShape",name:"ellipse-keyShape",draggable:!0});n.shapeMap["ellipse-keyShape"]=o;var a=r.width,s=r.height,u=r.show,c=r.text;return u&&(c?n.shapeMap["".concat(this.type,"-icon")]=n.addShape("text",{attrs:B({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):n.shapeMap["".concat(this.type,"-icon")]=n.addShape("image",{attrs:B({x:-a/2,y:-s/2},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(t,n),o},drawLinkPoints:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).linkPoints,r=e===void 0?{}:e,i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=or(r,["top","left","right","bottom","size","r"]),h=this.getSize(t),f=h[0]/2,d=h[1]/2;o&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:B(B({},l),{x:-f,y:0,r:u/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),a&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:B(B({},l),{x:f,y:0,r:u/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),i&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:-d,r:u/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),s&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:d,r:u/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getShapeStyle:function(t){var n=(this.mergeStyle||this.getOptions(t)).style,e={stroke:t.color},r=ye({},n,e),i=this.getSize(t),o=i[0]/2,a=i[1]/2,s=B({x:0,y:0,rx:o,ry:a},r);return s},update:function(t,n,e){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getSize(t),a={stroke:t.color,rx:o[0]/2,ry:o[1]/2},s=n.get("keyShape"),u=ye({},i,s.attr(),a);u=ye(u,t.style),this.updateShape(t,n,u,!0,e),this.updateLinkPoints(t,r)}},"single-node");ja("diamond",{options:{size:[80,80],style:{stroke:Jt.defaultNode.style.stroke,fill:Jt.defaultNode.style.fill,lineWidth:Jt.defaultNode.style.lineWidth},labelCfg:{style:{fill:Jt.nodeLabel.style.fill,fontSize:Jt.nodeLabel.style.fontSize,fontFamily:Jt.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Jt.defaultNode.linkPoints.size,lineWidth:Jt.defaultNode.linkPoints.lineWidth,fill:Jt.defaultNode.linkPoints.fill,stroke:Jt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:B({},Jt.nodeStateStyles)},shapeType:"diamond",labelPosition:"center",drawShape:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).icon,r=e===void 0?{}:e,i=this.getShapeStyle(t),o=n.addShape("path",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});n.shapeMap["".concat(this.type,"-keyShape")]=o;var a=r.width,s=r.height,u=r.show,c=r.text;return u&&(c?n.shapeMap["".concat(this.type,"-icon")]=n.addShape("text",{attrs:B({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):n.shapeMap["".concat(this.type,"-icon")]=n.addShape("image",{attrs:B({x:-a/2,y:-s/2},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(t,n),o},drawLinkPoints:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).linkPoints,r=e===void 0?{}:e,i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=or(r,["top","left","right","bottom","size","r"]),h=this.getSize(t),f=h[0],d=h[1];o&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:B(B({},l),{x:-f/2,y:0,r:u/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),a&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:B(B({},l),{x:f/2,y:0,r:u/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),i&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:-d/2,r:u/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),s&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:d/2,r:u/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},getPath:function(t){var n=this.getSize(t),e=n[0],r=n[1],i=[["M",0,-r/2],["L",e/2,0],["L",0,r/2],["L",-e/2,0],["Z"]];return i},getShapeStyle:function(t){var n=(this.mergeStyle||this.getOptions(t)).style,e={stroke:t.color},r=ye({},n,e),i=this.getPath(t),o=B({path:i},r);return o},update:function(t,n,e){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getPath(t),a={stroke:t.color,path:o},s=n.get("keyShape"),u=ye({},i,s.attr(),a);u=ye(u,t.style),this.updateShape(t,n,u,!0,e),this.updateLinkPoints(t,r)}},"single-node");ja("triangle",{options:{size:40,direction:"up",style:{stroke:Jt.defaultNode.style.stroke,fill:Jt.defaultNode.style.fill,lineWidth:Jt.defaultNode.style.lineWidth},labelCfg:{style:{fill:Jt.nodeLabel.style.fill,fontSize:Jt.nodeLabel.style.fontSize},offset:15},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Jt.defaultNode.linkPoints.size,lineWidth:Jt.defaultNode.linkPoints.lineWidth,fill:Jt.defaultNode.linkPoints.fill,stroke:Jt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20,offset:6},stateStyles:B({},Jt.nodeStateStyles)},shapeType:"triangle",labelPosition:"bottom",drawShape:function(t,n){var e=this.mergeStyle||this.getOptions(t),r=e.icon,i=r===void 0?{}:r,o=e.direction,a=this.getShapeStyle(t),s=t.direction||o,u=n.addShape("path",{attrs:a,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});n.shapeMap["".concat(this.type,"-keyShape")]=u;var c=i.width,l=i.height,h=i.show,f=i.offset,d=i.text;if(h)if(d)n.shapeMap["".concat(this.type,"-icon")]=n.addShape("text",{attrs:B({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0});else{var p=-c/2,g=-l/2;(s==="up"||s==="down")&&(g+=f),(s==="left"||s==="right")&&(p+=f),n.shapeMap["".concat(this.type,"-icon")]=n.addShape("image",{attrs:B({x:p,y:g},i),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})}return this.drawLinkPoints(t,n),u},drawLinkPoints:function(t,n){var e=this.mergeStyle||this.getOptions(t),r=e.linkPoints,i=r===void 0?{}:r,o=e.direction,a=t.direction||o,s=i.top,u=i.left,c=i.right,l=i.bottom,h=i.size,f=i.r,d=or(i,["top","left","right","bottom","size","r"]),p=this.getSize(t),g=p[0];if(u){var v=null,m=g*Math.sin(1/3*Math.PI),y=g*Math.sin(1/3*Math.PI);a==="up"?v=[-y,m]:a==="down"?v=[-y,-m]:a==="left"&&(v=[-y,y-m]),v&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:B(B({},d),{x:v[0],y:v[1],r:h/2||f||5}),className:"link-point-left",name:"link-point-left"}))}if(c){var b=null,m=g*Math.sin(1/3*Math.PI),y=g*Math.sin(1/3*Math.PI);a==="up"?b=[y,m]:a==="down"?b=[y,-m]:a==="right"&&(b=[y,y-m]),b&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:B(B({},d),{x:b[0],y:b[1],r:h/2||f||5}),className:"link-point-right",name:"link-point-right"}))}if(s){var x=null,m=g*Math.sin(1/3*Math.PI),y=g*Math.sin(1/3*Math.PI);a==="up"?x=[y-m,-m]:a==="left"?x=[y,-m]:a==="right"&&(x=[-y,-m]),x&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:B(B({},d),{x:x[0],y:x[1],r:h/2||f||5}),className:"link-point-top",name:"link-point-top"}))}if(l){var w=null,m=g*Math.sin(1/3*Math.PI),y=g*Math.sin(1/3*Math.PI);a==="down"?w=[-y+m,m]:a==="left"?w=[y,m]:a==="right"&&(w=[-y,m]),w&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:B(B({},d),{x:w[0],y:w[1],r:h/2||f||5}),className:"link-point-bottom",name:"link-point-bottom"}))}},getPath:function(t){var n=(this.mergeStyle||this.getOptions(t)).direction,e=t.direction||n,r=this.getSize(t),i=r[0],o=i*Math.sin(1/3*Math.PI),a=i*Math.sin(1/3*Math.PI),s=[["M",-a,o],["L",0,-o],["L",a,o],["Z"]];return e==="down"?s=[["M",-a,-o],["L",a,-o],["L",0,o],["Z"]]:e==="left"?s=[["M",-a,a-o],["L",a,-a],["L",a,a],["Z"]]:e==="right"&&(s=[["M",a,a-o],["L",-a,a],["L",-a,-a],["Z"]]),s},getShapeStyle:function(t){var n=(this.mergeStyle||this.getOptions(t)).style,e={stroke:t.color},r=ye({},n,e),i=this.getPath(t),o=B({path:i},r);return o},update:function(t,n,e){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getPath(t),a={stroke:t.color,path:o},s=n.get("keyShape"),u=ye({},i,s.attr(),a);u=ye(u,t.style),this.updateShape(t,n,u,!0,e),this.updateLinkPoints(t,r)},updateLinkPoints:function(t,n){var e=this.getOptions({}),r=e.linkPoints,i=e.direction,o=t.direction||i,a=n.shapeMap["link-point-left"]||n.find(function(D){return D.get("className")==="link-point-left"}),s=n.shapeMap["link-point-right"]||n.find(function(D){return D.get("className")==="link-point-right"}),u=n.shapeMap["link-point-top"]||n.find(function(D){return D.get("className")==="link-point-top"}),c=n.shapeMap["link-point-bottom"]||n.find(function(D){return D.get("className")==="link-point-bottom"}),l=r,h=a||s||u||c;h&&(l=h.attr());var f=ye({},l,t.linkPoints),d=f.fill,p=f.stroke,g=f.lineWidth,v=f.size/2;v||(v=f.r);var m=t.linkPoints?t.linkPoints:{left:void 0,right:void 0,top:void 0,bottom:void 0},y=m.left,b=m.right,x=m.top,w=m.bottom,E=this.getSize(t),M=E[0],_={r:v,fill:d,stroke:p,lineWidth:g},k=null,S=M*Math.sin(1/3*Math.PI),A=M*Math.sin(1/3*Math.PI);o==="up"?k=[-A,S]:o==="down"?k=[-A,-S]:o==="left"&&(k=[-A,A-S]),k&&(a?!y&&y!==void 0?(a.remove(),delete n.shapeMap["link-point-left"]):a.attr(B(B({},_),{x:k[0],y:k[1]})):y&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:B(B({},_),{x:k[0],y:k[1]}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})));var C=null;o==="up"?C=[A,S]:o==="down"?C=[A,-S]:o==="right"&&(C=[A,A-S]),C&&(s?!b&&b!==void 0?(s.remove(),delete n.shapeMap["link-point-right"]):s.attr(B(B({},_),{x:C[0],y:C[1]})):b&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:B(B({},_),{x:C[0],y:C[1]}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})));var I=null;o==="up"?I=[A-S,-S]:o==="left"?I=[A,-S]:o==="right"&&(I=[-A,-S]),I&&(u?!x&&x!==void 0?(u.remove(),delete n.shapeMap["link-point-top"]):u.attr(B(B({},_),{x:I[0],y:I[1]})):x&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:B(B({},_),{x:I[0],y:I[1]}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})));var N=null;o==="down"?N=[-A+S,S]:o==="left"?N=[A,S]:o==="right"&&(N=[-A,S]),N&&(c?!w&&w!==void 0?(c.remove(),delete n.shapeMap["link-point-bottom"]):c.attr(B(B({},_),{x:N[0],y:N[1]})):w&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:B(B({},_),{x:N[0],y:N[1]}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0})))}},"single-node");ja("modelRect",{options:{size:[185,70],style:{radius:5,stroke:"#69c0ff",fill:"#ffffff",lineWidth:Jt.defaultNode.style.lineWidth,fillOpacity:1},labelCfg:{style:{fill:"#595959",fontSize:14,fontFamily:Jt.windowFontFamily},offset:30},descriptionCfg:{style:{fontSize:12,fill:"#bfbfbf",fontFamily:Jt.windowFontFamily},paddingTop:0},preRect:{show:!0,width:4,fill:"#40a9ff",radius:2},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:10,lineWidth:1,fill:"#72CC4A",stroke:"#72CC4A"},logoIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg",width:16,height:16,offset:0},stateIcon:{show:!0,x:0,y:0,img:"https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg",width:16,height:16,offset:-5},anchorPoints:[[0,.5],[1,.5]]},shapeType:"modelRect",drawShape:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).preRect,r=e===void 0?{}:e,i=this.getShapeStyle(t),o=this.getSize(t),a=o[0],s=o[1],u=n.addShape("rect",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});n.shapeMap["".concat(this.type,"-keyShape")]=u;var c=r.show,l=or(r,["show"]);return c&&(n.shapeMap["pre-rect"]=n.addShape("rect",{attrs:B({x:-a/2,y:-s/2,height:s},l),className:"pre-rect",name:"pre-rect",draggable:!0})),this.drawLogoIcon(t,n),this.drawStateIcon(t,n),this.drawLinkPoints(t,n),u},drawLogoIcon:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).logoIcon,r=e===void 0?{}:e,i=this.getSize(t),o=i[0];if(r.show){var a=r.width,s=r.height,u=r.x,c=r.y,l=r.offset,h=r.text,f=or(r,["width","height","x","y","offset","text"]);h?n.shapeMap["rect-logo-icon"]=n.addShape("text",{attrs:B({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},f),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0}):n.shapeMap["rect-logo-icon"]=n.addShape("image",{attrs:B(B({},f),{x:u||-o/2+a+l,y:c||-s/2,width:a,height:s}),className:"rect-logo-icon",name:"rect-logo-icon",draggable:!0})}},drawStateIcon:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).stateIcon,r=e===void 0?{}:e,i=this.getSize(t),o=i[0];if(r.show){var a=r.width,s=r.height,u=r.x,c=r.y,l=r.offset,h=r.text,f=or(r,["width","height","x","y","offset","text"]);h?n.shapeMap["rect-state-icon"]=n.addShape("text",{attrs:B({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},f),className:"rect-state-icon",name:"rect-state-icon",draggable:!0}):n.shapeMap["rect-state-icon"]=n.addShape("image",{attrs:B(B({},f),{x:u||o/2-a+l,y:c||-s/2,width:a,height:s}),className:"rect-state-icon",name:"rect-state-icon",draggable:!0})}},drawLinkPoints:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).linkPoints,r=e===void 0?{}:e,i=r.top,o=r.left,a=r.right,s=r.bottom,u=r.size,c=r.r,l=or(r,["top","left","right","bottom","size","r"]),h=this.getSize(t),f=h[0],d=h[1];o&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:B(B({},l),{x:-f/2,y:0,r:u/2||c||5}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),a&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:B(B({},l),{x:f/2,y:0,r:u/2||c||5}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),i&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:-d/2,r:u/2||c||5}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),s&&(n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:B(B({},l),{x:0,y:d/2,r:u/2||c||5}),className:"link-point-bottom",name:"link-point-bottom",isAnchorPoint:!0}))},drawLabel:function(t,n){var e=this.getOptions(t),r=e.labelCfg,i=r===void 0?{}:r,o=e.logoIcon,a=o===void 0?{}:o,s=e.descriptionCfg,u=s===void 0?{}:s,c=this.getSize(t),l=c[0],h=null,f=a.show,d=a.width,p=-l/2+i.offset;f&&(p=-l/2+d+i.offset);var g=i.style,v=u.style,m=u.paddingTop;return Dt(t.description)?(h=n.addShape("text",{attrs:B(B({},g),{x:p,y:-5,text:t.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),n.shapeMap["text-shape"]=h,n.shapeMap["rect-description"]=n.addShape("text",{attrs:B(B({},v),{x:p,y:17+(m||0),text:t.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0})):(h=n.addShape("text",{attrs:B(B({},g),{x:p,y:7,text:t.label}),className:"text-shape",name:"text-shape",draggable:!0,labelRelated:!0}),n.shapeMap["text-shape"]=h),h},getShapeStyle:function(t){var n=(this.mergeStyle||this.getOptions(t)).style,e={stroke:t.color},r=ye({},n,e),i=this.getSize(t),o=r.width||i[0],a=r.height||i[1],s=B({x:-o/2,y:-a/2,width:o,height:a},r);return s},update:function(t,n){var e=this.mergeStyle||this.getOptions(t),r=e.style,i=r===void 0?{}:r,o=e.labelCfg,a=o===void 0?{}:o,s=e.descriptionCfg,u=s===void 0?{}:s,c=this.getSize(t),l=c[0],h=c[1],f=n.get("keyShape");f.attr(B(B({},i),{x:-l/2,y:-h/2,width:l,height:h}));var d=n.getContainer(),p=d.shapeMap["rect-logo-icon"]||d.find(function(Et){return Et.get("className")==="rect-logo-icon"}),g=p?p.attr():{},v=ye({},g,t.logoIcon),m=v.width;m===void 0&&(m=this.options.logoIcon.width);var y=t.logoIcon?t.logoIcon.show:void 0,b=a.offset,x=-l/2+m+b;!y&&y!==void 0&&(x=-l/2+b);var w=d.shapeMap["node-label"]||d.find(function(Et){return Et.get("className")==="node-label"}),E=d.shapeMap["rect-description"]||d.find(function(Et){return Et.get("className")==="rect-description"});if(t.label)if(!w)d.shapeMap["node-label"]=d.addShape("text",{attrs:B(B({},a.style),{x,y:t.description?-5:7,text:t.label}),className:"node-label",name:"node-label",draggable:!0,labelRelated:!0});else{var M=t.labelCfg?t.labelCfg.style:{},_=ye({},w.attr(),M);t.label&&(_.text=t.label),_.x=x,Dt(t.description)&&(_.y=-5),E&&(E.resetMatrix(),E.attr({x})),w.resetMatrix(),w.attr(_)}if(Dt(t.description)){var k=u.paddingTop;if(!E)d.shapeMap["rect-description"]=d.addShape("text",{attrs:B(B({},u.style),{x,y:17+(k||0),text:t.description}),className:"rect-description",name:"rect-description",draggable:!0,labelRelated:!0});else{var M=t.descriptionCfg?t.descriptionCfg.style:{},S=ye({},E.attr(),M);Dt(t.description)&&(S.text=t.description),S.x=x,E.resetMatrix(),E.attr(B(B({},S),{y:17+(k||0)}))}}var A=d.shapeMap["pre-rect"]||d.find(function(Et){return Et.get("className")==="pre-rect"});if(A&&!A.destroyed){var C=ye({},A.attr(),t.preRect);A.attr(B(B({},C),{x:-l/2,y:-h/2,height:h}))}if(p&&!p.destroyed)if(!y&&y!==void 0)p.remove(),delete d.shapeMap["pre-rect"];else{var I=v.width,N=v.height,D=v.x,P=v.y,j=v.offset,L=or(v,["width","height","x","y","offset"]);p.attr(B(B({},L),{x:D||-l/2+I+j,y:P||-N/2,width:I,height:N}))}else y&&this.drawLogoIcon(t,d);var R=d.shapeMap["rect-state-icon"]||d.find(function(Et){return Et.get("className")==="rect-state-icon"}),V=R?R.attr():{},tt=ye({},V,t.stateIcon);if(R){!tt.show&&tt.show!==void 0&&(R.remove(),delete d.shapeMap["rect-state-icon"]);var ut=tt.width,N=tt.height,D=tt.x,P=tt.y,dt=tt.offset,J=or(tt,["width","height","x","y","offset"]);R.attr(B(B({},J),{x:D||l/2-ut+dt,y:P||-N/2,width:ut,height:N}))}else tt.show&&this.drawStateIcon(t,d);this.updateLinkPoints(t,d)},getOptions:function(t,n){return n==="move"?t:mn({},this.options,this.getCustomConfig(t)||{},t)}},"single-node");ja("star",{options:{size:60,style:{stroke:Jt.defaultNode.style.stroke,fill:Jt.defaultNode.style.fill,lineWidth:Jt.defaultNode.style.lineWidth},labelCfg:{style:{fill:Jt.nodeLabel.style.fill,fontSize:Jt.nodeLabel.style.fontSize,fontFamily:Jt.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Jt.defaultNode.linkPoints.size,lineWidth:Jt.defaultNode.linkPoints.lineWidth,fill:Jt.defaultNode.linkPoints.fill,stroke:Jt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:B({},Jt.nodeStateStyles)},shapeType:"star",labelPosition:"center",drawShape:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).icon,r=e===void 0?{}:e,i=this.getShapeStyle(t),o=n.addShape("path",{attrs:i,className:"".concat(this.type,"-keyShape"),name:"".concat(this.type,"-keyShape"),draggable:!0});n.shapeMap["".concat(this.type,"-keyShape")]=o;var a=r.width,s=r.height,u=r.show,c=r.text;return u&&(c?n.shapeMap["".concat(this.type,"-icon")]=n.addShape("text",{attrs:B({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):n.shapeMap["".concat(this.type,"-icon")]=n.addShape("image",{attrs:B({x:-a/2,y:-s/2},r),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),this.drawLinkPoints(t,n),o},drawLinkPoints:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).linkPoints,r=e===void 0?{}:e,i=r.top,o=r.left,a=r.right,s=r.leftBottom,u=r.rightBottom,c=r.size,l=r.r,h=or(r,["top","left","right","leftBottom","rightBottom","size","r"]),f=this.getSize(t),d=f[0];if(a){var p=Math.cos(.1*Math.PI)*d,g=Math.sin((18+72*0)/180*Math.PI)*d;n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:B(B({},h),{x:p,y:-g,r:c/2||l||5}),className:"link-point-right",name:"link-point-right"})}if(i){var p=Math.cos(.5*Math.PI)*d,g=Math.sin((18+72*1)/180*Math.PI)*d;n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:B(B({},h),{x:p,y:-g,r:c/2||l||5}),className:"link-point-top",name:"link-point-top"})}if(o){var p=Math.cos(.9*Math.PI)*d,g=Math.sin((18+72*2)/180*Math.PI)*d;n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:B(B({},h),{x:p,y:-g,r:c/2||l||5}),className:"link-point-left",name:"link-point-left"})}if(s){var p=Math.cos(1.3*Math.PI)*d,g=Math.sin((18+72*3)/180*Math.PI)*d;n.shapeMap["link-point-bottom"]=n.addShape("circle",{attrs:B(B({},h),{x:p,y:-g,r:c/2||l||5}),className:"link-point-left-bottom",name:"link-point-left-bottom"})}if(u){var p=Math.cos(1.7*Math.PI)*d,g=Math.sin((18+72*4)/180*Math.PI)*d;n.shapeMap["link-point-right-bottom"]=n.addShape("circle",{attrs:B(B({},h),{x:p,y:-g,r:c/2||l||5}),className:"link-point-right-bottom",name:"link-point-right-bottom"})}},getPath:function(t){var n=this.getSize(t),e=n[0],r=e*3/8,i=t.innerR||r;return Cr.getStarPath(e,i)},getShapeStyle:function(t){var n=(this.mergeStyle||this.getOptions(t)).style,e={stroke:t.color},r=ye({},n,e),i=this.getPath(t),o=B({path:i},r);return o},update:function(t,n,e){var r=n.getContainer(),i=this.getOptions({}).style,o=this.getPath(t),a={stroke:t.color,path:o},s=n.get("keyShape"),u=ye({},i,s.attr(),a);u=ye(u,t.style),this.updateShape(t,n,u,!0,e),this.updateLinkPoints(t,r)},updateLinkPoints:function(t,n){var e=this.getOptions({}).linkPoints,r=n.shapeMap["link-point-left"]||n.find(function(S){return S.get("className")==="link-point-left"}),i=n.shapeMap["link-point-right"]||n.find(function(S){return S.get("className")==="link-point-right"}),o=n.shapeMap["link-point-top"]||n.find(function(S){return S.get("className")==="link-point-top"}),a=n.shapeMap["link-point-left-bottom"]||n.find(function(S){return S.get("className")==="link-point-left-bottom"}),s=n.shapeMap["link-point-left-bottom"]||n.find(function(S){return S.get("className")==="link-point-right-bottom"}),u=e,c=r||i||o||a||s;c&&(u=c.attr());var l=ye({},u,t.linkPoints),h=l.fill,f=l.stroke,d=l.lineWidth,p=l.size/2;p||(p=l.r);var g=t.linkPoints?t.linkPoints:{left:void 0,right:void 0,top:void 0,leftBottom:void 0,rightBottom:void 0},v=g.left,m=g.right,y=g.top,b=g.leftBottom,x=g.rightBottom,w=this.getSize(t),E=w[0],M={r:p,fill:h,stroke:f,lineWidth:d},_=Math.cos((18+72*0)/180*Math.PI)*E,k=Math.sin((18+72*0)/180*Math.PI)*E;i?!m&&m!==void 0?(i.remove(),delete n.shapeMap["link-point-right"]):i.attr(B(B({},M),{x:_,y:-k})):m&&(n.shapeMap["link-point-right"]=n.addShape("circle",{attrs:B(B({},M),{x:_,y:-k}),className:"link-point-right",name:"link-point-right",isAnchorPoint:!0})),_=Math.cos((18+72*1)/180*Math.PI)*E,k=Math.sin((18+72*1)/180*Math.PI)*E,o?!y&&y!==void 0?(o.remove(),delete n.shapeMap["link-point-top"]):o.attr(B(B({},M),{x:_,y:-k})):y&&(n.shapeMap["link-point-top"]=n.addShape("circle",{attrs:B(B({},M),{x:_,y:-k}),className:"link-point-top",name:"link-point-top",isAnchorPoint:!0})),_=Math.cos((18+72*2)/180*Math.PI)*E,k=Math.sin((18+72*2)/180*Math.PI)*E,r?!v&&v!==void 0?(r.remove(),delete n.shapeMap["link-point-left"]):r.attr(B(B({},M),{x:_,y:-k})):v&&(n.shapeMap["link-point-left"]=n.addShape("circle",{attrs:B(B({},M),{x:_,y:-k}),className:"link-point-left",name:"link-point-left",isAnchorPoint:!0})),_=Math.cos((18+72*3)/180*Math.PI)*E,k=Math.sin((18+72*3)/180*Math.PI)*E,a?!b&&b!==void 0?(a.remove(),delete n.shapeMap["link-point-left-bottom"]):a.attr(B(B({},M),{x:_,y:-k})):b&&(n.shapeMap["link-point-left-bottom"]=n.addShape("circle",{attrs:B(B({},M),{x:_,y:-k}),className:"link-point-left-bottom",name:"link-point-left-bottom",isAnchorPoint:!0})),_=Math.cos((18+72*4)/180*Math.PI)*E,k=Math.sin((18+72*4)/180*Math.PI)*E,s?!x&&x!==void 0?(s.remove(),delete n.shapeMap["link-point-right-bottom"]):s.attr(B(B({},M),{x:_,y:-k})):x&&(n.shapeMap["link-point-right-bottom"]=n.addShape("circle",{attrs:B(B({},M),{x:_,y:-k}),className:"link-point-right-bottom",name:"link-point-right-bottom",isAnchorPoint:!0}))}},"single-node");var T_=Cr.defaultSubjectColors,ll="fan-shape-";ja("donut",{options:{size:Jt.defaultNode.size,style:{x:0,y:0,stroke:Jt.defaultNode.style.stroke,fill:Jt.defaultNode.style.fill,lineWidth:Jt.defaultNode.style.lineWidth},labelCfg:{style:{fill:Jt.nodeLabel.style.fill,fontSize:Jt.nodeLabel.style.fontSize,fontFamily:Jt.windowFontFamily}},linkPoints:{top:!1,right:!1,bottom:!1,left:!1,size:Jt.defaultNode.linkPoints.size,lineWidth:Jt.defaultNode.linkPoints.lineWidth,fill:Jt.defaultNode.linkPoints.fill,stroke:Jt.defaultNode.linkPoints.stroke},icon:{show:!1,img:"https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",width:20,height:20},stateStyles:B({},Jt.nodeStateStyles)},shapeType:"circle",labelPosition:"center",drawShape:function(t,n){var e=(this.mergeStyle||this.getOptions(t)).icon,r=e===void 0?{}:e,i=this.getShapeStyle(t),o=mn({},r,t.icon),a=n.addShape("circle",{attrs:i,className:"".concat(this.type,"-keyShape"),draggable:!0,name:"".concat(this.type,"-keyShape")});n.shapeMap["".concat(this.type,"-keyShape")]=a;var s=o.width,u=o.height,c=o.show,l=o.text;return c&&(l?n.shapeMap["".concat(this.type,"-icon")]=n.addShape("text",{attrs:B({x:0,y:0,fontSize:12,fill:"#000",stroke:"#000",textBaseline:"middle",textAlign:"center"},o),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0}):n.shapeMap["".concat(this.type,"-icon")]=n.addShape("image",{attrs:B({x:-s/2,y:-u/2},o),className:"".concat(this.type,"-icon"),name:"".concat(this.type,"-icon"),draggable:!0})),aft(t,n,a),this.drawLinkPoints(t,n),a},updateShape:function(t,n,e,r,i){var o=n.get("keyShape");o.attr(B({},e)),sft(t,n,o),this.updateLabel(t,n,i),r&&this.updateIcon(t,n)}},"circle");var aft=function(t,n,e){var r=t.donutAttrs,i=r===void 0?{}:r,o=t.donutColorMap,a=o===void 0?{}:o,s=Object.keys(i).length;if(i&&s>1){var u=a5(i,a),c=u.configs,l=u.totalValue;if(l){var h=s5(e),f=h.lineWidth,d=h.arcR,p=[d,0],g=0;if(s===1){Jm(n,{arcR:d,arcBegin:p,beginAngle:g,config:c[0],fanIndex:0,lineWidth:f,totalValue:l,drawWhole:!0});return}for(var v=0;v<c.length;v++){var m=Jm(n,{arcR:d,arcBegin:p,beginAngle:g,config:c[v],fanIndex:v,lineWidth:f,totalValue:l});if(m.shouldEnd)return;p=m.arcBegin,g=m.beginAngle}}}},Jm=function(t,n){var e=n.arcR,r=n.arcBegin,i=n.beginAngle,o=n.config,a=n.fanIndex,s=n.lineWidth,u=n.totalValue,c=n.drawWhole,l=c===void 0?!1:c,h=n.updateShape,f=h===void 0?void 0:h,d=o.value/u;if(d<.001)return{beginAngle:i,arcBegin:r,shape:void 0,shouldEnd:!1};var p,g,v;if(l||d>.999)p=[e,1e-4],v=1;else{var m=d*Math.PI*2;g=i+m,p=[e*Math.cos(g),-e*Math.sin(g)],v=m>Math.PI?1:0}var y={path:[["M",r[0],r[1]],["A",e,e,0,v,0,p[0],p[1]]],stroke:o.color||(f==null?void 0:f.attr("stroke"))||T_[a%T_.length],lineWidth:s};return f?f.attr(y):t.shapeMap["".concat(ll).concat(a)]=t.addShape("path",{attrs:y,name:"".concat(ll).concat(a),draggable:!0}),{beginAngle:g,arcBegin:p,shape:t.shapeMap["".concat(ll).concat(a)],shouldEnd:l||d>.999}},sft=function(t,n,e){var r=t.donutAttrs,i=t.donutColorMap,o=i===void 0?{}:i,a={},s=n.getContainer();if(r){var u=a5(r,o),c=u.configs,l=u.totalValue;if(l)for(var h=s5(e),f=h.lineWidth,d=h.arcR,p=[d,0],g=0,v=0;v<c.length;v++){var m="".concat(ll).concat(v),y=Jm(s,{arcR:d,arcBegin:p,beginAngle:g,config:c[v],fanIndex:v,lineWidth:f,totalValue:l,drawWhole:c.length===1,updateShape:s.shapeMap[m]});if(y.shape&&(a[m]=!0),y.shouldEnd)break;p=y.arcBegin,g=y.beginAngle}}var b=Object.keys(s.shapeMap).filter(function(x){return x.includes(ll)});b.forEach(function(x){a[x]||(s.shapeMap[x].remove(!0),delete s.shapeMap[x])})},a5=function(t,n){var e=0,r=[];return Object.keys(t).forEach(function(i){var o=+t[i];isNaN(o)||(r.push({key:i,value:o,color:n[i]}),e+=o)}),{totalValue:e,configs:r}},s5=function(t){var n=t.attr("r"),e=.6*n,r=(n+e)/2,i=n-e;return{lineWidth:i,arcR:r}},Rf=function(t){var n=t.x,e=t.y;return{x:n,y:e,centerX:n,centerY:e,minX:n,minY:e,maxX:n,maxY:e,height:0,width:0}},uft=function(t){t===void 0&&(t=[]);var n=[],e=[];t.forEach(function(s){n.push(s.x),e.push(s.y)});var r=Math.min.apply(Math,n),i=Math.max.apply(Math,n),o=Math.min.apply(Math,e),a=Math.max.apply(Math,e);return{centerX:(r+i)/2,centerY:(o+a)/2,maxX:i,maxY:a,minX:r,minY:o,height:a-o,width:i-r}},wb=function(t){for(var n=[],e={},r=t.length,i=r-1;i>=0;i--){var o=t[i];o.id="".concat(o.x,"|||").concat(o.y),e[o.id]||(e[o.id]=o,n.push(o))}return n},u5=function(t){return wb(t)},ip=function(t,n){return t.width||t.height?{centerX:t.centerX,centerY:t.centerY,minX:t.minX-n,minY:t.minY-n,maxX:t.maxX+n,maxY:t.maxY+n,height:t.height+2*n,width:t.width+2*n}:t},cft=function(t,n){var e=Math.abs(t.x-n.centerX),r=Math.abs(t.y-n.centerY);return e===0&&r===0?0:e/n.width>r/n.height},$m=function(t,n,e){var r=cft(n,t);if(r===0){var i=t.centerX,o=t.centerY;return e.y<n.y?o=t.minY:e.x>n.x?i=t.maxX:e.x<n.x?i=t.minX:e.x===n.x&&(o=t.maxY),{x:i,y:o}}return r?{x:n.x>t.centerX?t.maxX:t.minX,y:n.y}:{x:n.x,y:n.y>t.centerY?t.maxY:t.minY}},O_=function(t,n){var e=Math.min(t.minX,n.minX),r=Math.min(t.minY,n.minY),i=Math.max(t.maxX,n.maxX),o=Math.max(t.maxY,n.maxY);return{centerX:(e+i)/2,centerY:(r+o)/2,minX:e,minY:r,maxX:i,maxY:o,height:o-r,width:i-e}},ty=function(t){return[{x:t.minX,y:t.minY},{x:t.maxX,y:t.minY},{x:t.maxX,y:t.maxY},{x:t.minX,y:t.maxY}]},Ff=function(t,n){var e=t.x,r=t.y;return e<n.minX||e>n.maxX||r<n.minY||r>n.maxY},lft=function(t,n){return n<t.minX||n>t.maxX?[]:[{x:n,y:t.minY},{x:n,y:t.maxY}]},hft=function(t,n){return n<t.minY||n>t.maxY?[]:[{x:t.minX,y:n},{x:t.maxX,y:n}]},fft=function(t,n){return lft(t,n.x).concat(hft(t,n.y))},jl=function(t,n){return Math.abs(t.x-n.x)+Math.abs(t.y-n.y)},dft=function(t,n){var e=-2,r=0;return n.forEach(function(i){i&&(t.x===i.x&&(r+=e),t.y===i.y&&(r+=e))}),r},N_=function(t,n,e,r,i){return jl(t,n)+jl(t,e)+dft(t,[n,e,r,i])},pft=function t(n,e,r,i,o){o===void 0&&(o=0),n.unshift(e[i]),r[i]&&r[i]!==i&&o<=100&&t(n,e,r,r[i],o+1)},Bf=function(t,n,e,r){var i=e.x-t.x,o=e.y-t.y,a=r.x-t.x,s=r.y-t.y,u=e.x-n.x,c=e.y-n.y,l=r.x-n.x,h=r.y-n.y,f=i*s-o*a,d=u*h-c*l,p=i*c-o*u,g=a*h-s*l;return f*d<=0&&p*g<=0},ey=function(t,n,e){if(e.width||e.height){var r=ty(e),i=r[0],o=r[1],a=r[2],s=r[3];return Bf(t,n,i,o)||Bf(t,n,i,s)||Bf(t,n,o,a)||Bf(t,n,a,s)}return!1},gft=function(t,n,e,r){var i=[];return t.forEach(function(o){if(o!==n&&(o.x===n.x||o.y===n.y)){if(ey(o,n,e)||ey(o,n,r))return;i.push(o)}}),wb(i)},vft=function(t,n,e,r,i,o,a){var s,u=[],c=(s={},s[n.id]=n,s),l={},h={},f={};h[n.id]=0,f[n.id]=N_(n,e,n);var d=new l5;d.add({id:n.id,value:f[n.id]});var p={};t.forEach(function(x){p[x.id]=x});for(var g;Object.keys(c).length;){var v=d.minId(!1);if(v)g=c[v];else break;if(g===e){var m=[];return pft(m,p,l,e.id),m}delete c[g.id],d.remove(g.id),u.push(g);var y=gft(t,g,r,i),b=function(x){x.forEach(function(w){if(u.indexOf(w)===-1){var E=w.id;c[E]||(c[E]=w);var M=f[g.id]+jl(g,w);if(h[E]&&M>=h[E]){d.add({id:E,value:f[E]});return}l[E]=g.id,h[E]=M,f[E]=h[E]+N_(w,e,n,o,a),d.add({id:E,value:f[E]})}})};b(y)}return[n,e]},mft=function(t,n,e){return!(t.x===n.x&&n.x===e.x||t.y===n.y&&n.y===e.y)},yft=function(t,n,e,r){var i=jl(t,n),o=jl(e,n);i<r&&(r=i),o<r&&(r=o);var a={x:n.x-r/i*(n.x-t.x),y:n.y-r/i*(n.y-t.y)},s={x:n.x-r/o*(n.x-e.x),y:n.y-r/o*(n.y-e.y)};return[a,s]},D_=function(t,n){var e=[],r=t[0];return e.push("M".concat(r.x," ").concat(r.y)),t.forEach(function(i,o){var a=t[o+1],s=t[o+2];if(a&&s)if(mft(i,a,s)){var u=yft(i,a,s,n),c=u[0],l=u[1];e.push("L".concat(c.x," ").concat(c.y)),e.push("Q".concat(a.x," ").concat(a.y," ").concat(l.x," ").concat(l.y)),e.push("L".concat(l.x," ").concat(l.y))}else e.push("L".concat(a.x," ").concat(a.y));else a&&e.push("L".concat(a.x," ").concat(a.y))}),e.join("")},c5=function(t,n,e,r,i){var o,a;if(!e||!e.getType())o=Rf(t);else if(e.getType()==="combo"){var s=e.getKeyShape().getBBox();if(s){var u=e.getModel(),c=u.x,l=u.y;o={x:c,y:l,width:s.width,height:s.height,minX:s.minX+c,maxX:s.maxX+c,minY:s.minY+l,maxY:s.maxY+l},o.centerX=(o.minX+o.maxX)/2,o.centerY=(o.minY+o.maxY)/2}else o=Rf(t)}else o=e&&e.getBBox();if(!r||!r.getType())a=Rf(n);else if(r.getType()==="combo"){var h=r.getKeyShape().getBBox();if(h){var f=r.getModel(),d=f.x,p=f.y;a={x:d,y:p,width:h.width,height:h.height,minX:h.minX+d,maxX:h.maxX+d,minY:h.minY+p,maxY:h.maxY+p},a.centerX=(a.minX+a.maxX)/2,a.centerY=(a.minY+a.maxY)/2}else a=Rf(n)}else a=r&&r.getBBox();var g=ip(o,i),v=ip(a,i),m=$m(g,t,n),y=$m(v,n,t),b=uft([m,y]),x=O_(g,b),w=O_(v,b),E=[];E=E.concat(ty(x)).concat(ty(w));var M={x:(t.x+n.x)/2,y:(t.y+n.y)/2};[b,x,w].forEach(function(k){E=E.concat(fft(k,M).filter(function(S){return Ff(S,g)&&Ff(S,v)}))}),[{x:m.x,y:y.y},{x:y.x,y:m.y}].forEach(function(k){Ff(k,g)&&Ff(k,v)&&E.push(k)}),E.unshift(m),E.push(y),E=wb(E);var _=vft(E,m,y,o,a,t,n);return _.unshift(t),_.push(n),u5(_)},bft=function(t){if(!(t!=null&&t.length))return t;for(var n=t[t.length-1],e={x:n.x,y:n.y},r=[n],i=[n],o=t.length-2;o>=0;o--){var a=t[o];if(a.x===e.x?r.push(a):(r=[a],e.x=a.x),a.y===e.y?i.push(a):(i=[a],e.y=a.y),r.length>2){var s=t.indexOf(r[1]);s>-1&&t.splice(s,1);continue}if(i.length>2){var s=t.indexOf(i[1]);s>-1&&t.splice(s,1)}}return t},l5=function(){function t(){this.arr=[],this.map={},this.arr=[],this.map={}}return t.prototype._innerAdd=function(n,e){for(var r=[0,e-1];r[1]-r[0]>1;){var i=Math.floor((r[0]+r[1])/2);if(this.arr[i].value>n.value)r[1]=i;else if(this.arr[i].value<n.value)r[0]=i;else{this.arr.splice(i,0,n),this.map[n.id]=!0;return}}this.arr.splice(r[1],0,n),this.map[n.id]=!0},t.prototype.add=function(n){delete this.map[n.id];var e=this.arr.length;if(!e){this.arr.push(n),this.map[n.id]=!0;return}if(this.arr[e-1].value<n.value){this.arr.push(n),this.map[n.id]=!0;return}this._innerAdd(n,e)},t.prototype.remove=function(n){this.map[n]&&delete this.map[n]},t.prototype._clearAndGetMinId=function(){for(var n,e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?n=this.arr[e].id:this.arr.splice(e,1);return n},t.prototype._findFirstId=function(){for(;this.arr.length;){var n=this.arr.shift();if(this.map[n.id])return n.id}},t.prototype.minId=function(n){return n?this._clearAndGetMinId():this._findFirstId()},t}(),xft=function(t,n){return Math.abs(t.x-n.x)+Math.abs(t.y-n.y)},wft=function(t,n,e,r,i){return u5(c5(t,n,e,r,i.offset))},Eft={offset:20,maxAllowedDirectionChange:Math.PI/2,maximumLoops:2e3,gridSize:10,directions:[{stepX:1,stepY:0},{stepX:-1,stepY:0},{stepX:0,stepY:1},{stepX:0,stepY:-1}],get penalties(){return{0:0,45:this.gridSize/2,90:this.gridSize/2}},distFunc:xft,fallbackRoute:wft},Wo=function(t,n){var e=Math.round(Math.abs(t/n)),r=t<0?-1:1;return e<0?0:r*e},Mft=function(t,n,e){var r={};return t.forEach(function(i){if(i)for(var o=ip(i.getBBox(),e),a=Wo(o.minX,n);a<=Wo(o.maxX,n);a+=1)for(var s=Wo(o.minY,n);s<=Wo(o.maxY,n);s+=1)r["".concat(a,"|||").concat(s)]=!0}),r},xv=function(t,n){var e=n.x-t.x,r=n.y-t.y;return e||r?Math.atan2(r,e):0},P_=function(t,n){var e=Math.abs(t-n);return e>Math.PI?2*Math.PI-e:e},L_=function(t,n,e){for(var r=1/0,i=0,o=n.length;i<o;i++){var a=e(t,n[i]);a<r&&(r=a)}return r},j_=function(t,n,e,r,i){var o=[];if(!e)return[t];var a=i.directions,s=i.offset,u=e.getBBox(),c=n.x>u.minX&&n.x<u.maxX&&n.y>u.minY&&n.y<u.maxY,l=ip(u,s);for(var h in l)l[h]=Wo(l[h],i.gridSize);if(c){for(var f=0,d=a;f<d.length;f++)for(var p=d[f],g=[[{x:l.minX,y:l.minY},{x:l.maxX,y:l.minY}],[{x:l.minX,y:l.minY},{x:l.minX,y:l.maxY}],[{x:l.maxX,y:l.minY},{x:l.maxX,y:l.maxY}],[{x:l.minX,y:l.maxY},{x:l.maxX,y:l.maxY}]],h=0;h<4;h++){var v=g[h],m=Cr.getLineIntersect(t,{x:t.x+p.stepX*l.width,y:t.y+p.stepY*l.height},v[0],v[1]);m&&!ey(t,m,u)&&(m.id="".concat(m.x,"|||").concat(m.y),o.push(m))}return o}var y=$m(l,t,r);return y.id="".concat(y.x,"|||").concat(y.y),[y]},ny=function(t,n,e,r){var i=xv(t,n),o=e[t.id];if(!o){var a=xv(r,t);return P_(a,i)}var s=xv({x:o.x,y:o.y},t);return P_(s,i)},Sft=function(t,n,e,r,i,o,a){var s=[r],u=r,c=t.id,l=t.x,h=t.y,f={x:l,y:h,id:c};ny(f,o,n,e)&&(u={x:o.x===r.x?r.x:f.x*a,y:o.y===r.y?r.y:f.y*a},s.unshift(u));for(var d=n[c];d&&d.id!==c;){var p={x:l,y:h,id:c},g={x:d.x,y:d.y,id:d.id},v=ny(g,p,n,e);v&&(u={x:g.x===p.x?u.x:g.x*a,y:g.y===p.y?u.y:g.y*a},s.unshift(u)),c=g.id,l=g.x,h=g.y,d=n[c]}return s[0].x=l===e.x?i.x:u.x,s[0].y=h===e.y?i.y:u.y,s.unshift(i),s},_ft=function(t,n,e,r,i){if(isNaN(t.x)||isNaN(n.x))return[];var o=mn(Eft,i);o.obstacles=o.obstacles||[];var a=o.penalties,s=o.gridSize,u=Mft(o.obstacles.concat([e,r]),s,o.offset),c={x:Wo(t.x,s),y:Wo(t.y,s)},l={x:Wo(n.x,s),y:Wo(n.y,s)};t.id="".concat(c.x,"|||").concat(c.y),n.id="".concat(l.x,"|||").concat(l.y);var h=j_(c,t,e,l,o),f=j_(l,n,r,c,o);h.forEach(function(L){delete u[L.id]}),f.forEach(function(L){delete u[L.id]});for(var d={},p={},g={},v={},m={},y=new l5,b=0;b<h.length;b++){var x=h[b];d[x.id]=x,v[x.id]=0,m[x.id]=L_(x,f,o.distFunc),y.add({id:x.id,value:m[x.id]})}var w=o.maximumLoops,E,M,_,k,S,A,C=1/0,I={};for(f.forEach(function(L){I["".concat(L.x,"|||").concat(L.y)]=!0}),Object.keys(d).forEach(function(L){var R=d[L].id;m[R]<=C&&(C=m[R],E=d[R])});Object.keys(d).length>0&&w>0;){var N=y.minId((w+1)%30===0);if(N)E=d[N];else break;if(I["".concat(E.x,"|||").concat(E.y)])return Sft(E,g,c,n,t,l,s);delete d[E.id],y.remove(E.id),p[E.id]=!0;for(var b=0;b<o.directions.length;b++){M=o.directions[b];var D="".concat(Math.round(E.x)+M.stepX,"|||").concat(Math.round(E.y)+M.stepY);if(_={x:E.x+M.stepX,y:E.y+M.stepY,id:D},!p[D]&&(A=ny(E,_,g,c),!(A>o.maxAllowedDirectionChange)&&!u[D])){d[D]||(d[D]=_);var P=a[A];k=o.distFunc(E,_)+(isNaN(P)?s:P),S=v[E.id]+k;var j=v[D];j&&S>=j||(g[D]=E,v[D]=S,m[D]=S+L_(_,f,o.distFunc),y.add({id:D,value:m[D]}))}}w-=1}return o.fallbackRoute(t,n,e,r,o)};NG("polyline",{options:{color:Jt.defaultEdge.color,size:Jt.defaultEdge.size,style:{radius:0,offset:15,x:0,y:0,stroke:Jt.defaultEdge.style.stroke,lineAppendWidth:Jt.defaultEdge.style.lineAppendWidth},labelCfg:{style:{fill:Jt.edgeLabel.style.fill,fontSize:Jt.edgeLabel.style.fontSize,fontFamily:Jt.windowFontFamily}},routeCfg:{obstacles:[],maxAllowedDirectionChange:Math.PI,maximumLoops:500,gridSize:10},stateStyles:B({},Jt.edgeStateStyles)},shapeType:"polyline",labelPosition:"center",drawShape:function(t,n){var e=this.getShapeStyle(t);e.radius===0&&delete e.radius;var r=n.addShape("path",{className:"edge-shape",name:"edge-shape",attrs:e});return n.shapeMap["edge-shape"]=r,r},getShapeStyle:function(t){var n=this.options.style,e={stroke:t.color},r=ye({},n,e,t.style);t=this.getPathPoints(t),this.radius=r.radius,this.offset=r.offset;var i=t.startPoint,o=t.endPoint,a=this.getControlPoints(t),s=[i];a&&(s=s.concat(a)),s.push(o);var u=t.sourceNode,c=t.targetNode,l=r.radius,h=this.options.routeCfg,f=ye({},h,t.routeCfg);f.offset=r.offset;var d=this.getPath(s,u,c,l,f,!a);(ve(d)&&d.length<=1||Dt(d)&&d.indexOf("L")===-1)&&(d="M0 0, L0 0"),(isNaN(i.x)||isNaN(i.y)||isNaN(o.x)||isNaN(o.y))&&(d="M0 0, L0 0");var p=ye({},Jt.defaultEdge.style,r,{lineWidth:t.size,path:d});return p},updateShapeStyle:function(t,n){var e=n.getContainer();if(n.isVisible()){var r={stroke:t.color},i=e.shapeMap["edge-shape"]||e.find(function(b){return b.get("className")==="edge-shape"})||n.getKeyShape(),o=t.size;t=this.getPathPoints(t);var a=t.startPoint,s=t.endPoint,u=this.getControlPoints(t),c=[a];u&&(c=c.concat(u)),c.push(s);var l=i.attr(),h=ye({},r,l,t.style),f=t.sourceNode,d=t.targetNode,p=h.radius,g=this.options.routeCfg,v=ye({},g,t.routeCfg);v.offset=h.offset;var m=this.getPath(c,f,d,p,v,!u);(ve(m)&&m.length<=1||Dt(m)&&m.indexOf("L")===-1)&&(m="M0 0, L0 0"),(isNaN(a.x)||isNaN(a.y)||isNaN(s.x)||isNaN(s.y))&&(m="M0 0, L0 0"),l.endArrow&&h.endArrow===!1&&(t.style.endArrow={path:""}),l.startArrow&&h.startArrow===!1&&(t.style.startArrow={path:""});var y=ye(r,i.attr(),{lineWidth:o,path:m},t.style);i&&i.attr(y)}},getPath:function(t,n,e,r,i,o){var a=i.offset,s=i.obstacles,u=i.simple;if(!a||t.length>2||o===!1){if(r)return D_(t,r);var c=[];return mt(t,function(d,p){p===0?c.push(["M",d.x,d.y]):c.push(["L",d.x,d.y])}),c}u!==!1&&!(s!=null&&s.length)&&(u=!0);var l=u?c5(t[t.length-1],t[0],e,n,a):_ft(t[0],t[t.length-1],n,e,i);if(!l||!l.length)return"M0 0, L0 0";if(r){var h=D_(l,r);return h}l=bft(l);var f=Cr.pointsToPolygon(l);return f}},"single-edge");var R_=za.cloneEvent,F_=za.isNaN,B_=Math.abs,kft=10,Aft=["shift","ctrl","alt","control"];const Cft={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,scalableRange:0,allowDragOnItem:!1}},getEvents:function(){return{mousedown:"onMouseDown",drag:"onDragMove",dragend:"onMouseUp","canvas:click":"onMouseUp",keyup:"onKeyUp",focus:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onMouseUp"}},updateViewport:function(t){var n=this.origin,e=+t.clientX,r=+t.clientY;if(!(F_(e)||F_(r))){var i=e-n.x,o=r-n.y;this.get("direction")==="x"?o=0:this.get("direction")==="y"&&(i=0),this.origin={x:e,y:r};var a=this.graph.get("width"),s=this.graph.get("height"),u=this.graph.get("canvas").getCanvasBBox(),c=this.scalableRange,l=this.scalableRange;c<1&&c>-1&&(c=a*c,l=s*l),(u.minX<=a+c&&u.minX+i>a+c||u.maxX+c>=0&&u.maxX+c+i<0)&&(i=0),(u.minY<=s+l&&u.minY+o>s+l||u.maxY+l>=0&&u.maxY+l+o<0)&&(o=0),this.graph.translate(i,o)}},onTouchStart:function(t){var n=this,e=t.originalEvent.touches,r=e[0],i=e[1];r&&i||(t.preventDefault(),this.mousedown=!0,n.onDragStart(t))},onMouseDown:function(t){this.mousedown=!0},onDragMove:function(t){this.mousedown&&(this.dragstart?this.onDrag(t):(this.dragstart=!0,this.onDragStart(t)))},onDragStart:function(t){var n=this,e=t.originalEvent;if(!(e&&t.name!=="touchstart"&&e.button!==0)&&!(t.name!=="touchstart"&&typeof window<"u"&&window.event&&!window.event.buttons&&!window.event.button)&&this.shouldBegin(t,this)&&!n.keydown&&this.allowDrag(t)){if(n.origin={x:t.clientX,y:t.clientY},n.dragging=!1,this.enableOptimize){for(var r=this.graph,i=r.getEdges(),o=0,a=i.length;o<a;o++){var s=i[o].get("group").get("children");s&&s.forEach(function(y){y.set("ori-visibility",y.get("ori-visibility")||y.get("visible")),y.hide()})}for(var u=r.getNodes(),c=0,l=u.length;c<l;c++)for(var h=u[c].getContainer(),f=h.get("children"),d=0,p=f;d<p.length;d++){var g=p[d],v=g.get("isKeyShape");v||(g.set("ori-visibility",g.get("ori-visibility")||g.get("visible")),g.hide())}}if(typeof window<"u"){var m=this;this.handleDOMContextMenu=function(y){return m.onMouseUp(y)},document.body.addEventListener("contextmenu",this.handleDOMContextMenu)}}},onTouchMove:function(t){var n=this,e=t.originalEvent.touches,r=e[0],i=e[1];if(r&&i){this.onMouseUp(t);return}t.preventDefault(),n.onDrag(t)},onDrag:function(t){if(this.mousedown){var n=this.graph;if(!this.keydown&&this.allowDrag(t)&&(t=R_(t),!!this.origin)){if(this.dragging)t.type="drag",n.emit("canvas:drag",t);else{if(B_(this.origin.x-t.clientX)+B_(this.origin.y-t.clientY)<kft)return;this.shouldBegin(t,this)&&(t.type="dragstart",n.emit("canvas:dragstart",t),this.originPosition={x:t.clientX,y:t.clientY},this.dragging=!0)}this.shouldUpdate(t,this)&&this.updateViewport(t)}}},onMouseUp:function(t){var n,e;this.mousedown=!1,this.dragstart=!1;var r=this.graph;if(!this.keydown){var i=r.getZoom(),o=r.get("modeController"),a=(e=(n=o==null?void 0:o.modes[o.mode])===null||n===void 0?void 0:n.filter(function(E){return E.type==="zoom-canvas"}))===null||e===void 0?void 0:e[0],s=a?a.optimizeZoom||.1:0;if(this.enableOptimize){for(var u=r.getEdges(),c=0,l=u.length;c<l;c++){var h=u[c].get("group").get("children");h&&h.forEach(function(E){var M=E.get("ori-visibility");E.set("ori-visibility",void 0),M&&E.show()})}if(i>s)for(var f=r.getNodes(),d=0,p=f.length;d<p;d++)for(var g=f[d].getContainer(),v=g.get("children"),m=0,y=v;m<y.length;m++){var b=y[m],x=b.get("isKeyShape");if(!x){var w=b.get("ori-visibility");b.set("ori-visibility",void 0),w&&b.show()}}}if(!this.dragging){this.origin=null;return}t=R_(t),this.shouldEnd(t,this)&&this.updateViewport(t),t.type="dragend",t.dx=t.clientX-this.originPosition.x,t.dy=t.clientY-this.originPosition.y,r.emit("canvas:dragend",t),this.endDrag(),typeof window<"u"&&document.body.removeEventListener("contextmenu",this.handleDOMContextMenu)}},endDrag:function(){this.origin=null,this.dragging=!1,this.dragbegin=!1,this.mousedown=!1,this.dragstart=!1},onKeyDown:function(t){var n=this,e=t.key;e&&(Aft.indexOf(e.toLowerCase())>-1?n.keydown=!0:n.keydown=!1)},onKeyUp:function(){this.keydown=!1,this.origin=null,this.dragging=!1,this.dragbegin=!1},allowDrag:function(t){var n,e,r=t.target,i=r&&r.isCanvas&&r.isCanvas();if(Rl(this.allowDragOnItem)&&!this.allowDragOnItem&&!i)return!1;if(yr(this.allowDragOnItem)){var o=this.allowDragOnItem,a=o.node,s=o.edge,u=o.combo,c=(e=(n=t.item)===null||n===void 0?void 0:n.getType)===null||e===void 0?void 0:e.call(n);if(!a&&c==="node"||!s&&c==="edge"||!u&&c==="combo")return!1}return!0}},Ift={getDefaultCfg:function(){return{updateEdge:!0,delegateStyle:{},enableDelegate:!1,onlyChangeComboSize:!1,comboActiveState:"",selectedState:"selected",enableOptimize:!1,enableDebounce:!1,enableStack:!0}},getEvents:function(){return{"node:mousedown":"onMouseDown",drag:"onDragMove",dragend:"onDragEnd","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave","combo:drop":"onDropCombo","node:drop":"onDropNode","canvas:drop":"onDropCanvas",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onDragEnd",afterchangedata:"onDragEnd"}},validationCombo:function(t){if(!this.origin||!t||t.destroyed)return!1;var n=t.getType();return n==="combo"},onTouchStart:function(t){if(t.item){var n=this;try{var e=t.originalEvent.touches,r=e[0],i=e[1];if(r&&i)return;t.preventDefault()}catch{console.warn("Touch original event not exist!")}this.mousedown={item:t.item,target:t.target,origin:{x:t.x,y:t.y}},this.dragstart=!0,n.onDragStart(t)}},onTouchMove:function(t){var n=this;try{var e=t.originalEvent.touches,r=e[0],i=e[1];if(r&&i){n.onDragEnd(t);return}t.preventDefault()}catch{console.warn("Touch original event not exist!")}n.onDrag(t)},onMouseDown:function(t){this.mousedown={item:t.item,target:t.target,origin:{x:t.x,y:t.y}},typeof window<"u"&&!this.windowEventBinded&&(this.windowEventBinded=!0,document.body.addEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.addEventListener("mouseup",this.onDragEnd.bind(this)))},onDragMove:function(t){var n,e;if(((e=(n=t.item)===null||n===void 0?void 0:n.getType)===null||e===void 0?void 0:e.call(n))!=="node"){this.onDragEnd();return}this.mousedown&&(this.dragstart?this.onDrag(B(B({},t),this.mousedown)):(this.dragstart=!0,this.onDragStart(t)))},onDragStart:function(t){var n=this;if(this.currentShouldEnd=!0,!!this.shouldBegin(B(B({},t),this.mousedown),this)){var e=this.mousedown,r=e.item,i=e.target;if(!(!r||r.destroyed||r.hasLocked())){var o=r.getContainer();if(o.set("capture",!1),this.cachedCaptureItems||(this.cachedCaptureItems=[]),this.cachedCaptureItems.push(r),i){var a=i.get("isAnchorPoint");if(a)return}var s=this.graph;this.targets=[],this.targetCombo=null;var u=s.findAllByState("node",this.selectedState),c=r.get("id"),l=u.filter(function(f){var d=f.get("id");return c===d});if(l.length===0?this.targets.push(r):u.length>1?u.forEach(function(f){var d=f.hasLocked();d||n.targets.push(f)}):this.targets.push(r),this.graph.get("enabledStack")&&this.enableStack){var h=[];this.targets.forEach(function(f){var d=f.getModel(),p=d.x,g=d.y,v=d.id;h.push({x:p,y:g,id:v})}),this.set("beforeDragNodes",h)}this.hidenEdge={},this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(f){var d=f.getEdges();d.forEach(function(p){p.isVisible()&&(n.hidenEdge[p.getID()]=!0,p.hide())})}),this.origin=this.mousedown.origin,this.point={},this.originPoint={}}}},onDrag:function(t){var n=this;if(!(!this.mousedown||!this.origin)&&this.shouldUpdate(t,this))if(this.get("enableDelegate"))this.updateDelegate(t);else if(this.enableDebounce)this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:t,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos});else{var e={};this.targets.map(function(r){n.update(r,t);var i=r.getModel().comboId;i&&(e[i]=n.graph.findById(i))}),this.onlyChangeComboSize&&this.updateParentCombos()}},onDragEnd:function(t){var n=this,e;if(this.mousedown=!1,this.dragstart=!1,typeof window<"u"&&this.windowEventBinded&&(this.windowEventBinded=!1,document.body.removeEventListener("contextmenu",this.onDragEnd.bind(this)),document.body.removeEventListener("mouseup",this.onDragEnd.bind(this))),!!this.origin){(e=this.cachedCaptureItems)===null||e===void 0||e.forEach(function(o){var a=o.getContainer();a.set("capture",!0)}),this.cachedCaptureItems=[],this.delegateRect&&(this.delegateRect.remove(),this.delegateRect=null),this.get("updateEdge")&&this.enableOptimize&&!this.enableDelegate&&this.targets.forEach(function(o){var a=o.getEdges();a.forEach(function(s){n.hidenEdge[s.getID()]&&s.show(),s.refresh()})}),this.hidenEdge={};var r=this.graph;if(r.get("enabledStack")&&this.enableStack){var i={before:{nodes:[],edges:[],combos:[]},after:{nodes:[],edges:[],combos:[]}};this.get("beforeDragNodes").forEach(function(o){i.before.nodes.push(o)}),this.targets.forEach(function(o){var a=o.getModel(),s=a.x,u=a.y,c=a.id;i.after.nodes.push({x:s,y:u,id:c})}),r.pushStack("update",Xe(i))}r.emit("dragnodeend",{items:this.targets,targetItem:null}),this.point={},this.origin=null,this.originPoint={},this.targets.length=0,this.targetCombo=null}},onDropCombo:function(t){var n=t.item;if(this.currentShouldEnd=this.shouldEnd(t,n,this),this.updatePositions(t,!this.currentShouldEnd),!(!this.currentShouldEnd||!this.validationCombo(n))){var e=this.graph;if(this.comboActiveState&&e.setItemState(n,this.comboActiveState,!1),this.targetCombo=n,this.onlyChangeComboSize)e.updateCombos();else{var r=n.getModel();this.targets.map(function(i){var o=i.getModel();o.comboId!==r.id&&e.updateComboTree(i,r.id)}),e.updateCombo(n)}e.emit("dragnodeend",{items:this.targets,targetItem:this.targetCombo})}},onDropCanvas:function(t){var n=this.graph;this.currentShouldEnd=this.shouldEnd(t,void 0,this),this.updatePositions(t,!this.currentShouldEnd),!(!this.targets||this.targets.length===0||!this.currentShouldEnd)&&(this.onlyChangeComboSize?this.updateParentCombos():this.targets.map(function(e){var r=e.getModel();r.comboId&&n.updateComboTree(e)}))},onDropNode:function(t){if(!(!this.targets||this.targets.length===0)){var n=this,e=t.item,r=n.graph,i=e.getModel().comboId,o=i?r.findById(i):void 0;if(this.currentShouldEnd=this.shouldEnd(t,o,this),this.updatePositions(t,!this.currentShouldEnd),!!this.currentShouldEnd){if(this.onlyChangeComboSize)this.updateParentCombos();else if(i){var a=r.findById(i);n.comboActiveState&&r.setItemState(a,n.comboActiveState,!1),this.targets.map(function(s){var u=s.getModel();i!==u.comboId&&r.updateComboTree(s,i)}),r.updateCombo(a)}else this.targets.map(function(s){var u=s.getModel();u.comboId&&r.updateComboTree(s)});r.emit("dragnodeend",{items:this.targets,targetItem:e})}}},onDragEnter:function(t){var n=t.item;if(this.validationCombo(n)){var e=this.graph;this.comboActiveState&&e.setItemState(n,this.comboActiveState,!0)}},onDragLeave:function(t){var n=t.item;if(this.validationCombo(n)){var e=this.graph;this.comboActiveState&&e.setItemState(n,this.comboActiveState,!1)}},updatePositions:function(t,n){var e=this;!this.targets||this.targets.length===0||(this.get("enableDelegate")?this.enableDebounce?this.debounceUpdate({targets:this.targets,graph:this.graph,point:this.point,origin:this.origin,evt:t,updateEdge:this.get("updateEdge"),onlyChangeComboSize:this.onlyChangeComboSize,updateParentCombos:this.updateParentCombos}):n||this.targets.map(function(r){return e.update(r,t)}):this.targets.map(function(r){return e.update(r,t,n)}))},update:function(t,n,e){var r=this.origin,i=t.get("model"),o=t.get("id");this.point[o]||(this.point[o]={x:i.x||0,y:i.y||0});var a=n.x-r.x+this.point[o].x,s=n.y-r.y+this.point[o].y;e&&(a+=r.x-n.x,s+=r.y-n.y);var u={x:a,y:s};this.get("updateEdge")?this.graph.updateItem(t,u,!1):t.updatePosition(u)},debounceUpdate:Fl(function(t){var n=t.targets,e=t.graph,r=t.point,i=t.origin,o=t.evt,a=t.updateEdge,s=t.onlyChangeComboSize,u=t.updateParentCombos;n.map(function(c){var l=c.get("model"),h=c.get("id");r[h]||(r[h]={x:l.x||0,y:l.y||0});var f=o.x-i.x+r[h].x,d=o.y-i.y+r[h].y,p={x:f,y:d};a?e.updateItem(c,p,!1):c.updatePosition(p)}),s&&u(e,n)},50,!0),updateDelegate:function(t){var n=this.graph;if(this.delegateRect){var e=t.x-this.origin.x+this.originPoint.minX,r=t.y-this.origin.y+this.originPoint.minY;this.delegateRect.attr({x:e,y:r})}else{var i=n.get("group"),o=mn({},nl.delegateStyle,this.delegateStyle),a=this.calculationGroupPosition(t),s=a.x,u=a.y,c=a.width,l=a.height,h=a.minX,f=a.minY;this.originPoint={x:s,y:u,width:c,height:l,minX:h,minY:f},this.delegateRect=i.addShape("rect",{attrs:B({width:c,height:l,x:s,y:u},o),name:"rect-delegate-shape"}),this.delegate=this.delegateRect,this.delegateRect.set("capture",!1)}},calculationGroupPosition:function(t){var n=this.targets;n.length===0&&n.push(t.item);for(var e=1/0,r=-1/0,i=1/0,o=-1/0,a=0;a<n.length;a++){var s=n[a],u=s.getBBox(),c=u.minX,l=u.minY,h=u.maxX,f=u.maxY;c<e&&(e=c),l<i&&(i=l),h>r&&(r=h),f>o&&(o=f)}var d=Math.floor(e),p=Math.floor(i),g=Math.ceil(r)-Math.floor(e),v=Math.ceil(o)-Math.floor(i);return{x:d,y:p,width:g,height:v,minX:e,minY:i}},updateParentCombos:function(t,n){var e=t||this.graph,r=n||this.targets,i={};r==null||r.forEach(function(o){var a=o.getModel().comboId;a&&(i[a]=e.findById(a))}),Object.values(i).forEach(function(o){o&&e.updateCombo(o)})}},Tft={getDefaultCfg:function(){return{trigger:"mouseenter",activeState:"active",inactiveState:"inactive",resetSelected:!1,shouldUpdate:function(){return!0}}},getEvents:function(){return this.get("trigger")==="mouseenter"?{"node:mouseenter":"setAllItemStates","combo:mouseenter":"setAllItemStates","node:mouseleave":"clearActiveState","combo:mouseleave":"clearActiveState"}:{"node:click":"setAllItemStates","combo:click":"setAllItemStates","canvas:click":"clearActiveState","node:touchstart":"setOnTouchStart","combo:touchstart":"setOnTouchStart","canvas:touchstart":"clearOnTouchStart"}},setOnTouchStart:function(t){var n=this;try{var e=t.originalEvent.touches,r=e[0],i=e[1];if(r&&i)return;t.preventDefault()}catch{console.warn("Touch original event not exist!")}n.setAllItemStates(t)},clearOnTouchStart:function(t){var n=this;try{var e=t.originalEvent.touches,r=e[0],i=e[1];if(r&&i)return;t.preventDefault()}catch{console.warn("Touch original event not exist!")}n.clearActiveState(t)},setAllItemStates:function(t){clearTimeout(this.timer),this.throttleSetAllItemStates(t,this)},clearActiveState:function(t){var n=this;this.timer=setTimeout(function(){n.throttleClearActiveState(t,n)},50)},throttleSetAllItemStates:fl(function(t,n){var e=t.item,r=n.graph;if(!(!r||r.destroyed)&&(n.item=e,!!n.shouldUpdate(t.item,{event:t,action:"activate"},n))){for(var i=n.activeState,o=n.inactiveState,a=r.getNodes(),s=r.getCombos(),u=r.getEdges(),c=r.get("vedges"),l=a.length,h=s.length,f=u.length,d=c.length,p=n.inactiveItems||{},g=n.activeItems||{},v=0;v<l;v++){var m=a[v],y=m.getID(),b=m.hasState("selected");n.resetSelected&&b&&r.setItemState(m,"selected",!1),g[y]&&(r.setItemState(m,i,!1),delete g[y]),o&&!p[y]&&(r.setItemState(m,o,!0),p[y]=m)}for(var v=0;v<h;v++){var x=s[v],w=x.getID(),b=x.hasState("selected");n.resetSelected&&b&&r.setItemState(x,"selected",!1),g[w]&&(r.setItemState(x,i,!1),delete g[w]),o&&!p[w]&&(r.setItemState(x,o,!0),p[w]=x)}for(var v=0;v<f;v++){var E=u[v],M=E.getID();g[M]&&(r.setItemState(E,i,!1),delete g[M]),o&&!p[M]&&(r.setItemState(E,o,!0),p[M]=E)}for(var v=0;v<d;v++){var _=c[v],k=_.getID();g[k]&&(r.setItemState(_,i,!1),delete g[k]),o&&!p[k]&&(r.setItemState(_,o,!0),p[k]=_)}if(e&&!e.destroyed){o&&(r.setItemState(e,o,!1),delete p[e.getID()]),g[e.getID()]||(r.setItemState(e,i,!0),g[e.getID()]=e);for(var S=e.getEdges(),A=S.length,v=0;v<A;v++){var E=S[v],M=E.getID(),C=void 0;E.getSource()===e?C=E.getTarget():C=E.getSource();var I=C.getID();o&&p[I]&&(r.setItemState(C,o,!1),delete p[I]),g[I]||(r.setItemState(C,i,!0),g[I]=C),p[M]&&(r.setItemState(E,o,!1),delete p[M]),g[M]||(r.setItemState(E,i,!0),g[M]=E),E.toFront()}}n.activeItems=g,n.inactiveItems=p,r.emit("afteractivaterelations",{item:t.item,action:"activate"})}},50,{trailing:!0,leading:!0}),throttleClearActiveState:fl(function(t,n){var e=n.get("graph");if(!(!e||e.destroyed)&&n.shouldUpdate(t.item,{event:t,action:"deactivate"},n)){var r=n.activeState,i=n.inactiveState,o=n.activeItems||{},a=n.inactiveItems||{};Object.values(o).filter(function(s){return!s.destroyed}).forEach(function(s){e.clearItemStates(s,r)}),Object.values(a).filter(function(s){return!s.destroyed}).forEach(function(s){e.clearItemStates(s,i)}),n.activeItems={},n.inactiveItems={},e.emit("afteractivaterelations",{item:t.item||n.get("item"),action:"deactivate"})}},50,{trailing:!0,leading:!0})};var zf=Math.min,z_=Math.max,G_=Math.abs,U_="shift",Oft=["drag","shift","ctrl","alt","control"];const Nft={getDefaultCfg:function(){return{brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:U_,includeEdges:!0,includeCombos:!1,selectedEdges:[],selectedNodes:[],selectedCombos:[]}},getEvents:function(){return Oft.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=U_,console.warn("Behavior brush-select 的 trigger 参数不合法，请输入 'drag'、'shift'、'ctrl' 或 'alt'")),this.trigger==="drag"?{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates"}:{dragstart:"onMouseDown",drag:"onMouseMove",dragend:"onMouseUp","canvas:click":"clearStates",keyup:"onKeyUp",keydown:"onKeyDown"}},onMouseDown:function(t){var n=t.item,e=this.brush;n||this.trigger!=="drag"&&!this.keydown||(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates(),e||(e=this.createBrush()),this.originPoint={x:t.canvasX,y:t.canvasY},e.attr({width:0,height:0}),e.show(),this.dragging=!0)},onMouseMove:function(t){this.dragging&&(this.trigger!=="drag"&&!this.keydown||this.updateBrush(t))},onMouseUp:function(t){this.graph,!(!this.brush&&!this.dragging)&&(this.trigger!=="drag"&&!this.keydown||(this.brush.remove(!0),this.brush=null,this.getSelectedNodes(t),this.dragging=!1))},clearStates:function(){var t=this,n=t.graph,e=t.selectedState,r=n.findAllByState("node",e),i=n.findAllByState("edge",e),o=n.findAllByState("combo",e);r.forEach(function(a){return n.setItemState(a,e,!1)}),i.forEach(function(a){return n.setItemState(a,e,!1)}),o.forEach(function(a){return n.setItemState(a,e,!1)}),this.selectedNodes=[],this.selectedEdges=[],this.selectedCombos=[],this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges,this.selectedCombos),n.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})},isBBoxCenterInRect:function(t,n,e,r,i){var o=t.getBBox();return o.centerX>=n&&o.centerX<=e&&o.centerY>=r&&o.centerY<=i},getSelectedNodes:function(t){var n=this,e=this,r=e.graph,i=e.originPoint,o=e.shouldUpdate,a=e.isBBoxCenterInRect,s=this.selectedState,u={x:t.x,y:t.y},c=r.getPointByCanvas(i.x,i.y),l=zf(u.x,c.x),h=z_(u.x,c.x),f=zf(u.y,c.y),d=z_(u.y,c.y),p=[],g=[];r.getNodes().forEach(function(y){if(y.isVisible()&&a(y,l,h,f,d)&&o(y,"select",n)){p.push(y);var b=y.getModel();g.push(b.id),r.setItemState(y,s,!0)}});var v=[];this.includeEdges&&p.forEach(function(y){var b=y.getOutEdges();b.forEach(function(x){if(x.isVisible()){var w=x.getModel(),E=w.source,M=w.target;g.includes(E)&&g.includes(M)&&o(x,"select",n)&&(v.push(x),r.setItemState(x,n.selectedState,!0))}})});var m=[];this.includeCombos&&r.getCombos().forEach(function(y){if(y.isVisible()&&a(y,l,h,f,d)&&o(y,"select",n)){m.push(y);var b=y.getModel();g.push(b.id),r.setItemState(y,s,!0)}}),this.selectedEdges=v,this.selectedNodes=p,this.selectedCombos=m,this.onSelect&&this.onSelect(p,v,m),r.emit("nodeselectchange",{selectedItems:{nodes:p,edges:v,combos:m},select:!0})},createBrush:function(){var t=this,n=t.graph.get("canvas").addShape("rect",{attrs:t.brushStyle,capture:!1,name:"brush-shape"});return this.brush=n,this.delegate=n,n},updateBrush:function(t){var n=this.originPoint;this.brush.attr({width:G_(t.canvasX-n.x),height:G_(t.canvasY-n.y),x:zf(t.canvasX,n.x),y:zf(t.canvasY,n.y)})},onKeyDown:function(t){var n=t.key;if(n){var e=this.trigger.toLowerCase(),r=n.toLowerCase();r===e||r==="control"&&e==="ctrl"||r==="ctrl"&&e==="control"?this.keydown=!0:this.keydown=!1}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.keydown=!1}};var Y_="shift",Dft=["shift","ctrl","alt","control"];const Pft={getDefaultCfg:function(){return{multiple:!0,trigger:Y_,selectedState:"selected",selectNode:!0,selectEdge:!1,selectCombo:!0}},getEvents:function(){var t=this;return Dft.indexOf(t.trigger.toLowerCase())>-1||(t.trigger=Y_,console.warn("Behavior click-select 的 trigger 参数不合法，请输入 'drag'、'shift'、'ctrl' 或 'alt'")),t.multiple?{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick",keyup:"onKeyUp",keydown:"onKeyDown"}:{"node:click":"onClick","combo:click":"onClick","edge:click":"onClick","canvas:click":"onCanvasClick"}},onClick:function(t){var n=this,e=t.item;if(!(!e||e.destroyed)){var r=e.getType(),i=n.graph,o=n.keydown,a=n.multiple,s=n.shouldUpdate,u=n.shouldBegin;if(u(t,n)){if(!o||!a){var c=i.findAllByState("node",n.selectedState).concat(i.findAllByState("edge",n.selectedState)).concat(i.findAllByState("combo",n.selectedState));mt(c,function(p){p!==e&&i.setItemState(p,n.selectedState,!1)})}var l=function(){switch(r){case"node":return n.selectNode;case"edge":return n.selectEdge;case"combo":return n.selectCombo;default:return!1}}();if(!l){var h=i.findAllByState("node",n.selectedState),f=i.findAllByState("edge",n.selectedState),d=i.findAllByState("combo",n.selectedState);i.emit("nodeselectchange",{selectedItems:{nodes:h,edges:f,combos:d},select:!1});return}if(e.hasState(n.selectedState)){s(t,n)&&i.setItemState(e,n.selectedState,!1);var h=i.findAllByState("node",n.selectedState),f=i.findAllByState("edge",n.selectedState),d=i.findAllByState("combo",n.selectedState);i.emit("nodeselectchange",{target:e,selectedItems:{nodes:h,edges:f,combos:d},select:!1})}else{s(t,n)&&i.setItemState(e,n.selectedState,!0);var h=i.findAllByState("node",n.selectedState),f=i.findAllByState("edge",n.selectedState),d=i.findAllByState("combo",n.selectedState);i.emit("nodeselectchange",{target:e,selectedItems:{nodes:h,edges:f,combos:d},select:!0})}}}},onCanvasClick:function(t){var n=this,e=this,r=e.graph,i=e.shouldBegin;if(i(t,this)){var o=r.findAllByState("node",this.selectedState);mt(o,function(u){r.setItemState(u,n.selectedState,!1)});var a=r.findAllByState("edge",this.selectedState);mt(a,function(u){r.setItemState(u,n.selectedState,!1)});var s=r.findAllByState("combo",this.selectedState);mt(s,function(u){r.setItemState(u,n.selectedState,!1)}),r.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[],combos:[]},select:!1})}},onKeyDown:function(t){var n=this,e=t.key;e&&(e.toLowerCase()===this.trigger.toLowerCase()||e.toLowerCase()==="control"?n.keydown=!0:n.keydown=!1)},onKeyUp:function(){var t=this;t.keydown=!1}};var Lft=yi,Gf=.05;const jft={getDefaultCfg:function(){return this.isFireFox=PN()==="firefox",{sensitivity:2,minZoom:void 0,maxZoom:void 0,enableOptimize:!1,optimizeZoom:.1,fixSelectedItems:{fixAll:!1,fixLineWidth:!1,fixLabel:!1,fixState:"selected"},animate:!1,animateCfg:{duration:500}}},getEvents:function(){var t=this.fixSelectedItems;return t.fixState||(t.fixState="selected"),t.fixAll&&(t.fixLineWidth=!0,t.fixLabel=!0),{wheel:"onWheel",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd"}},onTouchStart:function(t){var n=t.originalEvent.touches,e=n[0],r=n[1];t.preventDefault(),r&&(this.shouldBegin&&!this.shouldBegin(t,this)||(this.startPoint={pageX:e.pageX,pageY:e.pageY},this.moveable=!0,r&&(this.endPoint={pageX:r.pageX,pageY:r.pageY}),this.originScale=this.graph.getZoom()||this.currentScale||1))},onTouchMove:function(t){if(this.moveable){t.preventDefault();var n=t.originalEvent.touches,e=n[0],r=n[1];if(r){this.endPoint||(this.endPoint={pageX:r.pageX,pageY:r.pageY});var i=function(d,p){return Math.hypot(p.x-d.x,p.y-d.y)},o=i({x:e.pageX,y:e.pageY},{x:r.pageX,y:r.pageY})/i({x:this.startPoint.pageX,y:this.startPoint.pageY},{x:this.endPoint.pageX,y:this.endPoint.pageY}),a=this.originScale*o;this.currentScale=a;var s=this.get("minZoom")||this.graph.get("minZoom"),u=this.get("maxZoom")||this.graph.get("maxZoom");if(!(a>u||a<s)){var c=this.get("animate"),l=this.get("animateCfg"),h=this.graph.get("canvas"),f=h.getPointByClient(t.clientX,t.clientY);this.graph.zoomTo(a,{x:f.x,y:f.y},c,l),this.graph.emit("wheelzoom",t)}}}},onTouchEnd:function(){this.moveable=!1,this.endPoint=null},onWheel:function(t){var n=this,e=this,r=e.graph,i=e.fixSelectedItems;if(!(this.shouldBegin&&!this.shouldBegin(t,this))&&this.shouldUpdate(t,this)){t.preventDefault();var o=r.get("canvas"),a=o.getPointByClient(t.clientX,t.clientY),s=this.get("sensitivity"),u=r.getZoom(),c=u,l=u;this.isFireFox?t.deltaY>0||t.wheelDelta<0?c=1-Gf*s:c=1/(1-Gf*s):t.wheelDelta<0?c=1-Gf*s:c=1/(1-Gf*s),l=u*c;var h=this.get("minZoom")||r.get("minZoom"),f=this.get("maxZoom")||r.get("maxZoom");l>f?l=f:l<h&&(l=h);var d=this.get("enableOptimize");if(d){var p=this.get("optimizeZoom"),g=this.get("optimized"),v=r.getNodes(),m=r.getEdges(),y=v.length,b=m.length;if(!g){for(var x=0;x<y;x++){var w=v[x];if(!w.destroyed)for(var E=w.get("group").get("children"),M=E.length,_=0;_<M;_++){var k=E[_];!k.destoryed&&!k.get("isKeyShape")&&(k.set("ori-visibility",k.get("ori-visibility")||k.get("visible")),k.hide())}}for(var S=0;S<b;S++)for(var A=m[S],E=A.get("group").get("children"),M=E.length,_=0;_<M;_++){var k=E[_];k.set("ori-visibility",k.get("ori-visibility")||k.get("visible")),k.hide()}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var C=setTimeout(function(){var Wt=r.getZoom(),ee=n.get("optimized");if(ee){n.set("optimized",!1);for(var ot=0;ot<y;ot++){var O=v[ot],ct=O.get("group").get("children"),Xt=ct.length;if(Wt<p){var jt=O.getKeyShape(),te=jt.get("ori-visibility");jt.set("ori-visibility",void 0),te&&jt.show()}else for(var _t=0;_t<Xt;_t++){var Zt=ct[_t],te=Zt.get("ori-visibility");Zt.set("ori-visibility",void 0),!Zt.get("visible")&&te&&te&&Zt.show()}}for(var me=0;me<b;me++){var Ce=m[me],ct=Ce.get("group").get("children"),Xt=ct.length;if(Wt<p){var jt=Ce.getKeyShape(),te=jt.get("ori-visibility");jt.set("ori-visibility",void 0),te&&jt.show()}else for(var _t=0;_t<Xt;_t++){var Zt=ct[_t];if(!Zt.get("visible")){var te=Zt.get("ori-visibility");Zt.set("ori-visibility",void 0),te&&Zt.show()}}}}},100);this.set("timeout",C)}if(u<=1){var I=void 0,N=void 0;if(i.fixAll||i.fixLineWidth||i.fixLabel){I=r.findAllByState("node",i.fixState),N=r.findAllByState("edge",i.fixState);for(var D=u/l,P=I.length,j=0;j<P;j++){var w=I[j],L=w.getContainer(),R=w.getModel(),V=w.getOriginStyle(),tt=w.getStateStyle(i.fixState),ut=w.get("shapeFactory").getShape(R.type).getStateStyle(i.fixState,w)[i.fixState];if(i.fixAll){if(l<=1){var dt=Xe(L.getMatrix());dt||(dt=[1,0,0,0,1,0,0,0,1]);var J=w.getModel(),Et=J.x,Bt=J.y;dt=Lft(dt,[["t",-Et,-Bt],["s",D,D],["t",Et,Bt]]),L.setMatrix(dt)}}else for(var E=L.get("children"),M=E.length,_=0;_<M;_++){var k=E[_],Vt=void 0,se=void 0;if(i.fixLabel){var re=k.get("type");if(re==="text"){Vt=k.attr("fontSize")||12;var ue=tt[k.get("name")],de=ut[k.get("name")],Ze=ue?ue.fontSize:12,Ne=de?de.fontSize:12,Re=Ze||Ne||12;if(l<=1&&k.attr("fontSize",Re/l),se)break}}if(i.fixLineWidth&&k.get("isKeyShape")){se=k.attr("lineWidth")||0;var pn=tt.lineWidth||ut.lineWidth||V.lineWidth||0;if(l<=1&&k.attr("lineWidth",pn/l),Vt)break}}}for(var en=N.length,fn=0;fn<en;fn++)for(var A=N[fn],L=A.getContainer(),E=L.get("children"),R=A.getModel(),tt=A.getStateStyle(i.fixState),ut=A.get("shapeFactory").getShape(R.type).getStateStyle(i.fixState,A)[i.fixState],M=E.length,_=0;_<M;_++){var k=E[_],Vt=void 0,se=void 0;if(i.fixLabel||i.fixAll){var re=k.get("type");if(re==="text"){Vt=k.attr("fontSize")||12;var ue=tt[k.get("name")],de=ut[k.get("name")],Ze=ue?ue.fontSize:12,Ne=de?de.fontSize:12,Re=Ze||Ne||12;if(l<=1&&k.attr("fontSize",Re/l),se)break}}if((i.fixLineWidth||i.fixAll)&&k.get("isKeyShape")){se=k.attr("lineWidth")||0;var pn=tt.lineWidth||ut.lineWidth||1;if(l<=1&&k.attr("lineWidth",pn/l),Vt)break}}}}var De=this.get("animate"),Vn=this.get("animateCfg");r.zoomTo(l,{x:a.x,y:a.y},De,Vn),r.emit("wheelzoom",t)}}},h5={onMouseEnter:function(t){var n=t.item;this.currentTarget=n,this.showTooltip(t),this.graph.emit("tooltipchange",{item:t.item,action:"show"})},onMouseMove:function(t){if(!this.shouldUpdate(t,this)){this.hideTooltip();return}!this.currentTarget||t.item!==this.currentTarget||this.updatePosition(t)},onMouseLeave:function(t){this.shouldEnd(t,this)&&(this.hideTooltip(),this.graph.emit("tooltipchange",{item:this.currentTarget,action:"hide"}),this.currentTarget=null)},showTooltip:function(t){var n=this.container;if(!(!t.item||t.item.destroyed)){n||(n=this.createTooltip(this.graph.get("canvas")),this.container=n);var e=this.formatText(t.item.get("model"),t);n.innerHTML=e,Ve(this.container,{visibility:"visible"}),this.updatePosition(t)}},hideTooltip:function(){Ve(this.container,{visibility:"hidden"})},updatePosition:function(t){var n=this.get("shouldBegin"),e=this,r=e.width,i=e.height,o=e.container,a=e.graph;if(!n(t,this)){Ve(o,{visibility:"hidden"});return}var s=a.getPointByClient(t.clientX,t.clientY),u=a.getCanvasByPoint(s.x,s.y),c=u.x,l=u.y,h=o.getBoundingClientRect();c>r/2?c-=h.width:c+=this.offset,l>i/2?l-=h.height:l+=this.offset;var f="".concat(c,"px"),d="".concat(l,"px");Ve(this.container,{left:f,top:d,visibility:"visible"})},createTooltip:function(t){var n=t.get("el");n.style.position="relative";var e=Mn('<div class="g6-tooltip g6-'.concat(this.item,'-tooltip"></div>'));return n.parentNode.appendChild(e),Ve(e,{position:"absolute",visibility:"visible"}),this.width=t.get("width"),this.height=t.get("height"),this.container=e,this.graph.get("tooltips").push(e),e}},Rft=B({getDefaultCfg:function(){return{item:"node",offset:12,formatText:function(t){return t.label}}},getEvents:function(){return{"node:mouseenter":"onMouseEnter","node:mouseleave":"onMouseLeave","node:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},h5),Fft=B({getDefaultCfg:function(){return{item:"edge",offset:12,formatText:function(t){return"source: ".concat(t.source," target: ").concat(t.target)}}},getEvents:function(){return{"edge:mouseenter":"onMouseEnter","edge:mouseleave":"onMouseLeave","edge:mousemove":"onMouseMove",afterremoveitem:"onMouseLeave"}}},h5);var V_="click",Bft=["click","dblclick"];const zft={getDefaultCfg:function(){return{trigger:V_,onChange:function(){}}},getEvents:function(){var t,n;return Bft.includes(this.trigger)?n=this.trigger:(n=V_,console.warn("Behavior collapse-expand 的 trigger 参数不合法，请输入 'click' 或 'dblclick'")),t={},t["node:".concat(n)]="onNodeClick",t.touchstart="onNodeClick",t},onNodeClick:function(t){var n=this;if(this.trigger==="click"){if(this.timer){clearTimeout(this.timer),this.timer=0;return}this.timer=setTimeout(function(){n.toggle(t),clearTimeout(n.timer),n.timer=0},200)}else this.toggle(t)},toggle:function(t){var n=t.item;if(n){var e=this.graph.findDataById(n.get("id"));if(e){var r=e.children;if(!(!r||r.length===0)){var i=!e.collapsed;this.shouldBegin(t,i,this)&&(e.collapsed=i,n.getModel().collapsed=i,this.graph.emit("itemcollapsed",{item:t.item,collapsed:i}),this.shouldUpdate(t,i,this)&&(this.onChange(n,i,this),this.graph.layout()))}}}}};var Gft=za.calculationItemsBBox,Uft=function t(n,e){if(e(n)!==!1&&n){var r=n.get("combos");if(r.length===0)return!1;mt(r,function(i){t(i,e)})}};const Yft={getDefaultCfg:function(){return{enableDelegate:!1,delegateStyle:{},onlyChangeComboSize:!1,activeState:"",selectedState:"selected",enableStack:!0}},getEvents:function(){return{"combo:mousedown":"onMouseDown","combo:dragstart":"onDragStart","combo:drag":"onDrag","combo:dragend":"onDragEnd","combo:drop":"onDrop","node:drop":"onNodeDrop","combo:dragenter":"onDragEnter","combo:dragleave":"onDragLeave"}},validationCombo:function(t){var n=t.item;if(!n||n.destroyed||!this.shouldUpdate(t,this))return!1;var e=n.getType();return e==="combo"},onMouseDown:function(t){this.origin={x:t.x,y:t.y}},onDragStart:function(t){var n=this,e=this.graph,r=t.item;if(this.currentShouldEnd=!0,!!this.validationCombo(t)){this.targets=[];var i=e.findAllByState("combo",this.selectedState),o=r.get("id"),a=i.filter(function(u){var c=u.get("id");return o===c});a.length===0?this.targets.push(r):this.targets=i;var s=[];this.targets.forEach(function(u){var c=u.getModel(),l=c.x,h=c.y,f=c.id;s.push({x:l,y:h,id:f})}),this.set("beforeDragItems",s),this.activeState&&this.targets.map(function(u){var c=u.getModel();if(c.parentId){var l=e.findById(c.parentId);l&&e.setItemState(l,n.activeState,!0)}}),this.point={},this.originPoint={},this.currentItemChildCombos=[],Uft(r,function(u){if(u.destroyed)return!1;var c=u.getModel();return n.currentItemChildCombos.push(c.id),!0})}},onDrag:function(t){var n=this;if(this.origin&&this.validationCombo(t))if(this.enableDelegate)this.updateDelegate(t);else{if(this.activeState){var e=this.graph,r=t.item,i=r.getModel(),o=e.getCombos(),a=r.getBBox(),s=a.centerX,u=a.centerY,c=a.width,l=o.filter(function(h){var f=h.getModel();return i.parentId,f.id!==i.id&&!n.currentItemChildCombos.includes(f.id)});l.map(function(h){var f=h.getBBox(),d=f.centerX,p=f.centerY,g=f.width,v=s-d,m=u-p,y=2*Math.sqrt(v*v+m*m);c+g-y>.8*c?e.setItemState(h,n.activeState,!0):e.setItemState(h,n.activeState,!1)})}mt(this.targets,function(h){n.updateCombo(h,t)}),this.onlyChangeComboSize&&this.updateParentCombos()}},updatePositions:function(t,n){var e=this;(this.enableDelegate||n)&&mt(this.targets,function(r){e.updateCombo(r,t,n)})},onDrop:function(t){var n=this,e=t.item;if(this.currentShouldEnd=this.shouldEnd(t,e,this),this.updatePositions(t,!this.currentShouldEnd),!(!this.currentShouldEnd||!e||!this.targets||e.destroyed)){var r=this.graph,i=e.getModel();this.targets.map(function(o){var a=o.getModel();a.parentId!==i.id?(n.activeState&&r.setItemState(e,n.activeState,!1),n.onlyChangeComboSize?r.updateCombo(o):r.updateComboTree(o,i.id,!1)):r.updateCombo(e)}),this.end(e,t),this.endComparison=!0}},onNodeDrop:function(t){var n=this;if(!(!this.targets||this.targets.length===0)){var e=this.graph,r=t.item,i=r.getModel().comboId,o=i?e.findById(i):void 0;if(this.currentShouldEnd=this.shouldEnd(t,o,this),this.updatePositions(t,!this.currentShouldEnd),!!this.currentShouldEnd){var a;if(i){if(this.activeState){var s=e.findById(i);e.setItemState(s,this.activeState,!1)}this.targets.map(function(u){n.onlyChangeComboSize?e.updateCombo(u):i!==u.getID()&&(a=e.findById(i),i!==u.getModel().parentId&&e.updateComboTree(u,i,!1))})}else this.targets.map(function(u){if(n.onlyChangeComboSize)e.updateCombo(u);else{var c=u.getModel();c.comboId&&e.updateComboTree(u,void 0,!1)}});this.endComparison=!0,this.end(a,t)}}},onDragEnter:function(t){if(this.origin&&this.validationCombo(t)){var n=t.item,e=this.graph;this.activeState&&e.setItemState(n,this.activeState,!0)}},onDragLeave:function(t){if(this.origin&&this.validationCombo(t)){var n=t.item,e=this.graph;this.activeState&&e.setItemState(n,this.activeState,!1)}},onDragEnd:function(t){if(!(!this.targets||this.targets.length===0)){var n=t.item;this.currentShouldEnd&&this.updatePositions(t);var e=this.getParentCombo(n.getModel().parentId),r=this.graph;e&&this.activeState&&r.setItemState(e,this.activeState,!1),this.end(void 0,t)}},end:function(t,n){var e=this;if(this.origin){var r=this.graph;if(this.delegateShape){var i=r.get("delegateGroup");i.clear(),this.delegateShape=null}if(t&&this.activeState&&r.setItemState(t,this.activeState,!1),!t){var o=r.get("enabledStack")&&this.enableStack,a={before:{nodes:[],edges:[],combos:[].concat(this.get("beforeDragItems"))},after:{nodes:[],edges:[],combos:[]}};this.targets.map(function(s){if(!e.onlyChangeComboSize)r.updateComboTree(s,void 0,o);else{r.updateCombo(s);var u=s.getModel(),c=u.x,l=u.y,h=u.id;a.after.combos.push({x:c,y:l,id:h}),r.pushStack("update",a)}})}this.point=[],this.origin=null,this.originPoint=null,this.targets.length=0}},traverse:function(t,n,e){var r=this;if(e===void 0&&(e={}),n(t,e)!==!1&&t){var i=t.get("combos");mt(i,function(a){r.traverse(a,n,e)});var o=t.get("nodes");mt(o,function(a){r.traverse(a,n,e)})}},updateCombo:function(t,n,e){this.updateSingleItem(t,n,e);var r={};this.traverse(t,function(i,o){return i.destroyed?!1:(i.getEdges().forEach(function(a){return o[a.getID()]=a}),!0)},r),Object.values(r).forEach(function(i){return i.refresh()})},updateSingleItem:function(t,n,e){var r=this.origin,i=this.graph,o=t.getModel(),a=t.get("id");this.point[a]||(this.point[a]={x:o.x,y:o.y});var s=n.x-r.x+this.point[a].x,u=n.y-r.y+this.point[a].y;e&&(s+=r.x-n.x,u+=r.y-n.y),i.updateItem(t,{x:s,y:u},!1)},getParentCombo:function(t){var n=this.graph;if(t){var e=n.findById(t);if(e)return e}},updateDelegate:function(t){var n=this.graph;if(this.delegateShape){var e=t.x-this.origin.x+this.originPoint.minX,r=t.y-this.origin.y+this.originPoint.minY;this.delegateShape.attr({x:e,y:r})}else{var i=n.get("delegateGroup"),o=null;this.targets.length>1?o=Gft(this.targets):o=this.targets[0].getBBox();var a=o.x,s=o.y,u=o.width,c=o.height,l=o.minX,h=o.minY;this.originPoint={x:a,y:s,width:u,height:c,minX:l,minY:h};var f=B(B({},nl.delegateStyle),this.delegateStyle);this.delegateShape=i.addShape("rect",{attrs:B({width:o.width,height:o.height,x:o.x,y:o.y},f),name:"combo-delegate-shape"}),this.delegateShape.set("capture",!1),this.delegate=this.delegateShape}},updateParentCombos:function(){var t=this,n=t.graph,e=t.targets,r={};e==null||e.forEach(function(i){var o=i.getModel().parentId;o&&(r[o]=n.findById(o))}),Object.values(r).forEach(function(i){i&&n.updateCombo(i)})}};var W_="dblclick",Vft=["click","dblclick"];const Wft={getDefaultCfg:function(){return{trigger:W_,relayout:!0}},getEvents:function(){var t,n;return Vft.includes(this.trigger)?n=this.trigger:(n=W_,console.warn("Behavior collapse-expand-group 的 trigger 参数不合法，请输入 'click' 或 'dblclick'")),t={},t["combo:".concat(n)]="onComboClick",t},onComboClick:function(t){var n=t.item,e=this,r=e.graph,i=e.relayout;if(!(!n||n.destroyed||n.getType()!=="combo")){var o=n.getModel(),a=o.id;a&&(r.collapseExpandCombo(a),i&&r.get("layout")?r.layout():r.refreshPositions())}}};var Xft=za.isPolygonsIntersect,Hft=za.pathToPoints,X_="shift",qft=["drag","shift","ctrl","alt","control"],Zft=function(t,n){var e,r=t.getKeyShape();if(t.get("type")==="path")e=Hft(r.attr("path"));else{var i=r.getCanvasBBox();e=[[i.minX,i.minY],[i.maxX,i.minY],[i.maxX,i.maxY],[i.minX,i.maxY]]}return Xft(n,e)};const Kft={getDefaultCfg:function(){return{delegateStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},shouldDeselect:void 0,selectedState:"selected",trigger:X_,includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){return qft.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=X_,console.warn("Behavior lasso-select 的 trigger 参数不合法，请输入 'drag'、'shift'、'ctrl' 或 'alt'")),this.trigger==="drag"?{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd","canvas:click":"clearStates"}:{dragstart:"onDragStart",drag:"onDragMove",dragend:"onDragEnd",keyup:"onKeyUp",keydown:"onKeyDown","canvas:click":"clearStates"}},onDragStart:function(t){var n=this.lasso,e=t.item;e||this.trigger!=="drag"&&!this.keydown||(this.selectedNodes&&this.selectedNodes.length!==0&&this.clearStates("dragstart"),n||(n=this.createLasso()),this.dragging=!0,this.originPoint={x:t.x,y:t.y},this.points.push(this.originPoint),n.show())},onDragMove:function(t){this.dragging&&(this.trigger!=="drag"&&!this.keydown||(this.points.push({x:t.x,y:t.y}),this.updateLasso(t)))},onDragEnd:function(t){!this.lasso&&!this.dragging||this.trigger!=="drag"&&!this.keydown||(this.points.push(this.originPoint),this.getSelectedItems(),this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1)},getLassoPath:function(){var t=this.points,n=[];return t.length&&(t.forEach(function(e,r){r===0?n.push(["M",e.x,e.y]):n.push(["L",e.x,e.y])}),n.push(["L",t[0].x,t[0].y])),n},clearStates:function(t){t===void 0&&(t="canvas:click");var n=this,e=n.graph,r=n.selectedState,i=n.shouldDeselect,o=e.findAllByState("node",r),a=e.findAllByState("edge",r);(!i||i({action:t,nodes:o,edges:a}))&&(o.forEach(function(s){return e.setItemState(s,r,!1)}),a.forEach(function(s){return e.setItemState(s,r,!1)})),this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),this.selectedNodes=[],this.selectedEdges=[],e.emit("nodeselectchange",{selectedItems:{nodes:[],edges:[]},select:!1})},getSelectedItems:function(){var t=this,n=this,e=n.graph,r=n.shouldUpdate,i=this.points.map(function(c){return[e.getCanvasByPoint(c.x,c.y).x,e.getCanvasByPoint(c.x,c.y).y]}),o=this.selectedState,a=[],s=[];e.getNodes().forEach(function(c){if(c.isVisible()&&Zft(c,i)&&r(c,"select",t)){a.push(c);var l=c.getModel();s.push(l.id),e.setItemState(c,o,!0)}});var u=[];this.includeEdges&&a.forEach(function(c){var l=c.getOutEdges();l.forEach(function(h){if(h.isVisible()){var f=h.getModel(),d=f.source,p=f.target;s.includes(d)&&s.includes(p)&&r(h,"select",t)&&(u.push(h),e.setItemState(h,t.selectedState,!0))}})}),this.selectedEdges=u,this.selectedNodes=a,this.onSelect&&this.onSelect(a,u),e.emit("nodeselectchange",{selectedItems:{nodes:a,edges:u},select:!0})},createLasso:function(){var t=this,n=t.graph.get("delegateGroup").addShape("path",{attrs:B({path:[]},t.delegateStyle),capture:!1,name:"lasso-shape"});return this.lasso=n,this.delegate=n,this.points=[],n},updateLasso:function(t){var n=this;this.lasso.attr({path:n.getLassoPath()})},onKeyDown:function(t){var n=t.key;n&&(n.toLowerCase()===this.trigger.toLowerCase()?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.lasso&&(this.lasso.remove(!0),this.lasso=null,this.points=[],this.dragging=!1),this.keydown=!1}};var H_="click",Qft=["click","drag"],q_=void 0,Jft=["shift","ctrl","control","alt","meta",void 0];const $ft={getDefaultCfg:function(){return{trigger:H_,key:q_,edgeConfig:{},getEdgeConfig:void 0}},getEvents:function(){var t=this;Qft.indexOf(t.trigger.toLowerCase())>-1||(t.trigger=H_,console.warn("Behavior create-edge 的 trigger 参数不合法，请输入 'click'，'drag'")),t.key&&Jft.indexOf(t.key.toLowerCase())===-1&&(t.trigger=q_,console.warn("Behavior create-edge 的 key 参数不合法，请输入 'shift'，'ctrl'，'alt'，'control'，或 undefined"));var n;return t.trigger==="drag"?n={"node:dragstart":"onClick","combo:dragstart":"onClick",drag:"updateEndPoint","node:drop":"onClick","combo:drop":"onClick",dragend:"onDragEnd"}:t.trigger==="click"&&(n={"node:click":"onClick",mousemove:"updateEndPoint","edge:click":"cancelCreating","canvas:click":"cancelCreating","combo:click":"onClick"}),t.key&&(n.keydown="onKeyDown",n.keyup="onKeyUp"),n},onDragEnd:function(t){var n=this;if(!(n.key&&!n.keydown)){var e=t.item;(!e||e.getID()===n.source||e.getType()!=="node")&&n.cancelCreating({item:n.edge,x:t.x,y:t.y})}},onClick:function(t){var n=this;if(!(n.key&&!n.keydown)){var e=t.item,r=n.graph,i=e.getModel(),o=n.getEdgeConfig;if(n.addingEdge&&n.edge){if(!n.shouldEnd(t,n))return;var a=void 0;o&&An(o)?a=o({source:n.source,target:i.id},n):a=n.edgeConfig;var s=B({target:i.id},a);if(n.source===i.id&&(s.type="loop"),r.emit("beforecreateedge",{}),r.updateItem(n.edge,s,!1),r.get("enabledStack")){var u=B(B({},n.edge.getModel()),{itemType:"edge"}),c={};c.edges=[u],r.pushStack("add",{before:{},after:c})}r.emit("aftercreateedge",{edge:n.edge}),n.edge.getKeyShape().set("capture",!0),n.edge=null,n.addingEdge=!1}else{if(!n.shouldBegin(t,n))return;var a=void 0;o&&An(o)?a=o({source:i.id,target:i.id},n):a=n.edgeConfig,n.edge=r.addItem("edge",B({source:i.id,target:i.id},a),!1),n.source=i.id,n.addingEdge=!0,n.edge.getKeyShape().set("capture",!1)}}},updateEndPoint:function(t){var n=this;if(!(n.key&&!n.keydown)){n.edge&&n.edge.destroyed&&n.cancelCreating({item:n.edge});var e={x:t.x,y:t.y};if(!n.graph.findById(n.source)){n.addingEdge=!1;return}n.addingEdge&&n.edge&&n.graph.updateItem(n.edge,{target:e},!1)}},cancelCreating:function(t){var n,e,r=this;if(!(r.key&&!r.keydown)){var i=r.graph,o=t.item;if(r.addingEdge&&(r.edge===o||!((e=(n=t.target)===null||n===void 0?void 0:n.isCanvas)===null||e===void 0)&&e.call(n))){r.edge&&!r.edge.destroyed&&i.removeItem(r.edge,!1),r.edge=null,r.addingEdge=!1;return}}},onKeyDown:function(t){var n=this,e=t.key;e&&(e.toLowerCase()===n.key.toLowerCase()?n.keydown=!0:n.keydown=!1)},onKeyUp:function(){var t=this;t.addingEdge&&t.edge&&(t.graph.removeItem(t.edge,!1),t.addingEdge=!1,t.edge=null),this.keydown=!1}};var Z_="ctrl",tdt=["shift","ctrl","alt","control"],edt="1";const ndt={getDefaultCfg:function(){return{trigger:Z_,combinedKey:edt,functionName:"fitView",functionParams:[]}},getEvents:function(){return tdt.indexOf(this.trigger.toLowerCase())>-1||(this.trigger=Z_,console.warn("Behavior shortcuts-fit-view 的 trigger 参数 '".concat(this.trigger,"' 不合法，请输入 'drag'、'shift'、'ctrl' 或 'alt'"))),this.combinedKey===this.trigger&&(this.combinedKey=void 0),{keyup:"onKeyUp",keydown:"onKeyDown"}},onKeyDown:function(t){var n=t.key;if(n){var e=this.trigger.toLowerCase(),r=n.toLowerCase();this.triggerKeydown||(r===e||r==="control"&&e==="ctrl"||r==="ctrl"&&e==="control"?this.triggerKeydown=!0:this.triggerKeydown=!1);var i=this.graph;if(!i[this.functionName])return console.warn("Behavior shortcuts-fit-view 的 functionName 参数 '".concat(this.functionName,"' 不合法，它不是 Graph 的一个函数名")),{};if(this.triggerKeydown&&!this.combinedKey){this.functionParams&&this.functionParams.length?i[this.functionName].apply(i,this.functionParams):i[this.functionName]();return}var o=this.combinedKey.toLowerCase();this.triggerKeydown&&(r===o||r==="control"&&o==="ctrl"||r==="ctrl"&&o==="control")&&(this.functionParams&&this.functionParams.length?i[this.functionName].apply(i,this.functionParams):i[this.functionName]())}},onKeyUp:function(){this.brush&&(this.brush.remove(!0),this.brush=null,this.dragging=!1),this.triggerKeydown=!1}};var rdt=["shift","ctrl","alt","control","meta"];const idt={getDefaultCfg:function(){return{direction:"both",enableOptimize:!1,zoomKey:"ctrl",scalableRange:0,allowDragOnItem:!0}},getEvents:function(){return(!this.zoomKey||rdt.indexOf(this.zoomKey)===-1)&&(this.zoomKey="ctrl"),{wheel:"onWheel"}},onWheel:function(t){var n=this;if(this.allowDrag(t)){var e=this.graph,r=Array.isArray(this.zoomKey)?[].concat(this.zoomKey):[this.zoomKey];r.includes("control")&&r.push("ctrl");var i=r.some(function(R){return t["".concat(R,"Key")]});if(i){var o=e.get("canvas"),a=o.getPointByClient(t.clientX,t.clientY),s=e.getZoom();t.wheelDelta>0?s=s+s*.05:s=s-s*.05,e.zoomTo(s,{x:a.x,y:a.y})}else{var u=t.deltaX||t.movementX,c=t.deltaY||t.movementY;!c&&navigator.userAgent.indexOf("Firefox")>-1&&(c=-t.wheelDelta*125/3);var l=this.graph.get("width"),h=this.graph.get("height"),f=this.graph.get("canvas").getCanvasBBox(),d=this.scalableRange,p=this.scalableRange;d<1&&d>-1&&(d=l*d,p=h*p);var g=f.minX,v=f.maxX,m=f.minY,y=f.maxY;u>0?v<-d?u=0:v-u<-d&&(u=v+d):u<0&&(g>l+d?u=0:g-u>l+d&&(u=g-(l+d))),c>0?y<-p?c=0:y-c<-p&&(c=y+p):c<0&&(m>h+p?c=0:m-c>h+p&&(c=m-(h+p))),this.get("direction")==="x"?c=0:this.get("direction")==="y"&&(u=0),e.translate(-u,-c)}t.preventDefault();var b=this.get("enableOptimize");if(b){var x=this.get("optimizeZoom"),w=this.get("optimized"),E=e.getNodes(),M=e.getEdges(),_=E.length,k=M.length;if(!w){for(var S=0;S<_;S++){var A=E[S];if(!A.destroyed)for(var C=A.get("group").get("children"),I=C.length,N=0;N<I;N++){var D=C[N];!D.destoryed&&!D.get("isKeyShape")&&(D.set("ori-visibility",D.get("ori-visibility")||D.get("visible")),D.hide())}}for(var P=0;P<k;P++)for(var j=M[P],C=j.get("group").get("children"),I=C.length,N=0;N<I;N++){var D=C[N];D.set("ori-visibility",D.get("ori-visibility")||D.get("visible")),D.hide()}this.set("optimized",!0)}clearTimeout(this.get("timeout"));var L=setTimeout(function(){var R=e.getZoom(),V=n.get("optimized");if(V){n.set("optimized",!1);for(var tt=0;tt<_;tt++){var ut=E[tt],dt=ut.get("group").get("children"),J=dt.length;if(R<x){var Et=ut.getKeyShape(),Bt=Et.get("ori-visibility");Bt&&Et.show()}else for(var Vt=0;Vt<J;Vt++){var se=dt[Vt],Bt=se.get("ori-visibility");!se.get("visible")&&Bt&&Bt&&se.show()}}for(var re=0;re<k;re++){var ue=M[re],dt=ue.get("group").get("children"),J=dt.length;if(R<x){var Et=ue.getKeyShape(),Bt=Et.get("ori-visibility");Bt&&Et.show()}else for(var Vt=0;Vt<J;Vt++){var se=dt[Vt];if(!se.get("visible")){var Bt=se.get("ori-visibility");Bt&&se.show()}}}}},100);this.set("timeout",L)}}},allowDrag:function(t){var n,e,r=t.target,i=r&&r.isCanvas&&r.isCanvas();if(Rl(this.allowDragOnItem)&&!this.allowDragOnItem&&!i)return!1;if(yr(this.allowDragOnItem)){var o=this.allowDragOnItem,a=o.node,s=o.edge,u=o.combo,c=(e=(n=t.item)===null||n===void 0?void 0:n.getType)===null||e===void 0?void 0:e.call(n);if(!a&&c==="node"||!s&&c==="edge"||!u&&c==="combo")return!1}return!0}};var odt={"drag-canvas":Cft,"zoom-canvas":jft,"drag-node":Ift,"activate-relations":Tft,"brush-select":Nft,"click-select":Pft,"lasso-select":Kft,tooltip:Rft,"edge-tooltip":Fft,"collapse-expand":zft,"drag-combo":Yft,"collapse-expand-combo":Wft,"create-edge":$ft,"shortcuts-call":ndt,"scroll-canvas":idt};mt(odt,function(t,n){DG(n,t)});B(B({},FB),QU);$e.Layouts;function adt(t){const n=new Vct({container:t,width:t.scrollWidth||window.innerWidth,height:t.scrollHeight||window.innerHeight-64,fitViewPadding:[30,10],defaultEdge:{type:"cubic-horizontal"},layout:{type:"compactBox",direction:"LR",getWidth(){return 20},getHeight(){return 20},getVGap(){return 5},getHGap(){return 50}},modes:{default:["collapse-expand"]}});return n.node(e=>{var r;return{type:"rect",size:[60,0],style:{stroke:"#91a7ff"},label:e.text||e.id,labelCfg:{position:"top",style:{x:-25,textAlign:"left",cursor:(r=e.children)!=null&&r.length?"":"pointer"}}}}),n.edge(e=>({style:{stroke:"#dbe4ff"}})),n}const udt=zP({__name:"graph",props:{renderData:{}},emits:["clickLeaf"],setup(t,{emit:n}){const e=t,r=GP();function i(o){var a;return o.children=o.items,(a=o.items)==null||a.forEach(s=>i(s)),o}return UP(()=>{const o=adt(r.value),a=i(e.renderData);o.data(a),o.render(),o.fitCenter(),o.fitView(),o.on("text-shape:click",s=>{var u,c;const l=(c=(u=s.item)==null?void 0:u._cfg)==null?void 0:c.model;l&&(l.items||n("clickLeaf",l.link))}),o.on("node:mouseenter",s=>{var u;const c=s.item;if(!c)return;const l=(u=c._cfg)==null?void 0:u.model;l!=null&&l.children||c.setState("highlight",!0)}),o.on("node:mouseleave",s=>{var u;const c=s.item;if(!c)return;const l=(u=c._cfg)==null?void 0:u.model;l!=null&&l.children||c.setState("highlight",!1)})}),(o,a)=>(YP(),VP("div",{ref_key:"tree",ref:r},null,512))}});export{udt as default};
